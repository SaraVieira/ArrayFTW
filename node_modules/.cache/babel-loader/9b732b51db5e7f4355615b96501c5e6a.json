{"ast":null,"code":"import _classCallCheck from \"/Projects/arrayftw/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Projects/arrayftw/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { FBXLoader } from '../loaders/FBXLoader.js';\n\nvar XRHandOculusMeshModel = /*#__PURE__*/function () {\n  function XRHandOculusMeshModel(handModel, controller, path, handedness, options) {\n    var _this = this;\n\n    _classCallCheck(this, XRHandOculusMeshModel);\n\n    this.controller = controller;\n    this.handModel = handModel;\n    this.bones = [];\n    var loader = new FBXLoader();\n    var low = options && options.model === 'lowpoly' ? '_low' : '';\n    loader.setPath(path);\n    loader.load(\"OculusHand_\".concat(handedness === 'right' ? 'R' : 'L').concat(low, \".fbx\"), function (object) {\n      _this.handModel.add(object); // Hack because of the scale of the skinnedmesh\n\n\n      object.scale.setScalar(0.01);\n      var mesh = object.getObjectByProperty('type', 'SkinnedMesh');\n      mesh.frustumCulled = false;\n      mesh.castShadow = true;\n      mesh.receiveShadow = true;\n      var bonesMapping = ['b_%_wrist', // XRHand.WRIST,\n      'b_%_thumb1', // XRHand.THUMB_METACARPAL,\n      'b_%_thumb2', // XRHand.THUMB_PHALANX_PROXIMAL,\n      'b_%_thumb3', // XRHand.THUMB_PHALANX_DISTAL,\n      'b_%_thumb_null', // XRHand.THUMB_PHALANX_TIP,\n      null, //'b_%_index1', // XRHand.INDEX_METACARPAL,\n      'b_%_index1', // XRHand.INDEX_PHALANX_PROXIMAL,\n      'b_%_index2', // XRHand.INDEX_PHALANX_INTERMEDIATE,\n      'b_%_index3', // XRHand.INDEX_PHALANX_DISTAL,\n      'b_%_index_null', // XRHand.INDEX_PHALANX_TIP,\n      null, //'b_%_middle1', // XRHand.MIDDLE_METACARPAL,\n      'b_%_middle1', // XRHand.MIDDLE_PHALANX_PROXIMAL,\n      'b_%_middle2', // XRHand.MIDDLE_PHALANX_INTERMEDIATE,\n      'b_%_middle3', // XRHand.MIDDLE_PHALANX_DISTAL,\n      'b_%_middlenull', // XRHand.MIDDLE_PHALANX_TIP,\n      null, //'b_%_ring1', // XRHand.RING_METACARPAL,\n      'b_%_ring1', // XRHand.RING_PHALANX_PROXIMAL,\n      'b_%_ring2', // XRHand.RING_PHALANX_INTERMEDIATE,\n      'b_%_ring3', // XRHand.RING_PHALANX_DISTAL,\n      'b_%_ring_inull', // XRHand.RING_PHALANX_TIP,\n      'b_%_pinky0', // XRHand.LITTLE_METACARPAL,\n      'b_%_pinky1', // XRHand.LITTLE_PHALANX_PROXIMAL,\n      'b_%_pinky2', // XRHand.LITTLE_PHALANX_INTERMEDIATE,\n      'b_%_pinky3', // XRHand.LITTLE_PHALANX_DISTAL,\n      'b_%_pinkynull' // XRHand.LITTLE_PHALANX_TIP\n      ];\n      var joints = ['wrist', 'thumb-metacarpal', 'thumb-phalanx-proximal', 'thumb-phalanx-distal', 'thumb-tip', 'index-finger-metacarpal', 'index-finger-phalanx-proximal', 'index-finger-phalanx-intermediate', 'index-finger-phalanx-distal', 'index-finger-tip', 'middle-finger-metacarpal', 'middle-finger-phalanx-proximal', 'middle-finger-phalanx-intermediate', 'middle-finger-phalanx-distal', 'middle-finger-tip', 'ring-finger-metacarpal', 'ring-finger-phalanx-proximal', 'ring-finger-phalanx-intermediate', 'ring-finger-phalanx-distal', 'ring-finger-tip', 'pinky-finger-metacarpal', 'pinky-finger-phalanx-proximal', 'pinky-finger-phalanx-intermediate', 'pinky-finger-phalanx-distal', 'pinky-finger-tip'];\n      var i = 0;\n      bonesMapping.forEach(function (boneName) {\n        if (boneName) {\n          var bone = object.getObjectByName(boneName.replace(/%/g, handedness === 'right' ? 'r' : 'l'));\n\n          if (bone !== undefined) {\n            bone.jointName = joints[i];\n          }\n\n          _this.bones.push(bone);\n        } else {\n          _this.bones.push(null);\n        }\n\n        i++;\n      });\n    });\n  }\n\n  _createClass(XRHandOculusMeshModel, [{\n    key: \"updateMesh\",\n    value: function updateMesh() {\n      // XR Joints\n      var XRJoints = this.controller.joints;\n\n      for (var i = 0; i < this.bones.length; i++) {\n        var bone = this.bones[i];\n\n        if (bone) {\n          var XRJoint = XRJoints[bone.jointName];\n\n          if (XRJoint.visible) {\n            var position = XRJoint.position;\n\n            if (bone) {\n              bone.position.copy(position.clone().multiplyScalar(100));\n              bone.quaternion.copy(XRJoint.quaternion); // bone.scale.setScalar( XRJoint.jointRadius || defaultRadius );\n            }\n          }\n        }\n      }\n    }\n  }]);\n\n  return XRHandOculusMeshModel;\n}();\n\nexport { XRHandOculusMeshModel };","map":{"version":3,"sources":["/Projects/arrayftw/node_modules/three-stdlib/webxr/XRHandOculusMeshModel.js"],"names":["FBXLoader","XRHandOculusMeshModel","handModel","controller","path","handedness","options","bones","loader","low","model","setPath","load","object","add","scale","setScalar","mesh","getObjectByProperty","frustumCulled","castShadow","receiveShadow","bonesMapping","joints","i","forEach","boneName","bone","getObjectByName","replace","undefined","jointName","push","XRJoints","length","XRJoint","visible","position","copy","clone","multiplyScalar","quaternion"],"mappings":"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","sourcesContent":["import { FBXLoader } from '../loaders/FBXLoader.js';\n\nclass XRHandOculusMeshModel {\n  constructor(handModel, controller, path, handedness, options) {\n    this.controller = controller;\n    this.handModel = handModel;\n    this.bones = [];\n    const loader = new FBXLoader();\n    const low = options && options.model === 'lowpoly' ? '_low' : '';\n    loader.setPath(path);\n    loader.load(`OculusHand_${handedness === 'right' ? 'R' : 'L'}${low}.fbx`, object => {\n      this.handModel.add(object); // Hack because of the scale of the skinnedmesh\n\n      object.scale.setScalar(0.01);\n      const mesh = object.getObjectByProperty('type', 'SkinnedMesh');\n      mesh.frustumCulled = false;\n      mesh.castShadow = true;\n      mesh.receiveShadow = true;\n      const bonesMapping = ['b_%_wrist', // XRHand.WRIST,\n      'b_%_thumb1', // XRHand.THUMB_METACARPAL,\n      'b_%_thumb2', // XRHand.THUMB_PHALANX_PROXIMAL,\n      'b_%_thumb3', // XRHand.THUMB_PHALANX_DISTAL,\n      'b_%_thumb_null', // XRHand.THUMB_PHALANX_TIP,\n      null, //'b_%_index1', // XRHand.INDEX_METACARPAL,\n      'b_%_index1', // XRHand.INDEX_PHALANX_PROXIMAL,\n      'b_%_index2', // XRHand.INDEX_PHALANX_INTERMEDIATE,\n      'b_%_index3', // XRHand.INDEX_PHALANX_DISTAL,\n      'b_%_index_null', // XRHand.INDEX_PHALANX_TIP,\n      null, //'b_%_middle1', // XRHand.MIDDLE_METACARPAL,\n      'b_%_middle1', // XRHand.MIDDLE_PHALANX_PROXIMAL,\n      'b_%_middle2', // XRHand.MIDDLE_PHALANX_INTERMEDIATE,\n      'b_%_middle3', // XRHand.MIDDLE_PHALANX_DISTAL,\n      'b_%_middlenull', // XRHand.MIDDLE_PHALANX_TIP,\n      null, //'b_%_ring1', // XRHand.RING_METACARPAL,\n      'b_%_ring1', // XRHand.RING_PHALANX_PROXIMAL,\n      'b_%_ring2', // XRHand.RING_PHALANX_INTERMEDIATE,\n      'b_%_ring3', // XRHand.RING_PHALANX_DISTAL,\n      'b_%_ring_inull', // XRHand.RING_PHALANX_TIP,\n      'b_%_pinky0', // XRHand.LITTLE_METACARPAL,\n      'b_%_pinky1', // XRHand.LITTLE_PHALANX_PROXIMAL,\n      'b_%_pinky2', // XRHand.LITTLE_PHALANX_INTERMEDIATE,\n      'b_%_pinky3', // XRHand.LITTLE_PHALANX_DISTAL,\n      'b_%_pinkynull' // XRHand.LITTLE_PHALANX_TIP\n      ];\n      const joints = ['wrist', 'thumb-metacarpal', 'thumb-phalanx-proximal', 'thumb-phalanx-distal', 'thumb-tip', 'index-finger-metacarpal', 'index-finger-phalanx-proximal', 'index-finger-phalanx-intermediate', 'index-finger-phalanx-distal', 'index-finger-tip', 'middle-finger-metacarpal', 'middle-finger-phalanx-proximal', 'middle-finger-phalanx-intermediate', 'middle-finger-phalanx-distal', 'middle-finger-tip', 'ring-finger-metacarpal', 'ring-finger-phalanx-proximal', 'ring-finger-phalanx-intermediate', 'ring-finger-phalanx-distal', 'ring-finger-tip', 'pinky-finger-metacarpal', 'pinky-finger-phalanx-proximal', 'pinky-finger-phalanx-intermediate', 'pinky-finger-phalanx-distal', 'pinky-finger-tip'];\n      let i = 0;\n      bonesMapping.forEach(boneName => {\n        if (boneName) {\n          const bone = object.getObjectByName(boneName.replace(/%/g, handedness === 'right' ? 'r' : 'l'));\n\n          if (bone !== undefined) {\n            bone.jointName = joints[i];\n          }\n\n          this.bones.push(bone);\n        } else {\n          this.bones.push(null);\n        }\n\n        i++;\n      });\n    });\n  }\n\n  updateMesh() {\n    // XR Joints\n    const XRJoints = this.controller.joints;\n\n    for (let i = 0; i < this.bones.length; i++) {\n      const bone = this.bones[i];\n\n      if (bone) {\n        const XRJoint = XRJoints[bone.jointName];\n\n        if (XRJoint.visible) {\n          const position = XRJoint.position;\n\n          if (bone) {\n            bone.position.copy(position.clone().multiplyScalar(100));\n            bone.quaternion.copy(XRJoint.quaternion); // bone.scale.setScalar( XRJoint.jointRadius || defaultRadius );\n          }\n        }\n      }\n    }\n  }\n\n}\n\nexport { XRHandOculusMeshModel };\n"]},"metadata":{},"sourceType":"module"}