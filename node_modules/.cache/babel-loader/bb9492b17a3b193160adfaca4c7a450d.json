{"ast":null,"code":"import { ShaderMaterial, NormalBlending, FrontSide, NoColors, LessEqualDepth } from 'three';\nimport { NodeBuilder } from '../core/NodeBuilder.js';\nimport { ColorNode } from '../inputs/ColorNode.js';\nimport { PositionNode } from '../accessors/PositionNode.js';\nimport { RawNode } from './nodes/RawNode.js';\n\nfunction NodeMaterial(vertex, fragment) {\n  ShaderMaterial.call(this);\n  this.vertex = vertex || new RawNode(new PositionNode(PositionNode.PROJECTION));\n  this.fragment = fragment || new RawNode(new ColorNode(0xff0000));\n  this.updaters = [];\n}\n\nNodeMaterial.prototype = Object.create(ShaderMaterial.prototype);\nNodeMaterial.prototype.constructor = NodeMaterial;\nNodeMaterial.prototype.type = 'NodeMaterial';\nNodeMaterial.prototype.isNodeMaterial = true;\nObject.defineProperties(NodeMaterial.prototype, {\n  properties: {\n    get: function get() {\n      return this.fragment.properties;\n    }\n  },\n  needsUpdate: {\n    set: function set(value) {\n      if (value === true) this.version++;\n      this.needsCompile = value;\n    },\n    get: function get() {\n      return this.needsCompile;\n    }\n  }\n});\n\nNodeMaterial.prototype.onBeforeCompile = function (shader, renderer) {\n  this.build({\n    renderer: renderer\n  });\n  shader.defines = this.defines;\n  shader.uniforms = this.uniforms;\n  shader.vertexShader = this.vertexShader;\n  shader.fragmentShader = this.fragmentShader;\n  shader.extensionDerivatives = this.extensions.derivatives === true;\n  shader.extensionFragDepth = this.extensions.fragDepth === true;\n  shader.extensionDrawBuffers = this.extensions.drawBuffers === true;\n  shader.extensionShaderTextureLOD = this.extensions.shaderTextureLOD === true;\n};\n\nNodeMaterial.prototype.customProgramCacheKey = function () {\n  var hash = this.getHash();\n  return hash;\n};\n\nNodeMaterial.prototype.getHash = function () {\n  var hash = '{';\n  hash += '\"vertex\":' + this.vertex.getHash() + ',';\n  hash += '\"fragment\":' + this.fragment.getHash();\n  hash += '}';\n  return hash;\n};\n\nNodeMaterial.prototype.updateFrame = function (frame) {\n  for (var i = 0; i < this.updaters.length; ++i) {\n    frame.updateNode(this.updaters[i]);\n  }\n};\n\nNodeMaterial.prototype.build = function (params) {\n  params = params || {};\n  var builder = params.builder || new NodeBuilder();\n  builder.setMaterial(this, params.renderer);\n  builder.build(this.vertex, this.fragment);\n  this.vertexShader = builder.getCode('vertex');\n  this.fragmentShader = builder.getCode('fragment');\n  this.defines = builder.defines;\n  this.uniforms = builder.uniforms;\n  this.extensions = builder.extensions;\n  this.updaters = builder.updaters;\n  this.fog = builder.requires.fog;\n  this.lights = builder.requires.lights;\n  this.transparent = builder.requires.transparent || this.blending > NormalBlending;\n  return this;\n};\n\nNodeMaterial.prototype.copy = function (source) {\n  var uuid = this.uuid;\n\n  for (var name in source) {\n    this[name] = source[name];\n  }\n\n  this.uuid = uuid;\n\n  if (source.userData !== undefined) {\n    this.userData = JSON.parse(JSON.stringify(source.userData));\n  }\n\n  return this;\n};\n\nNodeMaterial.prototype.toJSON = function (meta) {\n  var isRootObject = meta === undefined || typeof meta === 'string';\n\n  if (isRootObject) {\n    meta = {\n      nodes: {}\n    };\n  }\n\n  if (meta && !meta.materials) meta.materials = {};\n\n  if (!meta.materials[this.uuid]) {\n    var data = {};\n    data.uuid = this.uuid;\n    data.type = this.type;\n    meta.materials[data.uuid] = data;\n    if (this.name !== '') data.name = this.name;\n    if (this.size !== undefined) data.size = this.size;\n    if (this.sizeAttenuation !== undefined) data.sizeAttenuation = this.sizeAttenuation;\n    if (this.blending !== NormalBlending) data.blending = this.blending;\n    if (this.flatShading === true) data.flatShading = this.flatShading;\n    if (this.side !== FrontSide) data.side = this.side;\n    if (this.vertexColors !== NoColors) data.vertexColors = this.vertexColors;\n    if (this.depthFunc !== LessEqualDepth) data.depthFunc = this.depthFunc;\n    if (this.depthTest === false) data.depthTest = this.depthTest;\n    if (this.depthWrite === false) data.depthWrite = this.depthWrite;\n    if (this.linewidth !== 1) data.linewidth = this.linewidth;\n    if (this.dashSize !== undefined) data.dashSize = this.dashSize;\n    if (this.gapSize !== undefined) data.gapSize = this.gapSize;\n    if (this.scale !== undefined) data.scale = this.scale;\n    if (this.dithering === true) data.dithering = true;\n    if (this.wireframe === true) data.wireframe = this.wireframe;\n    if (this.wireframeLinewidth > 1) data.wireframeLinewidth = this.wireframeLinewidth;\n    if (this.wireframeLinecap !== 'round') data.wireframeLinecap = this.wireframeLinecap;\n    if (this.wireframeLinejoin !== 'round') data.wireframeLinejoin = this.wireframeLinejoin;\n    if (this.alphaTest > 0) data.alphaTest = this.alphaTest;\n    if (this.premultipliedAlpha === true) data.premultipliedAlpha = this.premultipliedAlpha;\n    if (this.morphTargets === true) data.morphTargets = true;\n    if (this.skinning === true) data.skinning = true;\n    if (this.visible === false) data.visible = false;\n    if (JSON.stringify(this.userData) !== '{}') data.userData = this.userData;\n    data.fog = this.fog;\n    data.lights = this.lights;\n    data.vertex = this.vertex.toJSON(meta).uuid;\n    data.fragment = this.fragment.toJSON(meta).uuid;\n  }\n\n  meta.material = this.uuid;\n  return meta;\n};\n\nexport { NodeMaterial };","map":{"version":3,"sources":["/Projects/arrayftw/node_modules/three-stdlib/nodes/materials/NodeMaterial.js"],"names":["ShaderMaterial","NormalBlending","FrontSide","NoColors","LessEqualDepth","NodeBuilder","ColorNode","PositionNode","RawNode","NodeMaterial","vertex","fragment","call","PROJECTION","updaters","prototype","Object","create","constructor","type","isNodeMaterial","defineProperties","properties","get","needsUpdate","set","value","version","needsCompile","onBeforeCompile","shader","renderer","build","defines","uniforms","vertexShader","fragmentShader","extensionDerivatives","extensions","derivatives","extensionFragDepth","fragDepth","extensionDrawBuffers","drawBuffers","extensionShaderTextureLOD","shaderTextureLOD","customProgramCacheKey","hash","getHash","updateFrame","frame","i","length","updateNode","params","builder","setMaterial","getCode","fog","requires","lights","transparent","blending","copy","source","uuid","name","userData","undefined","JSON","parse","stringify","toJSON","meta","isRootObject","nodes","materials","data","size","sizeAttenuation","flatShading","side","vertexColors","depthFunc","depthTest","depthWrite","linewidth","dashSize","gapSize","scale","dithering","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","alphaTest","premultipliedAlpha","morphTargets","skinning","visible","material"],"mappings":"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","sourcesContent":["import { ShaderMaterial, NormalBlending, FrontSide, NoColors, LessEqualDepth } from 'three';\nimport { NodeBuilder } from '../core/NodeBuilder.js';\nimport { ColorNode } from '../inputs/ColorNode.js';\nimport { PositionNode } from '../accessors/PositionNode.js';\nimport { RawNode } from './nodes/RawNode.js';\n\nfunction NodeMaterial(vertex, fragment) {\n  ShaderMaterial.call(this);\n  this.vertex = vertex || new RawNode(new PositionNode(PositionNode.PROJECTION));\n  this.fragment = fragment || new RawNode(new ColorNode(0xff0000));\n  this.updaters = [];\n}\n\nNodeMaterial.prototype = Object.create(ShaderMaterial.prototype);\nNodeMaterial.prototype.constructor = NodeMaterial;\nNodeMaterial.prototype.type = 'NodeMaterial';\nNodeMaterial.prototype.isNodeMaterial = true;\nObject.defineProperties(NodeMaterial.prototype, {\n  properties: {\n    get: function () {\n      return this.fragment.properties;\n    }\n  },\n  needsUpdate: {\n    set: function (value) {\n      if (value === true) this.version++;\n      this.needsCompile = value;\n    },\n    get: function () {\n      return this.needsCompile;\n    }\n  }\n});\n\nNodeMaterial.prototype.onBeforeCompile = function (shader, renderer) {\n  this.build({\n    renderer: renderer\n  });\n  shader.defines = this.defines;\n  shader.uniforms = this.uniforms;\n  shader.vertexShader = this.vertexShader;\n  shader.fragmentShader = this.fragmentShader;\n  shader.extensionDerivatives = this.extensions.derivatives === true;\n  shader.extensionFragDepth = this.extensions.fragDepth === true;\n  shader.extensionDrawBuffers = this.extensions.drawBuffers === true;\n  shader.extensionShaderTextureLOD = this.extensions.shaderTextureLOD === true;\n};\n\nNodeMaterial.prototype.customProgramCacheKey = function () {\n  var hash = this.getHash();\n  return hash;\n};\n\nNodeMaterial.prototype.getHash = function () {\n  var hash = '{';\n  hash += '\"vertex\":' + this.vertex.getHash() + ',';\n  hash += '\"fragment\":' + this.fragment.getHash();\n  hash += '}';\n  return hash;\n};\n\nNodeMaterial.prototype.updateFrame = function (frame) {\n  for (let i = 0; i < this.updaters.length; ++i) {\n    frame.updateNode(this.updaters[i]);\n  }\n};\n\nNodeMaterial.prototype.build = function (params) {\n  params = params || {};\n  var builder = params.builder || new NodeBuilder();\n  builder.setMaterial(this, params.renderer);\n  builder.build(this.vertex, this.fragment);\n  this.vertexShader = builder.getCode('vertex');\n  this.fragmentShader = builder.getCode('fragment');\n  this.defines = builder.defines;\n  this.uniforms = builder.uniforms;\n  this.extensions = builder.extensions;\n  this.updaters = builder.updaters;\n  this.fog = builder.requires.fog;\n  this.lights = builder.requires.lights;\n  this.transparent = builder.requires.transparent || this.blending > NormalBlending;\n  return this;\n};\n\nNodeMaterial.prototype.copy = function (source) {\n  var uuid = this.uuid;\n\n  for (let name in source) {\n    this[name] = source[name];\n  }\n\n  this.uuid = uuid;\n\n  if (source.userData !== undefined) {\n    this.userData = JSON.parse(JSON.stringify(source.userData));\n  }\n\n  return this;\n};\n\nNodeMaterial.prototype.toJSON = function (meta) {\n  var isRootObject = meta === undefined || typeof meta === 'string';\n\n  if (isRootObject) {\n    meta = {\n      nodes: {}\n    };\n  }\n\n  if (meta && !meta.materials) meta.materials = {};\n\n  if (!meta.materials[this.uuid]) {\n    var data = {};\n    data.uuid = this.uuid;\n    data.type = this.type;\n    meta.materials[data.uuid] = data;\n    if (this.name !== '') data.name = this.name;\n    if (this.size !== undefined) data.size = this.size;\n    if (this.sizeAttenuation !== undefined) data.sizeAttenuation = this.sizeAttenuation;\n    if (this.blending !== NormalBlending) data.blending = this.blending;\n    if (this.flatShading === true) data.flatShading = this.flatShading;\n    if (this.side !== FrontSide) data.side = this.side;\n    if (this.vertexColors !== NoColors) data.vertexColors = this.vertexColors;\n    if (this.depthFunc !== LessEqualDepth) data.depthFunc = this.depthFunc;\n    if (this.depthTest === false) data.depthTest = this.depthTest;\n    if (this.depthWrite === false) data.depthWrite = this.depthWrite;\n    if (this.linewidth !== 1) data.linewidth = this.linewidth;\n    if (this.dashSize !== undefined) data.dashSize = this.dashSize;\n    if (this.gapSize !== undefined) data.gapSize = this.gapSize;\n    if (this.scale !== undefined) data.scale = this.scale;\n    if (this.dithering === true) data.dithering = true;\n    if (this.wireframe === true) data.wireframe = this.wireframe;\n    if (this.wireframeLinewidth > 1) data.wireframeLinewidth = this.wireframeLinewidth;\n    if (this.wireframeLinecap !== 'round') data.wireframeLinecap = this.wireframeLinecap;\n    if (this.wireframeLinejoin !== 'round') data.wireframeLinejoin = this.wireframeLinejoin;\n    if (this.alphaTest > 0) data.alphaTest = this.alphaTest;\n    if (this.premultipliedAlpha === true) data.premultipliedAlpha = this.premultipliedAlpha;\n    if (this.morphTargets === true) data.morphTargets = true;\n    if (this.skinning === true) data.skinning = true;\n    if (this.visible === false) data.visible = false;\n    if (JSON.stringify(this.userData) !== '{}') data.userData = this.userData;\n    data.fog = this.fog;\n    data.lights = this.lights;\n    data.vertex = this.vertex.toJSON(meta).uuid;\n    data.fragment = this.fragment.toJSON(meta).uuid;\n  }\n\n  meta.material = this.uuid;\n  return meta;\n};\n\nexport { NodeMaterial };\n"]},"metadata":{},"sourceType":"module"}