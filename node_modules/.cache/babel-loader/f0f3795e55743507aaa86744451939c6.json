{"ast":null,"code":"import { TempNode } from './TempNode.js';\nvar declarationRegexp = /^([a-z_0-9]+)\\s([a-z_0-9]+)\\s?\\=?\\s?(.*?)(\\;|$)/i;\n\nfunction ConstNode(src, useDefine) {\n  TempNode.call(this);\n  this.parse(src || ConstNode.PI, useDefine);\n}\n\nConstNode.PI = 'PI';\nConstNode.PI2 = 'PI2';\nConstNode.RECIPROCAL_PI = 'RECIPROCAL_PI';\nConstNode.RECIPROCAL_PI2 = 'RECIPROCAL_PI2';\nConstNode.LOG2 = 'LOG2';\nConstNode.EPSILON = 'EPSILON';\nConstNode.prototype = Object.create(TempNode.prototype);\nConstNode.prototype.constructor = ConstNode;\nConstNode.prototype.nodeType = 'Const';\n\nConstNode.prototype.getType = function (builder) {\n  return builder.getTypeByFormat(this.type);\n};\n\nConstNode.prototype.parse = function (src, useDefine) {\n  this.src = src || '';\n  var name,\n      type,\n      value = '';\n  var match = this.src.match(declarationRegexp);\n  this.useDefine = useDefine || this.src.charAt(0) === '#';\n\n  if (match && match.length > 1) {\n    type = match[1];\n    name = match[2];\n    value = match[3];\n  } else {\n    name = this.src;\n    type = 'f';\n  }\n\n  this.name = name;\n  this.type = type;\n  this.value = value;\n};\n\nConstNode.prototype.build = function (builder, output) {\n  if (output === 'source') {\n    if (this.value) {\n      if (this.useDefine) {\n        return '#define ' + this.name + ' ' + this.value;\n      }\n\n      return 'const ' + this.type + ' ' + this.name + ' = ' + this.value + ';';\n    } else if (this.useDefine) {\n      return this.src;\n    }\n  } else {\n    builder.include(this);\n    return builder.format(this.name, this.getType(builder), output);\n  }\n};\n\nConstNode.prototype.generate = function (builder, output) {\n  return builder.format(this.name, this.getType(builder), output);\n};\n\nConstNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.parse(source.src, source.useDefine);\n  return this;\n};\n\nConstNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.src = this.src;\n    if (data.useDefine === true) data.useDefine = true;\n  }\n\n  return data;\n};\n\nexport { ConstNode };","map":{"version":3,"sources":["/Projects/arrayftw/node_modules/three-stdlib/nodes/core/ConstNode.js"],"names":["TempNode","declarationRegexp","ConstNode","src","useDefine","call","parse","PI","PI2","RECIPROCAL_PI","RECIPROCAL_PI2","LOG2","EPSILON","prototype","Object","create","constructor","nodeType","getType","builder","getTypeByFormat","type","name","value","match","charAt","length","build","output","include","format","generate","copy","source","toJSON","meta","data","getJSONNode","createJSONNode"],"mappings":"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","sourcesContent":["import { TempNode } from './TempNode.js';\n\nvar declarationRegexp = /^([a-z_0-9]+)\\s([a-z_0-9]+)\\s?\\=?\\s?(.*?)(\\;|$)/i;\n\nfunction ConstNode(src, useDefine) {\n  TempNode.call(this);\n  this.parse(src || ConstNode.PI, useDefine);\n}\n\nConstNode.PI = 'PI';\nConstNode.PI2 = 'PI2';\nConstNode.RECIPROCAL_PI = 'RECIPROCAL_PI';\nConstNode.RECIPROCAL_PI2 = 'RECIPROCAL_PI2';\nConstNode.LOG2 = 'LOG2';\nConstNode.EPSILON = 'EPSILON';\nConstNode.prototype = Object.create(TempNode.prototype);\nConstNode.prototype.constructor = ConstNode;\nConstNode.prototype.nodeType = 'Const';\n\nConstNode.prototype.getType = function (builder) {\n  return builder.getTypeByFormat(this.type);\n};\n\nConstNode.prototype.parse = function (src, useDefine) {\n  this.src = src || '';\n  var name,\n      type,\n      value = '';\n  var match = this.src.match(declarationRegexp);\n  this.useDefine = useDefine || this.src.charAt(0) === '#';\n\n  if (match && match.length > 1) {\n    type = match[1];\n    name = match[2];\n    value = match[3];\n  } else {\n    name = this.src;\n    type = 'f';\n  }\n\n  this.name = name;\n  this.type = type;\n  this.value = value;\n};\n\nConstNode.prototype.build = function (builder, output) {\n  if (output === 'source') {\n    if (this.value) {\n      if (this.useDefine) {\n        return '#define ' + this.name + ' ' + this.value;\n      }\n\n      return 'const ' + this.type + ' ' + this.name + ' = ' + this.value + ';';\n    } else if (this.useDefine) {\n      return this.src;\n    }\n  } else {\n    builder.include(this);\n    return builder.format(this.name, this.getType(builder), output);\n  }\n};\n\nConstNode.prototype.generate = function (builder, output) {\n  return builder.format(this.name, this.getType(builder), output);\n};\n\nConstNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.parse(source.src, source.useDefine);\n  return this;\n};\n\nConstNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.src = this.src;\n    if (data.useDefine === true) data.useDefine = true;\n  }\n\n  return data;\n};\n\nexport { ConstNode };\n"]},"metadata":{},"sourceType":"module"}