{"ast":null,"code":"import { DefaultLoadingManager, FileLoader } from 'three';\nimport * as Nodes from '../nodes/Nodes.js';\n\nvar NodeMaterialLoader = function NodeMaterialLoader(manager, library) {\n  this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n  this.nodes = {};\n  this.materials = {};\n  this.passes = {};\n  this.names = {};\n  this.library = library || {};\n};\n\nvar NodeMaterialLoaderUtils = {\n  replaceUUIDObject: function replaceUUIDObject(object, uuid, value, recursive) {\n    recursive = recursive !== undefined ? recursive : true;\n    if (typeof uuid === 'object') uuid = uuid.uuid;\n\n    if (typeof object === 'object') {\n      var keys = Object.keys(object);\n\n      for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n\n        if (recursive) {\n          object[key] = this.replaceUUIDObject(object[key], uuid, value);\n        }\n\n        if (key === uuid) {\n          object[uuid] = object[key];\n          delete object[key];\n        }\n      }\n    }\n\n    return object === uuid ? value : object;\n  },\n  replaceUUID: function replaceUUID(json, uuid, value) {\n    this.replaceUUIDObject(json, uuid, value, false);\n    this.replaceUUIDObject(json.nodes, uuid, value);\n    this.replaceUUIDObject(json.materials, uuid, value);\n    this.replaceUUIDObject(json.passes, uuid, value);\n    this.replaceUUIDObject(json.library, uuid, value, false);\n    return json;\n  }\n};\nObject.assign(NodeMaterialLoader.prototype, {\n  load: function load(url, onLoad, onProgress, onError) {\n    var scope = this;\n    var loader = new FileLoader(scope.manager);\n    loader.setPath(scope.path);\n    loader.load(url, function (text) {\n      onLoad(scope.parse(JSON.parse(text)));\n    }, onProgress, onError);\n    return this;\n  },\n  setPath: function setPath(value) {\n    this.path = value;\n    return this;\n  },\n  getObjectByName: function getObjectByName(uuid) {\n    return this.names[uuid];\n  },\n  getObjectById: function getObjectById(uuid) {\n    return this.library[uuid] || this.nodes[uuid] || this.materials[uuid] || this.passes[uuid] || this.names[uuid];\n  },\n  getNode: function getNode(uuid) {\n    var object = this.getObjectById(uuid);\n\n    if (!object) {\n      console.warn('Node \"' + uuid + '\" not found.');\n    }\n\n    return object;\n  },\n  resolve: function resolve(json) {\n    switch (typeof json) {\n      case 'boolean':\n      case 'number':\n        return json;\n\n      case 'string':\n        if (/^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test(json) || this.library[json]) {\n          return this.getNode(json);\n        }\n\n        return json;\n\n      default:\n        if (Array.isArray(json)) {\n          for (var i = 0; i < json.length; i++) {\n            json[i] = this.resolve(json[i]);\n          }\n        } else {\n          for (var prop in json) {\n            if (prop === 'uuid') continue;\n            json[prop] = this.resolve(json[prop]);\n          }\n        }\n\n    }\n\n    return json;\n  },\n  declare: function declare(json) {\n    var uuid, node, object;\n\n    for (uuid in json.nodes) {\n      node = json.nodes[uuid];\n      object = new Nodes[node.nodeType + 'Node']();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.nodes[uuid] = object;\n    }\n\n    for (uuid in json.materials) {\n      node = json.materials[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.materials[uuid] = object;\n    }\n\n    for (uuid in json.passes) {\n      node = json.passes[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.passes[uuid] = object;\n    }\n\n    if (json.material) this.material = this.materials[json.material];\n    if (json.pass) this.pass = this.passes[json.pass];\n    return json;\n  },\n  parse: function parse(json) {\n    var uuid;\n    json = this.resolve(this.declare(json));\n\n    for (uuid in json.nodes) {\n      this.nodes[uuid].copy(json.nodes[uuid]);\n    }\n\n    for (uuid in json.materials) {\n      this.materials[uuid].copy(json.materials[uuid]);\n    }\n\n    for (uuid in json.passes) {\n      this.passes[uuid].copy(json.passes[uuid]);\n    }\n\n    return this.material || this.pass || this;\n  }\n});\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };","map":{"version":3,"sources":["/Projects/arrayftw/node_modules/three-stdlib/loaders/NodeMaterialLoader.js"],"names":["DefaultLoadingManager","FileLoader","Nodes","NodeMaterialLoader","manager","library","undefined","nodes","materials","passes","names","NodeMaterialLoaderUtils","replaceUUIDObject","object","uuid","value","recursive","keys","Object","i","length","key","replaceUUID","json","assign","prototype","load","url","onLoad","onProgress","onError","scope","loader","setPath","path","text","parse","JSON","getObjectByName","getObjectById","getNode","console","warn","resolve","test","Array","isArray","prop","declare","node","nodeType","name","type","material","pass","copy"],"mappings":"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","sourcesContent":["import { DefaultLoadingManager, FileLoader } from 'three';\nimport * as Nodes from '../nodes/Nodes.js';\n\nvar NodeMaterialLoader = function (manager, library) {\n  this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n  this.nodes = {};\n  this.materials = {};\n  this.passes = {};\n  this.names = {};\n  this.library = library || {};\n};\n\nvar NodeMaterialLoaderUtils = {\n  replaceUUIDObject: function (object, uuid, value, recursive) {\n    recursive = recursive !== undefined ? recursive : true;\n    if (typeof uuid === 'object') uuid = uuid.uuid;\n\n    if (typeof object === 'object') {\n      var keys = Object.keys(object);\n\n      for (let i = 0; i < keys.length; i++) {\n        var key = keys[i];\n\n        if (recursive) {\n          object[key] = this.replaceUUIDObject(object[key], uuid, value);\n        }\n\n        if (key === uuid) {\n          object[uuid] = object[key];\n          delete object[key];\n        }\n      }\n    }\n\n    return object === uuid ? value : object;\n  },\n  replaceUUID: function (json, uuid, value) {\n    this.replaceUUIDObject(json, uuid, value, false);\n    this.replaceUUIDObject(json.nodes, uuid, value);\n    this.replaceUUIDObject(json.materials, uuid, value);\n    this.replaceUUIDObject(json.passes, uuid, value);\n    this.replaceUUIDObject(json.library, uuid, value, false);\n    return json;\n  }\n};\nObject.assign(NodeMaterialLoader.prototype, {\n  load: function (url, onLoad, onProgress, onError) {\n    var scope = this;\n    var loader = new FileLoader(scope.manager);\n    loader.setPath(scope.path);\n    loader.load(url, function (text) {\n      onLoad(scope.parse(JSON.parse(text)));\n    }, onProgress, onError);\n    return this;\n  },\n  setPath: function (value) {\n    this.path = value;\n    return this;\n  },\n  getObjectByName: function (uuid) {\n    return this.names[uuid];\n  },\n  getObjectById: function (uuid) {\n    return this.library[uuid] || this.nodes[uuid] || this.materials[uuid] || this.passes[uuid] || this.names[uuid];\n  },\n  getNode: function (uuid) {\n    var object = this.getObjectById(uuid);\n\n    if (!object) {\n      console.warn('Node \"' + uuid + '\" not found.');\n    }\n\n    return object;\n  },\n  resolve: function (json) {\n    switch (typeof json) {\n      case 'boolean':\n      case 'number':\n        return json;\n\n      case 'string':\n        if (/^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test(json) || this.library[json]) {\n          return this.getNode(json);\n        }\n\n        return json;\n\n      default:\n        if (Array.isArray(json)) {\n          for (let i = 0; i < json.length; i++) {\n            json[i] = this.resolve(json[i]);\n          }\n        } else {\n          for (let prop in json) {\n            if (prop === 'uuid') continue;\n            json[prop] = this.resolve(json[prop]);\n          }\n        }\n\n    }\n\n    return json;\n  },\n  declare: function (json) {\n    var uuid, node, object;\n\n    for (uuid in json.nodes) {\n      node = json.nodes[uuid];\n      object = new Nodes[node.nodeType + 'Node']();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.nodes[uuid] = object;\n    }\n\n    for (uuid in json.materials) {\n      node = json.materials[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.materials[uuid] = object;\n    }\n\n    for (uuid in json.passes) {\n      node = json.passes[uuid];\n      object = new Nodes[node.type]();\n\n      if (node.name) {\n        object.name = node.name;\n        this.names[object.name] = object;\n      }\n\n      this.passes[uuid] = object;\n    }\n\n    if (json.material) this.material = this.materials[json.material];\n    if (json.pass) this.pass = this.passes[json.pass];\n    return json;\n  },\n  parse: function (json) {\n    var uuid;\n    json = this.resolve(this.declare(json));\n\n    for (uuid in json.nodes) {\n      this.nodes[uuid].copy(json.nodes[uuid]);\n    }\n\n    for (uuid in json.materials) {\n      this.materials[uuid].copy(json.materials[uuid]);\n    }\n\n    for (uuid in json.passes) {\n      this.passes[uuid].copy(json.passes[uuid]);\n    }\n\n    return this.material || this.pass || this;\n  }\n});\n\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };\n"]},"metadata":{},"sourceType":"module"}