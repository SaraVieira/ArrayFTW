{"ast":null,"code":"import { TempNode } from '../core/TempNode.js';\n\nfunction MathNode(a, bOrMethod, cOrMethod, method) {\n  TempNode.call(this);\n  this.a = a;\n  typeof bOrMethod !== 'string' ? this.b = bOrMethod : method = bOrMethod;\n  typeof cOrMethod !== 'string' ? this.c = cOrMethod : method = cOrMethod;\n  this.method = method;\n} // 1 input\n\n\nMathNode.RAD = 'radians';\nMathNode.DEG = 'degrees';\nMathNode.EXP = 'exp';\nMathNode.EXP2 = 'exp2';\nMathNode.LOG = 'log';\nMathNode.LOG2 = 'log2';\nMathNode.SQRT = 'sqrt';\nMathNode.INV_SQRT = 'inversesqrt';\nMathNode.FLOOR = 'floor';\nMathNode.CEIL = 'ceil';\nMathNode.NORMALIZE = 'normalize';\nMathNode.FRACT = 'fract';\nMathNode.SATURATE = 'saturate';\nMathNode.SIN = 'sin';\nMathNode.COS = 'cos';\nMathNode.TAN = 'tan';\nMathNode.ASIN = 'asin';\nMathNode.ACOS = 'acos';\nMathNode.ARCTAN = 'atan';\nMathNode.ABS = 'abs';\nMathNode.SIGN = 'sign';\nMathNode.LENGTH = 'length';\nMathNode.NEGATE = 'negate';\nMathNode.INVERT = 'invert'; // 2 inputs\n\nMathNode.MIN = 'min';\nMathNode.MAX = 'max';\nMathNode.MOD = 'mod';\nMathNode.STEP = 'step';\nMathNode.REFLECT = 'reflect';\nMathNode.DISTANCE = 'distance';\nMathNode.DOT = 'dot';\nMathNode.CROSS = 'cross';\nMathNode.POW = 'pow'; // 3 inputs\n\nMathNode.MIX = 'mix';\nMathNode.CLAMP = 'clamp';\nMathNode.REFRACT = 'refract';\nMathNode.SMOOTHSTEP = 'smoothstep';\nMathNode.FACEFORWARD = 'faceforward';\nMathNode.prototype = Object.create(TempNode.prototype);\nMathNode.prototype.constructor = MathNode;\nMathNode.prototype.nodeType = 'Math';\nMathNode.prototype.hashProperties = ['method'];\n\nMathNode.prototype.getNumInputs = function ()\n/*builder*/\n{\n  switch (this.method) {\n    case MathNode.MIX:\n    case MathNode.CLAMP:\n    case MathNode.REFRACT:\n    case MathNode.SMOOTHSTEP:\n    case MathNode.FACEFORWARD:\n      return 3;\n\n    case MathNode.MIN:\n    case MathNode.MAX:\n    case MathNode.MOD:\n    case MathNode.STEP:\n    case MathNode.REFLECT:\n    case MathNode.DISTANCE:\n    case MathNode.DOT:\n    case MathNode.CROSS:\n    case MathNode.POW:\n      return 2;\n\n    default:\n      return 1;\n  }\n};\n\nMathNode.prototype.getInputType = function (builder) {\n  var a = builder.getTypeLength(this.a.getType(builder));\n  var b = this.b ? builder.getTypeLength(this.b.getType(builder)) : 0;\n  var c = this.c ? builder.getTypeLength(this.c.getType(builder)) : 0;\n\n  if (a > b && a > c) {\n    return this.a.getType(builder);\n  } else if (b > c) {\n    return this.b.getType(builder);\n  }\n\n  return this.c.getType(builder);\n};\n\nMathNode.prototype.getType = function (builder) {\n  switch (this.method) {\n    case MathNode.LENGTH:\n    case MathNode.DISTANCE:\n    case MathNode.DOT:\n      return 'f';\n\n    case MathNode.CROSS:\n      return 'v3';\n  }\n\n  return this.getInputType(builder);\n};\n\nMathNode.prototype.generate = function (builder, output) {\n  var a,\n      b,\n      c,\n      al = this.a ? builder.getTypeLength(this.a.getType(builder)) : 0,\n      bl = this.b ? builder.getTypeLength(this.b.getType(builder)) : 0,\n      cl = this.c ? builder.getTypeLength(this.c.getType(builder)) : 0,\n      inputType = this.getInputType(builder),\n      nodeType = this.getType(builder);\n\n  switch (this.method) {\n    // 1 input\n    case MathNode.NEGATE:\n      return builder.format('( -' + this.a.build(builder, inputType) + ' )', inputType, output);\n\n    case MathNode.INVERT:\n      return builder.format('( 1.0 - ' + this.a.build(builder, inputType) + ' )', inputType, output);\n    // 2 inputs\n\n    case MathNode.CROSS:\n      a = this.a.build(builder, 'v3');\n      b = this.b.build(builder, 'v3');\n      break;\n\n    case MathNode.STEP:\n      a = this.a.build(builder, al === 1 ? 'f' : inputType);\n      b = this.b.build(builder, inputType);\n      break;\n\n    case MathNode.MIN:\n    case MathNode.MAX:\n    case MathNode.MOD:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, bl === 1 ? 'f' : inputType);\n      break;\n    // 3 inputs\n\n    case MathNode.REFRACT:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, inputType);\n      c = this.c.build(builder, 'f');\n      break;\n\n    case MathNode.MIX:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, inputType);\n      c = this.c.build(builder, cl === 1 ? 'f' : inputType);\n      break;\n    // default\n\n    default:\n      a = this.a.build(builder, inputType);\n      if (this.b) b = this.b.build(builder, inputType);\n      if (this.c) c = this.c.build(builder, inputType);\n      break;\n  } // build function call\n\n\n  var params = [];\n  params.push(a);\n  if (b) params.push(b);\n  if (c) params.push(c);\n  var numInputs = this.getNumInputs(builder);\n\n  if (params.length !== numInputs) {\n    throw Error(\"Arguments not match used in \\\"\".concat(this.method, \"\\\". Require \").concat(numInputs, \", currently \").concat(params.length, \".\"));\n  }\n\n  return builder.format(this.method + '( ' + params.join(', ') + ' )', nodeType, output);\n};\n\nMathNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.a = source.a;\n  this.b = source.b;\n  this.c = source.c;\n  this.method = source.method;\n  return this;\n};\n\nMathNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.a = this.a.toJSON(meta).uuid;\n    if (this.b) data.b = this.b.toJSON(meta).uuid;\n    if (this.c) data.c = this.c.toJSON(meta).uuid;\n    data.method = this.method;\n  }\n\n  return data;\n};\n\nexport { MathNode };","map":{"version":3,"sources":["/Projects/arrayftw/node_modules/three-stdlib/nodes/math/MathNode.js"],"names":["TempNode","MathNode","a","bOrMethod","cOrMethod","method","call","b","c","RAD","DEG","EXP","EXP2","LOG","LOG2","SQRT","INV_SQRT","FLOOR","CEIL","NORMALIZE","FRACT","SATURATE","SIN","COS","TAN","ASIN","ACOS","ARCTAN","ABS","SIGN","LENGTH","NEGATE","INVERT","MIN","MAX","MOD","STEP","REFLECT","DISTANCE","DOT","CROSS","POW","MIX","CLAMP","REFRACT","SMOOTHSTEP","FACEFORWARD","prototype","Object","create","constructor","nodeType","hashProperties","getNumInputs","getInputType","builder","getTypeLength","getType","generate","output","al","bl","cl","inputType","format","build","params","push","numInputs","length","Error","join","copy","source","toJSON","meta","data","getJSONNode","createJSONNode","uuid"],"mappings":"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","sourcesContent":["import { TempNode } from '../core/TempNode.js';\n\nfunction MathNode(a, bOrMethod, cOrMethod, method) {\n  TempNode.call(this);\n  this.a = a;\n  typeof bOrMethod !== 'string' ? this.b = bOrMethod : method = bOrMethod;\n  typeof cOrMethod !== 'string' ? this.c = cOrMethod : method = cOrMethod;\n  this.method = method;\n} // 1 input\n\n\nMathNode.RAD = 'radians';\nMathNode.DEG = 'degrees';\nMathNode.EXP = 'exp';\nMathNode.EXP2 = 'exp2';\nMathNode.LOG = 'log';\nMathNode.LOG2 = 'log2';\nMathNode.SQRT = 'sqrt';\nMathNode.INV_SQRT = 'inversesqrt';\nMathNode.FLOOR = 'floor';\nMathNode.CEIL = 'ceil';\nMathNode.NORMALIZE = 'normalize';\nMathNode.FRACT = 'fract';\nMathNode.SATURATE = 'saturate';\nMathNode.SIN = 'sin';\nMathNode.COS = 'cos';\nMathNode.TAN = 'tan';\nMathNode.ASIN = 'asin';\nMathNode.ACOS = 'acos';\nMathNode.ARCTAN = 'atan';\nMathNode.ABS = 'abs';\nMathNode.SIGN = 'sign';\nMathNode.LENGTH = 'length';\nMathNode.NEGATE = 'negate';\nMathNode.INVERT = 'invert'; // 2 inputs\n\nMathNode.MIN = 'min';\nMathNode.MAX = 'max';\nMathNode.MOD = 'mod';\nMathNode.STEP = 'step';\nMathNode.REFLECT = 'reflect';\nMathNode.DISTANCE = 'distance';\nMathNode.DOT = 'dot';\nMathNode.CROSS = 'cross';\nMathNode.POW = 'pow'; // 3 inputs\n\nMathNode.MIX = 'mix';\nMathNode.CLAMP = 'clamp';\nMathNode.REFRACT = 'refract';\nMathNode.SMOOTHSTEP = 'smoothstep';\nMathNode.FACEFORWARD = 'faceforward';\nMathNode.prototype = Object.create(TempNode.prototype);\nMathNode.prototype.constructor = MathNode;\nMathNode.prototype.nodeType = 'Math';\nMathNode.prototype.hashProperties = ['method'];\n\nMathNode.prototype.getNumInputs = function ()\n/*builder*/\n{\n  switch (this.method) {\n    case MathNode.MIX:\n    case MathNode.CLAMP:\n    case MathNode.REFRACT:\n    case MathNode.SMOOTHSTEP:\n    case MathNode.FACEFORWARD:\n      return 3;\n\n    case MathNode.MIN:\n    case MathNode.MAX:\n    case MathNode.MOD:\n    case MathNode.STEP:\n    case MathNode.REFLECT:\n    case MathNode.DISTANCE:\n    case MathNode.DOT:\n    case MathNode.CROSS:\n    case MathNode.POW:\n      return 2;\n\n    default:\n      return 1;\n  }\n};\n\nMathNode.prototype.getInputType = function (builder) {\n  var a = builder.getTypeLength(this.a.getType(builder));\n  var b = this.b ? builder.getTypeLength(this.b.getType(builder)) : 0;\n  var c = this.c ? builder.getTypeLength(this.c.getType(builder)) : 0;\n\n  if (a > b && a > c) {\n    return this.a.getType(builder);\n  } else if (b > c) {\n    return this.b.getType(builder);\n  }\n\n  return this.c.getType(builder);\n};\n\nMathNode.prototype.getType = function (builder) {\n  switch (this.method) {\n    case MathNode.LENGTH:\n    case MathNode.DISTANCE:\n    case MathNode.DOT:\n      return 'f';\n\n    case MathNode.CROSS:\n      return 'v3';\n  }\n\n  return this.getInputType(builder);\n};\n\nMathNode.prototype.generate = function (builder, output) {\n  var a,\n      b,\n      c,\n      al = this.a ? builder.getTypeLength(this.a.getType(builder)) : 0,\n      bl = this.b ? builder.getTypeLength(this.b.getType(builder)) : 0,\n      cl = this.c ? builder.getTypeLength(this.c.getType(builder)) : 0,\n      inputType = this.getInputType(builder),\n      nodeType = this.getType(builder);\n\n  switch (this.method) {\n    // 1 input\n    case MathNode.NEGATE:\n      return builder.format('( -' + this.a.build(builder, inputType) + ' )', inputType, output);\n\n    case MathNode.INVERT:\n      return builder.format('( 1.0 - ' + this.a.build(builder, inputType) + ' )', inputType, output);\n    // 2 inputs\n\n    case MathNode.CROSS:\n      a = this.a.build(builder, 'v3');\n      b = this.b.build(builder, 'v3');\n      break;\n\n    case MathNode.STEP:\n      a = this.a.build(builder, al === 1 ? 'f' : inputType);\n      b = this.b.build(builder, inputType);\n      break;\n\n    case MathNode.MIN:\n    case MathNode.MAX:\n    case MathNode.MOD:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, bl === 1 ? 'f' : inputType);\n      break;\n    // 3 inputs\n\n    case MathNode.REFRACT:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, inputType);\n      c = this.c.build(builder, 'f');\n      break;\n\n    case MathNode.MIX:\n      a = this.a.build(builder, inputType);\n      b = this.b.build(builder, inputType);\n      c = this.c.build(builder, cl === 1 ? 'f' : inputType);\n      break;\n    // default\n\n    default:\n      a = this.a.build(builder, inputType);\n      if (this.b) b = this.b.build(builder, inputType);\n      if (this.c) c = this.c.build(builder, inputType);\n      break;\n  } // build function call\n\n\n  var params = [];\n  params.push(a);\n  if (b) params.push(b);\n  if (c) params.push(c);\n  var numInputs = this.getNumInputs(builder);\n\n  if (params.length !== numInputs) {\n    throw Error(`Arguments not match used in \"${this.method}\". Require ${numInputs}, currently ${params.length}.`);\n  }\n\n  return builder.format(this.method + '( ' + params.join(', ') + ' )', nodeType, output);\n};\n\nMathNode.prototype.copy = function (source) {\n  TempNode.prototype.copy.call(this, source);\n  this.a = source.a;\n  this.b = source.b;\n  this.c = source.c;\n  this.method = source.method;\n  return this;\n};\n\nMathNode.prototype.toJSON = function (meta) {\n  var data = this.getJSONNode(meta);\n\n  if (!data) {\n    data = this.createJSONNode(meta);\n    data.a = this.a.toJSON(meta).uuid;\n    if (this.b) data.b = this.b.toJSON(meta).uuid;\n    if (this.c) data.c = this.c.toJSON(meta).uuid;\n    data.method = this.method;\n  }\n\n  return data;\n};\n\nexport { MathNode };\n"]},"metadata":{},"sourceType":"module"}