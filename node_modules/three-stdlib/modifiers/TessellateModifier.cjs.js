"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@babel/runtime/helpers/defineProperty"),e=require("three");function t(r){return r&&"object"==typeof r&&"default"in r?r:{default:r}}var o=t(r);exports.TessellateModifier=function(r,t){var a=this;void 0===r&&(r=.1),void 0===t&&(t=6),o.default(this,"maxEdgeLength",void 0),o.default(this,"maxIterations",void 0),o.default(this,"modify",(function(r){null!==r.index&&(r=r.toNonIndexed());var t=a.maxIterations,o=a.maxEdgeLength*a.maxEdgeLength,n=new e.Vector3,u=new e.Vector3,s=new e.Vector3,l=new e.Vector3,i=[n,u,s,l],f=new e.Vector3,c=new e.Vector3,p=new e.Vector3,y=new e.Vector3,d=[f,c,p,y],h=new e.Color,m=new e.Color,V=new e.Color,v=new e.Color,w=[h,m,V,v],A=new e.Vector2,x=new e.Vector2,b=new e.Vector2,g=new e.Vector2,C=[A,x,b,g],z=new e.Vector2,B=new e.Vector2,q=new e.Vector2,F=new e.Vector2,E=[z,B,q,F],I=r.attributes,L=void 0!==I.normal,T=void 0!==I.color,S=void 0!==I.uv,j=void 0!==I.uv2,M=I.position.array,P=L?I.normal.array:null,_=T?I.color.array:null,G=S?I.uv.array:null,N=j?I.uv2.array:null,O=M,k=P,D=_,H=G,J=N,K=0,Q=!0;function R(r,e,t){var o=i[r],a=i[e],n=i[t];if(O.push(o.x,o.y,o.z),O.push(a.x,a.y,a.z),O.push(n.x,n.y,n.z),L){var u=d[r],s=d[e],l=d[t];k.push(u.x,u.y,u.z),k.push(s.x,s.y,s.z),k.push(l.x,l.y,l.z)}if(T){var f=w[r],c=w[e],p=w[t];D.push(f.r,f.g,f.b),D.push(c.r,c.g,c.b),D.push(p.r,p.g,p.b)}if(S){var y=C[r],h=C[e],m=C[t];H.push(y.x,y.y),H.push(h.x,h.y),H.push(m.x,m.y)}if(j){var V=E[r],v=E[e],A=E[t];J.push(V.x,V.y),J.push(v.x,v.y),J.push(A.x,A.y)}}for(;Q&&K<t;){K++,Q=!1,M=O,O=[],L&&(P=k,k=[]),T&&(_=D,D=[]),S&&(G=H,H=[]),j&&(N=J,J=[]);for(var U=0,W=0,X=M.length;U<X;U+=9,W+=6){n.fromArray(M,U+0),u.fromArray(M,U+3),s.fromArray(M,U+6),L&&P&&(f.fromArray(P,U+0),c.fromArray(P,U+3),p.fromArray(P,U+6)),T&&_&&(h.fromArray(_,U+0),m.fromArray(_,U+3),V.fromArray(_,U+6)),S&&G&&(A.fromArray(G,W+0),x.fromArray(G,W+2),b.fromArray(G,W+4)),j&&N&&(z.fromArray(N,W+0),B.fromArray(N,W+2),q.fromArray(N,W+4));var Y=n.distanceToSquared(u),Z=u.distanceToSquared(s),$=n.distanceToSquared(s);Y>o||Z>o||$>o?(Q=!0,Y>=Z&&Y>=$?(l.lerpVectors(n,u,.5),L&&y.lerpVectors(f,c,.5),T&&v.lerpColors(h,m,.5),S&&g.lerpVectors(A,x,.5),j&&F.lerpVectors(z,B,.5),R(0,3,2),R(3,1,2)):Z>=Y&&Z>=$?(l.lerpVectors(u,s,.5),L&&y.lerpVectors(c,p,.5),T&&v.lerpColors(m,V,.5),S&&g.lerpVectors(x,b,.5),j&&F.lerpVectors(B,q,.5),R(0,1,3),R(3,2,0)):(l.lerpVectors(n,s,.5),L&&y.lerpVectors(f,p,.5),T&&v.lerpColors(h,V,.5),S&&g.lerpVectors(A,b,.5),j&&F.lerpVectors(z,q,.5),R(0,1,3),R(3,1,2))):R(0,1,2)}}var rr=new e.BufferGeometry;return rr.setAttribute("position",new e.Float32BufferAttribute(O,3)),L&&rr.setAttribute("normal",new e.Float32BufferAttribute(k,3)),T&&rr.setAttribute("color",new e.Float32BufferAttribute(D,3)),S&&rr.setAttribute("uv",new e.Float32BufferAttribute(H,2)),j&&rr.setAttribute("uv2",new e.Float32BufferAttribute(J,2)),rr})),this.maxEdgeLength=r,this.maxIterations=t};
