"use strict";var e=require("@babel/runtime/helpers/assertThisInitialized"),t=require("@babel/runtime/helpers/inheritsLoose"),r=require("./WebGPUBinding.cjs.js"),n=require("./constants.cjs.js");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=i(e),u=i(t);function a(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f=function(e){function t(t){var r;return(r=e.call(this,t)||this).uniforms=[],r.onBeforeUpdate=function(){},r.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,r.type=n.GPUBindingType.UniformBuffer,r.visibility=GPUShaderStage.VERTEX,r.usage=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,r.array=null,r.bufferGPU=null,Object.defineProperty(o.default(r),"isUniformsGroup",{value:!0}),r}u.default(t,e);var r=t.prototype;return r.addUniform=function(e){return this.uniforms.push(e),this},r.removeUniform=function(e){var t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this},r.setOnBeforeUpdate=function(e){return this.onBeforeUpdate=e,this},r.getByteLength=function(){for(var e=0,t=0,r=this.uniforms.length;t<r;t++){var n=this.uniforms[t],i=e%16;0!==i&&16-i-n.boundary<0&&(e+=16-i),n.offset=e/this.bytesPerElement,e+=n.itemSize*this.bytesPerElement}return e},r.update=function(){for(var e,t=!1,r=a(this.uniforms);!(e=r()).done;){var n=e.value;!0===this.updateByType(n)&&(t=!0)}return t},r.updateByType=function(e){return e.isFloatUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)},r.updateNumber=function(e){var t=!1,r=this.array,n=e.getValue(),i=e.offset;return r[i]!==n&&(r[i]=n,t=!0),t},r.updateVector2=function(e){var t=!1,r=this.array,n=e.getValue(),i=e.offset;return r[i+0]===n.x&&r[i+1]===n.y||(r[i+0]=n.x,r[i+1]=n.y,t=!0),t},r.updateVector3=function(e){var t=!1,r=this.array,n=e.getValue(),i=e.offset;return r[i+0]===n.x&&r[i+1]===n.y&&r[i+2]===n.z||(r[i+0]=n.x,r[i+1]=n.y,r[i+2]=n.z,t=!0),t},r.updateVector4=function(e){var t=!1,r=this.array,n=e.getValue(),i=e.offset;return r[i+0]===n.x&&r[i+1]===n.y&&r[i+2]===n.z&&r[i+4]===n.w||(r[i+0]=n.x,r[i+1]=n.y,r[i+2]=n.z,r[i+3]=n.w,t=!0),t},r.updateColor=function(e){var t=!1,r=this.array,n=e.getValue(),i=e.offset;return r[i+0]===n.r&&r[i+1]===n.g&&r[i+2]===n.b||(r[i+0]=n.r,r[i+1]=n.g,r[i+2]=n.b,t=!0),t},r.updateMatrix3=function(e){var t=!1,r=this.array,n=e.getValue().elements,i=e.offset;return r[i+0]===n[0]&&r[i+1]===n[1]&&r[i+2]===n[2]&&r[i+4]===n[3]&&r[i+5]===n[4]&&r[i+6]===n[5]&&r[i+8]===n[6]&&r[i+9]===n[7]&&r[i+10]===n[8]||(r[i+0]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+4]=n[3],r[i+5]=n[4],r[i+6]=n[5],r[i+8]=n[6],r[i+9]=n[7],r[i+10]=n[8],t=!0),t},r.updateMatrix4=function(e){var t=!1,r=this.array,n=e.getValue().elements,i=e.offset;return!1===function(e,t,r){for(var n=0,i=t.length;n<i;n++)if(e[r+n]!==t[n])return!1;return!0}(r,n,i)&&(r.set(n,i),t=!0),t},t}(r);module.exports=f;
