"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/inheritsLoose"),r=require("three");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e),i=function(e){function t(){return e.apply(this,arguments)||this}a.default(t,e);var i=t.prototype;return i.load=function(e,t,a,i){var n=this,p=new r.FileLoader(this.manager);p.setPath(this.path),p.setResponseType("text"),p.load(e,(function(r){try{t(n.parse(r))}catch(r){i?i(r):console.error(r),n.manager.itemError(e)}}),a,i)},i.parse=function(e){for(var t=(e=e.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim()).split(/[\n\r]+/g),a=t[0].trim().split(/\s+/g).map((function(e){return parseFloat(e)})),i=a[1]-a[0],n=a.length,p=1,o=a.length;p<o;p++)if(i!==a[p]-a[p-1])throw new Error("LUT3dlLoader: Inconsistent grid size not supported.");for(var l=new Array(n*n*n*3),s=0,g=0,m=1,h=t.length;m<h;m++){var d=t[m].trim().split(/\s/g),u=parseFloat(d[0]),f=parseFloat(d[1]),c=parseFloat(d[2]);g=Math.max(g,u,f,c);var w=s%n*n*n+Math.floor(s/n)%n*n+Math.floor(s/(n*n))%n;l[3*w+0]=u,l[3*w+1]=f,l[3*w+2]=c,s+=1}for(var F=Math.ceil(Math.log2(g)),y=Math.pow(2,F),T=0,v=l.length;T<v;T++){var L=l[T];l[T]=255*L/y}var M=new Uint8Array(l),x=new r.DataTexture;x.image.data=M,x.image.width=n,x.image.height=n*n,x.format=r.RGBFormat,x.type=r.UnsignedByteType,x.magFilter=r.LinearFilter,x.minFilter=r.LinearFilter,x.wrapS=r.ClampToEdgeWrapping,x.wrapT=r.ClampToEdgeWrapping,x.generateMipmaps=!1;var E=new r.DataTexture3D;return E.image.data=M,E.image.width=n,E.image.height=n,E.image.depth=n,E.format=r.RGBFormat,E.type=r.UnsignedByteType,E.magFilter=r.LinearFilter,E.minFilter=r.LinearFilter,E.wrapS=r.ClampToEdgeWrapping,E.wrapT=r.ClampToEdgeWrapping,E.wrapR=r.ClampToEdgeWrapping,E.generateMipmaps=!1,{size:n,texture:x,texture3D:E}},t}(r.Loader);exports.LUT3dlLoader=i;
