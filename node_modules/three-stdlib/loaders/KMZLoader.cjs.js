"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),r=require("./ColladaLoader.cjs.js"),t=require("fflate");require("./TGALoader.cjs.js");var a=function(r){e.Loader.call(this,r)};a.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:a,load:function(r,t,a,o){var n=this,s=new e.FileLoader(n.manager);s.setPath(n.path),s.setResponseType("arraybuffer"),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(r,(function(e){try{t(n.parse(e))}catch(e){o?o(e):console.error(e),n.manager.itemError(r)}}),a,o)},parse:function(a){var o=new e.LoadingManager;o.setURLModifier((function(e){var r=function(e){for(var r in n)if(r.substr(-e.length)===e)return n[r]}(e);if(r){console.log("Loading",e);var t=new Blob([r.buffer],{type:"application/octet-stream"});return URL.createObjectURL(t)}return e}));var n=t.unzipSync(new Uint8Array(a));if(n["doc.kml"]){var s=(new DOMParser).parseFromString(fflate.strFromU8(n["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(s)return new r.ColladaLoader(o).parse(fflate.strFromU8(n[s.textContent]))}else for(var i in console.warn("KMZLoader: Missing doc.kml file."),n){if("dae"===i.split(".").pop().toLowerCase())return new r.ColladaLoader(o).parse(fflate.strFromU8(n[i]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new e.Group}}}),exports.KMZLoader=a;
