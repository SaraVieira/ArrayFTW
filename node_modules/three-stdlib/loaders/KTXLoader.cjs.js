"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),t=function(t){e.CompressedTextureLoader.call(this,t)};t.prototype=Object.assign(Object.create(e.CompressedTextureLoader.prototype),{constructor:t,parse:function(e,t){var i=new r(e,1);return{mipmaps:i.mipmaps(t),width:i.pixelWidth,height:i.pixelHeight,format:i.glInternalFormat,isCubemap:6===i.numberOfFaces,mipmapCount:i.numberOfMipmapLevels}}});var r=function(){function e(t,r){this.arrayBuffer=t;var i=new Uint8Array(this.arrayBuffer,0,12);if(171===i[0]&&75===i[1]&&84===i[2]&&88===i[3]&&32===i[4]&&49===i[5]&&49===i[6]&&187===i[7]&&13===i[8]&&10===i[9]&&26===i[10]&&10===i[11]){var a=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*a),n=67305985===s.getUint32(0,!0);this.glType=s.getUint32(1*a,n),this.glTypeSize=s.getUint32(2*a,n),this.glFormat=s.getUint32(3*a,n),this.glInternalFormat=s.getUint32(4*a,n),this.glBaseInternalFormat=s.getUint32(5*a,n),this.pixelWidth=s.getUint32(6*a,n),this.pixelHeight=s.getUint32(7*a,n),this.pixelDepth=s.getUint32(8*a,n),this.numberOfArrayElements=s.getUint32(9*a,n),this.numberOfFaces=s.getUint32(10*a,n),this.numberOfMipmapLevels=s.getUint32(11*a,n),this.bytesOfKeyValueData=s.getUint32(12*a,n),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===r?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.mipmaps=function(t){for(var r=[],i=e.HEADER_LEN+this.bytesOfKeyValueData,a=this.pixelWidth,s=this.pixelHeight,n=t?this.numberOfMipmapLevels:1,p=0;p<n;p++){var h=new Int32Array(this.arrayBuffer,i,1)[0];i+=4;for(var o=0;o<this.numberOfFaces;o++){var u=new Uint8Array(this.arrayBuffer,i,h);r.push({data:u,width:a,height:s}),i+=h,i+=3-(h+3)%4}a=Math.max(1,.5*a),s=Math.max(1,.5*s)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();exports.KTXLoader=t;
