"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("three"),e=function(e){r.CompressedTextureLoader.call(this,e)};e.prototype=Object.assign(Object.create(r.CompressedTextureLoader.prototype),{constructor:e,parse:function(r,a){var t=new Uint32Array(r,0,13),o={buffer:r,header:t,loadMipmaps:a};return 55727696===t[0]?e._parseV3(o):559044176===t[11]?e._parseV2(o):void console.error("THREE.PVRLoader: Unknown PVR format.")}}),e._parseV3=function(a){var t,o,p=a.header,m=p[12],s=p[2],n=p[6],i=p[7],u=p[10],P=p[11];switch(s){case 0:t=2,o=r.RGB_PVRTC_2BPPV1_Format;break;case 1:t=2,o=r.RGBA_PVRTC_2BPPV1_Format;break;case 2:t=4,o=r.RGB_PVRTC_4BPPV1_Format;break;case 3:t=4,o=r.RGBA_PVRTC_4BPPV1_Format;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",s)}return a.dataPtr=52+m,a.bpp=t,a.format=o,a.width=i,a.height=n,a.numSurfaces=u,a.numMipmaps=P,a.isCubemap=6===u,e._extract(a)},e._parseV2=function(a){var t,o,p=a.header,m=p[0],s=p[1],n=p[2],i=p[3],u=p[4],P=p[10],_=p[12],c=255&u,d=P>0;return 25===c?(o=d?r.RGBA_PVRTC_4BPPV1_Format:r.RGB_PVRTC_4BPPV1_Format,t=4):24===c?(o=d?r.RGBA_PVRTC_2BPPV1_Format:r.RGB_PVRTC_2BPPV1_Format,t=2):console.error("THREE.PVRLoader: Unknown PVR format:",c),a.dataPtr=m,a.bpp=t,a.format=o,a.width=n,a.height=s,a.numSurfaces=_,a.numMipmaps=i+1,a.isCubemap=6===_,e._extract(a)},e._extract=function(r){var e,a={mipmaps:[],width:r.width,height:r.height,format:r.format,mipmapCount:r.numMipmaps,isCubemap:r.isCubemap},t=r.buffer,o=r.dataPtr,p=r.bpp,m=r.numSurfaces,s=0,n=0,i=0,u=0,P=0;2===p?(n=8,i=4):(n=4,i=4),e=n*i*p/8,a.mipmaps.length=r.numMipmaps*m;for(var _=0;_<r.numMipmaps;){var c=r.width>>_,d=r.height>>_;(u=c/n)<2&&(u=2),(P=d/i)<2&&(P=2),s=u*P*e;for(var V=0;V<m;V++){var R={data:new Uint8Array(t,o,s),width:c,height:d};a.mipmaps[V*r.numMipmaps+_]=R,o+=s}_++}return a},exports.PVRLoader=e;
