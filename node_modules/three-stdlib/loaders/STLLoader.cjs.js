"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),t=function(t){e.Loader.call(this,t)};t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,load:function(t,r,n,o){var a=this,i=new e.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,(function(e){try{r(a.parse(e))}catch(e){o?o(e):console.error(e),a.manager.itemError(t)}}),n,o)},parse:function(t){function r(e,t,r){for(var n=0,o=e.length;n<o;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var n,o=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(t);return function(e){var t;if(50,84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var n=[115,111,108,105,100],o=0;o<5;o++)if(r(n,t,o))return!1;return!0}(o)?function(t){for(var r,n,o,a,i,s,u,f,l=new DataView(t),c=l.getUint32(80,!0),g=!1,h=0;h<70;h++)1129270351==l.getUint32(h,!1)&&82==l.getUint8(h+4)&&61==l.getUint8(h+5)&&(g=!0,a=new Float32Array(3*c*3),i=l.getUint8(h+6)/255,s=l.getUint8(h+7)/255,u=l.getUint8(h+8)/255,f=l.getUint8(h+9)/255);for(var p=new e.BufferGeometry,d=new Float32Array(3*c*3),w=new Float32Array(3*c*3),v=0;v<c;v++){var b=84+50*v,y=l.getFloat32(b,!0),F=l.getFloat32(b+4,!0),A=l.getFloat32(b+8,!0);if(g){var U=l.getUint16(b+48,!0);0==(32768&U)?(r=(31&U)/31,n=(U>>5&31)/31,o=(U>>10&31)/31):(r=i,n=s,o=u)}for(var m=1;m<=3;m++){var x=b+12*m,L=3*v*3+3*(m-1);d[L]=l.getFloat32(x,!0),d[L+1]=l.getFloat32(x+4,!0),d[L+2]=l.getFloat32(x+8,!0),w[L]=y,w[L+1]=F,w[L+2]=A,g&&(a[L]=r,a[L+1]=n,a[L+2]=o)}}return p.setAttribute("position",new e.BufferAttribute(d,3)),p.setAttribute("normal",new e.BufferAttribute(w,3)),g&&(p.setAttribute("color",new e.BufferAttribute(a,3)),p.hasColors=!0,p.alpha=f),p}(o):function(t){for(var r,n=new e.BufferGeometry,o=/solid([\s\S]*?)endsolid/g,a=/facet([\s\S]*?)endfacet/g,i=0,s=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,u=new RegExp("vertex"+s+s+s,"g"),f=new RegExp("normal"+s+s+s,"g"),l=[],c=[],g=new e.Vector3,h=0,p=0,d=0;null!==(r=o.exec(t));){p=d;for(var w=r[0];null!==(r=a.exec(w));){for(var v=0,b=0,y=r[0];null!==(r=f.exec(y));)g.x=parseFloat(r[1]),g.y=parseFloat(r[2]),g.z=parseFloat(r[3]),b++;for(;null!==(r=u.exec(y));)l.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),c.push(g.x,g.y,g.z),v++,d++;1!==b&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==v&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}var F=p,A=d-p;n.addGroup(F,A,h),h++}return n.setAttribute("position",new e.Float32BufferAttribute(l,3)),n.setAttribute("normal",new e.Float32BufferAttribute(c,3)),n}("string"!=typeof(n=t)?e.LoaderUtils.decodeText(new Uint8Array(n)):n)}}),exports.STLLoader=t;
