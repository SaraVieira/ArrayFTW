"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("three"),e=function(e){r.CompressedTextureLoader.call(this,e)};e.prototype=Object.assign(Object.create(r.CompressedTextureLoader.prototype),{constructor:e,parse:function(e,a){var t={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function o(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function n(r,e,a,t){for(var o=a*t*4,n=new Uint8Array(r,e,o),i=new Uint8Array(o),m=0,s=0,p=0;p<t;p++)for(var u=0;u<a;u++){var c=n[s],d=n[++s],h=n[++s],f=n[++s];s++,i[m]=h,i[++m]=d,i[++m]=c,i[++m]=f,m++}return i}var i,m=o("DXT1"),s=o("DXT3"),p=o("DXT5"),u=o("ETC1"),c=new Int32Array(e,0,31);if(542327876!==c[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),t;if(4&!c[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),t;var d,h=c[21],f=!1;switch(h){case m:i=8,t.format=r.RGB_S3TC_DXT1_Format;break;case s:i=16,t.format=r.RGBA_S3TC_DXT3_Format;break;case p:i=16,t.format=r.RGBA_S3TC_DXT5_Format;break;case u:i=8,t.format=r.RGB_ETC1_Format;break;default:if(!(32===c[22]&&16711680&c[23]&&65280&c[24]&&255&c[25]&&4278190080&c[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(d=h,String.fromCharCode(255&d,d>>8&255,d>>16&255,d>>24&255))),t;f=!0,i=64,t.format=r.RGBAFormat}t.mipmapCount=1,131072&c[2]&&!1!==a&&(t.mipmapCount=Math.max(1,c[7]));var C=c[28];if(t.isCubemap=!!(512&C),t.isCubemap&&(!(1024&C)||!(2048&C)||!(4096&C)||!(8192&C)||!(16384&C)||!(32768&C)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),t;t.width=c[4],t.height=c[3];for(var D=c[1]+4,T=t.isCubemap?6:1,l=0;l<T;l++)for(var v=t.width,_=t.height,b=0;b<t.mipmapCount;b++){if(f)var A=(E=n(e,D,v,_)).length;else{A=Math.max(4,v)/4*Math.max(4,_)/4*i;var E=new Uint8Array(e,D,A)}var S={data:E,width:v,height:_};t.mipmaps.push(S),D+=A,v=Math.max(v>>1,1),_=Math.max(_>>1,1)}return t}}),exports.DDSLoader=e;
