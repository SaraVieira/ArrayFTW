"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@babel/runtime/helpers/inheritsLoose"),o=require("three");function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=e(t),n=function(t){function e(e,r,n,s){var u;u=t.call(this)||this;var p=[],a=[],l=[],c=new o.Vector3,f=new o.Matrix4;f.makeRotationFromEuler(n),f.setPosition(r);var h=new o.Matrix4;function m(t,o,r){o.applyMatrix4(e.matrixWorld),o.applyMatrix4(h),r.transformDirection(e.matrixWorld),t.push(new i(o.clone(),r.clone()))}function y(t,o){for(var e=[],r=.5*Math.abs(s.dot(o)),n=0;n<t.length;n+=3){var i,u,p,a=void 0,l=void 0,c=void 0,f=void 0;switch(((i=t[n+0].position.dot(o)-r>0)?1:0)+((u=t[n+1].position.dot(o)-r>0)?1:0)+((p=t[n+2].position.dot(o)-r>0)?1:0)){case 0:e.push(t[n]),e.push(t[n+1]),e.push(t[n+2]);break;case 1:if(i&&(a=t[n+1],l=t[n+2],c=x(t[n],a,o,r),f=x(t[n],l,o,r)),u){a=t[n],l=t[n+2],c=x(t[n+1],a,o,r),f=x(t[n+1],l,o,r),e.push(c),e.push(l.clone()),e.push(a.clone()),e.push(l.clone()),e.push(c.clone()),e.push(f);break}p&&(a=t[n],l=t[n+1],c=x(t[n+2],a,o,r),f=x(t[n+2],l,o,r)),e.push(a.clone()),e.push(l.clone()),e.push(c),e.push(f),e.push(c.clone()),e.push(l.clone());break;case 2:i||(l=x(a=t[n].clone(),t[n+1],o,r),c=x(a,t[n+2],o,r),e.push(a),e.push(l),e.push(c)),u||(l=x(a=t[n+1].clone(),t[n+2],o,r),c=x(a,t[n],o,r),e.push(a),e.push(l),e.push(c)),p||(l=x(a=t[n+2].clone(),t[n],o,r),c=x(a,t[n+1],o,r),e.push(a),e.push(l),e.push(c))}}return e}function x(t,e,r,n){var s=t.position.dot(r)-n,u=s/(s-(e.position.dot(r)-n));return new i(new o.Vector3(t.position.x+u*(e.position.x-t.position.x),t.position.y+u*(e.position.y-t.position.y),t.position.z+u*(e.position.z-t.position.z)),new o.Vector3(t.normal.x+u*(e.normal.x-t.normal.x),t.normal.y+u*(e.normal.y-t.normal.y),t.normal.z+u*(e.normal.z-t.normal.z)))}return h.copy(f).invert(),function(){var t,r=[],n=new o.Vector3,i=new o.Vector3;if(!0===e.geometry.isGeometry)return void console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");var u=e.geometry,h=u.attributes.position,x=u.attributes.normal;if(null!==u.index){var d=u.index;for(t=0;t<d.count;t++)n.fromBufferAttribute(h,d.getX(t)),i.fromBufferAttribute(x,d.getX(t)),m(r,n,i)}else for(t=0;t<h.count;t++)n.fromBufferAttribute(h,t),i.fromBufferAttribute(x,t),m(r,n,i);for(r=y(r,c.set(1,0,0)),r=y(r,c.set(-1,0,0)),r=y(r,c.set(0,1,0)),r=y(r,c.set(0,-1,0)),r=y(r,c.set(0,0,1)),r=y(r,c.set(0,0,-1)),t=0;t<r.length;t++){var b=r[t];l.push(.5+b.position.x/s.x,.5+b.position.y/s.y),b.position.applyMatrix4(f),p.push(b.position.x,b.position.y,b.position.z),a.push(b.normal.x,b.normal.y,b.normal.z)}}(),u.setAttribute("position",new o.Float32BufferAttribute(p,3)),u.setAttribute("normal",new o.Float32BufferAttribute(a,3)),u.setAttribute("uv",new o.Float32BufferAttribute(l,2)),u}return r.default(e,t),e}(o.BufferGeometry),i=function(){function t(t,o){this.position=t,this.normal=o}return t.prototype.clone=function(){return new this.constructor(this.position.clone(),this.normal.clone())},t}();exports.DecalGeometry=n,exports.DecalVertex=i;
