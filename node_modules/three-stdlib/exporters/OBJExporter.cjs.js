"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("three"),e=function(){};e.prototype={constructor:e,parse:function(e){var r,o,n,i,f,u="",a=0,m=0,y=0,p=new t.Vector3,x=new t.Color,g=new t.Vector3,s=new t.Vector2,c=[];return e.traverse((function(e){!0===e.isMesh&&function(e){var n=0,x=0,l=0,v=e.geometry,E=new t.Matrix3;if(!0!==v.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var d=v.getAttribute("position"),B=v.getAttribute("normal"),w=v.getAttribute("uv"),b=v.getIndex();if(u+="o "+e.name+"\n",e.material&&e.material.name&&(u+="usemtl "+e.material.name+"\n"),void 0!==d)for(r=0,i=d.count;r<i;r++,n++)p.x=d.getX(r),p.y=d.getY(r),p.z=d.getZ(r),p.applyMatrix4(e.matrixWorld),u+="v "+p.x+" "+p.y+" "+p.z+"\n";if(void 0!==w)for(r=0,i=w.count;r<i;r++,l++)s.x=w.getX(r),s.y=w.getY(r),u+="vt "+s.x+" "+s.y+"\n";if(void 0!==B)for(E.getNormalMatrix(e.matrixWorld),r=0,i=B.count;r<i;r++,x++)g.x=B.getX(r),g.y=B.getY(r),g.z=B.getZ(r),g.applyMatrix3(E).normalize(),u+="vn "+g.x+" "+g.y+" "+g.z+"\n";if(null!==b)for(r=0,i=b.count;r<i;r+=3){for(f=0;f<3;f++)o=b.getX(r+f)+1,c[f]=a+o+(B||w?"/"+(w?m+o:"")+(B?"/"+(y+o):""):"");u+="f "+c.join(" ")+"\n"}else for(r=0,i=d.count;r<i;r+=3){for(f=0;f<3;f++)o=r+f+1,c[f]=a+o+(B||w?"/"+(w?m+o:"")+(B?"/"+(y+o):""):"");u+="f "+c.join(" ")+"\n"}a+=n,m+=l,y+=x}(e),!0===e.isLine&&function(t){var e=0,f=t.geometry,m=t.type;if(!0!==f.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var y=f.getAttribute("position");if(u+="o "+t.name+"\n",void 0!==y)for(r=0,i=y.count;r<i;r++,e++)p.x=y.getX(r),p.y=y.getY(r),p.z=y.getZ(r),p.applyMatrix4(t.matrixWorld),u+="v "+p.x+" "+p.y+" "+p.z+"\n";if("Line"===m){for(u+="l ",o=1,i=y.count;o<=i;o++)u+=a+o+" ";u+="\n"}if("LineSegments"===m)for(n=1+(o=1),i=y.count;o<i;n=(o+=2)+1)u+="l "+(a+o)+" "+(a+n)+"\n";a+=e}(e),!0===e.isPoints&&function(t){var e=0,n=t.geometry;if(!0!==n.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var f=n.getAttribute("position"),m=n.getAttribute("color");if(u+="o "+t.name+"\n",void 0!==f)for(r=0,i=f.count;r<i;r++,e++)p.fromBufferAttribute(f,r),p.applyMatrix4(t.matrixWorld),u+="v "+p.x+" "+p.y+" "+p.z,void 0!==m&&(x.fromBufferAttribute(m,r),u+=" "+x.r+" "+x.g+" "+x.b),u+="\n";for(u+="p ",o=1,i=f.count;o<=i;o++)u+=a+o+" ";u+="\n",a+=e}(e)})),u}},exports.OBJExporter=e;
