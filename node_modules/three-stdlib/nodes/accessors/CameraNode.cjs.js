"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/TempNode.cjs.js"),t=require("../core/FunctionNode.cjs.js"),o=require("../inputs/FloatNode.cjs.js"),r=require("./PositionNode.cjs.js");function s(t,o){e.TempNode.call(this,"v3"),this.setScope(t||s.POSITION),this.setCamera(o)}require("three"),require("../core/Node.cjs.js"),require("../core/NodeLib.cjs.js"),require("../core/InputNode.cjs.js"),s.Nodes={depthColor:new t.FunctionNode(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n"))},s.POSITION="position",s.DEPTH="depth",s.TO_VERTEX="toVertex",s.prototype=Object.create(e.TempNode.prototype),s.prototype.constructor=s,s.prototype.nodeType="Camera",s.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0!==e?this.onUpdateFrame:void 0},s.prototype.setScope=function(e){switch(this.scope){case s.DEPTH:delete this.near,delete this.far}switch(this.scope=e,e){case s.DEPTH:var t=this.camera;this.near=new o.FloatNode(t?t.near:1),this.far=new o.FloatNode(t?t.far:1200)}},s.prototype.getType=function(){switch(this.scope){case s.DEPTH:return"f"}return this.type},s.prototype.getUnique=function(){switch(this.scope){case s.DEPTH:case s.TO_VERTEX:return!0}return!1},s.prototype.getShared=function(){switch(this.scope){case s.POSITION:return!1}return!0},s.prototype.generate=function(e,t){var o;switch(this.scope){case s.POSITION:o="cameraPosition";break;case s.DEPTH:o=e.include(s.Nodes.depthColor)+"( "+this.near.build(e,"f")+", "+this.far.build(e,"f")+" )";break;case s.TO_VERTEX:o="normalize( "+new r.PositionNode(r.PositionNode.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(o,this.getType(e),t)},s.prototype.onUpdateFrame=function(){switch(this.scope){case s.DEPTH:var e=this.camera;this.near.value=e.near,this.far.value=e.far}},s.prototype.copy=function(t){switch(e.TempNode.prototype.copy.call(this,t),this.setScope(t.scope),t.camera&&this.setCamera(t.camera),t.scope){case s.DEPTH:this.near.number=t.near,this.far.number=t.far}return this},s.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch((t=this.createJSONNode(e)).scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case s.DEPTH:t.near=this.near.value,t.far=this.far.value}return t},exports.CameraNode=s;
