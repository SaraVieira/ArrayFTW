"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/Node.cjs.js"),o=require("../../inputs/ColorNode.cjs.js");function i(){e.Node.call(this),this.color=new o.ColorNode(16777215)}require("three"),require("../../core/InputNode.cjs.js"),require("../../core/TempNode.cjs.js"),require("../../core/NodeUtils.cjs.js"),i.prototype=Object.create(e.Node.prototype),i.prototype.constructor=i,i.prototype.nodeType="Basic",i.prototype.generate=function(e){var o;if(e.isShader("vertex")){var i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif"].join("\n"));var t=["#include <beginnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED"," vNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];i&&t.push(i.code,i.result?"transformed = "+i.result+";":""),t.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),o=t.join("\n")}else{this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.mask&&this.mask.analyze(e);var r=this.color.flow(e,"c",{slot:"color"}),s=this.alpha?this.alpha.flow(e,"f"):void 0,a=this.mask?this.mask.flow(e,"b"):void 0;e.requires.transparent=void 0!==s,e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif"].join("\n"));t=["#include <normal_fragment_begin>",r.code];a&&t.push(a.code,"if ( ! "+a.result+" ) discard;"),s&&t.push(s.code,"#ifdef ALPHATEST"," if ( "+s.result+" <= ALPHATEST ) discard;","#endif"),s?t.push("gl_FragColor = vec4("+r.result+", "+s.result+" );"):t.push("gl_FragColor = vec4("+r.result+", 1.0 );"),o=t.join("\n")}return o},i.prototype.copy=function(o){return e.Node.prototype.copy.call(this,o),this.color=o.color,o.position&&(this.position=o.position),o.alpha&&(this.alpha=o.alpha),o.mask&&(this.mask=o.mask),this},i.prototype.toJSON=function(e){var o=this.getJSONNode(e);return o||((o=this.createJSONNode(e)).color=this.color.toJSON(e).uuid,this.position&&(o.position=this.position.toJSON(e).uuid),this.alpha&&(o.alpha=this.alpha.toJSON(e).uuid),this.mask&&(o.mask=this.mask.toJSON(e).uuid)),o},exports.BasicNode=i;
