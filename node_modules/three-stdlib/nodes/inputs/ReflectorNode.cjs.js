"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/TempNode.cjs.js"),t=require("../core/InputNode.cjs.js"),r=require("../accessors/PositionNode.cjs.js"),o=require("../math/OperatorNode.cjs.js"),s=require("./TextureNode.cjs.js"),i=require("./Matrix4Node.cjs.js");function u(t){e.TempNode.call(this,"v4"),t&&this.setMirror(t)}require("three"),require("../core/Node.cjs.js"),require("../core/NodeLib.cjs.js"),require("../accessors/UVNode.cjs.js"),require("../utils/ColorSpaceNode.cjs.js"),require("../core/ConstNode.cjs.js"),require("./FloatNode.cjs.js"),require("../core/FunctionNode.cjs.js"),require("../core/ExpressionNode.cjs.js"),u.prototype=Object.create(e.TempNode.prototype),u.prototype.constructor=u,u.prototype.nodeType="Reflector",u.prototype.setMirror=function(e){this.mirror=e,this.textureMatrix=new i.Matrix4Node(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new r.PositionNode(r.PositionNode.LOCAL),this.uv=new o.OperatorNode(this.textureMatrix,this.localPosition,o.OperatorNode.MUL),this.uvResult=new o.OperatorNode(null,this.uv,o.OperatorNode.ADD),this.texture=new s.TextureNode(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},u.prototype.generate=function(e,t){return e.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===t?this.texture.build(e,t):e.format(this.texture.build(e,this.type),this.type,t)):(console.warn("THREE.ReflectorNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.type,t))},u.prototype.copy=function(e){return t.InputNode.prototype.copy.call(this,e),this.scope.mirror=e.mirror,this},u.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).mirror=this.mirror.uuid,this.offset&&(t.offset=this.offset.toJSON(e).uuid)),t},exports.ReflectorNode=u;
