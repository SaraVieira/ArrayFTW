"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/InputNode.cjs.js"),t=require("../accessors/UVNode.cjs.js"),o=require("../utils/ColorSpaceNode.cjs.js"),r=require("../core/ExpressionNode.cjs.js");function i(o,r,i,s){e.InputNode.call(this,"v4",{shared:!0}),this.value=o,this.uv=r||new t.UVNode,this.bias=i,this.project=void 0!==s&&s}require("../core/TempNode.cjs.js"),require("three"),require("../core/Node.cjs.js"),require("../core/NodeLib.cjs.js"),require("../core/ConstNode.cjs.js"),require("./FloatNode.cjs.js"),require("../core/FunctionNode.cjs.js"),i.prototype=Object.create(e.InputNode.prototype),i.prototype.constructor=i,i.prototype.nodeType="Texture",i.prototype.getTexture=function(t,o){return e.InputNode.prototype.generate.call(this,t,o,this.value.uuid,"t")},i.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var i,s,u=this.getTexture(e,t),c=this.uv.build(e,this.project?"v4":"v2"),p=this.bias?this.bias.build(e,"f"):void 0;void 0===p&&e.context.bias&&(p=e.context.bias.setTexture(this).build(e,"f")),i=this.project?"texture2DProj":p?"tex2DBias":"tex2D",s=p?i+"( "+u+", "+c+", "+p+" )":i+"( "+u+", "+c+" )";var a={include:e.isShader("vertex"),ignoreCache:!0},n=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace||new o.ColorSpaceNode(new r.ExpressionNode("",n)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,n),e.removeContext(),e.format(s,n,t)},i.prototype.copy=function(t){return e.InputNode.prototype.copy.call(this,t),t.value&&(this.value=t.value),this.uv=t.uv,t.bias&&(this.bias=t.bias),void 0!==t.project&&(this.project=t.project),this},i.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},exports.TextureNode=i;
