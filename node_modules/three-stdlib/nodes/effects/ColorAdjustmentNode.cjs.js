"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../core/TempNode.cjs.js"),e=require("../core/FunctionNode.cjs.js"),o=require("./LuminanceNode.cjs.js");function r(e,o,n){t.TempNode.call(this,"v3"),this.rgb=e,this.adjustment=o,this.method=n||r.SATURATION}require("three"),require("../core/Node.cjs.js"),require("../core/NodeLib.cjs.js"),require("../core/ConstNode.cjs.js"),r.Nodes={hue:new e.FunctionNode(["vec3 hue(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n")),saturation:new e.FunctionNode(["vec3 saturation(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3( luminance( rgb ) );","\treturn mix( intensity, rgb, adjustment );","}"].join("\n"),[o.LuminanceNode.Nodes.luminance]),vibrance:new e.FunctionNode(["vec3 vibrance(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))},r.SATURATION="saturation",r.HUE="hue",r.VIBRANCE="vibrance",r.BRIGHTNESS="brightness",r.CONTRAST="contrast",r.prototype=Object.create(t.TempNode.prototype),r.prototype.constructor=r,r.prototype.nodeType="ColorAdjustment",r.prototype.hashProperties=["method"],r.prototype.generate=function(t,e){var o=this.rgb.build(t,"v3"),n=this.adjustment.build(t,"f");switch(this.method){case r.BRIGHTNESS:return t.format("( "+o+" + "+n+" )",this.getType(t),e);case r.CONTRAST:return t.format("( "+o+" * "+n+" )",this.getType(t),e)}var i=t.include(r.Nodes[this.method]);return t.format(i+"( "+o+", "+n+" )",this.getType(t),e)},r.prototype.copy=function(e){return t.TempNode.prototype.copy.call(this,e),this.rgb=e.rgb,this.adjustment=e.adjustment,this.method=e.method,this},r.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).rgb=this.rgb.toJSON(t).uuid,e.adjustment=this.adjustment.toJSON(t).uuid,e.method=this.method),e},exports.ColorAdjustmentNode=r;
