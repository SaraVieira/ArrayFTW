"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),t=require("@babel/runtime/helpers/inheritsLoose"),r=require("potpack"),a=require("@babel/runtime/helpers/assertThisInitialized"),n=require("@babel/runtime/helpers/defineProperty"),o=require("@babel/runtime/helpers/createClass"),s=require("@babel/runtime/helpers/asyncToGenerator"),l=require("fflate"),u=require("mmd-parser"),c=require("chevrotain"),h=require("@babel/runtime/helpers/extends"),d=require("zstddec"),f=require("ktx-parse"),p=require("opentype.js");function m(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v,g=m(t),y=m(r),x=m(a),b=m(n),A=m(o),w=m(s),M=m(h),S=function(t){e.Loader.call(this,t)};S.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:S,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:(v=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]],function(t){for(var r=new DataView(t),a={},i=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],n=0;n<i.length;n++)a[i[n]]=r.getInt32(4*n,!0);if(844121161===a.ident&&8===a.version){if(a.offset_end===r.byteLength){for(var o=new e.BufferGeometry,s=[],l=a.offset_st,u=0,c=a.num_st;u<c;u++){var h=r.getInt16(l+0,!0),d=r.getInt16(l+2,!0);s.push(h/a.skinwidth,1-d/a.skinheight),l+=4}l=a.offset_tris;for(var f=[],p=[],m=0,g=a.num_tris;m<g;m++)f.push(r.getUint16(l+0,!0),r.getUint16(l+2,!0),r.getUint16(l+4,!0)),p.push(r.getUint16(l+6,!0),r.getUint16(l+8,!0),r.getUint16(l+10,!0)),l+=12;var y=new e.Vector3,x=new e.Vector3,b=[],A=[];l=a.offset_frames;for(var w=0,M=a.num_frames;w<M;w++){x.set(r.getFloat32(l+0,!0),r.getFloat32(l+4,!0),r.getFloat32(l+8,!0)),y.set(r.getFloat32(l+12,!0),r.getFloat32(l+16,!0),r.getFloat32(l+20,!0)),l+=24;for(var S=0;S<16;S++){var T=r.getUint8(l+S,!0);if(0===T)break;b[S]=T}var C={name:String.fromCharCode.apply(null,b),vertices:[],normals:[]};l+=16;for(var F=0;F<a.num_vertices;F++){var E=r.getUint8(l++,!0),B=r.getUint8(l++,!0),L=r.getUint8(l++,!0),P=v[r.getUint8(l++,!0)];E=E*x.x+y.x,B=B*x.y+y.y,L=L*x.z+y.z,C.vertices.push(E,L,B),C.normals.push(P[0],P[2],P[1])}A.push(C)}for(var D=[],N=[],R=[],_=A[0].vertices,I=A[0].normals,O=0,U=f.length;O<U;O++){E=_[J=3*f[O]],B=_[J+1],L=_[J+2],D.push(E,B,L);var k=I[J],V=I[J+1],G=I[J+2];N.push(k,V,G),h=s[J=2*p[O]],d=s[J+1],R.push(h,d)}o.setAttribute("position",new e.Float32BufferAttribute(D,3)),o.setAttribute("normal",new e.Float32BufferAttribute(N,3)),o.setAttribute("uv",new e.Float32BufferAttribute(R,2));for(var j=[],z=[],H=0,W=A.length;H<W;H++){var X=(C=A[H]).name;if(C.vertices.length>0){D=[];for(var Q=0,Y=f.length;Q<Y;Q++){var J=3*f[Q];E=C.vertices[J],B=C.vertices[J+1],L=C.vertices[J+2],D.push(E,B,L)}var K=new e.Float32BufferAttribute(D,3);K.name=X,j.push(K)}if(C.normals.length>0){N=[];for(var q=0,Z=f.length;q<Z;q++)J=3*f[q],k=C.normals[J],V=C.normals[J+1],G=C.normals[J+2],N.push(k,V,G);var $=new e.Float32BufferAttribute(N,3);$.name=X,z.push($)}}return o.morphAttributes.position=j,o.morphAttributes.normal=z,o.morphTargetsRelative=!1,o.animations=e.AnimationClip.CreateClipsFromMorphTargetSequences(A,10),o}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")})});var T=function(t,r){e.Mesh.call(this,t,r),this.animationsMap={},this.animationsList=[];var a=Object.keys(this.morphTargetDictionary).length,i="__default",n=a-1,o=a/1;this.createAnimation(i,0,n,o),this.setAnimationWeight(i,1)};T.prototype=Object.assign(Object.create(e.Mesh.prototype),{constructor:T,createAnimation:function(e,t,r,a){var i={start:t,end:r,length:r-t+1,fps:a,duration:(r-t)/a,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},autoCreateAnimations:function(e){var t,r=/([a-z]+)_?(\d+)/i,a={},i=0;for(var n in this.morphTargetDictionary){var o=n.match(r);if(o&&o.length>1){var s=o[1];a[s]||(a[s]={start:1/0,end:-1/0}),i<(u=a[s]).start&&(u.start=i),i>u.end&&(u.end=i),t||(t=s)}i++}for(var l in a){var u=a[l];this.createAnimation(l,u.start,u.end,e)}this.firstAnimation=t},setAnimationDirectionForward:function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},setAnimationDirectionBackward:function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},setAnimationFPS:function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},setAnimationDuration:function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},setAnimationWeight:function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},setAnimationTime:function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},getAnimationTime:function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},getAnimationDuration:function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},playAnimation:function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},stopAnimation:function(e){var t=this.animationsMap[e];t&&(t.active=!1)},update:function(t){for(var r=0,a=this.animationsList.length;r<a;r++){var i=this.animationsList[r];if(i.active){var n=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var o=i.start+e.MathUtils.clamp(Math.floor(i.time/n),0,i.length-1),s=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*s,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o);var l=i.time%n/n;i.directionBackwards&&(l=1-l),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=l*s,this.morphTargetInfluences[i.lastFrame]=(1-l)*s):this.morphTargetInfluences[i.currentFrame]=s}}}});var C=function(){var t,r=new e.Vector3;function a(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new s,this.unassigned=new s,this.vertices=[]}function i(){this.normal=new e.Vector3,this.midpoint=new e.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function n(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}function o(e){this.point=e,this.prev=null,this.next=null,this.face=null}function s(){this.head=null,this.tail=null}return Object.assign(a.prototype,{setFromPoints:function(e){!0!==Array.isArray(e)&&console.error("THREE.ConvexHull: Points parameter is not an array."),e.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.vertices.push(new o(e[t]));return this.compute(),this},setFromObject:function(t){var r=[];return t.updateMatrixWorld(!0),t.traverse((function(t){var a,i,n,o=t.geometry;if(void 0!==o){if(o.isGeometry)return void console.error("THREE.ConvexHull no longer supports Geometry. Use THREE.BufferGeometry instead.");if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(a=0,i=s.count;a<i;a++)(n=new e.Vector3).fromBufferAttribute(s,a).applyMatrix4(t.matrixWorld),r.push(n)}}})),this.setFromPoints(r)},containsPoint:function(e){for(var t=this.faces,r=0,a=t.length;r<a;r++){if(t[r].distanceToPoint(e)>this.tolerance)return!1}return!0},intersectRay:function(e,t){for(var r=this.faces,a=-1/0,i=1/0,n=0,o=r.length;n<o;n++){var s=r[n],l=s.distanceToPoint(e.origin),u=s.normal.dot(e.direction);if(l>0&&u>=0)return null;var c=0!==u?-l/u:0;if(!(c<=0)&&(u>0?i=Math.min(c,i):a=Math.max(c,a),a>i))return null}return a!==-1/0?e.at(a,t):e.at(i,t),t},intersectsRay:function(e){return null!==this.intersectRay(e,r)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this},removeVertexFromFace:function(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this},removeAllVerticesFromFace:function(e){if(null!==e.outside){for(var t=e.outside,r=e.outside;null!==r.next&&r.next.face===e;)r=r.next;return this.assigned.removeSubList(t,r),t.prev=r.next=null,e.outside=null,t}},deleteFaceVertices:function(e,t){var r=this.removeAllVerticesFromFace(e);if(void 0!==r)if(void 0===t)this.unassigned.appendChain(r);else{var a=r;do{var i=a.next;t.distanceToPoint(a.point)>this.tolerance?this.addVertexToFace(a,t):this.unassigned.append(a),a=i}while(null!==a)}return this},resolveUnassignedPoints:function(e){if(!1===this.unassigned.isEmpty()){var t=this.unassigned.first();do{for(var r=t.next,a=this.tolerance,i=null,n=0;n<e.length;n++){var o=e[n];if(0===o.mark){var s=o.distanceToPoint(t.point);if(s>a&&(a=s,i=o),a>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(t,i),t=r}while(null!==t)}return this},computeExtremes:function(){var t,r,a,i=new e.Vector3,n=new e.Vector3,o=[],s=[];for(t=0;t<3;t++)o[t]=s[t]=this.vertices[0];for(i.copy(this.vertices[0].point),n.copy(this.vertices[0].point),t=0,r=this.vertices.length;t<r;t++){var l=this.vertices[t],u=l.point;for(a=0;a<3;a++)u.getComponent(a)<i.getComponent(a)&&(i.setComponent(a,u.getComponent(a)),o[a]=l);for(a=0;a<3;a++)u.getComponent(a)>n.getComponent(a)&&(n.setComponent(a,u.getComponent(a)),s[a]=l)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(i.x),Math.abs(n.x))+Math.max(Math.abs(i.y),Math.abs(n.y))+Math.max(Math.abs(i.z),Math.abs(n.z))),{min:o,max:s}},computeInitialHull:function(){var t,r,a;return function(){void 0===t&&(t=new e.Line3,r=new e.Plane,a=new e.Vector3);var n,o,s,l,u,c,h,d,f,p=this.vertices,m=this.computeExtremes(),v=m.min,g=m.max,y=0,x=0;for(c=0;c<3;c++)(f=g[c].point.getComponent(c)-v[c].point.getComponent(c))>y&&(y=f,x=c);for(o=v[x],s=g[x],y=0,t.set(o.point,s.point),c=0,h=this.vertices.length;c<h;c++)(n=p[c])!==o&&n!==s&&(t.closestPointToPoint(n.point,!0,a),(f=a.distanceToSquared(n.point))>y&&(y=f,l=n));for(y=-1,r.setFromCoplanarPoints(o.point,s.point,l.point),c=0,h=this.vertices.length;c<h;c++)(n=p[c])!==o&&n!==s&&n!==l&&(f=Math.abs(r.distanceToPoint(n.point)))>y&&(y=f,u=n);var b=[];if(r.distanceToPoint(u.point)<0)for(b.push(i.create(o,s,l),i.create(u,s,o),i.create(u,l,s),i.create(u,o,l)),c=0;c<3;c++)d=(c+1)%3,b[c+1].getEdge(2).setTwin(b[0].getEdge(d)),b[c+1].getEdge(1).setTwin(b[d+1].getEdge(0));else for(b.push(i.create(o,l,s),i.create(u,o,s),i.create(u,s,l),i.create(u,l,o)),c=0;c<3;c++)d=(c+1)%3,b[c+1].getEdge(2).setTwin(b[0].getEdge((3-c)%3)),b[c+1].getEdge(0).setTwin(b[d+1].getEdge(1));for(c=0;c<4;c++)this.faces.push(b[c]);for(c=0,h=p.length;c<h;c++)if((n=p[c])!==o&&n!==s&&n!==l&&n!==u){y=this.tolerance;var A=null;for(d=0;d<4;d++)(f=this.faces[d].distanceToPoint(n.point))>y&&(y=f,A=this.faces[d]);null!==A&&this.addVertexToFace(n,A)}return this}}(),reindexFaces:function(){for(var e=[],t=0;t<this.faces.length;t++){var r=this.faces[t];0===r.mark&&e.push(r)}return this.faces=e,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var e,t=0,r=this.assigned.first().face,a=r.outside;do{var i=r.distanceToPoint(a.point);i>t&&(t=i,e=a),a=a.next}while(null!==a&&a.face===r);return e}},computeHorizon:function(e,t,r,a){var i;this.deleteFaceVertices(r),r.mark=1,i=null===t?t=r.getEdge(0):t.next;do{var n=i.twin,o=n.face;0===o.mark&&(o.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,n,o,a):a.push(i)),i=i.next}while(i!==t);return this},addAdjoiningFace:function(e,t){var r=i.create(e,t.tail(),t.head());return this.faces.push(r),r.getEdge(-1).setTwin(t.twin),r.getEdge(0)},addNewFaces:function(e,t){this.newFaces=[];for(var r=null,a=null,i=0;i<t.length;i++){var n=t[i],o=this.addAdjoiningFace(e,n);null===r?r=o:o.next.setTwin(a),this.newFaces.push(o.face),a=o}return r.next.setTwin(a),this},addVertexToHull:function(e){var t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(i,{create:function(e,t,r){var a=new i,o=new n(e,a),s=new n(t,a),l=new n(r,a);return o.next=l.prev=s,s.next=o.prev=l,l.next=s.prev=o,a.edge=o,a.compute()}}),Object.assign(i.prototype,{getEdge:function(e){for(var t=this.edge;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t},compute:function(){void 0===t&&(t=new e.Triangle);var r=this.edge.tail(),a=this.edge.head(),i=this.edge.next.head();return t.set(r.point,a.point,i.point),t.getNormal(this.normal),t.getMidpoint(this.midpoint),this.area=t.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(e){return this.normal.dot(e)-this.constant}}),Object.assign(n.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1},lengthSquared:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1},setTwin:function(e){return this.twin=e,e.twin=this,this}}),Object.assign(s.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this},insertAfter:function(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this},append:function(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this},appendChain:function(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this},remove:function(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this},removeSubList:function(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this},isEmpty:function(){return null===this.head}}),a}(),F=function(t){function r(r){var a;a=t.call(this)||this;var i=[],n=[];void 0===C&&console.error("THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull");for(var o=(new C).setFromPoints(r).faces,s=0;s<o.length;s++){var l=o[s],u=l.edge;do{var c=u.head().point;i.push(c.x,c.y,c.z),n.push(l.normal.x,l.normal.y,l.normal.z),u=u.next}while(u!==l.edge)}return a.setAttribute("position",new e.Float32BufferAttribute(i,3)),a.setAttribute("normal",new e.Float32BufferAttribute(n,3)),a}return g.default(r,t),r}(e.BufferGeometry),E=function(t,r){this.minSizeForBreak=t||1.4,this.smallDelta=r||1e-4,this.tempLine1=new e.Line3,this.tempPlane1=new e.Plane,this.tempPlane2=new e.Plane,this.tempPlane_Cut=new e.Plane,this.tempCM1=new e.Vector3,this.tempCM2=new e.Vector3,this.tempVector3=new e.Vector3,this.tempVector3_2=new e.Vector3,this.tempVector3_3=new e.Vector3,this.tempVector3_P0=new e.Vector3,this.tempVector3_P1=new e.Vector3,this.tempVector3_P2=new e.Vector3,this.tempVector3_N0=new e.Vector3,this.tempVector3_N1=new e.Vector3,this.tempVector3_AB=new e.Vector3,this.tempVector3_CB=new e.Vector3,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var a=0;a<900;a++)this.segments[a]=!1};E.prototype={constructor:E,prepareBreakableObject:function(e,t,r,a,i){e.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var n=e.userData;n.mass=t,n.velocity=r.clone(),n.angularVelocity=a.clone(),n.breakable=i},subdivideByImpact:function(e,t,r,a,i){var n=[],o=this.tempPlane1,s=this.tempPlane2;this.tempVector3.addVectors(t,r),o.setFromCoplanarPoints(t,e.position,this.tempVector3);var l=i+a,u=this;return function i(c,h,d,f){if(Math.random()<.05*f||f>l)n.push(c);else{var p=Math.PI;0===f?(s.normal.copy(o.normal),s.constant=o.constant):f<=a?(p=(d-h)*(.2+.6*Math.random())+h,u.tempVector3_2.copy(e.position).sub(t).applyAxisAngle(r,p).add(t),s.setFromCoplanarPoints(t,u.tempVector3,u.tempVector3_2)):(p=(.5*(1&f)+.2*(2-Math.random()))*Math.PI,u.tempVector3_2.copy(t).sub(c.position).applyAxisAngle(r,p).add(c.position),u.tempVector3_3.copy(r).add(c.position),s.setFromCoplanarPoints(c.position,u.tempVector3_3,u.tempVector3_2)),u.cutByPlane(c,s,u.tempResultObjects);var m=u.tempResultObjects.object1,v=u.tempResultObjects.object2;m&&i(m,h,p,f+1),v&&i(v,p,d,f+1)}}(e,0,2*Math.PI,0),n},cutByPlane:function(t,r,a){var i=t.geometry,n=i.attributes.position.array,o=i.attributes.normal.array,s=n.length/3,l=s/3,u=i.getIndex();function c(e,t){var r=3*e+t;return u?u[r]:r}u&&(l=(u=u.array).length/3);for(var h=[],d=[],f=this.smallDelta,p=s*s,m=0;m<p;m++)this.segments[m]=!1;for(var v=this.tempVector3_P0,g=this.tempVector3_P1,y=this.tempVector3_N0,x=this.tempVector3_N1,b=0;b<l-1;b++){var A=c(b,0),w=c(b,1),M=c(b,2);y.set(o[A],o[A]+1,o[A]+2);for(var S=b+1;S<l;S++){var T=c(S,0),C=c(S,1),B=c(S,2);x.set(o[T],o[T]+1,o[T]+2),1-y.dot(x)<f&&(A===T||A===C||A===B?w===T||w===C||w===B?(this.segments[A*s+w]=!0,this.segments[w*s+A]=!0):(this.segments[M*s+A]=!0,this.segments[A*s+M]=!0):w!==T&&w!==C&&w!==B||(this.segments[M*s+w]=!0,this.segments[w*s+M]=!0))}}var L=this.tempPlane_Cut;t.updateMatrix(),E.transformPlaneToLocalSpace(r,t.matrix,L);for(var P=0;P<l;P++)for(var D=c(P,0),N=c(P,1),R=c(P,2),_=0;_<3;_++){var I=0===_?D:1===_?N:R,O=0===_?N:1===_?R:D;if(!this.segments[I*s+O]){this.segments[I*s+O]=!0,this.segments[O*s+I]=!0,v.set(n[3*I],n[3*I+1],n[3*I+2]),g.set(n[3*O],n[3*O+1],n[3*O+2]);var U=0;(k=L.distanceToPoint(v))>f?(U=2,d.push(v.clone())):k<-f?(U=1,h.push(v.clone())):(U=3,h.push(v.clone()),d.push(v.clone()));var k,V=0;if((k=L.distanceToPoint(g))>f?(V=2,d.push(g.clone())):k<-f?(V=1,h.push(g.clone())):(V=3,h.push(g.clone()),d.push(g.clone())),1===U&&2===V||2===U&&1===V){this.tempLine1.start.copy(v),this.tempLine1.end.copy(g);var G=new e.Vector3;if(void 0===(G=L.intersectLine(this.tempLine1,G)))return console.error("Internal error: segment does not intersect plane."),a.segmentedObject1=null,a.segmentedObject2=null,0;h.push(G),d.push(G.clone())}}}var j=.5*t.userData.mass;this.tempCM1.set(0,0,0);var z=0,H=h.length;if(H>0){for(var W=0;W<H;W++)this.tempCM1.add(h[W]);this.tempCM1.divideScalar(H);for(var X=0;X<H;X++){(q=h[X]).sub(this.tempCM1),z=Math.max(z,q.x,q.y,q.z)}this.tempCM1.add(t.position)}this.tempCM2.set(0,0,0);var Q=0,Y=d.length;if(Y>0){for(var J=0;J<Y;J++)this.tempCM2.add(d[J]);this.tempCM2.divideScalar(Y);for(var K=0;K<Y;K++){var q;(q=d[K]).sub(this.tempCM2),Q=Math.max(Q,q.x,q.y,q.z)}this.tempCM2.add(t.position)}var Z=null,$=null,ee=0;return H>4&&((Z=new e.Mesh(new F(h),t.material)).position.copy(this.tempCM1),Z.quaternion.copy(t.quaternion),this.prepareBreakableObject(Z,j,t.userData.velocity,t.userData.angularVelocity,2*z>this.minSizeForBreak),ee++),Y>4&&(($=new e.Mesh(new F(d),t.material)).position.copy(this.tempCM2),$.quaternion.copy(t.quaternion),this.prepareBreakableObject($,j,t.userData.velocity,t.userData.angularVelocity,2*Q>this.minSizeForBreak),ee++),a.object1=Z,a.object2=$,ee}},E.transformFreeVector=function(e,t){var r=e.x,a=e.y,i=e.z,n=t.elements;return e.x=n[0]*r+n[4]*a+n[8]*i,e.y=n[1]*r+n[5]*a+n[9]*i,e.z=n[2]*r+n[6]*a+n[10]*i,e},E.transformFreeVectorInverse=function(e,t){var r=e.x,a=e.y,i=e.z,n=t.elements;return e.x=n[0]*r+n[1]*a+n[2]*i,e.y=n[4]*r+n[5]*a+n[6]*i,e.z=n[8]*r+n[9]*a+n[10]*i,e},E.transformTiedVectorInverse=function(e,t){var r=e.x,a=e.y,i=e.z,n=t.elements;return e.x=n[0]*r+n[1]*a+n[2]*i-n[12],e.y=n[4]*r+n[5]*a+n[6]*i-n[13],e.z=n[8]*r+n[9]*a+n[10]*i-n[14],e},E.transformPlaneToLocalSpace=function(){var t=new e.Vector3;return function(e,r,a){a.normal.copy(e.normal),a.constant=e.constant;var i=E.transformTiedVectorInverse(e.coplanarPoint(t),r);E.transformFreeVectorInverse(a.normal,r),a.constant=-i.dot(a.normal)}}();var B,L,P,D,N,R,_=function(){e.Object3D.call(this)};(_.prototype=Object.create(e.Object3D.prototype)).constructor=_,_.prototype.updateMatrixWorld=(B=new e.Vector3,L=new e.Quaternion,P=new e.Vector3,D=new e.Vector3,N=new e.Quaternion,R=new e.Vector3,function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(D,N,R),this.matrix.decompose(B,L,P),this.matrixWorld.compose(D,L,R)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)});var I=function(t,r){e.Mesh.call(this,t,r),this.type="MorphAnimMesh",this.mixer=new e.AnimationMixer(this),this.activeAction=null};(I.prototype=Object.create(e.Mesh.prototype)).constructor=I,I.prototype.setDirectionForward=function(){this.mixer.timeScale=1},I.prototype.setDirectionBackward=function(){this.mixer.timeScale=-1},I.prototype.playAnimation=function(t,r){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);var a=e.AnimationClip.findByName(this,t);if(!a)throw new Error("THREE.MorphAnimMesh: animations["+t+"] undefined in .playAnimation()");var i=this.mixer.clipAction(a);i.timeScale=a.tracks.length*r/a.duration,this.activeAction=i.play()},I.prototype.updateAnimation=function(e){this.mixer.update(e)},I.prototype.copy=function(t){return e.Mesh.prototype.copy.call(this,t),this.mixer=new e.AnimationMixer(this),this};var O=function(t,r){e.BufferGeometry.call(this);var a=[],i=[],n=[],o=[1,1,1],s=[1,1,0],l=new e.Vector3(0,1,0),u=new e.Vector3,c=new e.Vector3,h=new e.Quaternion,d=new e.Quaternion;d.setFromAxisAngle(l,Math.PI/2);var f=new e.Vector3,p=new e.Vector3;p.copy(t.getPointAt(0));for(var m=[new e.Vector3(-.225,0,0),new e.Vector3(0,-.05,0),new e.Vector3(0,-.175,0),new e.Vector3(0,-.05,0),new e.Vector3(.225,0,0),new e.Vector3(0,-.175,0)],v=2*Math.PI,g=5,y=[],x=0;x<g;x++){var b=x/g*v;y.push(new e.Vector3(.06*Math.sin(b),.06*Math.cos(b),0))}g=6;for(var A=[],w=0;w<g;w++){b=w/g*v;A.push(new e.Vector3(.025*Math.sin(b),.025*Math.cos(b),0))}var M=new e.Vector3,S=new e.Vector3;function T(e,t){S.set(0,0,-1).applyQuaternion(h);for(var r=0;r<e.length;r++)M.copy(e[r]),M.applyQuaternion(h),M.add(f),a.push(M.x,M.y,M.z),i.push(S.x,S.y,S.z),n.push(t[0],t[1],t[2]);S.set(0,0,1).applyQuaternion(h);for(var o=e.length-1;o>=0;o--)M.copy(e[o]),M.applyQuaternion(h),M.add(f),a.push(M.x,M.y,M.z),i.push(S.x,S.y,S.z),n.push(t[0],t[1],t[2])}var C=new e.Vector3,F=new e.Vector3,E=new e.Vector3,B=new e.Vector3,L=new e.Vector3,P=new e.Vector3,D=new e.Vector3,N=new e.Vector3;function R(e,t,r){for(var o=0,s=e.length;o<s;o++){var l=e[o],u=e[(o+1)%s];C.copy(l).add(t),C.applyQuaternion(h),C.add(f),F.copy(u).add(t),F.applyQuaternion(h),F.add(f),E.copy(u).add(t),E.applyQuaternion(d),E.add(p),B.copy(l).add(t),B.applyQuaternion(d),B.add(p),a.push(C.x,C.y,C.z),a.push(F.x,F.y,F.z),a.push(B.x,B.y,B.z),a.push(F.x,F.y,F.z),a.push(E.x,E.y,E.z),a.push(B.x,B.y,B.z),L.copy(l),L.applyQuaternion(h),L.normalize(),P.copy(u),P.applyQuaternion(h),P.normalize(),D.copy(u),D.applyQuaternion(d),D.normalize(),N.copy(l),N.applyQuaternion(d),N.normalize(),i.push(L.x,L.y,L.z),i.push(P.x,P.y,P.z),i.push(N.x,N.y,N.z),i.push(P.x,P.y,P.z),i.push(D.x,D.y,D.z),i.push(N.x,N.y,N.z),n.push(r[0],r[1],r[2]),n.push(r[0],r[1],r[2]),n.push(r[0],r[1],r[2]),n.push(r[0],r[1],r[2]),n.push(r[0],r[1],r[2]),n.push(r[0],r[1],r[2])}}for(var _=new e.Vector3,I=1;I<=r;I++){f.copy(t.getPointAt(I/r)),l.set(0,1,0),u.subVectors(f,p).normalize(),c.crossVectors(l,u).normalize(),l.crossVectors(u,c);b=Math.atan2(u.x,u.z);h.setFromAxisAngle(l,b),I%2==0&&T(m,s),R(y,_.set(0,-.125,0),s),R(A,_.set(.2,0,0),o),R(A,_.set(-.2,0,0),o),p.copy(f),d.copy(h)}this.setAttribute("position",new e.BufferAttribute(new Float32Array(a),3)),this.setAttribute("normal",new e.BufferAttribute(new Float32Array(i),3)),this.setAttribute("color",new e.BufferAttribute(new Float32Array(n),3))};O.prototype=Object.create(e.BufferGeometry.prototype);var U=function(t,r){e.BufferGeometry.call(this);var a=[],i=[],n=new e.Quaternion,o=new e.Vector3(0,1,0),s=new e.Vector3,l=new e.Vector3,u=[new e.Vector3(0,.05,-.05),new e.Vector3(0,.05,.05),new e.Vector3(0,-.05,0)],c=[new e.Vector3(-.05,0,.05),new e.Vector3(-.05,0,-.05),new e.Vector3(.05,0,0)],h=[new e.Vector3(.05,0,-.05),new e.Vector3(.05,0,.05),new e.Vector3(-.05,0,0)],d=new e.Vector3,f=new e.Vector3,p=new e.Vector3,m=new e.Vector3,v=new e.Vector3,g=new e.Vector3,y=new e.Vector3,x=new e.Vector3;function b(e,t,r){for(var o=0,s=e.length;o<s;o++){var l=e[o],u=e[(o+1)%s];d.copy(l),d.applyQuaternion(n),d.add(t),f.copy(u),f.applyQuaternion(n),f.add(t),p.copy(u),p.applyQuaternion(n),p.add(r),m.copy(l),m.applyQuaternion(n),m.add(r),a.push(d.x,d.y,d.z),a.push(f.x,f.y,f.z),a.push(m.x,m.y,m.z),a.push(f.x,f.y,f.z),a.push(p.x,p.y,p.z),a.push(m.x,m.y,m.z),v.copy(l),v.applyQuaternion(n),v.normalize(),g.copy(u),g.applyQuaternion(n),g.normalize(),y.copy(u),y.applyQuaternion(n),y.normalize(),x.copy(l),x.applyQuaternion(n),x.normalize(),i.push(v.x,v.y,v.z),i.push(g.x,g.y,g.z),i.push(x.x,x.y,x.z),i.push(g.x,g.y,g.z),i.push(y.x,y.y,y.z),i.push(x.x,x.y,x.z)}}for(var A=new e.Vector3,w=new e.Vector3,M=1;M<=r;M++){s.copy(t.getPointAt(M/r)),l.copy(t.getTangentAt(M/r));var S=Math.atan2(l.x,l.z);n.setFromAxisAngle(o,S),s.y>10?(A.set(-.75,-.35,0),A.applyQuaternion(n),A.add(s),w.set(.75,-.35,0),w.applyQuaternion(n),w.add(s),b(u,A,w),A.set(-.7,-.3,0),A.applyQuaternion(n),A.add(s),w.set(-.7,-s.y,0),w.applyQuaternion(n),w.add(s),b(c,A,w),A.set(.7,-.3,0),A.applyQuaternion(n),A.add(s),w.set(.7,-s.y,0),w.applyQuaternion(n),w.add(s),b(h,A,w)):(A.set(0,-.2,0),A.applyQuaternion(n),A.add(s),w.set(0,-s.y,0),w.applyQuaternion(n),w.add(s),b(h,A,w))}this.setAttribute("position",new e.BufferAttribute(new Float32Array(a),3)),this.setAttribute("normal",new e.BufferAttribute(new Float32Array(i),3))};U.prototype=Object.create(e.BufferGeometry.prototype);var k=function(t,r){e.BufferGeometry.call(this);var a=[],i=new e.Vector3(0,1,0),n=new e.Vector3,o=new e.Quaternion,s=new e.Quaternion;s.setFromAxisAngle(i,Math.PI/2);var l=new e.Vector3,u=new e.Vector3;u.copy(t.getPointAt(0)),u.y=0;for(var c=new e.Vector3,h=new e.Vector3,d=new e.Vector3,f=new e.Vector3,p=1;p<=r;p++){l.copy(t.getPointAt(p/r)),l.y=0,n.subVectors(l,u);var m=Math.atan2(n.x,n.z);o.setFromAxisAngle(i,m),c.set(-.3,0,0),c.applyQuaternion(o),c.add(l),h.set(.3,0,0),h.applyQuaternion(o),h.add(l),d.set(.3,0,0),d.applyQuaternion(s),d.add(u),f.set(-.3,0,0),f.applyQuaternion(s),f.add(u),a.push(c.x,c.y,c.z),a.push(h.x,h.y,h.z),a.push(f.x,f.y,f.z),a.push(h.x,h.y,h.z),a.push(d.x,d.y,d.z),a.push(f.x,f.y,f.z),u.copy(l),s.copy(o)}this.setAttribute("position",new e.BufferAttribute(new Float32Array(a),3))};k.prototype=Object.create(e.BufferGeometry.prototype);var V=function(){e.BufferGeometry.call(this);for(var t=[],r=0;r<100;r++){var a=800*Math.random()-400,i=50*Math.random()+50,n=800*Math.random()-400,o=40*Math.random()+20;t.push(a-o,i,n-o),t.push(a+o,i,n-o),t.push(a-o,i,n+o),t.push(a+o,i,n-o),t.push(a+o,i,n+o),t.push(a-o,i,n+o)}this.setAttribute("position",new e.BufferAttribute(new Float32Array(t),3))};V.prototype=Object.create(e.BufferGeometry.prototype);var G=function(t){e.BufferGeometry.call(this);var r=[],a=[],i=new e.Raycaster;i.ray.direction.set(0,-1,0);for(var n=0;n<2e3;n++){var o=500*Math.random()-250,s=500*Math.random()-250;i.ray.origin.set(o,50,s);var l=i.intersectObject(t);if(0!==l.length){var u=l[0].point.y,c=5*Math.random()+.5,h=Math.random()*Math.PI*2;r.push(o+Math.sin(h),u,s+Math.cos(h)),r.push(o,u+c,s),r.push(o+Math.sin(h+Math.PI),u,s+Math.cos(h+Math.PI)),h+=Math.PI/2,r.push(o+Math.sin(h),u,s+Math.cos(h)),r.push(o,u+c,s),r.push(o+Math.sin(h+Math.PI),u,s+Math.cos(h+Math.PI));for(var d=.1*Math.random(),f=0;f<6;f++)a.push(.2+d,.4+d,0)}}this.setAttribute("position",new e.BufferAttribute(new Float32Array(r),3)),this.setAttribute("color",new e.BufferAttribute(new Float32Array(a),3))};G.prototype=Object.create(e.BufferGeometry.prototype);var z={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},r=document.createElement("div");r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0";var a='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>';return a=(a=t[e]?a.replace("$0","graphics card"):a.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=a,r}},H=function(t,r,a){var i=this;this.volume=t,r=r||0,Object.defineProperty(this,"index",{get:function(){return r},set:function(e){return r=e,i.geometryNeedsUpdate=!0,r}}),this.axis=a||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var n=new e.Texture(this.canvas);n.minFilter=e.LinearFilter,n.wrapS=n.wrapT=e.ClampToEdgeWrapping;var o=new e.MeshBasicMaterial({map:n,side:e.DoubleSide,transparent:!0});this.mesh=new e.Mesh(this.geometry,o),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()};H.prototype={constructor:H,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,t=this.jLength,r=this.sliceAccess,a=this.volume,i=this.canvasBuffer,n=this.ctxBuffer,o=n.getImageData(0,0,e,t),s=o.data,l=a.data,u=a.upperThreshold,c=a.lowerThreshold,h=a.windowLow,d=a.windowHigh,f=0;if("label"===a.dataType)for(var p=0;p<t;p++)for(var m=0;m<e;m++){var v=l[r(m,p)];v=v>=this.colorMap.length?v%this.colorMap.length+1:v;var g=this.colorMap[v];s[4*f]=g>>24&255,s[4*f+1]=g>>16&255,s[4*f+2]=g>>8&255,s[4*f+3]=255&g,f++}else for(var y=0;y<t;y++)for(var x=0;x<e;x++){var b=l[r(x,y)],A=255;A=u>=b&&c<=b?A:0,b=(b=Math.floor(255*(b-h)/(d-h)))>255?255:b<0?0:0|b,s[4*f]=b,s[4*f+1]=b,s[4*f+2]=b,s[4*f+3]=A,f++}n.putImageData(o,0,0),this.ctx.drawImage(i,0,0,e,t,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var t=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=t.sliceAccess,this.jLength=t.jLength,this.iLength=t.iLength,this.matrix=t.matrix,this.canvas.width=t.planeWidth,this.canvas.height=t.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new e.PlaneGeometry(t.planeWidth,t.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix4(this.matrix)),this.geometryNeedsUpdate=!1}};var W=function(t,r,a,i,n){if(arguments.length>0){switch(this.xLength=Number(t)||1,this.yLength=Number(r)||1,this.zLength=Number(a)||1,i){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(n);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(n);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(n);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(n);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(n);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(n);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(n);break;case"Float64":case"float64":case"double":this.data=new Float64Array(n);break;default:this.data=new Uint8Array(n)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new e.Matrix3,this.matrix.identity();var o=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return o},set:function(e){o=e,this.sliceList.forEach((function(e){e.geometryNeedsUpdate=!0}))}});var s=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return s},set:function(e){s=e,this.sliceList.forEach((function(e){e.geometryNeedsUpdate=!0}))}}),this.sliceList=[]};W.prototype={constructor:W,getData:function(e,t,r){return this.data[r*this.xLength*this.yLength+t*this.xLength+e]},access:function(e,t,r){return r*this.xLength*this.yLength+t*this.xLength+e},reverseAccess:function(e){var t=Math.floor(e/(this.yLength*this.xLength)),r=Math.floor((e-t*this.yLength*this.xLength)/this.xLength);return[e-t*this.yLength*this.xLength-r*this.xLength,r,t]},map:function(e,t){var r=this.data.length;t=t||this;for(var a=0;a<r;a++)this.data[a]=e.call(t,this.data[a],a,this.data);return this},extractPerpendicularPlane:function(t,r){var a,i,n,o,s,l,u,c,h=(new e.Matrix4).identity(),d=this,f=new e.Vector3,p=new e.Vector3,m=new e.Vector3,v=new e.Vector3(this.xLength,this.yLength,this.zLength);switch(t){case"x":f.set(1,0,0),p.set(0,0,-1),m.set(0,-1,0),s=this.spacing[2],l=this.spacing[1],c=new e.Vector3(r,0,0),h.multiply((new e.Matrix4).makeRotationY(Math.PI/2)),u=(d.RASDimensions[0]-1)/2,h.setPosition(new e.Vector3(r-u,0,0));break;case"y":f.set(0,1,0),p.set(1,0,0),m.set(0,0,1),s=this.spacing[0],l=this.spacing[2],c=new e.Vector3(0,r,0),h.multiply((new e.Matrix4).makeRotationX(-Math.PI/2)),u=(d.RASDimensions[1]-1)/2,h.setPosition(new e.Vector3(0,r-u,0));break;case"z":default:f.set(0,0,1),p.set(1,0,0),m.set(0,-1,0),s=this.spacing[0],l=this.spacing[1],c=new e.Vector3(0,0,r),u=(d.RASDimensions[2]-1)/2,h.setPosition(new e.Vector3(0,0,r-u))}p.applyMatrix4(d.inverseMatrix).normalize(),p.argVar="i",m.applyMatrix4(d.inverseMatrix).normalize(),m.argVar="j",f.applyMatrix4(d.inverseMatrix).normalize(),a=Math.floor(Math.abs(p.dot(v))),i=Math.floor(Math.abs(m.dot(v))),n=Math.abs(a*s),o=Math.abs(i*l),c=Math.abs(Math.round(c.applyMatrix4(d.inverseMatrix).dot(f)));var g=[new e.Vector3(1,0,0),new e.Vector3(0,1,0),new e.Vector3(0,0,1)],y=[p,m,f].find((function(e){return Math.abs(e.dot(g[0]))>.9})),x=[p,m,f].find((function(e){return Math.abs(e.dot(g[1]))>.9})),b=[p,m,f].find((function(e){return Math.abs(e.dot(g[2]))>.9}));return{iLength:a,jLength:i,sliceAccess:function(e,t){var r=y===f?c:"i"===y.argVar?e:t,a=x===f?c:"i"===x.argVar?e:t,i=b===f?c:"i"===b.argVar?e:t,n=y.dot(g[0])>0?r:d.xLength-1-r,o=x.dot(g[1])>0?a:d.yLength-1-a,s=b.dot(g[2])>0?i:d.zLength-1-i;return d.access(n,o,s)},matrix:h,planeWidth:n,planeHeight:o}},extractSlice:function(e,t){var r=new H(this,t,e);return this.sliceList.push(r),r},repaintAllSlices:function(){return this.sliceList.forEach((function(e){e.repaint()})),this},computeMinMax:function(){var e=1/0,t=-1/0,r=this.data.length,a=0;for(a=0;a<r;a++)if(!isNaN(this.data[a])){var i=this.data[a];e=Math.min(e,i),t=Math.max(t,i)}return this.min=e,this.max=t,[e,t]}};var X=function(){function t(t,r){var a=this;void 0===r&&(r=1024),this.renderer=t,this.res=r,this.lightMapContainers=[],this.compiled=!1,this.scene=new e.Scene,this.scene.background=null,this.tinyTarget=new e.WebGLRenderTarget(1,1),this.buffer1Active=!1,this.firstUpdate=!0,this.warned=!1;var i=/(Android|iPad|iPhone|iPod)/g.test(navigator.userAgent)?alfFloatType:e.FloatType;this.progressiveLightMap1=new e.WebGLRenderTarget(this.res,this.res,{type:i}),this.progressiveLightMap2=new e.WebGLRenderTarget(this.res,this.res,{type:i}),this.uvMat=new e.MeshPhongMaterial,this.uvMat.uniforms={},this.uvMat.onBeforeCompile=function(e){e.vertexShader="#define USE_LIGHTMAP\n"+e.vertexShader.slice(0,-1)+"\tgl_Position = vec4((uv2 - 0.5) * 2.0, 1.0, 1.0); }";var t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv2;\n"+e.fragmentShader.slice(0,t)+"\tuniform sampler2D previousShadowMap;\n\tuniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+"\nvec3 texelOld = texture2D(previousShadowMap, vUv2).rgb;\n\t\t\t\tgl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/averagingWindow);\n\t\t\t}",e.uniforms.previousShadowMap={value:a.progressiveLightMap1.texture},e.uniforms.averagingWindow={value:100},a.uvMat.uniforms=e.uniforms,a.uvMat.userData.shader=e,a.compiled=!0}}var r=t.prototype;return r.addObjectsToLightMap=function(e){this.uv_boxes=[];for(var t=3/this.res,r=0;r<e.length;r++){var a=e[r];a.isLight?this.scene.attach(a):a.geometry.hasAttribute("uv")?(null==this.blurringPlane&&this._initializeBlurPlane(this.res,this.progressiveLightMap1),a.material.lightMap=this.progressiveLightMap2.texture,a.material.dithering=!0,a.castShadow=!0,a.receiveShadow=!0,a.renderOrder=1e3+r,this.uv_boxes.push({w:1+2*t,h:1+2*t,index:r}),this.lightMapContainers.push({basicMat:a.material,object:a}),this.compiled=!1):console.warn("All lightmap objects need UVs!")}var i=y.default(this.uv_boxes);this.uv_boxes.forEach((function(r){for(var a=e[r.index].geometry.getAttribute("uv").clone(),n=0;n<a.array.length;n+=a.itemSize)a.array[n]=(a.array[n]+r.x+t)/i.w,a.array[n+1]=(a.array[n+1]+r.y+t)/i.h;e[r.index].geometry.setAttribute("uv2",a),e[r.index].geometry.getAttribute("uv2").needsUpdate=!0}))},r.update=function(e,t,r){if(void 0===t&&(t=100),void 0===r&&(r=!0),null!=this.blurringPlane){var a=this.renderer.getRenderTarget();this.blurringPlane.visible=r;for(var i=0;i<this.lightMapContainers.length;i++)this.lightMapContainers[i].object.oldScene=this.lightMapContainers[i].object.parent,this.scene.attach(this.lightMapContainers[i].object);this.firstUpdate&&(this.renderer.setRenderTarget(this.tinyTarget),this.renderer.render(this.scene,e),this.firstUpdate=!1);for(var n=0;n<this.lightMapContainers.length;n++)this.uvMat.uniforms.averagingWindow={value:t},this.lightMapContainers[n].object.material=this.uvMat,this.lightMapContainers[n].object.oldFrustumCulled=this.lightMapContainers[n].object.frustumCulled,this.lightMapContainers[n].object.frustumCulled=!1;var o=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,s=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1;this.renderer.setRenderTarget(o),this.uvMat.uniforms.previousShadowMap={value:s.texture},this.blurringPlane.material.uniforms.previousShadowMap={value:s.texture},this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e);for(var l=0;l<this.lightMapContainers.length;l++)this.lightMapContainers[l].object.frustumCulled=this.lightMapContainers[l].object.oldFrustumCulled,this.lightMapContainers[l].object.material=this.lightMapContainers[l].basicMat,this.lightMapContainers[l].object.oldScene.attach(this.lightMapContainers[l].object);this.renderer.setRenderTarget(a)}},r.showDebugLightmap=function(t,r){void 0===r&&(r=void 0),0!=this.lightMapContainers.length?(null==this.labelMesh&&(this.labelMaterial=new e.MeshBasicMaterial({map:this.progressiveLightMap1.texture,side:e.DoubleSide}),this.labelPlane=new e.PlaneGeometry(100,100),this.labelMesh=new e.Mesh(this.labelPlane,this.labelMaterial),this.labelMesh.position.y=250,this.lightMapContainers[0].object.parent.add(this.labelMesh)),null!=r&&this.labelMesh.position.copy(r),this.labelMesh.visible=t):this.warned||(console.warn("Call this after adding the objects!"),this.warned=!0)},r._initializeBlurPlane=function(t,r){var a=this;void 0===r&&(r=null);var i=new e.MeshBasicMaterial;i.uniforms={previousShadowMap:{value:null},pixelOffset:{value:1/t},polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:3},i.onBeforeCompile=function(e){e.vertexShader="#define USE_UV\n"+e.vertexShader.slice(0,-1)+"\tgl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";var n=e.fragmentShader.indexOf("void main() {");e.fragmentShader="#define USE_UV\n"+e.fragmentShader.slice(0,n)+"\tuniform sampler2D previousShadowMap;\n\tuniform float pixelOffset;\n"+e.fragmentShader.slice(n-1,-1)+"\tgl_FragColor.rgb = (\n\t\t\t  texture2D(previousShadowMap, vUv + vec2( pixelOffset,  0.0        )).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2( 0.0        ,  pixelOffset)).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2( 0.0        , -pixelOffset)).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2(-pixelOffset,  0.0        )).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2( pixelOffset,  pixelOffset)).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2(-pixelOffset,  pixelOffset)).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2( pixelOffset, -pixelOffset)).rgb +\n\t\t\t  texture2D(previousShadowMap, vUv + vec2(-pixelOffset, -pixelOffset)).rgb)/8.0;\n\t\t}",e.uniforms.previousShadowMap={value:r.texture},e.uniforms.pixelOffset={value:.5/t},i.uniforms=e.uniforms,i.userData.shader=e,a.compiled=!0},this.blurringPlane=new e.Mesh(new e.PlaneBufferGeometry(1,1),i),this.blurringPlane.name="Blurring Plane",this.blurringPlane.frustumCulled=!1,this.blurringPlane.renderOrder=0,this.blurringPlane.material.depthWrite=!1,this.scene.add(this.blurringPlane)},t}(),Q=function(t){e.Object3D.call(this),this.element=t||document.createElement("div"),this.element.style.position="absolute",this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))};Q.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:Q,copy:function(t,r){return e.Object3D.prototype.copy.call(this,t,r),this.element=t.element.cloneNode(!0),this}});var Y={UniformBuffer:"uniform-buffer",StorageBuffer:"storage-buffer",ReadonlyStorageBuffer:"readonly-storage-buffer",Sampler:"sampler",ComparisonSampler:"comparison-sampler",SampledTexture:"sampled-texture",MultisampledTexture:"multisampled-texture",ReadonlyStorageTexture:"readonly-storage-texture",WriteonlyStorageTexture:"writeonly-storage-texture"},J={OneD:"1d",TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",CubeArray:"cube-array",ThreeD:"3d"},K=function(){function e(e){void 0===e&&(e=""),this.name=e,this.visibility=null,this.type=null,this.isShared=!1}return e.prototype.setVisibility=function(e){this.visibility=e},e}(),q=function(){function e(e,t){void 0===t&&(t=null),this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}var t=e.prototype;return t.setValue=function(e){this.value=e},t.getValue=function(){return this.value},e}(),Z=function(e){function t(t,r){var a;return void 0===r&&(r=0),(a=e.call(this,t,r)||this).boundary=4,a.itemSize=1,Object.defineProperty(x.default(a),"isFloatUniform",{value:!0}),a}return g.default(t,e),t}(q),$=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Vector2),(i=t.call(this,r,a)||this).boundary=8,i.itemSize=2,Object.defineProperty(x.default(i),"isVector2Uniform",{value:!0}),i}return g.default(r,t),r}(q),ee=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Vector3),(i=t.call(this,r,a)||this).boundary=16,i.itemSize=3,Object.defineProperty(x.default(i),"isVector3Uniform",{value:!0}),i}return g.default(r,t),r}(q),te=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Vector4),(i=t.call(this,r,a)||this).boundary=16,i.itemSize=4,Object.defineProperty(x.default(i),"isVector4Uniform",{value:!0}),i}return g.default(r,t),r}(q),re=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Color),(i=t.call(this,r,a)||this).boundary=16,i.itemSize=3,Object.defineProperty(x.default(i),"isColorUniform",{value:!0}),i}return g.default(r,t),r}(q),ae=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Matrix3),(i=t.call(this,r,a)||this).boundary=48,i.itemSize=12,Object.defineProperty(x.default(i),"isMatrix3Uniform",{value:!0}),i}return g.default(r,t),r}(q),ie=function(t){function r(r,a){var i;return void 0===a&&(a=new e.Matrix4),(i=t.call(this,r,a)||this).boundary=64,i.itemSize=16,Object.defineProperty(x.default(i),"isMatrix4Uniform",{value:!0}),i}return g.default(r,t),r}(q),ne=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(Z),oe=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}($),se=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(ee),le=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(te),ue=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(re),ce=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(ae),he=function(e){function t(t){var r;return(r=e.call(this,t.name,t.value)||this).nodeUniform=t,r}return g.default(t,e),t.prototype.getValue=function(){return this.nodeUniform.value},t}(ie),de=function(e){function t(t,r){var a;return(a=e.call(this,t)||this).texture=r,a.dimension=J.TwoD,a.type=Y.SampledTexture,a.visibility=GPUShaderStage.FRAGMENT,a.textureGPU=null,Object.defineProperty(x.default(a),"isSampledTexture",{value:!0}),a}return g.default(t,e),t}(K),fe=function(e){function t(t){var r;return(r=e.call(this,t)||this).dimension=J.TwoDArray,Object.defineProperty(x.default(r),"isSampledArrayTexture",{value:!0}),r}return g.default(t,e),t}(de),pe=function(e){function t(t){var r;return(r=e.call(this,t)||this).dimension=J.ThreeD,Object.defineProperty(x.default(r),"isSampled3DTexture",{value:!0}),r}return g.default(t,e),t}(de),me=function(e){function t(t){var r;return(r=e.call(this,t)||this).dimension=J.Cube,Object.defineProperty(x.default(r),"isSampledCubeTexture",{value:!0}),r}return g.default(t,e),t}(de),ve=function(t){e.Object3D.call(this),this.element=t||document.createElement("div"),this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))};ve.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:ve,copy:function(t,r){return e.Object3D.prototype.copy.call(this,t,r),this.element=t.element.cloneNode(!0),this}});var ge=function(e){ve.call(this,e)};(ge.prototype=Object.create(ve.prototype)).constructor=ge;var ye=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},xe=function(){this.id=0,this.v1=new be,this.v2=new be,this.v3=new be,this.normalModel=new e.Vector3,this.vertexNormalsModel=[new e.Vector3,new e.Vector3,new e.Vector3],this.vertexNormalsLength=0,this.color=new e.Color,this.material=null,this.uvs=[new e.Vector2,new e.Vector2,new e.Vector2],this.z=0,this.renderOrder=0},be=function(){this.position=new e.Vector3,this.positionWorld=new e.Vector3,this.positionScreen=new e.Vector4,this.visible=!0};be.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)};var Ae=function(){this.id=0,this.v1=new be,this.v2=new be,this.vertexColors=[new e.Color,new e.Color],this.material=null,this.z=0,this.renderOrder=0},we=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new e.Vector2,this.material=null,this.renderOrder=0},Me=function(){var t,r,a,i,n,o,s,l,u,c,h,d=[],f=0,p=[],m=0,v=[],g=0,y=[],x=0,b=[],A=0,w={objects:[],lights:[],elements:[]},M=new e.Vector3,S=new e.Vector4,T=new e.Box3(new e.Vector3(-1,-1,-1),new e.Vector3(1,1,1)),C=new e.Box3,F=new Array(3),E=new e.Matrix4,B=new e.Matrix4,L=new e.Matrix4,P=new e.Frustum;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var D=new function(){var t=[],r=[],o=[],u=null,c=new e.Matrix3;function d(e){var t=e.position,r=e.positionWorld,a=e.positionScreen;r.copy(t).applyMatrix4(h),a.copy(r).applyMatrix4(B);var i=1/a.w;a.x*=i,a.y*=i,a.z*=i,e.visible=a.x>=-1&&a.x<=1&&a.y>=-1&&a.y<=1&&a.z>=-1&&a.z<=1}function f(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(F[0]=e.positionScreen,F[1]=t.positionScreen,F[2]=r.positionScreen,T.intersectsBox(C.setFromPoints(F)))}function v(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(e){u=e,c.getNormalMatrix(u.matrixWorld),t.length=0,r.length=0,o.length=0},projectVertex:d,checkTriangleVisibility:f,checkBackfaceCulling:v,pushVertex:function(e,t,r){(a=function(){if(i===m){var e=new be;return p.push(e),m++,i++,e}return p[i++]}()).position.set(e,t,r),d(a)},pushNormal:function(e,r,a){t.push(e,r,a)},pushColor:function(e,t,a){r.push(e,t,a)},pushUv:function(e,t){o.push(e,t)},pushLine:function(e,t){var a,i,n,o,c,h,d,f,m=p[e],v=p[t];m.positionScreen.copy(m.position).applyMatrix4(L),v.positionScreen.copy(v.position).applyMatrix4(L),!0==(a=m.positionScreen,i=v.positionScreen,n=0,o=1,c=a.z+a.w,h=i.z+i.w,d=-a.z+a.w,f=-i.z+i.w,c>=0&&h>=0&&d>=0&&f>=0||!(c<0&&h<0||d<0&&f<0)&&(c<0?n=Math.max(n,c/(c-h)):h<0&&(o=Math.min(o,c/(c-h))),d<0?n=Math.max(n,d/(d-f)):f<0&&(o=Math.min(o,d/(d-f))),!(o<n||(a.lerp(i,n),i.lerp(a,1-o),0))))&&(m.positionScreen.multiplyScalar(1/m.positionScreen.w),v.positionScreen.multiplyScalar(1/v.positionScreen.w),(s=function(){if(l===x){var e=new Ae;return y.push(e),x++,l++,e}return y[l++]}()).id=u.id,s.v1.copy(m),s.v2.copy(v),s.z=Math.max(m.positionScreen.z,v.positionScreen.z),s.renderOrder=u.renderOrder,s.material=u.material,u.material.vertexColors&&(s.vertexColors[0].fromArray(r,3*e),s.vertexColors[1].fromArray(r,3*t)),w.elements.push(s))},pushTriangle:function(a,i,s,l){var h=p[a],d=p[i],m=p[s];if(!1!==f(h,d,m)&&(l.side===e.DoubleSide||!0===v(h,d,m))){(n=I()).id=u.id,n.v1.copy(h),n.v2.copy(d),n.v3.copy(m),n.z=(h.positionScreen.z+d.positionScreen.z+m.positionScreen.z)/3,n.renderOrder=u.renderOrder,M.subVectors(m.position,d.position),S.subVectors(h.position,d.position),M.cross(S),n.normalModel.copy(M),n.normalModel.applyMatrix3(c).normalize();for(var g=0;g<3;g++){var y=n.vertexNormalsModel[g];y.fromArray(t,3*arguments[g]),y.applyMatrix3(c).normalize();var x=n.uvs[g];x.fromArray(o,2*arguments[g])}n.vertexNormalsLength=3,n.material=l,l.vertexColors&&n.color.fromArray(r,3*a),w.elements.push(n)}}}};function N(e){if(!1!==e.visible){if(e.isLight)w.lights.push(e);else if(e.isMesh||e.isLine||e.isPoints){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===P.intersectsObject(e))return;R(e)}else if(e.isSprite){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===P.intersectsSprite(e))return;R(e)}for(var t=e.children,r=0,a=t.length;r<a;r++)N(t[r])}}function R(e){(t=function(){if(r===f){var e=new ye;return d.push(e),f++,r++,e}return d[r++]}()).id=e.id,t.object=e,M.setFromMatrixPosition(e.matrixWorld),M.applyMatrix4(B),t.z=M.z,t.renderOrder=e.renderOrder,w.objects.push(t)}function _(e,t,r){var a=1/e.w;e.z*=a,e.z>=-1&&e.z<=1&&((u=function(){if(c===A){var e=new we;return b.push(e),A++,c++,e}return b[c++]}()).id=t.id,u.x=e.x*a,u.y=e.y*a,u.z=e.z,u.renderOrder=t.renderOrder,u.object=t,u.rotation=t.rotation,u.scale.x=t.scale.x*Math.abs(u.x-(e.x+r.projectionMatrix.elements[0])/(e.w+r.projectionMatrix.elements[12])),u.scale.y=t.scale.y*Math.abs(u.y-(e.y+r.projectionMatrix.elements[5])/(e.w+r.projectionMatrix.elements[13])),u.material=t.material,w.elements.push(u))}function I(){if(o===g){var e=new xe;return v.push(e),g++,o++,e}return v[o++]}function O(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}this.projectScene=function(e,t,a,n){o=0,l=0,c=0,w.elements.length=0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),E.copy(t.matrixWorldInverse),B.multiplyMatrices(t.projectionMatrix,E),P.setFromProjectionMatrix(B),r=0,w.objects.length=0,w.lights.length=0,N(e),!0===a&&w.objects.sort(O);for(var s=w.objects,u=0,d=s.length;u<d;u++){var f=s[u].object,p=f.geometry;if(D.setObject(f),h=f.matrixWorld,i=0,f.isMesh){if(p.isBufferGeometry){var m=f.material,v=Array.isArray(m),g=p.attributes,y=p.groups;if(void 0===g.position)continue;for(var x=0,b=(ge=g.position.array).length;x<b;x+=3){var A=ge[x],M=ge[x+1],T=ge[x+2];if(!0===m.morphTargets)for(var C=p.morphAttributes.position,F=p.morphTargetsRelative,R=f.morphTargetInfluences,I=0,U=C.length;I<U;I++){var k=R[I];if(0!==k){var V=C[I];F?(A+=V.getX(x/3)*k,M+=V.getY(x/3)*k,T+=V.getZ(x/3)*k):(A+=(V.getX(x/3)-ge[x])*k,M+=(V.getY(x/3)-ge[x+1])*k,T+=(V.getZ(x/3)-ge[x+2])*k)}}D.pushVertex(A,M,T)}if(void 0!==g.normal)for(var G=g.normal.array,j=0,z=G.length;j<z;j+=3)D.pushNormal(G[j],G[j+1],G[j+2]);if(void 0!==g.color)for(var H=0,W=(ue=g.color.array).length;H<W;H+=3)D.pushColor(ue[H],ue[H+1],ue[H+2]);if(void 0!==g.uv)for(var X=g.uv.array,Q=0,Y=X.length;Q<Y;Q+=2)D.pushUv(X[Q],X[Q+1]);if(null!==p.index){var J=p.index.array;if(y.length>0)for(var K=0;K<y.length;K++){var q=y[K];if(void 0!==(m=!0===v?f.material[q.materialIndex]:f.material))for(var Z=q.start,$=q.start+q.count;Z<$;Z+=3)D.pushTriangle(J[Z],J[Z+1],J[Z+2],m)}else for(var ee=0,te=J.length;ee<te;ee+=3)D.pushTriangle(J[ee],J[ee+1],J[ee+2],m)}else if(y.length>0)for(var re=0;re<y.length;re++){q=y[re];if(void 0!==(m=!0===v?f.material[q.materialIndex]:f.material))for(var ae=q.start,ie=q.start+q.count;ae<ie;ae+=3)D.pushTriangle(ae,ae+1,ae+2,m)}else for(var ne=0,oe=ge.length/3;ne<oe;ne+=3)D.pushTriangle(ne,ne+1,ne+2,m)}else if(p.isGeometry)return void console.error("THREE.Projector no longer supports Geometry. Use THREE.BufferGeometry instead.")}else if(f.isLine){if(L.multiplyMatrices(B,h),p.isBufferGeometry){if(void 0!==(g=p.attributes).position){for(var se=0,le=(ge=g.position.array).length;se<le;se+=3)D.pushVertex(ge[se],ge[se+1],ge[se+2]);if(void 0!==g.color)for(var ue,ce=0,he=(ue=g.color.array).length;ce<he;ce+=3)D.pushColor(ue[ce],ue[ce+1],ue[ce+2]);if(null!==p.index)for(var de=0,fe=(J=p.index.array).length;de<fe;de+=2)D.pushLine(J[de],J[de+1]);else for(var pe=f.isLineSegments?2:1,me=0,ve=ge.length/3-1;me<ve;me+=pe)D.pushLine(me,me+1)}}else if(p.isGeometry)return void console.error("THREE.Projector no longer supports Geometry. Use THREE.BufferGeometry instead.")}else if(f.isPoints){if(L.multiplyMatrices(B,h),p.isGeometry)return void console.error("THREE.Projector no longer supports Geometry. Use THREE.BufferGeometry instead.");if(p.isBufferGeometry&&void 0!==(g=p.attributes).position)for(var ge,ye=0,xe=(ge=g.position.array).length;ye<xe;ye+=3)S.set(ge[ye],ge[ye+1],ge[ye+2],1),S.applyMatrix4(L),_(S,f,t)}else f.isSprite&&(f.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,f.matrixWorld),S.set(h.elements[12],h.elements[13],h.elements[14],1),S.applyMatrix4(B),_(S,f,t))}return!0===n&&w.elements.sort(O),w}},Se=function(t){e.Object3D.call(this),this.node=t};(Se.prototype=Object.create(e.Object3D.prototype)).constructor=Se;var Te=function(t){void 0===t&&(t=1);var r=new Float32Array(4096*t*3),a=new e.DataTexture(r,1024,4*t,e.RGBFormat,e.FloatType);return a.wrapS=e.RepeatWrapping,a.wrapT=e.RepeatWrapping,a.magFilter=e.NearestFilter,a.needsUpdate=!0,a},Ce=function(e,t,r){void 0===r&&(r=0);var a=Math.floor(1024);t.arcLengthDivisions=a/2,t.updateArcLengths();for(var i=t.getSpacedPoints(a),n=t.computeFrenetFrames(a,!0),o=0;o<a;o++){var s=Math.floor(o/1024),l=o%1024,u=i[o];Fe(e,l,u.x,u.y,u.z,0+s+4*r),u=n.tangents[o],Fe(e,l,u.x,u.y,u.z,1+s+4*r),u=n.normals[o],Fe(e,l,u.x,u.y,u.z,2+s+4*r),u=n.binormals[o],Fe(e,l,u.x,u.y,u.z,3+s+4*r)}e.needsUpdate=!0},Fe=function(e,t,r,a,i,n){var o=e.image.data,s=3072*n;o[3*t+s+0]=r,o[3*t+s+1]=a,o[3*t+s+2]=i};function Ee(e){return{spineTexture:{value:e},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}}}function Be(e,t,r){void 0===r&&(r=1),e.__ok||(e.__ok=!0,e.onBeforeCompile=function(e){if(!e.__modified){e.__modified=!0,Object.assign(e.uniforms,t);var a=("\n\t\tuniform sampler2D spineTexture;\n\t\tuniform float pathOffset;\n\t\tuniform float pathSegment;\n\t\tuniform float spineOffset;\n\t\tuniform float spineLength;\n\t\tuniform int flow;\n\n\t\tfloat textureLayers = "+4*r+".;\n\t\tfloat textureStacks = 1.;\n\n\t\t"+e.vertexShader+"\n\t\t").replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,"\n        void main() {\n        #include <beginnormal_vertex>\n\n        vec4 worldPos = modelMatrix * vec4(position, 1.);\n\n        bool bend = flow > 0;\n        float xWeight = bend ? 0. : 1.;\n\n        #ifdef USE_INSTANCING\n        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];\n        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;\n        #else\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;\n        #endif\n\n        mt = mod(mt, textureStacks);\n        float rowOffset = floor(mt);\n\n        #ifdef USE_INSTANCING\n        rowOffset += instanceMatrix[3][1] * 4.;\n        #endif\n\n        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;\n        mat3 basis = mat3(a, b, c);\n\n        vec3 transformed = basis\n          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)\n          + spinePos;\n\n        vec3 transformedNormal = normalMatrix * (basis * objectNormal);\n\t\t\t").replace("#include <project_vertex>","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\t\t\t\tgl_Position = projectionMatrix * mvPosition;");e.vertexShader=a}})}var Le=function(){function t(t,r){void 0===r&&(r=1),b.default(this,"curveArray",void 0),b.default(this,"curveLengthArray",void 0),b.default(this,"object3D",void 0),b.default(this,"splineTexure",void 0),b.default(this,"uniforms",void 0);var a=t.clone(),i=Te(r),n=Ee(i);a.traverse((function(t){(t instanceof e.Mesh||t instanceof e.InstancedMesh)&&(t.material=t.material.clone(),Be(t.material,n,r))})),this.curveArray=new Array(r),this.curveLengthArray=new Array(r),this.object3D=a,this.splineTexure=i,this.uniforms=n}var r=t.prototype;return r.updateCurve=function(e,t){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");var r=t.getLength();this.uniforms.spineLength.value=r,this.curveLengthArray[e]=r,this.curveArray[e]=t,Ce(this.splineTexure,t,e)},r.moveAlongCurve=function(e){this.uniforms.pathOffset.value+=e},t}(),Pe=new e.Matrix4,De=function(t){function r(r,a,i,n){var o,s=new e.InstancedMesh(i,n,r);return s.instanceMatrix.setUsage(e.DynamicDrawUsage),o=t.call(this,s,a)||this,b.default(x.default(o),"offsets",void 0),b.default(x.default(o),"whichCurve",void 0),o.offsets=new Array(r).fill(0),o.whichCurve=new Array(r).fill(0),o}g.default(r,t);var a=r.prototype;return a.writeChanges=function(e){Pe.makeTranslation(this.curveLengthArray[this.whichCurve[e]],this.whichCurve[e],this.offsets[e]),this.object3D.setMatrixAt(e,Pe),this.object3D.instanceMatrix.needsUpdate=!0},a.moveIndividualAlongCurve=function(e,t){this.offsets[e]+=t,this.writeChanges(e)},a.setCurve=function(e,t){if(isNaN(t))throw Error("curve index being set is Not a Number (NaN)");this.whichCurve[e]=t,this.writeChanges(e)},r}(Le),Ne=function(e,t){return e[t]},Re=function(t,r){var a=null!==t[0].index,i=new Set(Object.keys(t[0].attributes)),n=new Set(Object.keys(t[0].morphAttributes)),o={},s={},l=t[0].morphTargetsRelative,u=new e.BufferGeometry,c=0;if(t.forEach((function(e,t){var h=0;if(a!==(null!==e.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var d in e.attributes){if(!i.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[d]&&(o[d]=[]),o[d].push(e.attributes[d]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+". Make sure all geometries have the same number of attributes."),null;if(l!==e.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var f in e.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[f]&&(s[f]=[]),s[f].push(e.morphAttributes[f])}if(u.userData.mergedUserData=u.userData.mergedUserData||[],u.userData.mergedUserData.push(e.userData),r){var p;if(e.index)p=e.index.count;else{if(void 0===e.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+t+". The geometry must have either an index or a position attribute"),null;p=e.attributes.position.count}u.addGroup(c,p,t),c+=p}})),a){var h=0,d=[];t.forEach((function(e){for(var t=e.index,r=0;r<t.count;++r)d.push(t.getX(r)+h);h+=e.attributes.position.count})),u.setIndex(d)}for(var f in o){var p=_e(o[f]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+f+" attribute."),null;u.setAttribute(f,p)}for(var m in s){var v=s[m][0].length;if(0===v)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[m]=[];for(var g=0;g<v;++g){for(var y=[],x=0;x<s[m].length;++x)y.push(s[m][x][g]);var b=_e(y);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+m+" morphAttribute."),null;u.morphAttributes[m].push(b)}}return u},_e=function(t){var r=void 0,a=void 0,i=void 0,n=0;if(t.forEach((function(e){return void 0===r&&(r=e.array.constructor),r!==e.array.constructor?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null):(void 0===a&&(a=e.itemSize),a!==e.itemSize?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null):(void 0===i&&(i=e.normalized),i!==e.normalized?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null):void(n+=e.array.length)))})),r&&a){var o=new r(n),s=0;return t.forEach((function(e){o.set(e.array,s),s+=e.array.length})),new e.BufferAttribute(o,a,i)}},Ie=function(t){for(var r=void 0,a=0,i=0,n=0,o=t.length;n<o;++n){var s=t[n];if(void 0===r&&(r=s.array.constructor),r!==s.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;a+=s.array.length,i+=s.itemSize}for(var l=new e.InterleavedBuffer(new r(a),i),u=0,c=[],h=["getX","getY","getZ","getW"],d=["setX","setY","setZ","setW"],f=0,p=t.length;f<p;f++){var m=t[f],v=m.itemSize,g=m.count,y=new e.InterleavedBufferAttribute(l,v,u,m.normalized);c.push(y),u+=v;for(var x=0;x<g;x++)for(var b=0;b<v;b++){Ne(y,d[b])(x,Ne(m,h[b])(x))}}return c};function Oe(e){var t=0;for(var r in e.attributes){var a=e.getAttribute(r);t+=a.count*a.itemSize*a.array.BYTES_PER_ELEMENT}var i=e.getIndex();return t+=i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0}function Ue(t,r){void 0===r&&(r=1e-4),r=Math.max(r,Number.EPSILON);for(var a={},i=t.getIndex(),n=t.getAttribute("position"),o=i?i.count:n.count,s=0,l=Object.keys(t.attributes),u={},c={},h=[],d=["getX","getY","getZ","getW"],f=0,p=l.length;f<p;f++){var m=l[f];u[m]=[];var v=t.morphAttributes[m];v&&(c[m]=new Array(v.length).fill(0).map((function(){return[]})))}for(var g=Math.log10(1/r),y=Math.pow(10,g),x=0;x<o;x++){for(var b=i?i.getX(x):x,A="",w=0,M=l.length;w<M;w++)for(var S=l[w],T=t.getAttribute(S),C=T.itemSize,F=0;F<C;F++)A+=~~(T[d[F]](b)*y)+",";if(A in a)h.push(a[A]);else{for(var E=0,B=l.length;E<B;E++)for(var L=l[E],P=t.getAttribute(L),D=t.morphAttributes[L],N=P.itemSize,R=u[L],_=c[L],I=0;I<N;I++){var O=d[I];if(R.push(P[O](b)),D)for(var U=0,k=D.length;U<k;U++)_[U].push(D[U][O](b))}a[A]=s,h.push(s),s++}}for(var V=t.clone(),G=0,j=l.length;G<j;G++){var z=l[G],H=t.getAttribute(z),W=new H.array.constructor(u[z]),X=new e.BufferAttribute(W,H.itemSize,H.normalized);if(V.setAttribute(z,X),z in c)for(var Q=0;Q<c[z].length;Q++){var Y=t.morphAttributes[z][Q],J=new Y.array.constructor(c[z][Q]),K=new e.BufferAttribute(J,Y.itemSize,Y.normalized);V.morphAttributes[z][Q]=K}}return V.setIndex(h),V}function ke(t,r){if(r===e.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(r===e.TriangleFanDrawMode||r===e.TriangleStripDrawMode){var a=t.getIndex();if(null===a){var i=[],n=t.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<n.count;o++)i.push(o);t.setIndex(i),a=t.getIndex()}var s=a.count-2,l=[];if(a)if(r===e.TriangleFanDrawMode)for(var u=1;u<=s;u++)l.push(a.getX(0)),l.push(a.getX(u)),l.push(a.getX(u+1));else for(var c=0;c<s;c++)c%2==0?(l.push(a.getX(c)),l.push(a.getX(c+1)),l.push(a.getX(c+2))):(l.push(a.getX(c+2)),l.push(a.getX(c+1)),l.push(a.getX(c)));l.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var h=t.clone();return h.setIndex(l),h.clearGroups(),h}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",r),t}function Ve(t){if(!0!==t.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type BufferGeometry."),null;var r=new e.Vector3,a=new e.Vector3,i=new e.Vector3,n=new e.Vector3,o=new e.Vector3,s=new e.Vector3,l=new e.Vector3,u=new e.Vector3,c=new e.Vector3;function h(e,t,h,d,f,p,m,v,g){r.fromBufferAttribute(h,p),a.fromBufferAttribute(h,m),i.fromBufferAttribute(h,v);var y=e.morphTargetInfluences;if(t.morphTargets&&d&&y){l.set(0,0,0),u.set(0,0,0),c.set(0,0,0);for(var x=0,b=d.length;x<b;x++){var A=y[x],w=d[x];0!==A&&(n.fromBufferAttribute(w,p),o.fromBufferAttribute(w,m),s.fromBufferAttribute(w,v),f?(l.addScaledVector(n,A),u.addScaledVector(o,A),c.addScaledVector(s,A)):(l.addScaledVector(n.sub(r),A),u.addScaledVector(o.sub(a),A),c.addScaledVector(s.sub(i),A)))}r.add(l),a.add(u),i.add(c)}e.isSkinnedMesh&&(e.boneTransform(p,r),e.boneTransform(m,a),e.boneTransform(v,i)),g[3*p+0]=r.x,g[3*p+1]=r.y,g[3*p+2]=r.z,g[3*m+0]=a.x,g[3*m+1]=a.y,g[3*m+2]=a.z,g[3*v+0]=i.x,g[3*v+1]=i.y,g[3*v+2]=i.z}var d,f,p,m,v,g,y,x,b,A=t.geometry,w=t.material,M=A.index,S=A.attributes.position,T=A.morphAttributes.position,C=A.morphTargetsRelative,F=A.attributes.normal,E=A.morphAttributes.position,B=A.groups,L=A.drawRange,P=new Float32Array(S.count*S.itemSize),D=new Float32Array(F.count*F.itemSize);if(null!==M)if(Array.isArray(w))for(m=0,g=B.length;m<g;m++)for(b=w[(x=B[m]).materialIndex],v=Math.max(x.start,L.start),y=Math.min(x.start+x.count,L.start+L.count);v<y;v+=3)h(t,b,S,T,C,d=M.getX(v),f=M.getX(v+1),p=M.getX(v+2),P),h(t,b,F,E,C,d,f,p,D);else for(m=Math.max(0,L.start),g=Math.min(M.count,L.start+L.count);m<g;m+=3)h(t,w,S,T,C,d=M.getX(m),f=M.getX(m+1),p=M.getX(m+2),P),h(t,w,F,E,C,d,f,p,D);else if(void 0!==S)if(Array.isArray(w))for(m=0,g=B.length;m<g;m++)for(b=w[(x=B[m]).materialIndex],v=Math.max(x.start,L.start),y=Math.min(x.start+x.count,L.start+L.count);v<y;v+=3)h(t,b,S,T,C,d=v,f=v+1,p=v+2,P),h(t,b,F,E,C,d,f,p,D);else for(m=Math.max(0,L.start),g=Math.min(S.count,L.start+L.count);m<g;m+=3)h(t,w,S,T,C,d=m,f=m+1,p=m+2,P),h(t,w,F,E,C,d,f,p,D);return{positionAttribute:S,normalAttribute:F,morphedPositionAttribute:new e.Float32BufferAttribute(P,3),morphedNormalAttribute:new e.Float32BufferAttribute(D,3)}}var Ge=Object.freeze({__proto__:null,mergeBufferGeometries:Re,mergeBufferAttributes:_e,interleaveAttributes:Ie,estimateBytesUsed:Oe,mergeVertices:Ue,toTrianglesDrawMode:ke,computeMorphedAttributes:Ve}),je=new e.Vector3,ze=new e.Vector3;function He(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}var We=function(){function e(e,t){b.default(this,"position",void 0),b.default(this,"id",void 0),b.default(this,"faces",void 0),b.default(this,"neighbors",void 0),b.default(this,"collapseCost",void 0),b.default(this,"collapseNeighbor",void 0),b.default(this,"minCost",0),b.default(this,"totalCost",0),b.default(this,"costCount",0),this.position=e,this.id=t,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}var t=e.prototype;return t.addUniqueNeighbor=function(e){var t,r;t=this.neighbors,r=e,-1===t.indexOf(r)&&t.push(r)},t.removeIfNonNeighbor=function(e){var t=this.neighbors,r=this.faces,a=t.indexOf(e);if(-1!==a){for(var i=0;i<r.length;i++)if(r[i].hasVertex(e))return;t.splice(a,1)}},e}(),Xe=function(){function t(t,r,a,i,n,o){b.default(this,"a",void 0),b.default(this,"b",void 0),b.default(this,"c",void 0),b.default(this,"v1",void 0),b.default(this,"v2",void 0),b.default(this,"v3",void 0),b.default(this,"normal",new e.Vector3),this.a=i,this.b=n,this.c=o,this.v1=t,this.v2=r,this.v3=a,this.computeNormal(),t.faces.push(this),t.addUniqueNeighbor(r),t.addUniqueNeighbor(a),r.faces.push(this),r.addUniqueNeighbor(t),r.addUniqueNeighbor(a),a.faces.push(this),a.addUniqueNeighbor(t),a.addUniqueNeighbor(r)}var r=t.prototype;return r.computeNormal=function(){var e=this.v1.position,t=this.v2.position,r=this.v3.position;je.subVectors(r,t),ze.subVectors(e,t),je.cross(ze).normalize(),this.normal.copy(je)},r.hasVertex=function(e){return e===this.v1||e===this.v2||e===this.v3},r.replaceVertex=function(e,t){e===this.v1?this.v1=t:e===this.v2?this.v2=t:e===this.v3&&(this.v3=t),He(e.faces,this),t.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},t}(),Qe=function(){function t(){var t=this;b.default(this,"computeEdgeCollapseCost",(function(e,t){var r,a,i,n=t.position.distanceTo(e.position),o=0,s=[],l=e.faces.length;for(r=0;r<l;r++)(a=e.faces[r]).hasVertex(t)&&s.push(a);for(r=0;r<l;r++){var u=1;a=e.faces[r];for(var c=0;c<s.length;c++){i=s[c];var h=a.normal.dot(i.normal);u=Math.min(u,(1.001-h)/2)}o=Math.max(o,u)}return s.length<2&&(o=1),n*o+0})),b.default(this,"computeEdgeCostAtVertex",(function(e){if(0===e.neighbors.length)return e.collapseNeighbor=null,void(e.collapseCost=-.01);e.collapseCost=1e5,e.collapseNeighbor=null;for(var r=0;r<e.neighbors.length;r++){var a=t.computeEdgeCollapseCost(e,e.neighbors[r]);e.collapseNeighbor||(e.collapseNeighbor=e.neighbors[r],e.collapseCost=a,e.minCost=a,e.totalCost=0,e.costCount=0),e.costCount++,e.totalCost+=a,a<e.minCost&&(e.collapseNeighbor=e.neighbors[r],e.minCost=a)}e.collapseCost=e.totalCost/e.costCount})),b.default(this,"removeFace",(function(e,t){He(t,e),e.v1&&He(e.v1.faces,e),e.v2&&He(e.v2.faces,e),e.v3&&He(e.v3.faces,e);for(var r,a,i=[e.v1,e.v2,e.v3],n=0;n<3;n++)a=i[(n+1)%3],(r=i[n])&&a&&(r.removeIfNonNeighbor(a),a.removeIfNonNeighbor(r))})),b.default(this,"collapse",(function(e,r,a,i){if(i){var n,o=[];for(n=0;n<a.neighbors.length;n++)o.push(a.neighbors[n]);for(n=a.faces.length-1;n>=0;n--)a.faces[n].hasVertex(i)&&t.removeFace(a.faces[n],r);for(n=a.faces.length-1;n>=0;n--)a.faces[n].replaceVertex(a,i);for(t.removeVertex(a,e),n=0;n<o.length;n++)t.computeEdgeCostAtVertex(o[n])}else t.removeVertex(a,e)})),b.default(this,"minimumCostEdge",(function(e){for(var t=e[0],r=0;r<e.length;r++)e[r].collapseCost<t.collapseCost&&(t=e[r]);return t})),b.default(this,"modify",(function(r,a){var i=(r=r.clone()).attributes;for(var n in i)"position"!==n&&r.deleteAttribute(n);for(var o=[],s=[],l=(r=Ue(r)).getAttribute("position"),u=0;u<l.count;u++){var c=(new e.Vector3).fromBufferAttribute(l,u),h=new We(c,u);o.push(h)}var d,f=r.getIndex();if(null!==f)for(var p=0;p<f.count;p+=3){var m=f.getX(p),v=f.getX(p+1),g=f.getX(p+2),y=new Xe(o[m],o[v],o[g],m,v,g);s.push(y)}else for(var x=0;x<l.count;x+=3){var b=x,A=x+1,w=x+2,M=new Xe(o[b],o[A],o[w],b,A,w);s.push(M)}for(var S=0,T=o.length;S<T;S++)t.computeEdgeCostAtVertex(o[S]);for(var C=a;C--;){if(!(d=t.minimumCostEdge(o))){console.log("THREE.SimplifyModifier: No next vertex");break}t.collapse(o,s,d,d.collapseNeighbor)}for(var F=new e.BufferGeometry,E=[],B=[],L=0;L<o.length;L++){var P=o[L].position;E.push(P.x,P.y,P.z)}for(var D=0;D<s.length;D++){var N=s[D],R=o.indexOf(N.v1),_=o.indexOf(N.v2),I=o.indexOf(N.v3);B.push(R,_,I)}return F.setAttribute("position",new e.Float32BufferAttribute(E,3)),F.setIndex(B),F}))}return t.prototype.removeVertex=function(e,t){for(console.assert(0===e.faces.length);e.neighbors.length;){He(e.neighbors.pop().neighbors,e)}He(t,e)},t}();function Ye(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ke(t){this.uuid=e.MathUtils.generateUUID(),this.name="",this.type=t,this.userData={}}function qe(e,t){Ke.call(this,e),t=t||{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}function Ze(e,t){(t=t||{}).shared=void 0!==t.shared&&t.shared,qe.call(this,e,t),this.readonly=!1}function $e(e){Ze.call(this,"f"),this.value=e||0}Ke.prototype={constructor:Ke,isNode:!0,hashProperties:void 0,analyze:function(e,t){t=t||{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1},analyzeAndFlow:function(e,t,r){return r=r||{},this.analyze(e,r),this.flow(e,t,r)},flow:function(e,t,r){r=r||{},e.addFlow(r.slot,r.cache,r.context);var a={};return a.result=this.build(e,t),a.code=e.clearNodeCode(),a.extra=e.context.extra,e.removeFlow(),a},build:function(e,t,r){t=t||this.getType(e,t);var a=e.getNodeData(r||this);return e.analyzing&&this.appendDepsNode(e,a,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)},generate:function(){},getHash:function(){var e,t,r="{";for(e in this)(t=this[e])instanceof Ke&&(r+='"'+e+'":'+t.getHash()+",");if(this.hashProperties)for(var a=0;a<this.hashProperties.length;a++)t=this[e=this.hashProperties[a]],r+='"'+e+'":"'+String(t)+'",';return r+='"id":"'+this.uuid+'"}'},appendDepsNode:function(e,t,r){t.deps=(t.deps||0)+1;var a=e.getTypeLength(r);(a>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=a,t.output=r)},setName:function(e){return this.name=e,this},getName:function(){return this.name},getType:function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type},getJSONNode:function(e){if(!(void 0===e||"string"==typeof e)&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},copy:function(e){return void 0!==e.name&&(this.name=e.name),void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this},createJSONNode:function(e){var t=void 0===e||"string"==typeof e,r={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return r.uuid=this.uuid,r.nodeType=this.nodeType,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t||(e.nodes[this.uuid]=r),r},toJSON:function(e){return this.getJSONNode(e)||this.createJSONNode(e)}},qe.prototype=Object.create(Ke.prototype),qe.prototype.constructor=qe,qe.prototype.build=function(t,r,a,i){if(r=r||this.getType(t),this.getShared(t,r)){var n=this.getUnique(t,r);n&&void 0===this.constructor.uuid&&(this.constructor.uuid=e.MathUtils.generateUUID()),a=t.getUuid(a||this.getUuid(),!n);var o=t.getNodeData(a),s=o.output||this.getType(t);if(t.analyzing)return(o.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,o,r),this.generate(t,r,a)):Ke.prototype.build.call(this,t,r,a);if(n)return o.name=o.name||Ke.prototype.build.call(this,t,r,a),o.name;if(!this.getLabel()&&(!this.getShared(t,s)||t.context.ignoreCache||1===o.deps))return Ke.prototype.build.call(this,t,r,a);a=this.getUuid(!1);var l=this.getTemp(t,a);if(l)return t.format(l,s,r);l=qe.prototype.generate.call(this,t,r,a,o.output,i);var u=this.generate(t,s,a);return t.addNodeCode(l+" = "+u+";"),t.format(l,s,r)}return Ke.prototype.build.call(this,t,r,a)},qe.prototype.getShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},qe.prototype.getUnique=function(){return this.unique},qe.prototype.setLabel=function(e){return this.label=e,this},qe.prototype.getLabel=function(){return this.label},qe.prototype.getUuid=function(e){var t=(e||null==e)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t},qe.prototype.getTemp=function(e,t){t=t||this.uuid;var r=e.getVars()[t];return r?r.name:void 0},qe.prototype.generate=function(e,t,r,a,i){return this.getShared(e,t)||console.error("THREE.TempNode is not shared!"),r=r||this.uuid,e.getTempVar(r,a||this.getType(e),i,this.getLabel()).name},Ze.prototype=Object.create(qe.prototype),Ze.prototype.constructor=Ze,Ze.prototype.setReadonly=function(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this},Ze.prototype.getReadonly=function(){return this.readonly},Ze.prototype.copy=function(e){return qe.prototype.copy.call(this,e),void 0!==e.readonly&&(this.readonly=e.readonly),this},Ze.prototype.createJSONNode=function(e){var t=qe.prototype.createJSONNode.call(this,e);return!0===this.readonly&&(t.readonly=this.readonly),t},Ze.prototype.generate=function(e,t,r,a,i,n){r=e.getUuid(r||this.getUuid()),a=a||this.getType(e);var o=e.getNodeData(r);return this.getReadonly(e)&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,a,i,n):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(a,this,i,n,this.getLabel())),e.format(o.vertex.name,a,t)):(o.fragment||(o.fragment=e.createFragmentUniform(a,this,i,n,this.getLabel())),e.format(o.fragment.name,a,t))},$e.prototype=Object.create(Ze.prototype),$e.prototype.constructor=$e,$e.prototype.nodeType="Float",$e.prototype.generateReadonly=function(e,t,r,a){return e.format(this.value+(this.value%1?"":".0"),a,t)},$e.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value=e.value,this},$e.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t};var et=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i;function tt(e,t){qe.call(this),this.parse(e||tt.PI,t)}tt.PI="PI",tt.PI2="PI2",tt.RECIPROCAL_PI="RECIPROCAL_PI",tt.RECIPROCAL_PI2="RECIPROCAL_PI2",tt.LOG2="LOG2",tt.EPSILON="EPSILON",tt.prototype=Object.create(qe.prototype),tt.prototype.constructor=tt,tt.prototype.nodeType="Const",tt.prototype.getType=function(e){return e.getTypeByFormat(this.type)},tt.prototype.parse=function(e,t){this.src=e||"";var r,a,i="",n=this.src.match(et);this.useDefine=t||"#"===this.src.charAt(0),n&&n.length>1?(a=n[1],r=n[2],i=n[3]):(r=this.src,a="f"),this.name=r,this.type=a,this.value=i},tt.prototype.build=function(e,t){return"source"!==t?(e.include(this),e.format(this.name,this.getType(e),t)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0},tt.prototype.generate=function(e,t){return e.format(this.name,this.getType(e),t)},tt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.parse(e.src,e.useDefine),this},tt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src,!0===t.useDefine&&(t.useDefine=!0)),t};var rt=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,at=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim;function it(e){qe.call(this),this.parse(e)}it.prototype=Object.create(qe.prototype),it.prototype.constructor=it,it.prototype.nodeType="Struct",it.prototype.getType=function(e){return e.getTypeByFormat(this.name)},it.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},it.prototype.generate=function(e,t){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)},it.prototype.parse=function(e){this.src=e||"",this.inputs=[];var t=rt.exec(this.src);if(t){for(var r,a=t[2];r=at.exec(a);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name},it.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src),t};var nt,ot,st,lt,ut,ct,ht,dt,ft,pt,mt,vt,gt,yt,xt={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,t,r){r=void 0===r||r,this.keywords[e]={callback:t,cache:r}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,t){return this.keywords[e].callback.call(this,t)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return void 0!==this.nodes[e]},containsKeyword:function(e){return void 0!==this.keywords[e]}},bt=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,At=/[a-z_0-9]+/gi;function wt(e,t,r,a,i){this.isMethod=void 0===i,this.isInterface=!1,qe.call(this,i),this.parse(e,t,r,a)}function Mt(e,t){qe.call(this),this.setFunction(e,t)}function St(e,t,r,a,i){wt.call(this,e,i,a,r,t)}function Tt(e,t,r){qe.call(this),this.a=e,this.b=t,this.op=r}function Ct(e,t,r,a){qe.call(this),this.a=e,"string"!=typeof t?this.b=t:a=t,"string"!=typeof r?this.c=r:a=r,this.method=a}function Ft(e,t){qe.call(this,"v4"),this.input=e,this.method=t||Ft.LINEAR_TO_LINEAR}function Et(e,t,r){qe.call(this,"v4"),this.value=e,this.uv=t,this.bias=r}function Bt(e){qe.call(this,"v3"),this.scope=e||Bt.LOCAL}function Lt(e){qe.call(this,"v3"),this.scope=e||Lt.VIEW}function Pt(e){qe.call(this,"v3"),this.scope=e||Pt.CUBE}function Dt(e,t,r){qe.call(this,"v4"),this.value=e,this.radianceNode=new Et(this.value,t||new Pt(Pt.VECTOR),r),this.irradianceNode=new Et(this.value,new Lt(Lt.WORLD),new $e(1).setReadonly(!0))}wt.prototype=Object.create(qe.prototype),wt.prototype.constructor=wt,wt.prototype.nodeType="Function",wt.prototype.useKeywords=!0,wt.prototype.getShared=function(){return!this.isMethod},wt.prototype.getType=function(e){return e.getTypeByFormat(this.type)},wt.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},wt.prototype.getIncludeByName=function(e){for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]},wt.prototype.generate=function(e,t){for(var r=0,a=this.src,i=0;i<this.includes.length;i++)e.include(this.includes[i],this);for(var n in this.extensions)e.extensions[n]=!0;for(var o=[];l=At.exec(this.src);)o.push(l);for(var s=0;s<o.length;s++){var l,u=(l=o[s])[0],c=!this.isMethod||!this.getInputByName(u),h=u;if(this.keywords[u]||this.useKeywords&&c&&xt.containsKeyword(u)){var d=this.keywords[u];if(!d){var f=xt.getKeywordData(u);f.cache&&(d=e.keywords[u]),d=d||xt.getKeyword(u,e),f.cache&&(e.keywords[u]=d)}h=d.build(e)}u!==h&&(a=a.substring(0,l.index+r)+h+a.substring(l.index+u.length+r),r+=h.length-u.length),void 0===this.getIncludeByName(h)&&xt.contains(h)&&e.include(xt.get(h))}return"source"===t?a:this.isMethod?(this.isInterface||e.include(this,!1,a),this.name):e.format("( "+a+" )",this.getType(e),t)},wt.prototype.parse=function(e,t,r,a){if(this.src=e||"",this.includes=t||[],this.extensions=r||{},this.keywords=a||{},this.isMethod){var i=this.src.match(bt);if(this.inputs=[],i&&4==i.length){this.type=i[1],this.name=i[2];var n=i[3].match(At);if(n)for(var o=0;o<n.length;){var s,l,u=n[o++];"in"===u||"out"===u||"inout"===u?s=n[o++]:(s=u,u=""),l=n[o++],this.inputs.push({name:l,type:s,qualifier:u})}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}},wt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,this.parse(e.src,e.includes,e.extensions,e.keywords),void 0!==e.type&&(this.type=e.type),this},wt.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){for(var r in(t=this.createJSONNode(e)).src=this.src,t.isMethod=this.isMethod,t.useKeywords=this.useKeywords,this.isMethod||(t.type=this.type),t.extensions=JSON.parse(JSON.stringify(this.extensions)),t.keywords={},this.keywords)t.keywords[r]=this.keywords[r].toJSON(e).uuid;if(this.includes.length){t.includes=[];for(var a=0;a<this.includes.length;a++)t.includes.push(this.includes[a].toJSON(e).uuid)}}return t},Mt.prototype=Object.create(qe.prototype),Mt.prototype.constructor=Mt,Mt.prototype.nodeType="FunctionCall",Mt.prototype.setFunction=function(e,t){this.value=e,this.inputs=t||[]},Mt.prototype.getFunction=function(){return this.value},Mt.prototype.getType=function(e){return this.value.getType(e)},Mt.prototype.generate=function(e,t){for(var r=this.getType(e),a=this.value,i=a.build(e,t)+"( ",n=[],o=0;o<a.inputs.length;o++){var s=a.inputs[o],l=this.inputs[o]||this.inputs[s.name];n.push(l.build(e,e.getTypeByFormat(s.type)))}return i+=n.join(", ")+" )",e.format(i,r,t)},Mt.prototype.copy=function(e){for(var t in qe.prototype.copy.call(this,e),e.inputs)this.inputs[t]=e.inputs[t];return this.value=e.value,this},Mt.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){var r=this.value;if((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,r.inputs.length){t.inputs={};for(var a=0;a<r.inputs.length;a++){var i=r.inputs[a],n=this.inputs[a]||this.inputs[i.name];t.inputs[i.name]=n.toJSON(e).uuid}}}return t},St.prototype=Object.create(wt.prototype),St.prototype.constructor=St,St.prototype.nodeType="Expression",Tt.ADD="+",Tt.SUB="-",Tt.MUL="*",Tt.DIV="/",Tt.prototype=Object.create(qe.prototype),Tt.prototype.constructor=Tt,Tt.prototype.nodeType="Operator",Tt.prototype.getType=function(e){var t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t},Tt.prototype.generate=function(e,t){var r=this.getType(e),a=this.a.build(e,r),i=this.b.build(e,r);return e.format("( "+a+" "+this.op+" "+i+" )",r,t)},Tt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op,this},Tt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t},Ct.RAD="radians",Ct.DEG="degrees",Ct.EXP="exp",Ct.EXP2="exp2",Ct.LOG="log",Ct.LOG2="log2",Ct.SQRT="sqrt",Ct.INV_SQRT="inversesqrt",Ct.FLOOR="floor",Ct.CEIL="ceil",Ct.NORMALIZE="normalize",Ct.FRACT="fract",Ct.SATURATE="saturate",Ct.SIN="sin",Ct.COS="cos",Ct.TAN="tan",Ct.ASIN="asin",Ct.ACOS="acos",Ct.ARCTAN="atan",Ct.ABS="abs",Ct.SIGN="sign",Ct.LENGTH="length",Ct.NEGATE="negate",Ct.INVERT="invert",Ct.MIN="min",Ct.MAX="max",Ct.MOD="mod",Ct.STEP="step",Ct.REFLECT="reflect",Ct.DISTANCE="distance",Ct.DOT="dot",Ct.CROSS="cross",Ct.POW="pow",Ct.MIX="mix",Ct.CLAMP="clamp",Ct.REFRACT="refract",Ct.SMOOTHSTEP="smoothstep",Ct.FACEFORWARD="faceforward",Ct.prototype=Object.create(qe.prototype),Ct.prototype.constructor=Ct,Ct.prototype.nodeType="Math",Ct.prototype.hashProperties=["method"],Ct.prototype.getNumInputs=function(){switch(this.method){case Ct.MIX:case Ct.CLAMP:case Ct.REFRACT:case Ct.SMOOTHSTEP:case Ct.FACEFORWARD:return 3;case Ct.MIN:case Ct.MAX:case Ct.MOD:case Ct.STEP:case Ct.REFLECT:case Ct.DISTANCE:case Ct.DOT:case Ct.CROSS:case Ct.POW:return 2;default:return 1}},Ct.prototype.getInputType=function(e){var t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,a=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>a?this.a.getType(e):r>a?this.b.getType(e):this.c.getType(e)},Ct.prototype.getType=function(e){switch(this.method){case Ct.LENGTH:case Ct.DISTANCE:case Ct.DOT:return"f";case Ct.CROSS:return"v3"}return this.getInputType(e)},Ct.prototype.generate=function(e,t){var r,a,i,n=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,s=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),u=this.getType(e);switch(this.method){case Ct.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Ct.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Ct.CROSS:r=this.a.build(e,"v3"),a=this.b.build(e,"v3");break;case Ct.STEP:r=this.a.build(e,1===n?"f":l),a=this.b.build(e,l);break;case Ct.MIN:case Ct.MAX:case Ct.MOD:r=this.a.build(e,l),a=this.b.build(e,1===o?"f":l);break;case Ct.REFRACT:r=this.a.build(e,l),a=this.b.build(e,l),i=this.c.build(e,"f");break;case Ct.MIX:r=this.a.build(e,l),a=this.b.build(e,l),i=this.c.build(e,1===s?"f":l);break;default:r=this.a.build(e,l),this.b&&(a=this.b.build(e,l)),this.c&&(i=this.c.build(e,l))}var c=[];c.push(r),a&&c.push(a),i&&c.push(i);var h=this.getNumInputs(e);if(c.length!==h)throw Error('Arguments not match used in "'+this.method+'". Require '+h+", currently "+c.length+".");return e.format(this.method+"( "+c.join(", ")+" )",u,t)},Ct.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.c=e.c,this.method=e.method,this},Ct.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,this.b&&(t.b=this.b.toJSON(e).uuid),this.c&&(t.c=this.c.toJSON(e).uuid),t.method=this.method),t},Ft.Nodes=(nt=new wt(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),ot=new wt(["vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );","}"].join("\n")),st=new wt(["vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );","}"].join("\n")),lt=new wt(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),ut=new wt(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n")),ct=new wt(["vec4 RGBEToLinear( in vec4 value ) {","\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );","}"].join("\n")),ht=new wt(["vec4 LinearToRGBE( in vec4 value ) {","\tfloat maxComponent = max( max( value.r, value.g ), value.b );","\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );","\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );","}"].join("\n")),dt=new wt(["vec3 RGBMToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.xyz * value.w * maxRange, 1.0 );","}"].join("\n")),ft=new wt(["vec3 LinearToRGBM( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );","\tM            = ceil( M * 255.0 ) / 255.0;","\treturn vec4( value.rgb / ( M * maxRange ), M );","}"].join("\n")),pt=new wt(["vec3 RGBDToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );","}"].join("\n")),mt=new wt(["vec3 LinearToRGBD( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat D      = max( maxRange / maxRGB, 1.0 );","\tD            = clamp( floor( D ) / 255.0, 0.0, 1.0 );","\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );","}"].join("\n")),vt=new tt("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),gt=new wt(["vec4 LinearToLogLuv( in vec4 value ) {","\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;","\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));","\tvec4 vResult;","\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;","\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;","\tvResult.w = fract(Le);","\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;","\treturn vResult;","}"].join("\n"),[vt]),yt=new tt("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );"),{LinearToLinear:nt,GammaToLinear:ot,LinearToGamma:st,sRGBToLinear:lt,LinearTosRGB:ut,RGBEToLinear:ct,LinearToRGBE:ht,RGBMToLinear:dt,LinearToRGBM:ft,RGBDToLinear:pt,LinearToRGBD:mt,cLogLuvM:vt,LinearToLogLuv:gt,cLogLuvInverseM:yt,LogLuvToLinear:new wt(["vec4 LogLuvToLinear( in vec4 value ) {","\tfloat Le = value.z * 255.0 + value.w;","\tvec3 Xp_Y_XYZp;","\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);","\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;","\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;","\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;","\treturn vec4( max(vRGB, 0.0), 1.0 );","}"].join("\n"),[yt])}),Ft.LINEAR_TO_LINEAR="LinearToLinear",Ft.GAMMA_TO_LINEAR="GammaToLinear",Ft.LINEAR_TO_GAMMA="LinearToGamma",Ft.SRGB_TO_LINEAR="sRGBToLinear",Ft.LINEAR_TO_SRGB="LinearTosRGB",Ft.RGBE_TO_LINEAR="RGBEToLinear",Ft.LINEAR_TO_RGBE="LinearToRGBE",Ft.RGBM_TO_LINEAR="RGBMToLinear",Ft.LINEAR_TO_RGBM="LinearToRGBM",Ft.RGBD_TO_LINEAR="RGBDToLinear",Ft.LINEAR_TO_RGBD="LinearToRGBD",Ft.LINEAR_TO_LOG_LUV="LinearToLogLuv",Ft.LOG_LUV_TO_LINEAR="LogLuvToLinear",Ft.getEncodingComponents=function(t){switch(t){case e.LinearEncoding:return["Linear"];case e.sRGBEncoding:return["sRGB"];case e.RGBEEncoding:return["RGBE"];case e.RGBM7Encoding:return["RGBM",new $e(7).setReadonly(!0)];case e.RGBM16Encoding:return["RGBM",new $e(16).setReadonly(!0)];case e.RGBDEncoding:return["RGBD",new $e(256).setReadonly(!0)];case e.GammaEncoding:return["Gamma",new St("float( GAMMA_FACTOR )","f")]}},Ft.prototype=Object.create(qe.prototype),Ft.prototype.constructor=Ft,Ft.prototype.nodeType="ColorSpace",Ft.prototype.hashProperties=["method"],Ft.prototype.generate=function(e,t){var r=this.input.build(e,"v4"),a=this.getType(e),i=Ft.Nodes[this.method],n=e.include(i);if(n===Ft.LINEAR_TO_LINEAR)return e.format(r,a,t);if(2===i.inputs.length){var o=this.factor.build(e,"f");return e.format(n+"( "+r+", "+o+" )",a,t)}return e.format(n+"( "+r+" )",a,t)},Ft.prototype.fromEncoding=function(e){var t=Ft.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]},Ft.prototype.fromDecoding=function(e){var t=Ft.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]},Ft.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.input=e.input,this.method=e.method,this},Ft.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).input=this.input.toJSON(e).uuid,t.method=this.method),t},Et.Nodes=function(){var e=new it("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new tt("float cubeUV_maxMipLevel 8.0",!0),r=new tt("float cubeUV_minMipLevel 4.0",!0),a=new tt("float cubeUV_maxTileSize 256.0",!0),i=new tt("float cubeUV_minTileSize 16.0",!0),n=new wt("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");n.useKeywords=!1;var o=new wt("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");o.useKeywords=!1;var s=new wt("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,n,o,t,r,a,i]);s.useKeywords=!1;var l=new tt("float r0 1.0",!0),u=new tt("float v0 0.339",!0),c=new tt("float m0 -2.0",!0);return{bilinearCubeUV:s,roughnessToMip:new wt("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,u,c,new tt("float r1 0.8",!0),new tt("float v1 0.276",!0),new tt("float m1 -1.0",!0),new tt("float r4 0.4",!0),new tt("float v4 0.046",!0),new tt("float m4 2.0",!0),new tt("float r5 0.305",!0),new tt("float v5 0.016",!0),new tt("float m5 3.0",!0),new tt("float r6 0.21",!0),new tt("float v6 0.0038",!0),new tt("float m6 4.0",!0)]),m0:c,cubeUV_maxMipLevel:t}}(),Et.prototype=Object.create(qe.prototype),Et.prototype.constructor=Et,Et.prototype.nodeType="TextureCubeUV",Et.prototype.bilinearCubeUV=function(e,t,r,a){var i=new Mt(Et.Nodes.bilinearCubeUV,[t,r,a]);this.colorSpaceTL=this.colorSpaceTL||new Ft(new St("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(i.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR||new Ft(new St("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(i.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL||new Ft(new St("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(i.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR||new Ft(new St("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(i.build(e)+".br");var n={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(n),this.colorSpaceTLExp=new St(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new St(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new St(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new St(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();var o=new St("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=i,o},Et.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=this.uv,a=this.bias||e.context.roughness,i=new Ct(new Mt(Et.Nodes.roughnessToMip,[a]),Et.Nodes.m0,Et.Nodes.cubeUV_maxMipLevel,Ct.CLAMP),n=new Ct(i,Ct.FLOOR),o=new Ct(i,Ct.FRACT),s=new Ct(this.bilinearCubeUV(e,this.value,r,n),this.bilinearCubeUV(e,this.value,r,new Tt(n,new $e(1).setReadonly(!0),Tt.ADD)),o,Ct.MIX);return e.format(s.build(e),"v4",t)}return console.warn("THREE.TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},Et.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.bias=this.bias.toJSON(e).uuid),t},Bt.LOCAL="local",Bt.WORLD="world",Bt.VIEW="view",Bt.PROJECTION="projection",Bt.prototype=Object.create(qe.prototype),Bt.prototype.constructor=Bt,Bt.prototype.nodeType="Position",Bt.prototype.getType=function(){switch(this.scope){case Bt.PROJECTION:return"v4"}return this.type},Bt.prototype.getShared=function(){switch(this.scope){case Bt.LOCAL:case Bt.WORLD:return!1}return!0},Bt.prototype.generate=function(e,t){var r;switch(this.scope){case Bt.LOCAL:e.isShader("vertex")?r="transformed":(e.requires.position=!0,r="vPosition");break;case Bt.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,r="vWPosition";break;case Bt.VIEW:r=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Bt.PROJECTION:r=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(r,this.getType(e),t)},Bt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.scope=e.scope,this},Bt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},xt.addKeyword("position",(function(){return new Bt})),xt.addKeyword("worldPosition",(function(){return new Bt(Bt.WORLD)})),xt.addKeyword("viewPosition",(function(){return new Bt(Bt.VIEW)})),Lt.LOCAL="local",Lt.WORLD="world",Lt.VIEW="view",Lt.prototype=Object.create(qe.prototype),Lt.prototype.constructor=Lt,Lt.prototype.nodeType="Normal",Lt.prototype.getShared=function(){return this.scope===Lt.WORLD},Lt.prototype.build=function(e,t,r,a){var i=e.context[this.scope+"Normal"];return i?i.build(e,t,r,a):qe.prototype.build.call(this,e,t,r)},Lt.prototype.generate=function(e,t){var r;switch(this.scope){case Lt.VIEW:r=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case Lt.LOCAL:e.isShader("vertex")?r="objectNormal":(e.requires.normal=!0,r="vObjectNormal");break;case Lt.WORLD:e.isShader("vertex")?r="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,r="vWNormal")}return e.format(r,this.getType(e),t)},Lt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.scope=e.scope,this},Lt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},xt.addKeyword("viewNormal",(function(){return new Lt(Lt.VIEW)})),xt.addKeyword("localNormal",(function(){return new Lt(Lt.NORMAL)})),xt.addKeyword("worldNormal",(function(){return new Lt(Lt.WORLD)})),Pt.CUBE="cube",Pt.SPHERE="sphere",Pt.VECTOR="vector",Pt.prototype=Object.create(qe.prototype),Pt.prototype.constructor=Pt,Pt.prototype.nodeType="Reflect",Pt.prototype.getUnique=function(e){return!e.context.viewNormal},Pt.prototype.getType=function(){switch(this.scope){case Pt.SPHERE:return"v2"}return this.type},Pt.prototype.generate=function(e,t){var r=this.getUnique(e);if(e.isShader("fragment")){var a;switch(this.scope){case Pt.VECTOR:var i=new Lt(Lt.VIEW),n=e.context.roughness,o=i.build(e,"v3"),s=new Bt(Bt.VIEW).build(e,"v3"),l=n?n.build(e,"f"):void 0,u="reflect( -normalize( "+s+" ), "+o+" )";l&&(u="normalize( mix( "+u+", "+o+", "+l+" * "+l+" ) )");var c="inverseTransformDirection( "+u+", viewMatrix )";r?(e.addNodeCode("vec3 reflectVec = "+c+";"),a="reflectVec"):a=c;break;case Pt.CUBE:c="vec3( -"+(h=new Pt(Pt.VECTOR).build(e,"v3"))+".x, "+h+".yz )";r?(e.addNodeCode("vec3 reflectCubeVec = "+c+";"),a="reflectCubeVec"):a=c;break;case Pt.SPHERE:var h;c="normalize( ( viewMatrix * vec4( "+(h=new Pt(Pt.VECTOR).build(e,"v3"))+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode("vec2 reflectSphereVec = "+c+";"),a="reflectSphereVec"):a=c}return e.format(a,this.getType(e),t)}return console.warn("THREE.ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)},Pt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},Dt.prototype=Object.create(qe.prototype),Dt.prototype.constructor=Dt,Dt.prototype.nodeType="TextureCube",Dt.prototype.generate=function(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("THREE.TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))},Dt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.value=e.value,this},Dt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t};var Nt,Rt={elements:["x","y","z","w"],addShortcuts:function(){function e(e,t,r){return r?{get:function(){return this[e][t][r]},set:function(a){this[e][t][r]=a}}:{get:function(){return this[e][t]},set:function(r){this[e][t]=r}}}return function(t,r,a){for(var i={},n=0;n<a.length;++n){var o=a[n].split("."),s=o[0],l=o[1];i[s]=e(r,s,l)}Object.defineProperties(t,i)}}()};function _t(t,r){Ze.call(this,"v2"),this.value=t instanceof e.Vector2?t:new e.Vector2(t,r)}function It(e){qe.call(this,"v2",{shared:!1}),this.index=e||0}function Ot(e,t){qe.call(this,"v3"),this.value=e,this.scale=t||new _t(1,1)}function Ut(e,t){qe.call(this,"v3"),this.value=e,this.scale=t||new $e(1),this.toNormalMap=!1}function kt(t,r,a){Ze.call(this,"c"),this.value=t instanceof e.Color?t:new e.Color(t||0,r,a)}function Vt(e){$e.call(this),this.texture=e,this.maxMIPLevel=0}function Gt(e,t){qe.call(this,"f"),this.roughness=e,this.texture=t,this.maxMIPLevel=void 0}function jt(){Ke.call(this),this.color=new kt(16777215),this.roughness=new $e(1),this.metalness=new $e(0)}function zt(e){e=e||{},this.name=e.name,this.type=e.type,this.node=e.node,this.needsUpdate=e.needsUpdate}function Ht(t,r,a){Ze.call(this,"v3"),this.value=t instanceof e.Vector3?t:new e.Vector3(t,r,a)}function Wt(t,r,a,i){Ze.call(this,"v4"),this.value=t instanceof e.Vector4?t:new e.Vector4(t,r,a,i)}function Xt(e,t,r,a){Ze.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new It,this.bias=r,this.project=void 0!==a&&a}function Qt(e,t,r){Ze.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new Pt,this.bias=r}_t.prototype=Object.create(Ze.prototype),_t.prototype.constructor=_t,_t.prototype.nodeType="Vector2",Rt.addShortcuts(_t.prototype,"value",["x","y"]),_t.prototype.generateReadonly=function(e,t,r,a){return e.format("vec2( "+this.x+", "+this.y+" )",a,t)},_t.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value.copy(e),this},_t.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,!0===this.readonly&&(t.readonly=!0)),t},It.prototype=Object.create(qe.prototype),It.prototype.constructor=It,It.prototype.nodeType="UV",It.prototype.generate=function(e,t){e.requires.uv[this.index]=!0;var r=this.index>0?this.index+1:"",a=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(a,this.getType(e),t)},It.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.index=e.index,this},It.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},xt.addKeyword("uv",(function(){return new It})),xt.addKeyword("uv2",(function(){return new It(1)})),Ot.Nodes={perturbNormal2Arb:new wt("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 vUv, vec2 normalScale ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = map * 2.0 - 1.0;\n\n\t\tmapN.xy *= normalScale;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t// Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\n\n\t\t\tif ( dot( cross( S, T ), N ) < 0.0 ) mapN.xy *= - 1.0;\n\n\t\t#else\n\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}",null,{derivatives:!0})},Ot.prototype=Object.create(qe.prototype),Ot.prototype.constructor=Ot,Ot.prototype.nodeType="NormalMap",Ot.prototype.generate=function(t,r){if(t.isShader("fragment")){var a=t.include(Ot.Nodes.perturbNormal2Arb);this.normal=this.normal||new Lt,this.position=this.position||new Bt(Bt.VIEW),this.uv=this.uv||new It;var i=this.scale.build(t,"v2");return t.material.side===e.BackSide&&(i="-"+i),t.format(a+"( -"+this.position.build(t,"v3")+", "+this.normal.build(t,"v3")+", "+this.value.build(t,"v3")+", "+this.uv.build(t,"v2")+", "+i+" )",this.getType(t),r)}return console.warn("THREE.NormalMapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),r)},Ot.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale,this},Ot.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},Ut.Nodes={dHdxy_fwd:Nt=new wt(["vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {","\tvec2 dSTdx = dFdx( vUv );","\tvec2 dSTdy = dFdy( vUv );","\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;","\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","\treturn vec2( dBx, dBy );","}"].join("\n"),null,{derivatives:!0}),perturbNormalArb:new wt(["vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );","\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );","\tvec3 vN = surf_norm;","\tvec3 R1 = cross( vSigmaY, vN );","\tvec3 R2 = cross( vN, vSigmaX );","\tfloat fDet = dot( vSigmaX, R1 );","\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","\treturn normalize( abs( fDet ) * surf_norm - vGrad );","}"].join("\n"),[Nt],{derivatives:!0}),bumpToNormal:new wt(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );","}"].join("\n"),null,{derivatives:!0})},Ut.prototype=Object.create(qe.prototype),Ut.prototype.constructor=Ut,Ut.prototype.nodeType="BumpMap",Ut.prototype.hashProperties=["toNormalMap"],Ut.prototype.generate=function(e,t){if(e.isShader("fragment")){if(this.toNormalMap){var r=e.include(Ut.Nodes.bumpToNormal);return e.format(r+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )",this.getType(e),t)}var a=e.include(Ut.Nodes.dHdxy_fwd),i=e.include(Ut.Nodes.perturbNormalArb);this.normal=this.normal||new Lt,this.position=this.position||new Bt(Bt.VIEW);var n=a+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )";return e.format(i+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+n+" )",this.getType(e),t)}return console.warn("THREE.BumpMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},Ut.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale,this},Ut.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},kt.prototype=Object.create(Ze.prototype),kt.prototype.constructor=kt,kt.prototype.nodeType="Color",Rt.addShortcuts(kt.prototype,"value",["r","g","b"]),kt.prototype.generateReadonly=function(e,t,r,a){return e.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",a,t)},kt.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value.copy(e),this},kt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).r=this.r,t.g=this.g,t.b=this.b,!0===this.readonly&&(t.readonly=!0)),t},Vt.prototype=Object.create($e.prototype),Vt.prototype.constructor=Vt,Vt.prototype.nodeType="MaxMIPLevel",Object.defineProperties(Vt.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image;Array.isArray(e)&&(e=e[0]),this.maxMIPLevel=void 0!==e?Math.log(Math.max(e.width,e.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(){}}}),Vt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.uuid),t},Gt.Nodes={getSpecularMIPLevel:new wt(["float getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {","\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );","\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n"))},Gt.prototype=Object.create(qe.prototype),Gt.prototype.constructor=Gt,Gt.prototype.nodeType="SpecularMIPLevel",Gt.prototype.setTexture=function(e){return this.texture=e,this},Gt.prototype.generate=function(e,t){if(e.isShader("fragment")){this.maxMIPLevel=this.maxMIPLevel||new Vt,this.maxMIPLevel.texture=this.texture;var r=e.include(Gt.Nodes.getSpecularMIPLevel);return e.format(r+"( "+this.roughness.build(e,"f")+", "+this.maxMIPLevel.build(e,"f")+" )",this.type,t)}return console.warn("THREE.SpecularMIPLevelNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t)},Gt.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.texture=e.texture,this.roughness=e.roughness,this},Gt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture,t.roughness=this.roughness),t},jt.prototype=Object.create(Ke.prototype),jt.prototype.constructor=jt,jt.prototype.nodeType="Standard",jt.prototype.build=function(t){var r;t.define("STANDARD");var a=this.clearcoat||this.clearcoatRoughness||this.clearCoatNormal;if(a&&t.define("CLEARCOAT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){var i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(e.UniformsUtils.merge([e.UniformsLib.fog,e.UniformsLib.lights])),e.UniformsLib.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];i&&n.push(i.code,i.result?"transformed = "+i.result+";":""),n.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),r=n.join("\n")}else{var o=new St("material.specularRoughness","f"),s=new St("material.clearcoatRoughness","f"),l={roughness:o,bias:new Gt(o),viewNormal:new St("normal","v3"),worldNormal:new St("inverseTransformDirection( geometry.normal, viewMatrix )","v3"),gamma:!0},u={gamma:!0},c={roughness:s,bias:new Gt(s),viewNormal:new St("clearcoatNormal","v3"),worldNormal:new St("inverseTransformDirection( geometry.clearcoatNormal, viewMatrix )","v3"),gamma:!0};this.mask&&this.mask.analyze(t),this.color.analyze(t,{slot:"color",context:u}),this.roughness.analyze(t),this.metalness.analyze(t),this.alpha&&this.alpha.analyze(t),this.normal&&this.normal.analyze(t),this.clearcoat&&this.clearcoat.analyze(t),this.clearcoatRoughness&&this.clearcoatRoughness.analyze(t),this.clearcoatNormal&&this.clearcoatNormal.analyze(t),this.reflectivity&&this.reflectivity.analyze(t),this.light&&this.light.analyze(t,{cache:"light"}),this.ao&&this.ao.analyze(t),this.ambient&&this.ambient.analyze(t),this.shadow&&this.shadow.analyze(t),this.emissive&&this.emissive.analyze(t,{slot:"emissive"}),this.environment&&(this.environment.analyze(t,{cache:"radiance",context:l,slot:"radiance"}),t.requires.irradiance&&this.environment.analyze(t,{cache:"irradiance",context:l,slot:"irradiance"})),this.sheen&&this.sheen.analyze(t);var h,d=this.mask?this.mask.flow(t,"b"):void 0,f=this.color.flow(t,"c",{slot:"color",context:u}),p=this.roughness.flow(t,"f"),m=this.metalness.flow(t,"f"),v=this.alpha?this.alpha.flow(t,"f"):void 0,g=this.normal?this.normal.flow(t,"v3"):void 0,y=this.clearcoat?this.clearcoat.flow(t,"f"):void 0,x=(s=this.clearcoatRoughness?this.clearcoatRoughness.flow(t,"f"):void 0,this.clearcoatNormal?this.clearcoatNormal.flow(t,"v3"):void 0),b=this.reflectivity?this.reflectivity.flow(t,"f"):void 0,A=this.light?this.light.flow(t,"v3",{cache:"light"}):void 0,w=this.ao?this.ao.flow(t,"f"):void 0,M=this.ambient?this.ambient.flow(t,"c"):void 0,S=this.shadow?this.shadow.flow(t,"c"):void 0,T=this.emissive?this.emissive.flow(t,"c",{slot:"emissive"}):void 0;this.environment&&(h={radiance:this.environment.flow(t,"c",{cache:"radiance",context:l,slot:"radiance"})},t.requires.irradiance&&(h.irradiance=this.environment.flow(t,"c",{cache:"irradiance",context:l,slot:"irradiance"})));var C=a&&h?this.environment.flow(t,"c",{cache:"clearcoat",context:c,slot:"environment"}):void 0,F=this.sheen?this.sheen.flow(t,"c"):void 0;t.requires.transparent=void 0!==v,t.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));n=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\t#include <clearcoat_normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];d&&n.push(d.code,"if ( ! "+d.result+" ) discard;"),n.push(f.code,"\tvec3 diffuseColor = "+f.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",p.code,"\tfloat roughnessFactor = "+p.result+";",m.code,"\tfloat metalnessFactor = "+m.result+";"),v&&n.push(v.code,"#ifdef ALPHATEST","\tif ( "+v.result+" <= ALPHATEST ) discard;","#endif"),g&&n.push(g.code,"normal = "+g.result+";"),x&&n.push(x.code,"clearcoatNormal = "+x.result+";"),n.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),n.push("material.diffuseColor = "+(A?"vec3( 1.0 )":"diffuseColor * ( 1.0 - metalnessFactor )")+";","material.specularRoughness = max( roughnessFactor, 0.0525 );","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),y?n.push(y.code,"material.clearcoat = saturate( "+y.result+" );"):a&&n.push("material.clearcoat = 0.0;"),s?n.push(s.code,"material.clearcoatRoughness = max( "+s.result+", 0.0525 );","material.clearcoatRoughness += geometryRoughness;","material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );"):a&&n.push("material.clearcoatRoughness = 0.0;"),F&&n.push("material.sheenColor = "+F.result+";"),b?n.push(b.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+b.result+" ) ), diffuseColor, metalnessFactor );"):n.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),n.push("#include <lights_fragment_begin>"),A&&(n.push(A.code,"reflectedLight.directDiffuse = "+A.result+";"),n.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),w&&n.push(w.code,"reflectedLight.indirectDiffuse *= "+w.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+w.result+", material.specularRoughness );"),M&&n.push(M.code,"reflectedLight.indirectDiffuse += "+M.result+";"),S&&n.push(S.code,"reflectedLight.directDiffuse *= "+S.result+";","reflectedLight.directSpecular *= "+S.result+";"),T&&n.push(T.code,"reflectedLight.directDiffuse += "+T.result+";"),h&&(n.push(h.radiance.code),t.requires.irradiance&&n.push(h.irradiance.code),C&&n.push(C.code,"clearcoatRadiance += "+C.result+";"),n.push("radiance += "+h.radiance.result+";"),t.requires.irradiance&&n.push("iblIrradiance += PI * "+h.irradiance.result+";")),n.push("#include <lights_fragment_end>"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),v?n.push("gl_FragColor = vec4( outgoingLight, "+v.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),r=n.join("\n")}return r},jt.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.roughness=e.roughness,this.metalness=e.metalness,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.clearcoat&&(this.clearcoat=e.clearcoat),e.clearcoatRoughness&&(this.clearcoatRoughness=e.clearcoatRoughness),e.clearcoatNormal&&(this.clearcoatNormal=e.clearcoatNormal),e.reflectivity&&(this.reflectivity=e.reflectivity),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),e.sheen&&(this.sheen=e.sheen),this},jt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.clearcoat&&(t.clearcoat=this.clearcoat.toJSON(e).uuid),this.clearcoatRoughness&&(t.clearcoatRoughness=this.clearcoatRoughness.toJSON(e).uuid),this.clearcoatNormal&&(t.clearcoatNormal=this.clearcoatNormal.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.sheen&&(t.sheen=this.sheen.toJSON(e).uuid)),t},Object.defineProperties(zt.prototype,{value:{get:function(){return this.node.value},set:function(e){this.node.value=e}}}),Ht.prototype=Object.create(Ze.prototype),Ht.prototype.constructor=Ht,Ht.prototype.nodeType="Vector3",Rt.addShortcuts(Ht.prototype,"value",["x","y","z"]),Ht.prototype.generateReadonly=function(e,t,r,a){return e.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",a,t)},Ht.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value.copy(e),this},Ht.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,!0===this.readonly&&(t.readonly=!0)),t},Wt.prototype=Object.create(Ze.prototype),Wt.prototype.constructor=Wt,Wt.prototype.nodeType="Vector4",Rt.addShortcuts(Wt.prototype,"value",["x","y","z","w"]),Wt.prototype.generateReadonly=function(e,t,r,a){return e.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",a,t)},Wt.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value.copy(e),this},Wt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,!0===this.readonly&&(t.readonly=!0)),t},Xt.prototype=Object.create(Ze.prototype),Xt.prototype.constructor=Xt,Xt.prototype.nodeType="Texture",Xt.prototype.getTexture=function(e,t){return Ze.prototype.generate.call(this,e,t,this.value.uuid,"t")},Xt.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var r,a,i=this.getTexture(e,t),n=this.uv.build(e,this.project?"v4":"v2"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=e.context.bias.setTexture(this).build(e,"f")),r=this.project?"texture2DProj":o?"tex2DBias":"tex2D",a=o?r+"( "+i+", "+n+", "+o+" )":r+"( "+i+", "+n+" )";var s={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(s),this.colorSpace=this.colorSpace||new Ft(new St("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)},Xt.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),void 0!==e.project&&(this.project=e.project),this},Xt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},Qt.prototype=Object.create(Ze.prototype),Qt.prototype.constructor=Qt,Qt.prototype.nodeType="CubeTexture",Qt.prototype.getTexture=function(e,t){return Ze.prototype.generate.call(this,e,t,this.value.uuid,"tc")},Qt.prototype.generate=function(e,t){if("samplerCube"===t)return this.getTexture(e,t);var r,a=this.getTexture(e,t),i=this.uv.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;void 0===n&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f")),r=n?"texCubeBias( "+a+", "+i+", "+n+" )":"texCube( "+a+", "+i+" )";var o={include:e.isShader("vertex"),ignoreCache:!0},s=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace||new Ft(new St("",s)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(e,s),e.removeContext(),e.format(r,s,t)},Qt.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),this},Qt.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.uuid,t.uv=this.uv.toJSON(e).uuid,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t};var Yt=Rt.elements,Jt=["float","vec2","vec3","vec4"],Kt={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b"},qt={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"};function Zt(){this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1,transparent:!1,irradiance:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.analyzing=!1}function $t(e){Ke.call(this,"v4"),this.value=e}function er(t,r){e.ShaderMaterial.call(this),this.vertex=t||new $t(new Bt(Bt.PROJECTION)),this.fragment=r||new $t(new kt(16711680)),this.updaters=[]}function tr(){var e=new jt;er.call(this,e,e),this.type="StandardNodeMaterial"}function rr(){Ke.call(this),this.color=new kt(16777215)}function ar(e,t,r){Ze.call(this,r),this.object=e,this.property=t}function ir(e,t){Ke.call(this),this.node=e,this.components=t||"x"}function nr(){jt.call(this),this.properties={color:new e.Color(16777215),roughness:.5,metalness:.5,normalScale:new e.Vector2(1,1)},this.inputs={color:new ar(this.properties,"color","c"),roughness:new ar(this.properties,"roughness","f"),metalness:new ar(this.properties,"metalness","f"),normalScale:new ar(this.properties,"normalScale","v2")}}function or(){Ke.call(this),this.color=new kt(15658734),this.specular=new kt(1118481),this.shininess=new $e(30)}function sr(){Ke.call(this),this.color=new kt(15658734),this.spherical=!0}function lr(){var e=new or;er.call(this,e,e),this.type="PhongNodeMaterial"}function ur(){var e=new nr;er.call(this,e,e),this.type="MeshStandardNodeMaterial"}function cr(){var e=new rr;er.call(this,e,e),this.type="BasicNodeMaterial"}function hr(){var e=new sr;er.call(this,e,e),this.type="SpriteNodeMaterial"}function dr(e,t){Ke.call(this,e),this.value=t}function fr(e){this.time=void 0!==e?e:0,this.id=0}function pr(e,t){Ke.call(this,t),this.name=e}function mr(e,t){qe.call(this,"v3"),this.setScope(e||mr.POSITION),this.setCamera(t)}function vr(e){qe.call(this,"v3",{shared:!1}),this.scope=e||vr.TOTAL}function gr(){_t.call(this),this.size=new e.Vector2}function yr(e){qe.call(this,"v2"),this.resolution=e||new gr}Zt.prototype={constructor:Zt,build:function(e,t){this.buildShader("vertex",e),this.buildShader("fragment",t);for(var r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){var a=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+a+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+a+";"),this.addVertexFinalCode("vUv"+a+" = uv"+a+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this},buildShader:function(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")},setMaterial:function(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this},addFlow:function(e,t,r){return this.addSlot(e).addCache(t).addContext(r)},removeFlow:function(){return this.removeSlot().removeCache().removeContext()},addCache:function(e){return this.cache=e||"",this.caches.push(this.cache),this},removeCache:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this},addContext:function(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this},removeContext:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this},addSlot:function(e){return this.slot=e||"",this.slots.push(this.slot),this},removeSlot:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this},addVertexCode:function(e){this.addCode(e,"vertex")},addFragmentCode:function(e){this.addCode(e,"fragment")},addCode:function(e,t){this.code[t||this.shader]+=e+"\n"},addVertexNodeCode:function(e){this.addNodeCode(e,"vertex")},addFragmentNodeCode:function(e){this.addNodeCode(e,"fragment")},addNodeCode:function(e,t){this.nodeCode[t||this.shader]+=e+"\n"},clearNodeCode:function(e){e=e||this.shader;var t=this.nodeCode[e];return this.nodeCode[e]="",t},clearVertexNodeCode:function(){return this.clearNodeCode("vertex")},clearFragmentNodeCode:function(){return this.clearNodeCode("fragment")},addVertexFinalCode:function(e){this.addFinalCode(e,"vertex")},addFragmentFinalCode:function(e){this.addFinalCode(e,"fragment")},addFinalCode:function(e,t){this.finalCode[t||this.shader]+=e+"\n"},addVertexParsCode:function(e){this.addParsCode(e,"vertex")},addFragmentParsCode:function(e){this.addParsCode(e,"fragment")},addParsCode:function(e,t){this.parsCode[t||this.shader]+=e+"\n"},addVaryCode:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)},isCache:function(e){return-1!==this.caches.indexOf(e)},isSlot:function(e){return-1!==this.slots.indexOf(e)},define:function(e,t){this.defines[e]=void 0===t?1:t},require:function(e){this.requires[e]=!0},isDefined:function(e){return void 0!==this.defines[e]},getVar:function(e,t,r,a,i,n){void 0===a&&(a="varying"),void 0===i&&(i="V"),void 0===n&&(n="");var o=this.getVars(a),s=o[e];if(!s){var l=o.length;s={name:r||"node"+i+l+(n?"_"+n:""),type:t},o.push(s),o[e]=s}return s},getTempVar:function(e,t,r,a){return this.getVar(e,t,r,this.shader,"T",a)},getAttribute:function(e,t){if(!this.attributes[e]){var r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]},getCode:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")},getVarListCode:function(e,t){t=t||"";for(var r="",a=0,i=e.length;a<i;++a){var n=e[a],o=n.type,s=n.name,l=this.getFormatByType(o);if(void 0===l)throw new Error("Node pars "+l+" not found.");r+=t+" "+l+" "+s+";\n"}return r},getVars:function(e){return this.inputs.vars[e||this.shader]},getNodeData:function(e){var t=e.isNode?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}},createUniform:function(e,t,r,a,i,n){var o=this.inputs.uniforms,s=o.list.length,l=new zt({type:t,name:a||"nodeU"+s+(n?"_"+n:""),node:r,needsUpdate:i});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l},createVertexUniform:function(e,t,r,a,i){return this.createUniform("vertex",e,t,r,a,i)},createFragmentUniform:function(e,t,r,a,i){return this.createUniform("fragment",e,t,r,a,i)},include:function(e,t,r){var a;if(e="string"==typeof e?xt.get(e):e,!1===this.context.include)return e.name;e instanceof wt?a=this.includes.functions:e instanceof tt?a=this.includes.consts:e instanceof it&&(a=this.includes.structs);var i=a[this.shader]=a[this.shader]||[];if(e){var n=i[e.name];if(n||(n=i[e.name]={node:e,deps:[]},i.push(n),n.src=e.build(this,"source")),e instanceof wt&&t&&i[t.name]&&-1==i[t.name].deps.indexOf(e)&&(i[t.name].deps.push(e),e.includes&&e.includes.length)){var o=0;do{this.include(e.includes[o++],t)}while(o<e.includes.length)}return r&&(n.src=r),e.name}throw new Error("Include not found.")},colorToVectorProperties:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},colorToVector:function(e){return e.replace(/c/g,"v3")},getIncludes:function(e,t){return this.includes[e][t||this.shader]},getIncludesCode:function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){if(!(i=this.getIncludes(t,r)))return"";for(var a="",i=i.sort(e),n=0;n<i.length;n++)i[n].src&&(a+=i[n].src+"\n");return a}}(),getConstructorFromLength:function(e){return Jt[e-1]},isTypeMatrix:function(e){return/^m/.test(e)},getTypeLength:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))},getTypeFromLength:function(e){return 1===e?"f":"v"+e},findNode:function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];if(void 0!==t&&t.isNode)return t}},resolve:function(){for(var t=0;t<arguments.length;t++){var r=arguments[t];if(void 0!==r){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case e.CubeReflectionMapping:case e.CubeRefractionMapping:return new Qt(r);case e.CubeUVReflectionMapping:case e.CubeUVRefractionMapping:return new Dt(new Xt(r));default:return new Xt(r)}else{if(r.isVector2)return new _t(r);if(r.isVector3)return new Ht(r);if(r.isVector4)return new Wt(r)}}}},format:function(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e},getTypeByFormat:function(e){return Kt[e]||e},getFormatByType:function(e){return qt[e]||e},getUuid:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return Yt[e]},getIndexByElement:function(e){return Yt.indexOf(e)},isShader:function(e){return this.shader===e},setShader:function(e){return this.shader=e,this},mergeDefines:function(e){for(var t in e)this.defines[t]=e[t];return this.defines},mergeUniform:function(e){for(var t in e)this.uniforms[t]=e[t];return this.uniforms},getTextureEncodingFromMap:function(t){var r;return t?t.isTexture?r=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=t.texture.encoding):r=e.LinearEncoding,r===e.LinearEncoding&&this.context.gamma&&(r=e.GammaEncoding),r}},$t.prototype=Object.create(Ke.prototype),$t.prototype.constructor=$t,$t.prototype.nodeType="Raw",$t.prototype.generate=function(e){var t=this.value.analyzeAndFlow(e,this.type),r=t.code+"\n";return e.isShader("vertex")?r+="gl_Position = "+t.result+";":r+="gl_FragColor = "+t.result+";",r},$t.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.value=e.value,this},$t.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t},er.prototype=Object.create(e.ShaderMaterial.prototype),er.prototype.constructor=er,er.prototype.type="NodeMaterial",er.prototype.isNodeMaterial=!0,Object.defineProperties(er.prototype,{properties:{get:function(){return this.fragment.properties}},needsUpdate:{set:function(e){!0===e&&this.version++,this.needsCompile=e},get:function(){return this.needsCompile}}}),er.prototype.onBeforeCompile=function(e,t){this.build({renderer:t}),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD},er.prototype.customProgramCacheKey=function(){return this.getHash()},er.prototype.getHash=function(){var e="{";return e+='"vertex":'+this.vertex.getHash()+",",e+='"fragment":'+this.fragment.getHash(),e+="}"},er.prototype.updateFrame=function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])},er.prototype.build=function(t){var r=(t=t||{}).builder||new Zt;return r.setMaterial(this,t.renderer),r.build(this.vertex,this.fragment),this.vertexShader=r.getCode("vertex"),this.fragmentShader=r.getCode("fragment"),this.defines=r.defines,this.uniforms=r.uniforms,this.extensions=r.extensions,this.updaters=r.updaters,this.fog=r.requires.fog,this.lights=r.requires.lights,this.transparent=r.requires.transparent||this.blending>e.NormalBlending,this},er.prototype.copy=function(e){var t=this.uuid;for(var r in e)this[r]=e[r];return this.uuid=t,void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this},er.prototype.toJSON=function(t){if((void 0===t||"string"==typeof t)&&(t={nodes:{}}),t&&!t.materials&&(t.materials={}),!t.materials[this.uuid]){var r={};r.uuid=this.uuid,r.type=this.type,t.materials[r.uuid]=r,""!==this.name&&(r.name=this.name),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==e.NormalBlending&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==e.FrontSide&&(r.side=this.side),this.vertexColors!==e.NoColors&&(r.vertexColors=this.vertexColors),this.depthFunc!==e.LessEqualDepth&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.fog=this.fog,r.lights=this.lights,r.vertex=this.vertex.toJSON(t).uuid,r.fragment=this.fragment.toJSON(t).uuid}return t.material=this.uuid,t},tr.prototype=Object.create(er.prototype),tr.prototype.constructor=tr,Rt.addShortcuts(tr.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearcoat","clearcoatRoughness","clearcoatNormal","normal","emissive","ambient","light","shadow","ao","environment","mask","position","sheen"]),rr.prototype=Object.create(Ke.prototype),rr.prototype.constructor=rr,rr.prototype.nodeType="Basic",rr.prototype.generate=function(e){var t;if(e.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif"].join("\n"));var a=["#include <beginnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED"," vNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&a.push(r.code,r.result?"transformed = "+r.result+";":""),a.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),t=a.join("\n")}else{this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.mask&&this.mask.analyze(e);var i=this.color.flow(e,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(e,"f"):void 0,o=this.mask?this.mask.flow(e,"b"):void 0;e.requires.transparent=void 0!==n,e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif"].join("\n"));a=["#include <normal_fragment_begin>",i.code];o&&a.push(o.code,"if ( ! "+o.result+" ) discard;"),n&&a.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),n?a.push("gl_FragColor = vec4("+i.result+", "+n.result+" );"):a.push("gl_FragColor = vec4("+i.result+", 1.0 );"),t=a.join("\n")}return t},rr.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.color=e.color,e.position&&(this.position=e.position),e.alpha&&(this.alpha=e.alpha),e.mask&&(this.mask=e.mask),this},rr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).color=this.color.toJSON(e).uuid,this.position&&(t.position=this.position.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.mask&&(t.mask=this.mask.toJSON(e).uuid)),t},ar.prototype=Object.create(Ze.prototype),ar.prototype.constructor=ar,ar.prototype.nodeType="Property",Object.defineProperties(ar.prototype,{value:{get:function(){return this.object[this.property]},set:function(e){this.object[this.property]=e}}}),ar.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,t.property=this.property),t},ir.prototype=Object.create(Ke.prototype),ir.prototype.constructor=ir,ir.prototype.nodeType="Switch",ir.prototype.getType=function(e){return e.getTypeFromLength(this.components.length)},ir.prototype.generate=function(e,t){var r=this.node.getType(e),a=this.node.build(e,r),i=e.getTypeLength(r)-1;if(i>0){var n,o=0,s=e.colorToVectorProperties(this.components),l=s.length;for(n=0;n<l;n++)o=Math.max(o,e.getIndexByElement(s.charAt(n)));for(o>i&&(o=i),a+=".",n=0;n<l;n++){var u=e.getIndexByElement(s.charAt(n));u>o&&(u=o),a+=e.getElementByIndex(u)}return e.format(a,this.getType(e),t)}return e.format(a,r,t)},ir.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.node=e.node,this.components=e.components,this},ir.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).node=this.node.toJSON(e).uuid,t.components=this.components),t},nr.prototype=Object.create(jt.prototype),nr.prototype.constructor=nr,nr.prototype.nodeType="MeshStandard",nr.prototype.build=function(e){var t=this.properties,r=this.inputs;if(e.isShader("fragment")){var a=e.findNode(t.color,r.color),i=e.resolve(t.map);this.color=i?new Tt(a,i,Tt.MUL):a;var n=e.findNode(t.roughness,r.roughness),o=e.resolve(t.roughnessMap);this.roughness=o?new Tt(n,new ir(o,"g"),Tt.MUL):n;var s=e.findNode(t.metalness,r.metalness),l=e.resolve(t.metalnessMap);this.metalness=l?new Tt(s,new ir(l,"b"),Tt.MUL):s,t.normalMap?(this.normal=new Ot(e.resolve(t.normalMap)),this.normal.scale=e.findNode(t.normalScale,r.normalScale)):this.normal=void 0,this.environment=e.resolve(t.envMap)}return jt.prototype.build.call(this,e)},nr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),console.warn(".toJSON not implemented in",this)),t},or.prototype=Object.create(Ke.prototype),or.prototype.constructor=or,or.prototype.nodeType="Phong",or.prototype.build=function(t){var r;if(t.define("PHONG"),t.requires.lights=!0,t.isShader("vertex")){var a=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(e.UniformsUtils.merge([e.UniformsLib.fog,e.UniformsLib.lights])),t.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];a&&i.push(a.code,a.result?"transformed = "+a.result+";":""),i.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),r=i.join("\n")}else{this.mask&&this.mask.analyze(t),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.alpha&&this.alpha.analyze(t),this.normal&&this.normal.analyze(t),this.light&&this.light.analyze(t,{cache:"light"}),this.ao&&this.ao.analyze(t),this.ambient&&this.ambient.analyze(t),this.shadow&&this.shadow.analyze(t),this.emissive&&this.emissive.analyze(t,{slot:"emissive"}),this.environment&&this.environment.analyze(t,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(t);var n=this.mask?this.mask.flow(t,"b"):void 0,o=this.color.flow(t,"c",{slot:"color"}),s=this.specular.flow(t,"c"),l=this.shininess.flow(t,"f"),u=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.normal?this.normal.flow(t,"v3"):void 0,h=this.light?this.light.flow(t,"v3",{cache:"light"}):void 0,d=this.ao?this.ao.flow(t,"f"):void 0,f=this.ambient?this.ambient.flow(t,"c"):void 0,p=this.shadow?this.shadow.flow(t,"c"):void 0,m=this.emissive?this.emissive.flow(t,"c",{slot:"emissive"}):void 0,v=this.environment?this.environment.flow(t,"c",{slot:"environment"}):void 0,g=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(t,"f"):void 0;t.requires.transparent=void 0!==u,t.addParsCode(["#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));i=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"];n&&i.push(n.code,"if ( ! "+n.result+" ) discard;"),i.push(o.code,"\tvec3 diffuseColor = "+o.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",s.code,"\tvec3 specular = "+s.result+";",l.code,"\tfloat shininess = max( 0.0001, "+l.result+" );","\tfloat specularStrength = 1.0;"),u&&i.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),c&&i.push(c.code,"normal = "+c.result+";"),i.push("material.diffuseColor = "+(h?"vec3( 1.0 )":"diffuseColor")+";"),i.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h&&(i.push(h.code,"reflectedLight.directDiffuse = "+h.result+";"),i.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),d&&i.push(d.code,"reflectedLight.indirectDiffuse *= "+d.result+";"),f&&i.push(f.code,"reflectedLight.indirectDiffuse += "+f.result+";"),p&&i.push(p.code,"reflectedLight.directDiffuse *= "+p.result+";","reflectedLight.directSpecular *= "+p.result+";"),m&&i.push(m.code,"reflectedLight.directDiffuse += "+m.result+";"),i.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),v&&(i.push(v.code),g?i.push(g.code,"outgoingLight = mix( outgoingLight, "+v.result+", "+g.result+" );"):i.push("outgoingLight = "+v.result+";")),u?i.push("gl_FragColor = vec4( outgoingLight, "+u.result+" );"):i.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),i.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>"),r=i.join("\n")}return r},or.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.specular=e.specular,this.shininess=e.shininess,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha),this},or.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t},sr.prototype=Object.create(Ke.prototype),sr.prototype.constructor=sr,sr.prototype.nodeType="Sprite",sr.prototype.build=function(t){if(t.define("SPRITE"),t.requires.lights=!1,t.requires.transparent=void 0!==this.alpha,t.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(e.UniformsUtils.merge([e.UniformsLib.fog])),t.addParsCode(["#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n")),o=["#include <clipping_planes_fragment>","#include <begin_vertex>"],r&&o.push(r.code,r.result?"transformed = "+r.result+";":""),o.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||o.push("modelMtx[1][1] = 1.0;"),o.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&o.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),o.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{t.addParsCode(["#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>"].join("\n")),t.addCode(["#include <clipping_planes_fragment>","#include <logdepthbuf_fragment>"].join("\n")),this.mask&&this.mask.analyze(t),this.alpha&&this.alpha.analyze(t),this.color.analyze(t,{slot:"color"});var a=this.mask?this.mask.flow(t,"b"):void 0,i=this.alpha?this.alpha.flow(t,"f"):void 0,n=this.color.flow(t,"c",{slot:"color"}),o=[];a&&o.push(a.code,"if ( ! "+a.result+" ) discard;"),i?o.push(i.code,"#ifdef ALPHATEST","if ( "+i.result+" <= ALPHATEST ) discard;","#endif",n.code,"gl_FragColor = vec4( "+n.result+", "+i.result+" );"):o.push(n.code,"gl_FragColor = vec4( "+n.result+", 1.0 );"),o.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return o.join("\n")},sr.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,void 0!==e.spherical&&(this.spherical=e.spherical),e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),this},sr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,!1===this.spherical&&(t.spherical=!1),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid)),t},lr.prototype=Object.create(er.prototype),lr.prototype.constructor=lr,Rt.addShortcuts(lr.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]),ur.prototype=Object.create(er.prototype),ur.prototype.constructor=ur,Rt.addShortcuts(ur.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]),cr.prototype=Object.create(er.prototype),cr.prototype.constructor=cr,Rt.addShortcuts(cr.prototype,"fragment",["color","alpha","mask","position"]),hr.prototype=Object.create(er.prototype),hr.prototype.constructor=hr,Rt.addShortcuts(hr.prototype,"fragment",["color","alpha","mask","position","spherical"]),dr.prototype=Object.create(Ke.prototype),dr.prototype.constructor=dr,dr.prototype.nodeType="Var",dr.prototype.getType=function(e){return e.getTypeByFormat(this.type)},dr.prototype.generate=function(e,t){var r=e.getVar(this.uuid,this.type);return this.value&&e.isShader("vertex")&&e.addNodeCode(r.name+" = "+this.value.build(e,this.getType(e))+";"),e.format(r.name,this.getType(e),t)},dr.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.type=e.type,this.value=e.value,this},dr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type,this.value&&(t.value=this.value.toJSON(e).uuid)),t},fr.prototype={constructor:fr,update:function(e){return++this.id,this.time+=e,this.delta=e,this},setRenderer:function(e){return this.renderer=e,this},setRenderTexture:function(e){return this.renderTexture=e,this},updateNode:function(e){return e.frameId===this.id||(e.updateFrame(this),e.frameId=this.id),this}},pr.prototype=Object.create(Ke.prototype),pr.prototype.constructor=pr,pr.prototype.nodeType="Attribute",pr.prototype.getAttributeType=function(e){return"number"==typeof this.type?e.getConstructorFromLength(this.type):this.type},pr.prototype.getType=function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)},pr.prototype.generate=function(e,t){var r=this.getAttributeType(e),a=e.getAttribute(this.name,r),i=e.isShader("vertex")?this.name:a.varying.name;return e.format(i,this.getType(e),t)},pr.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.type=e.type,this},pr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type),t},mr.Nodes={depthColor:new wt(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n"))},mr.POSITION="position",mr.DEPTH="depth",mr.TO_VERTEX="toVertex",mr.prototype=Object.create(qe.prototype),mr.prototype.constructor=mr,mr.prototype.nodeType="Camera",mr.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0!==e?this.onUpdateFrame:void 0},mr.prototype.setScope=function(e){switch(this.scope){case mr.DEPTH:delete this.near,delete this.far}switch(this.scope=e,e){case mr.DEPTH:var t=this.camera;this.near=new $e(t?t.near:1),this.far=new $e(t?t.far:1200)}},mr.prototype.getType=function(){switch(this.scope){case mr.DEPTH:return"f"}return this.type},mr.prototype.getUnique=function(){switch(this.scope){case mr.DEPTH:case mr.TO_VERTEX:return!0}return!1},mr.prototype.getShared=function(){switch(this.scope){case mr.POSITION:return!1}return!0},mr.prototype.generate=function(e,t){var r;switch(this.scope){case mr.POSITION:r="cameraPosition";break;case mr.DEPTH:r=e.include(mr.Nodes.depthColor)+"( "+this.near.build(e,"f")+", "+this.far.build(e,"f")+" )";break;case mr.TO_VERTEX:r="normalize( "+new Bt(Bt.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(r,this.getType(e),t)},mr.prototype.onUpdateFrame=function(){switch(this.scope){case mr.DEPTH:var e=this.camera;this.near.value=e.near,this.far.value=e.far}},mr.prototype.copy=function(e){switch(qe.prototype.copy.call(this,e),this.setScope(e.scope),e.camera&&this.setCamera(e.camera),e.scope){case mr.DEPTH:this.near.number=e.near,this.far.number=e.far}return this},mr.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch((t=this.createJSONNode(e)).scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case mr.DEPTH:t.near=this.near.value,t.far=this.far.value}return t},vr.TOTAL="total",vr.prototype=Object.create(qe.prototype),vr.prototype.constructor=vr,vr.prototype.nodeType="Light",vr.prototype.generate=function(e,t){return e.isCache("light")?e.format("reflectedLight.directDiffuse",this.type,t):(console.warn('THREE.LightNode is only compatible in "light" channel.'),e.format("vec3( 0.0 )",this.type,t))},vr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.scope=e.scope,this},vr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},gr.prototype=Object.create(_t.prototype),gr.prototype.constructor=gr,gr.prototype.nodeType="Resolution",gr.prototype.updateFrame=function(e){if(e.renderer){e.renderer.getSize(this.size);var t=e.renderer.getPixelRatio();this.x=this.size.width*t,this.y=this.size.height*t}else console.warn("ResolutionNode need a renderer in NodeFrame")},gr.prototype.copy=function(e){return _t.prototype.copy.call(this,e),this.renderer=e.renderer,this},gr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).renderer=this.renderer.uuid),t},yr.prototype=Object.create(qe.prototype),yr.prototype.constructor=yr,yr.prototype.nodeType="ScreenUV",yr.prototype.generate=function(e,t){var r;return e.isShader("fragment")?r="( gl_FragCoord.xy / "+this.resolution.build(e,"v2")+")":(console.warn("THREE.ScreenUVNode is not compatible with "+e.shader+" shader."),r="vec2( 0.0 )"),e.format(r,this.getType(e),t)},yr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.resolution=e.resolution,this},yr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).resolution=this.resolution.toJSON(e).uuid),t};var xr=["color","color2"],br=["vColor","vColor2"];function Ar(e){qe.call(this,"v4",{shared:!1}),this.index=e||0}function wr(e,t){Ke.call(this),this.code=e,this.value=t}function Mr(t,r){Ht.call(this),this.params={},this.velocity=new e.Vector3,this.setTarget(t),this.setParams(r)}function Sr(e){qe.call(this),this.slots=e||{}}function Tr(t){Ze.call(this,"m3"),this.value=t||new e.Matrix3}function Cr(e,t){St.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=e||new It,this.position=t||new Tr}Ar.prototype=Object.create(qe.prototype),Ar.prototype.constructor=Ar,Ar.prototype.nodeType="Colors",Ar.prototype.generate=function(e,t){e.requires.color[this.index]=!0;var r=e.isShader("vertex")?xr[this.index]:br[this.index];return e.format(r,this.getType(e),t)},Ar.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.index=e.index,this},Ar.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},wr.prototype=Object.create(Ke.prototype),wr.prototype.constructor=wr,wr.prototype.nodeType="Bypass",wr.prototype.getType=function(e){return this.value?this.value.getType(e):e.isShader("fragment")?"f":"void"},wr.prototype.generate=function(e,t){var r=this.code.build(e,t)+";";return e.addNodeCode(r),e.isShader("vertex")?this.value?this.value.build(e,t):void 0:this.value?this.value.build(e,t):e.format("0.0","f",t)},wr.prototype.copy=function(e){return Ke.prototype.copy.call(this,e),this.code=e.code,this.value=e.value,this},wr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).code=this.code.toJSON(e).uuid,this.value&&(t.value=this.value.toJSON(e).uuid)),t},Mr.prototype=Object.create(Ht.prototype),Mr.prototype.constructor=Mr,Mr.prototype.nodeType="Velocity",Mr.prototype.getReadonly=function(){return!1},Mr.prototype.setParams=function(t){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=t||{},this.params.type){case"elastic":this.moment=new e.Vector3,this.speed=new e.Vector3,this.springVelocity=new e.Vector3,this.lastVelocity=new e.Vector3}},Mr.prototype.setTarget=function(t){this.target&&(delete this.position,delete this.oldPosition),this.target=t,t&&(this.position=t.getWorldPosition(this.position||new e.Vector3),this.oldPosition=this.position.clone())},Mr.prototype.updateFrameVelocity=function(){this.target&&(this.position=this.target.getWorldPosition(this.position||new e.Vector3),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},Mr.prototype.updateFrame=function(e){switch(this.updateFrameVelocity(e),this.params.type){case"elastic":var t=e.delta*(this.params.fps||60),r=Math.pow(this.params.spring,t),a=Math.pow(this.params.damping,t);this.velocity.multiplyScalar(Math.exp(-this.params.damping*t)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(a).multiplyScalar(1-r)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(r),this.moment.add(this.springVelocity),this.moment.multiplyScalar(a),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},Mr.prototype.copy=function(e){return Ht.prototype.copy.call(this,e),e.target&&this.setTarget(e.target),this.setParams(e.params),this},Mr.prototype.toJSON=function(e){var t=Ht.prototype.toJSON.call(this,e);return this.target&&(t.target=this.target.uuid),t.params=JSON.parse(JSON.stringify(this.params)),t},Sr.prototype=Object.create(qe.prototype),Sr.prototype.constructor=Sr,Sr.prototype.nodeType="SubSlot",Sr.prototype.getType=function(e,t){return t},Sr.prototype.generate=function(e,t){return this.slots[e.slot]?this.slots[e.slot].build(e,t):e.format("0.0","f",t)},Sr.prototype.copy=function(e){for(var t in qe.prototype.copy.call(this,e),e.slots)this.slots[t]=e.slots[t];return this},Sr.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)for(var r in(t=this.createJSONNode(e)).slots={},this.slots){var a=this.slots[r];a&&(t.slots[r]=a.toJSON(e).uuid)}return t},Tr.prototype=Object.create(Ze.prototype),Tr.prototype.constructor=Tr,Tr.prototype.nodeType="Matrix3",Object.defineProperties(Tr.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Tr.prototype.generateReadonly=function(e,t,r,a){return e.format("mat3( "+this.value.elements.join(", ")+" )",a,t)},Tr.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value.fromArray(e.elements),this},Tr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},Cr.prototype=Object.create(St.prototype),Cr.prototype.constructor=Cr,Cr.prototype.nodeType="UVTransform",Cr.prototype.generate=function(e,t){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,St.prototype.generate.call(this,e,t)},Cr.prototype.setUvTransform=function(e,t,r,a,i,n,o){n=void 0!==n?n:.5,o=void 0!==o?o:.5,this.position.value.setUvTransform(e,t,r,a,i,n,o)},Cr.prototype.copy=function(e){return St.prototype.copy.call(this,e),this.uv=e.uv,this.position=e.position,this},Cr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.position=this.position.toJSON(e).uuid),t};var Fr,Er=Rt.elements;function Br(e,t,r,a){qe.call(this,"f"),this.x=e,this.y=t,this.z=r,this.w=a}function Lr(e,t,r){$e.call(this),this.scale=void 0!==e?e:1,this.scope=t||Lr.GLOBAL,this.timeScale=void 0!==r?r:void 0!==e}function Pr(e,t,r,a,i){qe.call(this),this.a=e,this.b=t,this.op=r,this.ifNode=a,this.elseNode=i}function Dr(e){Ze.call(this,"b"),this.value=Boolean(e)}function Nr(e){Ze.call(this,"i"),this.value=Math.floor(e||0)}function Rr(t){Ze.call(this,"m4"),this.value=t||new e.Matrix4}function _r(e){Xt.call(this,void 0,e)}function Ir(e){qe.call(this,"v4"),e&&this.setMirror(e)}function Or(t,r,a,i){i=i||{},this.input=a,this.clear=void 0===i.clear||i.clear,this.renderTarget=new e.WebGLRenderTarget(t,r,i),this.material=new er,this.camera=new e.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new e.Scene,this.quad=new e.Mesh(new e.PlaneGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.render=!0,Xt.call(this,this.renderTarget.texture)}function Ur(e){qe.call(this,"f"),this.uv=e||new It}function kr(e){qe.call(this,"f"),this.uv=e||new It}function Vr(e,t,r,a){qe.call(this,"v4"),this.value=e,this.uv=t||new It,this.radius=r||new _t(1,1),this.size=a,this.blurX=!0,this.blurY=!0,this.horizontal=new $e(1/64),this.vertical=new $e(1/64)}function Gr(e){qe.call(this,"f"),this.rgb=e}function jr(e,t,r){qe.call(this,"v3"),this.rgb=e,this.adjustment=t,this.method=r||jr.SATURATION}function zr(t,r){if(void 0===r){var a={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat},i=t.getDrawingBufferSize(new e.Vector2);r=new e.WebGLRenderTarget(i.width,i.height,a)}this.renderer=t,this.renderTarget=r,this.output=new _r,this.material=new er,this.camera=new e.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new e.Scene,this.quad=new e.Mesh(new e.PlaneGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.needsUpdate=!0}Br.prototype=Object.create(qe.prototype),Br.prototype.constructor=Br,Br.prototype.nodeType="Join",Br.prototype.getNumElements=function(){for(var e=Er.length;e--;)if(void 0!==this[Er[e]]){++e;break}return Math.max(e,2)},Br.prototype.getType=function(e){return e.getTypeFromLength(this.getNumElements())},Br.prototype.generate=function(e,t){for(var r=this.getType(e),a=this.getNumElements(),i=[],n=0;n<a;n++){var o=this[Er[n]];i.push(o?o.build(e,"f"):"0.0")}var s=(a>1?e.getConstructorFromLength(a):"")+"( "+i.join(", ")+" )";return e.format(s,r,t)},Br.prototype.copy=function(e){for(var t in qe.prototype.copy.call(this,e),e.inputs)this[t]=e.inputs[t];return this},Br.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){(t=this.createJSONNode(e)).inputs={};for(var r=this.getNumElements(),a=0;a<r;a++){var i=this[Er[a]];i&&(t.inputs[Er[a]]=i.toJSON(e).uuid)}}return t},Lr.GLOBAL="global",Lr.LOCAL="local",Lr.DELTA="delta",Lr.prototype=Object.create($e.prototype),Lr.prototype.constructor=Lr,Lr.prototype.nodeType="Timer",Lr.prototype.getReadonly=function(){return!1},Lr.prototype.getUnique=function(){return this.timeScale&&(this.scope===Lr.GLOBAL||this.scope===Lr.DELTA)},Lr.prototype.updateFrame=function(e){var t=this.timeScale?this.scale:1;switch(this.scope){case Lr.LOCAL:this.value+=e.delta*t;break;case Lr.DELTA:this.value=e.delta*t;break;default:this.value=e.time*t}},Lr.prototype.copy=function(e){return $e.prototype.copy.call(this,e),this.scope=e.scope,this.scale=e.scale,this.timeScale=e.timeScale,this},Lr.prototype.toJSON=function(e){var t=$e.prototype.toJSON.call(this,e);return t.scope=this.scope,t.scale=this.scale,t.timeScale=this.timeScale,t},xt.addKeyword("time",(function(){return new Lr})),Pr.EQUAL="==",Pr.NOT_EQUAL="!=",Pr.GREATER=">",Pr.GREATER_EQUAL=">=",Pr.LESS="<",Pr.LESS_EQUAL="<=",Pr.AND="&&",Pr.OR="||",Pr.prototype=Object.create(qe.prototype),Pr.prototype.constructor=Pr,Pr.prototype.nodeType="Cond",Pr.prototype.getType=function(e){if(this.ifNode){var t=this.ifNode.getType(e),r=this.elseNode.getType(e);return e.getTypeLength(r)>e.getTypeLength(t)?r:t}return"b"},Pr.prototype.getCondType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},Pr.prototype.generate=function(e,t){var r,a=this.getType(e),i=this.getCondType(e),n=this.a.build(e,i),o=this.b.build(e,i);if(this.ifNode){var s=this.ifNode.build(e,a),l=this.elseNode.build(e,a);r="( "+[n,this.op,o,"?",s,":",l].join(" ")+" )"}else r="( "+n+" "+this.op+" "+o+" )";return e.format(r,this.getType(e),t)},Pr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op,this.ifNode=e.ifNode,this.elseNode=e.elseNode,this},Pr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op,t.ifNode&&(t.ifNode=this.ifNode.toJSON(e).uuid),t.elseNode&&(t.elseNode=this.elseNode.toJSON(e).uuid)),t},Dr.prototype=Object.create(Ze.prototype),Dr.prototype.constructor=Dr,Dr.prototype.nodeType="Bool",Dr.prototype.generateReadonly=function(e,t,r,a){return e.format(this.value,a,t)},Dr.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value=e.value,this},Dr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},Nr.prototype=Object.create(Ze.prototype),Nr.prototype.constructor=Nr,Nr.prototype.nodeType="Int",Nr.prototype.generateReadonly=function(e,t,r,a){return e.format(this.value,a,t)},Nr.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.value=e.value,this},Nr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},Rr.prototype=Object.create(Ze.prototype),Rr.prototype.constructor=Rr,Rr.prototype.nodeType="Matrix4",Object.defineProperties(Rr.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Rr.prototype.generateReadonly=function(e,t,r,a){return e.format("mat4( "+this.value.elements.join(", ")+" )",a,t)},Rr.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.scope.value.fromArray(e.elements),this},Rr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},_r.prototype=Object.create(Xt.prototype),_r.prototype.constructor=_r,_r.prototype.nodeType="Screen",_r.prototype.getUnique=function(){return!0},_r.prototype.getTexture=function(e,t){return Ze.prototype.generate.call(this,e,t,this.getUuid(),"t","renderTexture")},Ir.prototype=Object.create(qe.prototype),Ir.prototype.constructor=Ir,Ir.prototype.nodeType="Reflector",Ir.prototype.setMirror=function(e){this.mirror=e,this.textureMatrix=new Rr(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new Bt(Bt.LOCAL),this.uv=new Tt(this.textureMatrix,this.localPosition,Tt.MUL),this.uvResult=new Tt(null,this.uv,Tt.ADD),this.texture=new Xt(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},Ir.prototype.generate=function(e,t){return e.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===t?this.texture.build(e,t):e.format(this.texture.build(e,this.type),this.type,t)):(console.warn("THREE.ReflectorNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.type,t))},Ir.prototype.copy=function(e){return Ze.prototype.copy.call(this,e),this.scope.mirror=e.mirror,this},Ir.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).mirror=this.mirror.uuid,this.offset&&(t.offset=this.offset.toJSON(e).uuid)),t},Or.prototype=Object.create(Xt.prototype),Or.prototype.constructor=Or,Or.prototype.nodeType="RTT",Or.prototype.build=function(e,t,r){var a=new Zt;return a.nodes=e.nodes,a.updaters=e.updaters,this.material.fragment.value=this.input,this.material.build({builder:a}),Xt.prototype.build.call(this,e,t,r)},Or.prototype.updateFramesaveTo=function(t){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var r=new er;r.fragment.value=this,r.build();var a=new e.Scene,i=new e.Mesh(new e.PlaneGeometry(2,2),r);i.frustumCulled=!1,a.add(i),this.saveToScene=a,this.saveToMaterial=r}this.saveToCurrent=this.saveTo,t.renderer.setRenderTarget(this.saveTo.renderTarget),this.saveTo.clear&&t.renderer.clear(),t.renderer.render(this.saveToScene,this.camera)},Or.prototype.updateFrame=function(e){e.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(e),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=e.renderTexture),e.renderer.setRenderTarget(this.renderTarget),this.clear&&e.renderer.clear(),e.renderer.render(this.scene,this.camera)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(e)):console.warn("RTTNode need a renderer in NodeFrame")},Or.prototype.copy=function(e){return Xt.prototype.copy.call(this,e),this.saveTo=e.saveTo,this},Or.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=Xt.prototype.toJSON.call(this,e),this.saveTo&&(t.saveTo=this.saveTo.toJSON(e).uuid)),t},Ur.prototype=Object.create(qe.prototype),Ur.prototype.constructor=Ur,Ur.prototype.nodeType="Noise",Ur.Nodes={snoise:new wt(["float snoise(vec2 co) {","\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}"].join("\n"))},Ur.prototype.generate=function(e,t){var r=e.include(Ur.Nodes.snoise);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},Ur.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.uv=e.uv,this},Ur.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},kr.prototype=Object.create(qe.prototype),kr.prototype.constructor=kr,kr.prototype.nodeType="Noise",kr.Nodes={checker:new wt(["float checker( vec2 uv ) {","\tfloat cx = floor( uv.x );","\tfloat cy = floor( uv.y ); ","\tfloat result = mod( cx + cy, 2.0 );","\treturn sign( result );","}"].join("\n"))},kr.prototype.generate=function(e,t){var r=e.include(kr.Nodes.checker);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},kr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.uv=e.uv,this},kr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},Vr.Nodes={blurX:new wt(["vec4 blurX( sampler2D tex, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tex, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( tex, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( tex, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( tex, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( tex, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( tex, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( tex, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( tex, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum * .667;","}"].join("\n")),blurY:new wt(["vec4 blurY( sampler2D tex, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tex, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( tex, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( tex, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( tex, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( tex, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( tex, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( tex, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( tex, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum * .667;","}"].join("\n"))},Vr.prototype=Object.create(qe.prototype),Vr.prototype.constructor=Vr,Vr.prototype.nodeType="Blur",Vr.prototype.hashProperties=["blurX","blurY"],Vr.prototype.updateFrame=function(){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var e=this.value.value.image;this.horizontal.value=this.radius.x/e.width,this.vertical.value=this.radius.y/e.height}},Vr.prototype.generate=function(e,t){if(e.isShader("fragment")){var r,a=[],i=e.include(Vr.Nodes.blurX),n=e.include(Vr.Nodes.blurY);return this.blurX&&a.push(i+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.horizontal.build(e,"f")+" )"),this.blurY&&a.push(n+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.vertical.build(e,"f")+" )"),r=2==a.length?"( "+a.join(" + ")+" / 2.0 )":a.length?"( "+a[0]+" )":"vec4( 0.0 )",e.format(r,this.getType(e),t)}return console.warn("THREE.BlurNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},Vr.prototype.copy=function(t){return qe.prototype.copy.call(this,t),this.value=t.value,this.uv=t.uv,this.radius=t.radius,void 0!==t.size&&(this.size=new e.Vector2(t.size.x,t.size.y)),this.blurX=t.blurX,this.blurY=t.blurY,this},Vr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.radius=this.radius.toJSON(e).uuid,this.size&&(t.size={x:this.size.x,y:this.size.y}),t.blurX=this.blurX,t.blurY=this.blurY),t},Gr.Nodes={LUMA:Fr=new tt("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )"),luminance:new wt(["float luminance( vec3 rgb ) {","\treturn dot( rgb, LUMA );","}"].join("\n"),[Fr])},Gr.prototype=Object.create(qe.prototype),Gr.prototype.constructor=Gr,Gr.prototype.nodeType="Luminance",Gr.prototype.generate=function(e,t){var r=e.include(Gr.Nodes.luminance);return e.format(r+"( "+this.rgb.build(e,"v3")+" )",this.getType(e),t)},Gr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.rgb=e.rgb,this},Gr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid),t},jr.Nodes={hue:new wt(["vec3 hue(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n")),saturation:new wt(["vec3 saturation(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3( luminance( rgb ) );","\treturn mix( intensity, rgb, adjustment );","}"].join("\n"),[Gr.Nodes.luminance]),vibrance:new wt(["vec3 vibrance(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))},jr.SATURATION="saturation",jr.HUE="hue",jr.VIBRANCE="vibrance",jr.BRIGHTNESS="brightness",jr.CONTRAST="contrast",jr.prototype=Object.create(qe.prototype),jr.prototype.constructor=jr,jr.prototype.nodeType="ColorAdjustment",jr.prototype.hashProperties=["method"],jr.prototype.generate=function(e,t){var r=this.rgb.build(e,"v3"),a=this.adjustment.build(e,"f");switch(this.method){case jr.BRIGHTNESS:return e.format("( "+r+" + "+a+" )",this.getType(e),t);case jr.CONTRAST:return e.format("( "+r+" * "+a+" )",this.getType(e),t)}var i=e.include(jr.Nodes[this.method]);return e.format(i+"( "+r+", "+a+" )",this.getType(e),t)},jr.prototype.copy=function(e){return qe.prototype.copy.call(this,e),this.rgb=e.rgb,this.adjustment=e.adjustment,this.method=e.method,this},jr.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid,t.adjustment=this.adjustment.toJSON(e).uuid,t.method=this.method),t},zr.prototype={constructor:zr,render:function(e,t,r){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.output,this.material.build(),this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=this.renderTarget.texture),this.needsUpdate=!1),r.setRenderer(this.renderer).setRenderTexture(this.renderTarget.texture),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(e,t),r.updateNode(this.material),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},setPixelRatio:function(t){this.renderer.setPixelRatio(t);var r=this.renderer.getSize(new e.Vector2);this.setSize(r.width,r.height)},setSize:function(e,t){var r=this.renderer.getPixelRatio();this.renderTarget.setSize(e*r,t*r),this.renderer.setSize(e,t)},copy:function(e){return this.output=e.output,this},toJSON:function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.post&&(e.post={}),!e.post[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePostProcessing",e.post[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.output=this.output.toJSON(e).uuid}return e.post=this.uuid,e}};var Hr=Object.freeze({__proto__:null,Node:Ke,TempNode:qe,InputNode:Ze,ConstNode:tt,VarNode:dr,StructNode:it,AttributeNode:pr,FunctionNode:wt,ExpressionNode:St,FunctionCallNode:Mt,NodeLib:xt,NodeUtils:Rt,NodeFrame:fr,NodeUniform:zt,NodeBuilder:Zt,BoolNode:Dr,IntNode:Nr,FloatNode:$e,Vector2Node:_t,Vector3Node:Ht,Vector4Node:Wt,ColorNode:kt,Matrix3Node:Tr,Matrix4Node:Rr,TextureNode:Xt,CubeTextureNode:Qt,ScreenNode:_r,ReflectorNode:Ir,PropertyNode:ar,RTTNode:Or,UVNode:It,ColorsNode:Ar,PositionNode:Bt,NormalNode:Lt,CameraNode:mr,LightNode:vr,ReflectNode:Pt,ScreenUVNode:yr,ResolutionNode:gr,MathNode:Ct,OperatorNode:Tt,CondNode:Pr,NoiseNode:Ur,CheckerNode:kr,TextureCubeUVNode:Et,TextureCubeNode:Dt,NormalMapNode:Ot,BumpMapNode:Ut,BypassNode:wr,JoinNode:Br,SwitchNode:ir,TimerNode:Lr,VelocityNode:Mr,UVTransformNode:Cr,MaxMIPLevelNode:Vt,SpecularMIPLevelNode:Gt,ColorSpaceNode:Ft,SubSlotNode:Sr,BlurNode:Vr,ColorAdjustmentNode:jr,LuminanceNode:Gr,RawNode:$t,BasicNode:rr,SpriteNode:sr,PhongNode:or,StandardNode:jt,MeshStandardNode:nr,NodeMaterial:er,BasicNodeMaterial:cr,SpriteNodeMaterial:hr,PhongNodeMaterial:lr,StandardNodeMaterial:tr,MeshStandardNodeMaterial:ur,NodePostProcessing:zr}),Wr=function(){function e(){b.default(this,"enabled",!0),b.default(this,"needsSwap",!0),b.default(this,"clear",!1),b.default(this,"renderToScreen",!1)}var t=e.prototype;return t.setSize=function(e,t){},t.render=function(e,t,r,a,i){console.error("THREE.Pass: .render() must be implemented in derived pass.")},e}(),Xr=function(){function t(t){b.default(this,"camera",new e.OrthographicCamera(-1,1,1,-1,0,1)),b.default(this,"geometry",new e.PlaneGeometry(2,2)),b.default(this,"mesh",void 0),this.mesh=new e.Mesh(this.geometry,t)}var r=t.prototype;return r.dispose=function(){this.mesh.geometry.dispose()},r.render=function(e){e.render(this.mesh,this.camera)},A.default(t,[{key:"material",get:function(){return this.mesh.material},set:function(e){this.mesh.material=e}}]),t}(),Qr=function(t){function r(r,a){var i;return void 0===a&&(a="tDiffuse"),i=t.call(this)||this,b.default(x.default(i),"textureID",void 0),b.default(x.default(i),"uniforms",void 0),b.default(x.default(i),"material",void 0),b.default(x.default(i),"fsQuad",void 0),i.textureID=a,r instanceof e.ShaderMaterial?(i.uniforms=r.uniforms,i.material=r):(i.uniforms=e.UniformsUtils.clone(r.uniforms),i.material=new e.ShaderMaterial({defines:Object.assign({},r.defines),uniforms:i.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader})),i.fsQuad=new Xr(i.material),i}return g.default(r,t),r.prototype.render=function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))},r}(Wr);function Yr(){Qr.call(this),this.name="",this.uuid=e.MathUtils.generateUUID(),this.userData={},this.textureID="renderTexture",this.input=new _r,this.material=new er,this.needsUpdate=!0}Yr.prototype=Object.create(Qr.prototype),Yr.prototype.constructor=Yr,Yr.prototype.render=function(){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.input,this.needsUpdate=!1),this.uniforms=this.material.uniforms,Qr.prototype.render.apply(this,arguments)},Yr.prototype.copy=function(e){return this.input=e.input,this},Yr.prototype.toJSON=function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.passes&&(e.passes={}),!e.passes[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePass",e.passes[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.input=this.input.toJSON(e).uuid}return e.pass=this.uuid,e};var Jr=function(){function t(){this.pluginCallbacks=[],this.register((function(e){return new B(e)})),this.register((function(e){return new L(e)})),this.register((function(e){return new P(e)}))}t.prototype={constructor:t,register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,r){for(var a=new E,i=[],n=0,o=this.pluginCallbacks.length;n<o;n++)i.push(this.pluginCallbacks[n](a));a.setPlugins(i),a.write(e,t,r)}};var r=0,a=1,i=2,n=3,o=4,s=5121,l=5123,u=5126,c=5125,h=34962,d=34963,f=9728,p=9729,m=9984,v=9985,g=9986,y=9987,x=33071,b=33648,A=10497,w={};w[e.NearestFilter]=f,w[e.NearestMipmapNearestFilter]=m,w[e.NearestMipmapLinearFilter]=g,w[e.LinearFilter]=p,w[e.LinearMipmapNearestFilter]=v,w[e.LinearMipmapLinearFilter]=y,w[e.ClampToEdgeWrapping]=x,w[e.RepeatWrapping]=A,w[e.MirroredRepeatWrapping]=b;var M={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function S(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}function T(e){return 4*Math.ceil(e/4)}function C(e,t){t=t||0;var r=T(e.byteLength);if(r!==e.byteLength){var a=new Uint8Array(r);if(a.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<r;i++)a[i]=t;return a.buffer}return e}var F=null;function E(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}function B(e){this.writer=e,this.name="KHR_lights_punctual"}function L(e){this.writer=e,this.name="KHR_materials_unlit"}function P(e){this.writer=e,this.name="KHR_materials_pbrSpecularGlossiness"}return E.prototype={constructor:E,setPlugins:function(e){this.plugins=e},write:function(e,t,r){this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e);var a=this;Promise.all(this.pending).then((function(){var e,r=a.buffers,i=a.json,n=a.options,o=a.extensionsUsed,s=new Blob(r,{type:"application/octet-stream"}),l=Object.keys(o);(l.length>0&&(i.extensionsUsed=l),i.buffers&&i.buffers.length>0&&(i.buffers[0].byteLength=s.size),!0===n.binary)?((e=new window.FileReader).readAsArrayBuffer(s),e.onloadend=function(){var r=C(e.result),a=new DataView(new ArrayBuffer(8));a.setUint32(0,r.byteLength,!0),a.setUint32(4,5130562,!0);var n=C(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,a=e.length;r<a;r++){var i=e.charCodeAt(r);t[r]=i>255?32:i}return t.buffer}(JSON.stringify(i)),32),o=new DataView(new ArrayBuffer(8));o.setUint32(0,n.byteLength,!0),o.setUint32(4,1313821514,!0);var s=new ArrayBuffer(12),l=new DataView(s);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);var u=12+o.byteLength+n.byteLength+a.byteLength+r.byteLength;l.setUint32(8,u,!0);var c=new Blob([s,o,n,a,r],{type:"application/octet-stream"}),h=new window.FileReader;h.readAsArrayBuffer(c),h.onloadend=function(){t(h.result)}}):i.buffers&&i.buffers.length>0?((e=new window.FileReader).readAsDataURL(s),e.onloadend=function(){var r=e.result;i.buffers[0].uri=r,t(i)}):t(i)}))},serializeUserData:function(e,t){if(0!==Object.keys(e.userData).length){var r=this.options,a=this.extensionsUsed;try{var i=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&i.gltfExtensions){for(var n in void 0===t.extensions&&(t.extensions={}),i.gltfExtensions)t.extensions[n]=i.gltfExtensions[n],a[n]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(t.extras=i)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}},getUID:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)},isNormalizedNormalAttribute:function(t){if(this.cache.attributesNormalized.has(t))return!1;for(var r=new e.Vector3,a=0,i=t.count;a<i;a++)if(Math.abs(r.fromBufferAttribute(t,a).length()-1)>5e-4)return!1;return!0},createNormalizedNormalAttribute:function(t){var r=this.cache;if(r.attributesNormalized.has(t))return r.attributesNormalized.get(t);for(var a=t.clone(),i=new e.Vector3,n=0,o=a.count;n<o;n++)i.fromBufferAttribute(a,n),0===i.x&&0===i.y&&0===i.z?i.setX(1):i.normalize(),a.setXYZ(n,i.x,i.y,i.z);return r.attributesNormalized.set(t,a),a},applyTextureTransform:function(e,t){var r=!1,a={};0===t.offset.x&&0===t.offset.y||(a.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(a.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(a.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=a,this.extensionsUsed.KHR_texture_transform=!0)},processBuffer:function(e){var t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0},processBufferView:function(e,t,r,a,i){var n,o=this.json;o.bufferViews||(o.bufferViews=[]),n=t===s?1:t===l?2:4;for(var d=T(a*e.itemSize*n),f=new DataView(new ArrayBuffer(d)),p=0,m=r;m<r+a;m++)for(var v=0;v<e.itemSize;v++){var g=void 0;e.itemSize>4?g=e.array[m*e.itemSize+v]:0===v?g=e.getX(m):1===v?g=e.getY(m):2===v?g=e.getZ(m):3===v&&(g=e.getW(m)),t===u?f.setFloat32(p,g,!0):t===c?f.setUint32(p,g,!0):t===l?f.setUint16(p,g,!0):t===s&&f.setUint8(p,g),p+=n}var y={buffer:this.processBuffer(f.buffer),byteOffset:this.byteOffset,byteLength:d};return void 0!==i&&(y.target=i),i===h&&(y.byteStride=e.itemSize*n),this.byteOffset+=d,o.bufferViews.push(y),{id:o.bufferViews.length-1,byteLength:0}},processBufferViewImage:function(e){var t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise((function(a){var i=new window.FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){var e=C(i.result),n={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,a(r.bufferViews.push(n)-1)}}))},processAccessor:function(e,t,r,a){var i,n=this.options,o=this.json;if(e.array.constructor===Float32Array)i=u;else if(e.array.constructor===Uint32Array)i=c;else if(e.array.constructor===Uint16Array)i=l;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");i=s}if(void 0===r&&(r=0),void 0===a&&(a=e.count),n.truncateDrawRange&&void 0!==t&&null===t.index){var f=r+a,p=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;r=Math.max(r,t.drawRange.start),(a=Math.min(f,p)-r)<0&&(a=0)}if(0===a)return null;var m,v=function(e,t,r){for(var a={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+r;i++)for(var n=0;n<e.itemSize;n++){var o=void 0;e.itemSize>4?o=e.array[i*e.itemSize+n]:0===n?o=e.getX(i):1===n?o=e.getY(i):2===n?o=e.getZ(i):3===n&&(o=e.getW(i)),a.min[n]=Math.min(a.min[n],o),a.max[n]=Math.max(a.max[n],o)}return a}(e,r,a);void 0!==t&&(m=e===t.index?d:h);var g=this.processBufferView(e,i,r,a,m),y={bufferView:g.id,byteOffset:g.byteOffset,componentType:i,count:a,max:v.max,min:v.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(y.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(y)-1},processImage:function(t,r,a){var i=this,n=i.cache,o=i.json,s=i.options,l=i.pending;n.images.has(t)||n.images.set(t,{});var u=n.images.get(t),c=r===e.RGBAFormat?"image/png":"image/jpeg",h=c+":flipY/"+a.toString();if(void 0!==u[h])return u[h];o.images||(o.images=[]);var d={mimeType:c};if(s.embedImages){var f=F=F||document.createElement("canvas");f.width=Math.min(t.width,s.maxTextureSize),f.height=Math.min(t.height,s.maxTextureSize);var p=f.getContext("2d");if(!0===a&&(p.translate(0,f.height),p.scale(1,-1)),"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)p.drawImage(t,0,0,f.width,f.height);else{r!==e.RGBAFormat&&r!==e.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(t.width>s.maxTextureSize||t.height>s.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",t);var m=t.data;if(r===e.RGBFormat){m=new Uint8ClampedArray(t.height*t.width*4);for(var v=0,g=0;v<m.length;v+=4,g+=3)m[v+0]=t.data[g+0],m[v+1]=t.data[g+1],m[v+2]=t.data[g+2],m[v+3]=255}p.putImageData(new ImageData(m,t.width,t.height),0,0)}!0===s.binary?l.push(new Promise((function(e){f.toBlob((function(t){i.processBufferViewImage(t).then((function(t){d.bufferView=t,e()}))}),c)}))):d.uri=f.toDataURL(c)}else d.uri=t.src;var y=o.images.push(d)-1;return u[h]=y,y},processSampler:function(e){var t=this.json;t.samplers||(t.samplers=[]);var r={magFilter:w[e.magFilter],minFilter:w[e.minFilter],wrapS:w[e.wrapS],wrapT:w[e.wrapT]};return t.samplers.push(r)-1},processTexture:function(e){var t=this.cache,r=this.json;if(t.textures.has(e))return t.textures.get(e);r.textures||(r.textures=[]);var a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(a.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,a)}));var i=r.textures.push(a)-1;return t.textures.set(e,i),i},processMaterial:function(t){var r=this.cache,a=this.json;if(r.materials.has(t))return r.materials.get(t);if(t.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;a.materials||(a.materials=[]);var i={pbrMetallicRoughness:{}};!0!==t.isMeshStandardMaterial&&!0!==t.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var n=t.color.toArray().concat([t.opacity]);if(S(n,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=n),t.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=t.metalness,i.pbrMetallicRoughness.roughnessFactor=t.roughness):(i.pbrMetallicRoughness.metallicFactor=.5,i.pbrMetallicRoughness.roughnessFactor=.5),t.metalnessMap||t.roughnessMap)if(t.metalnessMap===t.roughnessMap){var o={index:this.processTexture(t.metalnessMap)};this.applyTextureTransform(o,t.metalnessMap),i.pbrMetallicRoughness.metallicRoughnessTexture=o}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(t.map){var s={index:this.processTexture(t.map)};this.applyTextureTransform(s,t.map),i.pbrMetallicRoughness.baseColorTexture=s}if(t.emissive){var l=t.emissive.clone().multiplyScalar(t.emissiveIntensity).toArray();if(S(l,[0,0,0])||(i.emissiveFactor=l),t.emissiveMap){var u={index:this.processTexture(t.emissiveMap)};this.applyTextureTransform(u,t.emissiveMap),i.emissiveTexture=u}}if(t.normalMap){var c={index:this.processTexture(t.normalMap)};t.normalScale&&-1!==t.normalScale.x&&(t.normalScale.x!==t.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),c.scale=t.normalScale.x),this.applyTextureTransform(c,t.normalMap),i.normalTexture=c}if(t.aoMap){var h={index:this.processTexture(t.aoMap),texCoord:1};1!==t.aoMapIntensity&&(h.strength=t.aoMapIntensity),this.applyTextureTransform(h,t.aoMap),i.occlusionTexture=h}t.transparent?i.alphaMode="BLEND":t.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=t.alphaTest),t.side===e.DoubleSide&&(i.doubleSided=!0),""!==t.name&&(i.name=t.name),this.serializeUserData(t,i),this._invokeAll((function(e){e.writeMaterial&&e.writeMaterial(t,i)}));var d=a.materials.push(i)-1;return r.materials.set(t,d),d},processMesh:function(t){var s=this.cache,l=this.json,u=[t.geometry.uuid];if(Array.isArray(t.material))for(var c=0,h=t.material.length;c<h;c++)u.push(t.material[c].uuid);else u.push(t.material.uuid);var d=u.join(":");if(s.meshes.has(d))return s.meshes.get(d);var f,p=t.geometry;if(f=t.isLineSegments?a:t.isLineLoop?i:t.isLine?n:t.isPoints?r:t.material.wireframe?a:o,!0!==p.isBufferGeometry)throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");var m={},v={},g=[],y=[],x={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},b=p.getAttribute("normal");void 0===b||this.isNormalizedNormalAttribute(b)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),p.setAttribute("normal",this.createNormalizedNormalAttribute(b)));var A=null;for(var w in p.attributes)if("morph"!==w.substr(0,5)){var M=p.attributes[w];w=x[w]||w.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(w)||(w="_"+w),s.attributes.has(this.getUID(M)))v[w]=s.attributes.get(this.getUID(M));else{A=null;var S=M.array;"JOINTS_0"!==w||S instanceof Uint16Array||S instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),A=new e.BufferAttribute(new Uint16Array(S),M.itemSize,M.normalized));var T=this.processAccessor(A||M,p);null!==T&&(v[w]=T,s.attributes.set(this.getUID(M),T))}}if(void 0!==b&&p.setAttribute("normal",b),0===Object.keys(v).length)return null;if(void 0!==t.morphTargetInfluences&&t.morphTargetInfluences.length>0){var C=[],F=[],E={};if(void 0!==t.morphTargetDictionary)for(var B in t.morphTargetDictionary)E[t.morphTargetDictionary[B]]=B;for(var L=0;L<t.morphTargetInfluences.length;++L){var P={},D=!1;for(var N in p.morphAttributes)if("position"===N||"normal"===N){M=p.morphAttributes[N][L];var R=N.toUpperCase(),_=p.attributes[N];if(s.attributes.has(this.getUID(M)))P[R]=s.attributes.get(this.getUID(M));else{var I=M.clone();if(!p.morphTargetsRelative)for(var O=0,U=M.count;O<U;O++)I.setXYZ(O,M.getX(O)-_.getX(O),M.getY(O)-_.getY(O),M.getZ(O)-_.getZ(O));P[R]=this.processAccessor(I,p),s.attributes.set(this.getUID(_),P[R])}}else D||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),D=!0);y.push(P),C.push(t.morphTargetInfluences[L]),void 0!==t.morphTargetDictionary&&F.push(E[L])}m.weights=C,F.length>0&&(m.extras={},m.extras.targetNames=F)}var k=Array.isArray(t.material);if(k&&0===p.groups.length)return null;for(var V=k?t.material:[t.material],G=k?p.groups:[{materialIndex:0,start:void 0,count:void 0}],j=0,z=G.length;j<z;j++){var H={mode:f,attributes:v};if(this.serializeUserData(p,H),y.length>0&&(H.targets=y),null!==p.index){var W=this.getUID(p.index);void 0===G[j].start&&void 0===G[j].count||(W+=":"+G[j].start+":"+G[j].count),s.attributes.has(W)?H.indices=s.attributes.get(W):(H.indices=this.processAccessor(p.index,p,G[j].start,G[j].count),s.attributes.set(W,H.indices)),null===H.indices&&delete H.indices}var X=this.processMaterial(V[G[j].materialIndex]);null!==X&&(H.material=X),g.push(H)}m.primitives=g,l.meshes||(l.meshes=[]),this._invokeAll((function(e){e.writeMesh&&e.writeMesh(t,m)}));var Q=l.meshes.push(m)-1;return s.meshes.set(d,Q),Q},processCamera:function(t){var r=this.json;r.cameras||(r.cameras=[]);var a=t.isOrthographicCamera,i={type:a?"orthographic":"perspective"};return a?i.orthographic={xmag:2*t.right,ymag:2*t.top,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:i.perspective={aspectRatio:t.aspect,yfov:e.MathUtils.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},""!==t.name&&(i.name=t.type),r.cameras.push(i)-1},processAnimation:function(r,a){var i=this.json,n=this.nodeMap;i.animations||(i.animations=[]);for(var o=(r=t.Utils.mergeMorphTargetTracks(r.clone(),a)).tracks,s=[],l=[],u=0;u<o.length;++u){var c=o[u],h=e.PropertyBinding.parseTrackName(c.name),d=e.PropertyBinding.findNode(a,h.nodeName),f=M[h.propertyName];if("bones"===h.objectName&&(d=!0===d.isSkinnedMesh?d.skeleton.getBoneByName(h.objectIndex):void 0),!d||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',c.name),null;var p=c.values.length/c.times.length;f===M.morphTargetInfluences&&(p/=d.morphTargetInfluences.length);var m=void 0;!0===c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(m="CUBICSPLINE",p/=3):m=c.getInterpolation()===e.InterpolateDiscrete?"STEP":"LINEAR",l.push({input:this.processAccessor(new e.BufferAttribute(c.times,1)),output:this.processAccessor(new e.BufferAttribute(c.values,p)),interpolation:m}),s.push({sampler:l.length-1,target:{node:n.get(d),path:f}})}return i.animations.push({name:r.name||"clip_"+i.animations.length,samplers:l,channels:s}),i.animations.length-1},processSkin:function(t){var r=this.json,a=this.nodeMap,i=r.nodes[a.get(t)],n=t.skeleton;if(void 0===n)return null;var o=t.skeleton.bones[0];if(void 0===o)return null;for(var s=[],l=new Float32Array(16*n.bones.length),u=new e.Matrix4,c=0;c<n.bones.length;++c)s.push(a.get(n.bones[c])),u.copy(n.boneInverses[c]),u.multiply(t.bindMatrix).toArray(l,16*c);return void 0===r.skins&&(r.skins=[]),r.skins.push({inverseBindMatrices:this.processAccessor(new e.BufferAttribute(l,16)),joints:s,skeleton:a.get(o)}),i.skin=r.skins.length-1},processNode:function(e){var t=this.json,r=this.options,a=this.nodeMap;t.nodes||(t.nodes=[]);var i={};if(r.trs){var n=e.quaternion.toArray(),o=e.position.toArray(),s=e.scale.toArray();S(n,[0,0,0,1])||(i.rotation=n),S(o,[0,0,0])||(i.translation=o),S(s,[1,1,1])||(i.scale=s)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function(e){return S(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(i.matrix=e.matrix.elements);if(""!==e.name&&(i.name=String(e.name)),this.serializeUserData(e,i),e.isMesh||e.isLine||e.isPoints){var l=this.processMesh(e);null!==l&&(i.mesh=l)}else e.isCamera&&(i.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){for(var u=[],c=0,h=e.children.length;c<h;c++){var d=e.children[c];if(d.visible||!1===r.onlyVisible)null!==(f=this.processNode(d))&&u.push(f)}u.length>0&&(i.children=u)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,i)}));var f=t.nodes.push(i)-1;return a.set(e,f),f},processScene:function(e){var t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);var a={};""!==e.name&&(a.name=e.name),t.scenes.push(a);for(var i=[],n=0,o=e.children.length;n<o;n++){var s=e.children[n];if(s.visible||!1===r.onlyVisible){var l=this.processNode(s);null!==l&&i.push(l)}}i.length>0&&(a.nodes=i),this.serializeUserData(e,a)},processObjects:function(t){var r=new e.Scene;r.name="AuxScene";for(var a=0;a<t.length;a++)r.children.push(t[a]);this.processScene(r)},processInput:function(t){var r=this.options;t=t instanceof Array?t:[t],this._invokeAll((function(e){e.beforeParse&&e.beforeParse(t)}));for(var a=[],i=0;i<t.length;i++)t[i]instanceof e.Scene?this.processScene(t[i]):a.push(t[i]);a.length>0&&this.processObjects(a);for(var n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(var o=0;o<r.animations.length;++o)this.processAnimation(r.animations[o],t[0]);this._invokeAll((function(e){e.afterParse&&e.afterParse(t)}))},_invokeAll:function(e){for(var t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}},B.prototype={constructor:B,writeNode:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var r=this.writer,a=r.json,i=r.extensionsUsed,n={};e.name&&(n.name=e.name),n.color=e.color.toArray(),n.intensity=e.intensity,e.isDirectionalLight?n.type="directional":e.isPointLight?(n.type="point",e.distance>0&&(n.range=e.distance)):e.isSpotLight&&(n.type="spot",e.distance>0&&(n.range=e.distance),n.spot={},n.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,n.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),i[this.name]||(a.extensions=a.extensions||{},a.extensions[this.name]={lights:[]},i[this.name]=!0);var o=a.extensions[this.name].lights;o.push(n),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}},L.prototype={constructor:L,writeMaterial:function(e,t){if(e.isMeshBasicMaterial){var r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}},P.prototype={constructor:P,writeMaterial:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var r=this.writer,a=r.extensionsUsed,i={};t.pbrMetallicRoughness.baseColorFactor&&(i.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var n=[1,1,1];if(e.specular.toArray(n,0),i.specularFactor=n,i.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(i.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var o={index:r.processTexture(e.specularMap)};r.applyTextureTransform(o,e.specularMap),i.specularGlossinessTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=i,a[this.name]=!0}}},t.Utils={insertKeyframe:function(e,t){var r,a=.001,i=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+i),s=e.createInterpolant(new e.ValueBufferType(i));if(0===e.times.length){n[0]=t;for(var l=0;l<i;l++)o[l]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<a)return 0;n[0]=t,n.set(e.times,1),o.set(s.evaluate(t),0),o.set(e.values,i),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<a)return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),o.set(e.values,0),o.set(s.evaluate(t),e.values.length),r=n.length-1}else for(var u=0;u<e.times.length;u++){if(Math.abs(e.times[u]-t)<a)return u;if(e.times[u]<t&&e.times[u+1]>t){n.set(e.times.slice(0,u+1),0),n[u+1]=t,n.set(e.times.slice(u+1),u+2),o.set(e.values.slice(0,(u+1)*i),0),o.set(s.evaluate(t),(u+1)*i),o.set(e.values.slice((u+1)*i),(u+2)*i),r=u+1;break}}return e.times=n,e.values=o,r},mergeMorphTargetTracks:function(t,r){for(var a=[],i={},n=t.tracks,o=0;o<n.length;++o){var s=n[o],l=e.PropertyBinding.parseTrackName(s.name),u=e.PropertyBinding.findNode(r,l.nodeName);if("morphTargetInfluences"===l.propertyName&&void 0!==l.propertyIndex){if(s.createInterpolant!==s.InterpolantFactoryMethodDiscrete&&s.createInterpolant!==s.InterpolantFactoryMethodLinear){if(s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(s=s.clone()).setInterpolation(e.InterpolateLinear)}var c=u.morphTargetInfluences.length,h=u.morphTargetDictionary[l.propertyIndex];if(void 0===h)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);var d=void 0;if(void 0!==i[u.uuid]){var f=s.createInterpolant(new s.ValueBufferType(1));d=i[u.uuid];for(var p=0;p<d.times.length;p++)d.values[p*c+h]=f.evaluate(d.times[p]);for(var m=0;m<s.times.length;m++){var v=this.insertKeyframe(d,s.times[m]);d.values[v*c+h]=s.values[m]}}else{for(var g=new((d=s.clone()).ValueBufferType)(c*d.times.length),y=0;y<d.times.length;y++)g[y*c+h]=d.values[y];d.name=(l.nodeName||"")+".morphTargetInfluences",d.values=g,i[u.uuid]=d,a.push(d)}}else a.push(s)}return t.tracks=a,t}},t}(),Kr=function(){function e(){}return e.prototype.parse=function(){var e=w.default(regeneratorRuntime.mark((function e(t){var r,a,i,n,o,s,u,c,h,d,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r='#usda 1.0\n(\n    customLayerData = {\n        string creator = "Three.js USDZExporter"\n    }\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\n',a={},i={},t.traverse((function(e){if(e.isMesh){var t=e.geometry,n=e.material;a[n.uuid]=n,null!==n.map&&(i[n.map.uuid]=n.map),null!==n.normalMap&&(i[n.normalMap.uuid]=n.normalMap),null!==n.aoMap&&(i[n.aoMap.uuid]=n.aoMap),null!==n.roughnessMap&&(i[n.roughnessMap.uuid]=n.roughnessMap),null!==n.metalnessMap&&(i[n.metalnessMap.uuid]=n.metalnessMap),null!==n.emissiveMap&&(i[n.emissiveMap.uuid]=n.emissiveMap),r+=$r(e,ta(t,n))}})),r+=aa(a),r+=na(i),n={"model.usda":l.strToU8(r)},e.t0=regeneratorRuntime.keys(i);case 8:if((e.t1=e.t0()).done){e.next=16;break}return o=e.t1.value,s=i[o],e.next=13,qr(s.image);case 13:n["textures/Texture_"+s.id+".jpg"]=e.sent,e.next=8;break;case 16:for(c in u=0,n)h=n[c],d=34+c.length,4!==(f=63&(u+=d))&&(p=new Uint8Array(64-f),n[c]=[h,{extra:{12345:p}}]),u=h.length;return e.abrupt("return",l.zipSync(n,{level:0}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}();function qr(e){return Zr.apply(this,arguments)}function Zr(){return(Zr=w.default(regeneratorRuntime.mark((function e(t){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)){e.next=15;break}return r=1024/Math.max(t.width,t.height),(a=document.createElement("canvas")).width=t.width*Math.min(1,r),a.height=t.height*Math.min(1,r),a.getContext("2d").drawImage(t,0,0,a.width,a.height),e.next=9,new Promise((function(e){return a.toBlob(e,"image/jpeg",1)}));case 9:return i=e.sent,e.t0=Uint8Array,e.next=13,i.arrayBuffer();case 13:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $r(e,t){return'def Xform "'+("Object_"+e.id)+'"\n{\n    matrix4d xformOp:transform = '+function(e){var t=e.elements;return"( "+ea(t,0)+", "+ea(t,4)+", "+ea(t,8)+", "+ea(t,12)+" )"}(e.matrixWorld)+'\n    uniform token[] xformOpOrder = ["xformOp:transform"]\n\n    '+t+"\n}\n\n"}function ea(e,t){return"("+e[t+0]+", "+e[t+1]+", "+e[t+2]+", "+e[t+3]+")"}function ta(e,t){var r="Geometry_"+e.id,a=e.attributes,i=a.position.count;return"uv2"in a&&console.warn("THREE.USDZExporter: uv2 not supported yet."),'def Mesh "'+r+'"\n    {\n        int[] faceVertexCounts = ['+function(e){var t=null!==e.index?e.index.array.length:e.attributes.position.count;return Array(t/3).fill(3).join(", ")}(e)+"]\n        int[] faceVertexIndices = ["+function(e){if(null!==e.index)return e.index.array.join(", ");for(var t=[],r=e.attributes.position.count,a=0;a<r;a++)t.push(a);return t.join(", ")}(e)+"]\n        rel material:binding = </Materials/Material_"+t.id+">\n        normal3f[] normals = ["+ra(a.normal,i)+'] (\n            interpolation = "vertex"\n        )\n        point3f[] points = ['+ra(a.position,i)+"]\n        float2[] primvars:st = ["+function(e,t){if(void 0===e)return console.warn("USDZExporter: UVs missing."),Array(t).fill("(0, 0)").join(", ");for(var r=[],a=e.array,i=0;i<a.length;i+=2)r.push("("+a[i+0].toPrecision(7)+", "+(1-a[i+1].toPrecision(7))+")");return r.join(", ")}(a.uv,i)+'] (\n            interpolation = "vertex"\n        )\n        uniform token subdivisionScheme = "none"\n    }\n'}function ra(e,t){if(void 0===e)return console.warn("USDZExporter: Normals missing."),Array(t).fill("(0, 0, 0)").join(", ");for(var r=[],a=e.array,i=0;i<a.length;i+=3)r.push("("+a[i+0].toPrecision(7)+", "+a[i+1].toPrecision(7)+", "+a[i+2].toPrecision(7)+")");return r.join(", ")}function aa(e){var t=[];for(var r in e){var a=e[r];t.push(ia(a))}return'def "Materials"\n{\n'+t.join("")+"\n}\n\n"}function ia(e){var t="            ",r=[];return null!==e.map?r.push(t+"color3f inputs:diffuseColor.connect = </Textures/Texture_"+e.map.id+".outputs:rgb>"):r.push(t+"color3f inputs:diffuseColor = "+sa(e.color)),null!==e.emissiveMap?r.push(t+"color3f inputs:emissiveColor.connect = </Textures/Texture_"+e.emissiveMap.id+".outputs:rgb>"):e.emissive.getHex()>0&&r.push(t+"color3f inputs:emissiveColor = "+sa(e.emissive)),null!==e.normalMap&&r.push(t+"normal3f inputs:normal.connect = </Textures/Texture_"+e.normalMap.id+".outputs:rgb>"),null!==e.aoMap&&r.push(t+"float inputs:occlusion.connect = </Textures/Texture_"+e.aoMap.id+".outputs:r>"),null!==e.roughnessMap?r.push(t+"float inputs:roughness.connect = </Textures/Texture_"+e.roughnessMap.id+".outputs:g>"):r.push(t+"float inputs:roughness = "+e.roughness),null!==e.metalnessMap?r.push(t+"float inputs:metallic.connect = </Textures/Texture_"+e.metalnessMap.id+".outputs:b>"):r.push(t+"float inputs:metallic = "+e.metalness),'\n    def Material "Material_'+e.id+'"\n    {\n        token outputs:surface.connect = </Materials/Material_'+e.id+'/PreviewSurface.outputs:surface>\n\n        def Shader "PreviewSurface"\n        {\n            uniform token info:id = "UsdPreviewSurface"\n'+r.join("\n")+"\n            int inputs:useSpecularWorkflow = 0\n            token outputs:surface\n        }\n    }\n"}function na(e){var t=[];for(var r in e){var a=e[r];t.push(oa(a))}return'def "Textures"\n{\n'+t.join("")+"\n}\n\n"}function oa(e){return'\n    def Shader "Texture_'+e.id+'"\n    {\n        uniform token info:id = "UsdUVTexture"\n        asset inputs:file = @textures/Texture_'+e.id+'.jpg@\n        token inputs:wrapS = "repeat"\n        token inputs:wrapT = "repeat"\n        float outputs:r\n        float outputs:g\n        float outputs:b\n        float3 outputs:rgb\n    }\n'}function sa(e){return"("+e.r+", "+e.g+", "+e.b+")"}var la=function(){};la.prototype={constructor:la,parse:function(t,r,a){function i(e){t.traverse((function(t){if(!0===t.isMesh){var r=t,a=r.geometry;if(!0!==a.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");!0===a.hasAttribute("position")&&e(r,a)}}))}r&&"object"==typeof r&&(console.warn('THREE.PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),a=r,r=void 0);var n=(a=Object.assign({binary:!1,excludeAttributes:[],littleEndian:!1},a)).excludeAttributes,o=!1,s=!1,l=!1,u=0,c=0;t.traverse((function(e){if(!0===e.isMesh){var t=e.geometry;if(!0!==t.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");var r=t.getAttribute("position"),a=t.getAttribute("normal"),i=t.getAttribute("uv"),n=t.getAttribute("color"),h=t.getIndex();if(void 0===r)return;u+=r.count,c+=h?h.count/3:r.count/3,void 0!==a&&(o=!0),void 0!==i&&(l=!0),void 0!==n&&(s=!0)}}));var h=-1===n.indexOf("index");if(o=o&&-1===n.indexOf("normal"),s=s&&-1===n.indexOf("color"),l=l&&-1===n.indexOf("uv"),h&&c!==Math.floor(c))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var d="ply\nformat "+(a.binary?a.littleEndian?"binary_little_endian":"binary_big_endian":"ascii")+" 1.0\nelement vertex "+u+"\nproperty float x\nproperty float y\nproperty float z\n";!0===o&&(d+="property float nx\nproperty float ny\nproperty float nz\n"),!0===l&&(d+="property float s\nproperty float t\n"),!0===s&&(d+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===h&&(d+="element face "+c+"\nproperty list uchar int vertex_index\n"),d+="end_header\n";var f=new e.Vector3,p=new e.Matrix3,m=null;if(!0===a.binary){var v=(new TextEncoder).encode(d),g=u*(12+(o?12:0)+(s?3:0)+(l?8:0)),y=h?13*c:0,x=new DataView(new ArrayBuffer(v.length+g+y));new Uint8Array(x.buffer).set(v,0);var b=v.length,A=v.length+g,w=0;i((function(e,t){var r=t.getAttribute("position"),i=t.getAttribute("normal"),n=t.getAttribute("uv"),u=t.getAttribute("color"),c=t.getIndex();p.getNormalMatrix(e.matrixWorld);for(var d=0,m=r.count;d<m;d++)f.x=r.getX(d),f.y=r.getY(d),f.z=r.getZ(d),f.applyMatrix4(e.matrixWorld),x.setFloat32(b,f.x,a.littleEndian),b+=4,x.setFloat32(b,f.y,a.littleEndian),b+=4,x.setFloat32(b,f.z,a.littleEndian),b+=4,!0===o&&(null!=i?(f.x=i.getX(d),f.y=i.getY(d),f.z=i.getZ(d),f.applyMatrix3(p).normalize(),x.setFloat32(b,f.x,a.littleEndian),b+=4,x.setFloat32(b,f.y,a.littleEndian),b+=4,x.setFloat32(b,f.z,a.littleEndian),b+=4):(x.setFloat32(b,0,a.littleEndian),b+=4,x.setFloat32(b,0,a.littleEndian),b+=4,x.setFloat32(b,0,a.littleEndian),b+=4)),!0===l&&(null!=n?(x.setFloat32(b,n.getX(d),a.littleEndian),b+=4,x.setFloat32(b,n.getY(d),a.littleEndian),b+=4):!1!==l&&(x.setFloat32(b,0,a.littleEndian),b+=4,x.setFloat32(b,0,a.littleEndian),b+=4)),!0===s&&(null!=u?(x.setUint8(b,Math.floor(255*u.getX(d))),b+=1,x.setUint8(b,Math.floor(255*u.getY(d))),b+=1,x.setUint8(b,Math.floor(255*u.getZ(d))),b+=1):(x.setUint8(b,255),b+=1,x.setUint8(b,255),b+=1,x.setUint8(b,255),b+=1));if(!0===h)if(null!==c)for(var v=0,g=c.count;v<g;v+=3)x.setUint8(A,3),A+=1,x.setUint32(A,c.getX(v+0)+w,a.littleEndian),A+=4,x.setUint32(A,c.getX(v+1)+w,a.littleEndian),A+=4,x.setUint32(A,c.getX(v+2)+w,a.littleEndian),A+=4;else for(var y=0,M=r.count;y<M;y+=3)x.setUint8(A,3),A+=1,x.setUint32(A,w+y,a.littleEndian),A+=4,x.setUint32(A,w+y+1,a.littleEndian),A+=4,x.setUint32(A,w+y+2,a.littleEndian),A+=4;w+=r.count})),m=x.buffer}else{w=0;var M="",S="";i((function(e,t){var r=t.getAttribute("position"),a=t.getAttribute("normal"),i=t.getAttribute("uv"),n=t.getAttribute("color"),u=t.getIndex();p.getNormalMatrix(e.matrixWorld);for(var d=0,m=r.count;d<m;d++){f.x=r.getX(d),f.y=r.getY(d),f.z=r.getZ(d),f.applyMatrix4(e.matrixWorld);var v=f.x+" "+f.y+" "+f.z;!0===o&&(null!=a?(f.x=a.getX(d),f.y=a.getY(d),f.z=a.getZ(d),f.applyMatrix3(p).normalize(),v+=" "+f.x+" "+f.y+" "+f.z):v+=" 0 0 0"),!0===l&&(null!=i?v+=" "+i.getX(d)+" "+i.getY(d):!1!==l&&(v+=" 0 0")),!0===s&&(v+=null!=n?" "+Math.floor(255*n.getX(d))+" "+Math.floor(255*n.getY(d))+" "+Math.floor(255*n.getZ(d)):" 255 255 255"),M+=v+"\n"}if(!0===h){if(null!==u)for(var g=0,y=u.count;g<y;g+=3)S+="3 "+(u.getX(g+0)+w),S+=" "+(u.getX(g+1)+w),S+=" "+(u.getX(g+2)+w)+"\n";else for(var x=0,b=r.count;x<b;x+=3)S+="3 "+(w+x)+" "+(w+x+1)+" "+(w+x+2)+"\n";c+=u?u.count/3:r.count/3}w+=r.count})),m=""+d+M+(h?S+"\n":"\n")}return"function"==typeof r&&requestAnimationFrame((function(){return r(m)})),m}};var ua=function(){};ua.prototype={constructor:ua,parse:function(e,t){if(!0===e.isBufferGeometry)throw new Error("DRACOExporter: The first parameter of parse() is now an instance of Mesh or Points.");if(void 0===DracoEncoderModule)throw new Error("THREE.DRACOExporter: required the draco_decoder to work.");void 0===t&&(t={decodeSpeed:5,encodeSpeed:5,encoderMethod:ua.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1});var r,a,i=e.geometry,n=DracoEncoderModule(),o=new n.Encoder;if(!0!==i.isBufferGeometry)throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.BufferGeometry instance.");if(!0===e.isMesh){r=new n.MeshBuilder,a=new n.Mesh;var s=i.getAttribute("position");if(r.AddFloatAttributeToMesh(a,n.POSITION,s.count,s.itemSize,s.array),null!==(l=i.getIndex()))r.AddFacesToMesh(a,l.count/3,l.array);else{for(var l=new(s.count>65535?Uint32Array:Uint16Array)(s.count),u=0;u<l.length;u++)l[u]=u;r.AddFacesToMesh(a,s.count,l)}if(!0===t.exportNormals){var c=i.getAttribute("normal");void 0!==c&&r.AddFloatAttributeToMesh(a,n.NORMAL,c.count,c.itemSize,c.array)}if(!0===t.exportUvs){var h=i.getAttribute("uv");void 0!==h&&r.AddFloatAttributeToMesh(a,n.TEX_COORD,h.count,h.itemSize,h.array)}if(!0===t.exportColor)void 0!==(d=i.getAttribute("color"))&&r.AddFloatAttributeToMesh(a,n.COLOR,d.count,d.itemSize,d.array)}else{if(!0!==e.isPoints)throw new Error("DRACOExporter: Unsupported object type.");r=new n.PointCloudBuilder,a=new n.PointCloud;var d;s=i.getAttribute("position");r.AddFloatAttribute(a,n.POSITION,s.count,s.itemSize,s.array),!0===t.exportColor&&void 0!==(d=i.getAttribute("color"))&&r.AddFloatAttribute(a,n.COLOR,d.count,d.itemSize,d.array)}var f,p=new n.DracoInt8Array,m=void 0!==t.encodeSpeed?t.encodeSpeed:5,v=void 0!==t.decodeSpeed?t.decodeSpeed:5;if(o.SetSpeedOptions(m,v),void 0!==t.encoderMethod&&o.SetEncodingMethod(t.encoderMethod),void 0!==t.quantization)for(var g=0;g<5;g++)void 0!==t.quantization[g]&&o.SetAttributeQuantization(g,t.quantization[g]);if(f=!0===e.isMesh?o.EncodeMeshToDracoBuffer(a,p):o.EncodePointCloudToDracoBuffer(a,!0,p),n.destroy(a),0===f)throw new Error("THREE.DRACOExporter: Draco encoding failed.");for(var y=new Int8Array(new ArrayBuffer(f)),x=0;x<f;x++)y[x]=p.GetValue(x);return n.destroy(p),n.destroy(o),n.destroy(r),y}},ua.MESH_EDGEBREAKER_ENCODING=1,ua.MESH_SEQUENTIAL_ENCODING=0,ua.POINT_CLOUD=0,ua.TRIANGULAR_MESH=1,ua.INVALID=-1,ua.POSITION=0,ua.NORMAL=1,ua.COLOR=2,ua.TEX_COORD=3,ua.GENERIC=4;var ca=function(){};ca.prototype={constructor:ca,parse:function(t,r,a){a=a||{},""!==(a=Object.assign({version:"1.4.1",author:null,textureDirectory:""},a)).textureDirectory&&(a.textureDirectory=(a.textureDirectory+"/").replace(/\\/g,"/").replace(/\/+/g,"/"));var i,n,o=a.version;if("1.4.1"!==o&&"1.5.0"!==o)return console.warn("ColladaExporter : Version "+o+" not supported for export. Only 1.4.1 and 1.5.0."),null;function s(e,t){return i=i||document.createElement("canvas"),n=n||i.getContext("2d"),i.width=e.width,i.height=e.height,n.drawImage(e,0,0),function(e){for(var t=atob(e),r=new Uint8Array(t.length),a=0,i=r.length;a<i;a++)r[a]=t.charCodeAt(a);return r}(i.toDataURL("image/"+t,1).replace(/^data:image\/(png|jpg);base64,/,""))}var l,u=["getX","getY","getZ","getW"];function c(e){if(e.isInterleavedBufferAttribute){for(var t=new e.array.constructor(e.count*e.itemSize),r=e.itemSize,a=0,i=e.count;a<i;a++)for(var n=0;n<r;n++)t[a*r+n]=e[u[n]](a);return t}return e.array}function h(e,t,r,a){var i=c(e);return'<source id="'+t+'"><float_array id="'+t+'-array" count="'+i.length+'">'+i.join(" ")+'</float_array><technique_common><accessor source="#'+t+'-array" count="'+Math.floor(i.length/e.itemSize)+'" stride="'+e.itemSize+'">'+r.map((function(e){return'<param name="'+e+'" type="'+a+'" />'})).join("")+"</accessor></technique_common></source>"}function d(e){var t=m.get(e);if(null==t){t="image-"+(g.length+1);var r="png",i=e.name||t,n='<image id="'+t+'" name="'+i+'">';n+="1.5.0"===o?"<init_from><ref>"+a.textureDirectory+i+"."+"png</ref></init_from>":"<init_from>"+a.textureDirectory+i+"."+"png</init_from>",n+="</image>",g.push(n),m.set(e,t),v.push({directory:a.textureDirectory,name:i,ext:r,data:s(e.image,r),original:e})}return t}var f=new WeakMap,p=new WeakMap,m=new WeakMap,v=[],g=[],y=[],x=[],b=[],A=function t(r){var a='<node name="'+r.name+'">';if(a+=function(t){return t.updateMatrix(),(l=l||new e.Matrix4).copy(t.matrix),l.transpose(),"<matrix>"+l.toArray().join(" ")+"</matrix>"}(r),!0===r.isMesh&&null!==r.geometry){var i=function(e){var t,r,a,i=f.get(e);if(!i){var n=e;if(!0!==n.isBufferGeometry)throw new Error("THREE.ColladaExporter: Geometry is not of type THREE.BufferGeometry.");var o="Mesh"+(y.length+1),s=n.index?n.index.count*n.index.itemSize:n.attributes.position.count,l=null!=n.groups&&0!==n.groups.length?n.groups:[{start:0,count:s,materialIndex:0}],u='<geometry id="'+o+'"'+(e.name?' name="'+e.name+'"':"")+"><mesh>",d=o+"-position",p=o+"-vertices";u+=h(n.attributes.position,d,["X","Y","Z"],"float"),u+='<vertices id="'+p+'"><input semantic="POSITION" source="#'+d+'" /></vertices>';var m='<input semantic="VERTEX" source="#'+p+'" offset="0" />';if("normal"in n.attributes){var v=o+"-normal";u+=h(n.attributes.normal,v,["X","Y","Z"],"float"),m+='<input semantic="NORMAL" source="#'+v+'" offset="0" />'}if("uv"in n.attributes){var g=o+"-texcoord";u+=h(n.attributes.uv,g,["S","T"],"float"),m+='<input semantic="TEXCOORD" source="#'+g+'" offset="0" set="0" />'}if("uv2"in n.attributes&&(g=o+"-texcoord2",u+=h(n.attributes.uv2,g,["S","T"],"float"),m+='<input semantic="TEXCOORD" source="#'+g+'" offset="0" set="1" />'),"color"in n.attributes){var x=o+"-color";u+=h(n.attributes.color,x,["X","Y","Z"],"uint8"),m+='<input semantic="COLOR" source="#'+x+'" offset="0" />'}var b=null;if(n.index)b=c(n.index);else for(var A=0,w=(b=new Array(s)).length;A<w;A++)b[A]=A;for(var M=0,S=l.length;M<S;M++){var T=l[M],C=(t=b,r=T.start,a=T.count,Array.isArray(t)?t.slice(r,r+a):new t.constructor(t.buffer,r*t.BYTES_PER_ELEMENT,a)),F=C.length/3;u+='<triangles material="MESH_MATERIAL_'+T.materialIndex+'" count="'+F+'">',u+=m,u+="<p>"+C.join(" ")+"</p>",u+="</triangles>"}u+="</mesh></geometry>",y.push(u),i={meshid:o,bufferGeometry:n},f.set(e,i)}return i}(r.geometry),n=i.meshid,o=i.bufferGeometry,s=null,u=r.material||new e.MeshBasicMaterial,m=Array.isArray(u)?u:[u];s=(o.groups.length>m.length?new Array(o.groups.length):new Array(m.length)).fill().map((function(t,r){return function(t){var r=p.get(t);if(null==r){r="Mat"+(x.length+1);var a="phong";!0===t.isMeshLambertMaterial?a="lambert":!0===t.isMeshBasicMaterial&&(a="constant",null!==t.map&&console.warn("ColladaExporter: Texture maps not supported with MeshBasicMaterial."));var i=t.emissive?t.emissive:new e.Color(0,0,0),n=t.color?t.color:new e.Color(0,0,0),o=t.specular?t.specular:new e.Color(1,1,1),s=t.shininess||0,l=t.reflectivity||0,u="";!0===t.transparent&&(u+="<transparent>"+(t.map?'<texture texture="diffuse-sampler"></texture>':"<float>1</float>")+"</transparent>",t.opacity<1&&(u+="<transparency><float>"+t.opacity+"</float></transparency>"));var c='<technique sid="common"><'+a+"><emission>"+(t.emissiveMap?'<texture texture="emissive-sampler" texcoord="TEXCOORD" />':'<color sid="emission">'+i.r+" "+i.g+" "+i.b+" 1</color>")+"</emission>"+("constant"!==a?"<diffuse>"+(t.map?'<texture texture="diffuse-sampler" texcoord="TEXCOORD" />':'<color sid="diffuse">'+n.r+" "+n.g+" "+n.b+" 1</color>")+"</diffuse>":"")+("constant"!==a?"<bump>"+(t.normalMap?'<texture texture="bump-sampler" texcoord="TEXCOORD" />':"")+"</bump>":"")+("phong"===a?'<specular><color sid="specular">'+o.r+" "+o.g+" "+o.b+" 1</color></specular><shininess>"+(t.specularMap?'<texture texture="specular-sampler" texcoord="TEXCOORD" />':'<float sid="shininess">'+s+"</float>")+"</shininess>":"")+"<reflective><color>"+n.r+" "+n.g+" "+n.b+" 1</color></reflective><reflectivity><float>"+l+"</float></reflectivity>"+u+"</"+a+"></technique>",h='<effect id="'+r+'-effect"><profile_COMMON>'+(t.map?'<newparam sid="diffuse-surface"><surface type="2D"><init_from>'+d(t.map)+'</init_from></surface></newparam><newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>':"")+(t.specularMap?'<newparam sid="specular-surface"><surface type="2D"><init_from>'+d(t.specularMap)+'</init_from></surface></newparam><newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>':"")+(t.emissiveMap?'<newparam sid="emissive-surface"><surface type="2D"><init_from>'+d(t.emissiveMap)+'</init_from></surface></newparam><newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>':"")+(t.normalMap?'<newparam sid="bump-surface"><surface type="2D"><init_from>'+d(t.normalMap)+'</init_from></surface></newparam><newparam sid="bump-sampler"><sampler2D><source>bump-surface</source></sampler2D></newparam>':"")+c+(t.side===e.DoubleSide?'<extra><technique profile="THREEJS"><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>':"")+"</profile_COMMON></effect>",f='<material id="'+r+'"'+(t.name?' name="'+t.name+'"':"")+'><instance_effect url="#'+r+'-effect" /></material>';b.push(f),x.push(h),p.set(t,r)}return r}(m[r%m.length])})),a+='<instance_geometry url="#'+n+'">'+(null!=s?"<bind_material><technique_common>"+s.map((function(e,t){return'<instance_material symbol="MESH_MATERIAL_'+t+'" target="#'+e+'" ><bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" /></instance_material>'})).join("")+"</technique_common></bind_material>":"")+"</instance_geometry>"}return r.children.forEach((function(e){return a+=t(e)})),a+="</node>"}(t),w='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><COLLADA xmlns="'+("1.4.1"===o?"http://www.collada.org/2005/11/COLLADASchema":"https://www.khronos.org/collada/")+'" version="'+o+'"><asset><contributor><authoring_tool>three.js Collada Exporter</authoring_tool>'+(null!==a.author?"<author>"+a.author+"</author>":"")+"</contributor><created>"+(new Date).toISOString()+"</created><modified>"+(new Date).toISOString()+"</modified><up_axis>Y_UP</up_axis></asset>";w+="<library_images>"+g.join("")+"</library_images>",w+="<library_effects>"+x.join("")+"</library_effects>",w+="<library_materials>"+b.join("")+"</library_materials>",w+="<library_geometries>"+y.join("")+"</library_geometries>",w+='<library_visual_scenes><visual_scene id="Scene" name="scene">'+A+"</visual_scene></library_visual_scenes>",w+='<scene><instance_visual_scene url="#Scene"/></scene>';var M,S,T,C,F,E,B={data:(M=w+="</COLLADA>",S=/^<\//,T=/(\?>$)|(\/>$)/,C=/<[^>]+>[^<]*<\/[^<]+>/,F=function e(t,r){return r>0?t+e(t,r-1):""},E=0,M.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map((function(e){C.test(e)||T.test(e)||!S.test(e)||E--;var t=""+F("  ",E)+e;return C.test(e)||T.test(e)||S.test(e)||E++,t})).join("\n")),textures:v};return"function"==typeof r&&requestAnimationFrame((function(){return r(B)})),B}};var ha=function(){};ha.prototype={constructor:ha,parse:function(t,r){void 0===r&&(r={});var a,i=void 0!==r.binary&&r.binary,n=[],o=0;t.traverse((function(e){if(e.isMesh){var t=e.geometry;if(!0!==t.isBufferGeometry)throw new Error("THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.");var r=t.index,a=t.getAttribute("position");o+=null!==r?r.count/3:a.count/3,n.push({object3d:e,geometry:t})}}));var s=80;if(!0===i){var l=new ArrayBuffer(2*o+3*o*4*4+80+4);(a=new DataView(l)).setUint32(s,o,!0),s+=4}else a="",a+="solid exported\n";for(var u=new e.Vector3,c=new e.Vector3,h=new e.Vector3,d=new e.Vector3,f=new e.Vector3,p=new e.Vector3,m=0,v=n.length;m<v;m++){var g=n[m].object3d,y=n[m].geometry,x=y.index,b=y.getAttribute("position");if(null!==x)for(var A=0;A<x.count;A+=3){M(x.getX(A+0),x.getX(A+1),x.getX(A+2),b,g)}else for(var w=0;w<b.count;w+=3){M(w+0,w+1,w+2,b,g)}}return!1===i&&(a+="endsolid exported\n"),a;function M(e,t,r,n,o){u.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),h.fromBufferAttribute(n,r),!0===o.isSkinnedMesh&&(o.boneTransform(e,u),o.boneTransform(t,c),o.boneTransform(r,h)),u.applyMatrix4(o.matrixWorld),c.applyMatrix4(o.matrixWorld),h.applyMatrix4(o.matrixWorld),function(e,t,r){d.subVectors(r,t),f.subVectors(e,t),d.cross(f).normalize(),p.copy(d).normalize(),!0===i?(a.setFloat32(s,p.x,!0),s+=4,a.setFloat32(s,p.y,!0),s+=4,a.setFloat32(s,p.z,!0),s+=4):(a+="\tfacet normal "+p.x+" "+p.y+" "+p.z+"\n",a+="\t\touter loop\n")}(u,c,h),S(u),S(c),S(h),!0===i?(a.setUint16(s,0,!0),s+=2):(a+="\t\tendloop\n",a+="\tendfacet\n")}function S(e){!0===i?(a.setFloat32(s,e.x,!0),s+=4,a.setFloat32(s,e.y,!0),s+=4,a.setFloat32(s,e.z,!0),s+=4):a+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n"}}};var da=function(){};da.prototype={constructor:da,parse:function(t){var r,a,i,n,o,s="",l=0,u=0,c=0,h=new e.Vector3,d=new e.Color,f=new e.Vector3,p=new e.Vector2,m=[];return t.traverse((function(t){!0===t.isMesh&&function(t){var i=0,d=0,v=0,g=t.geometry,y=new e.Matrix3;if(!0!==g.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var x=g.getAttribute("position"),b=g.getAttribute("normal"),A=g.getAttribute("uv"),w=g.getIndex();if(s+="o "+t.name+"\n",t.material&&t.material.name&&(s+="usemtl "+t.material.name+"\n"),void 0!==x)for(r=0,n=x.count;r<n;r++,i++)h.x=x.getX(r),h.y=x.getY(r),h.z=x.getZ(r),h.applyMatrix4(t.matrixWorld),s+="v "+h.x+" "+h.y+" "+h.z+"\n";if(void 0!==A)for(r=0,n=A.count;r<n;r++,v++)p.x=A.getX(r),p.y=A.getY(r),s+="vt "+p.x+" "+p.y+"\n";if(void 0!==b)for(y.getNormalMatrix(t.matrixWorld),r=0,n=b.count;r<n;r++,d++)f.x=b.getX(r),f.y=b.getY(r),f.z=b.getZ(r),f.applyMatrix3(y).normalize(),s+="vn "+f.x+" "+f.y+" "+f.z+"\n";if(null!==w)for(r=0,n=w.count;r<n;r+=3){for(o=0;o<3;o++)a=w.getX(r+o)+1,m[o]=l+a+(b||A?"/"+(A?u+a:"")+(b?"/"+(c+a):""):"");s+="f "+m.join(" ")+"\n"}else for(r=0,n=x.count;r<n;r+=3){for(o=0;o<3;o++)a=r+o+1,m[o]=l+a+(b||A?"/"+(A?u+a:"")+(b?"/"+(c+a):""):"");s+="f "+m.join(" ")+"\n"}l+=i,u+=v,c+=d}(t),!0===t.isLine&&function(e){var t=0,o=e.geometry,u=e.type;if(!0!==o.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var c=o.getAttribute("position");if(s+="o "+e.name+"\n",void 0!==c)for(r=0,n=c.count;r<n;r++,t++)h.x=c.getX(r),h.y=c.getY(r),h.z=c.getZ(r),h.applyMatrix4(e.matrixWorld),s+="v "+h.x+" "+h.y+" "+h.z+"\n";if("Line"===u){for(s+="l ",a=1,n=c.count;a<=n;a++)s+=l+a+" ";s+="\n"}if("LineSegments"===u)for(i=1+(a=1),n=c.count;a<n;i=(a+=2)+1)s+="l "+(l+a)+" "+(l+i)+"\n";l+=t}(t),!0===t.isPoints&&function(e){var t=0,i=e.geometry;if(!0!==i.isBufferGeometry)throw new Error("THREE.OBJExporter: Geometry is not of type THREE.BufferGeometry.");var o=i.getAttribute("position"),u=i.getAttribute("color");if(s+="o "+e.name+"\n",void 0!==o)for(r=0,n=o.count;r<n;r++,t++)h.fromBufferAttribute(o,r),h.applyMatrix4(e.matrixWorld),s+="v "+h.x+" "+h.y+" "+h.z,void 0!==u&&(d.fromBufferAttribute(u,r),s+=" "+d.r+" "+d.g+" "+d.b),s+="\n";for(s+="p ",a=1,n=o.count;a<=n;a++)s+=l+a+" ";s+="\n",l+=t}(t)})),s}};var fa=function(){};fa.CreateRotationAnimation=function(t,r){var a=[0,t],i=".rotation["+(r=r||"x")+"]",n=new e.NumberKeyframeTrack(i,a,[0,360]);return new e.AnimationClip(null,t,[n])},fa.CreateScaleAxisAnimation=function(t,r){var a=[0,t],i=".scale["+(r=r||"x")+"]",n=new e.NumberKeyframeTrack(i,a,[0,1]);return new e.AnimationClip(null,t,[n])},fa.CreateShakeAnimation=function(t,r){for(var a=[],i=[],n=new e.Vector3,o=0;o<10*t;o++)a.push(o/10),n.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).multiply(r).toArray(i,i.length);var s=new e.VectorKeyframeTrack(".position",a,i);return new e.AnimationClip(null,t,[s])},fa.CreatePulsationAnimation=function(t,r){for(var a=[],i=[],n=new e.Vector3,o=0;o<10*t;o++){a.push(o/10);var s=Math.random()*r;n.set(s,s,s).toArray(i,i.length)}var l=new e.VectorKeyframeTrack(".scale",a,i);return new e.AnimationClip(null,t,[l])},fa.CreateVisibilityAnimation=function(t){var r=[0,t/2,t],a=new e.BooleanKeyframeTrack(".visible",r,[!0,!1,!0]);return new e.AnimationClip(null,t,[a])},fa.CreateMaterialColorAnimation=function(t,r){for(var a=[],i=[],n=t/r.length,o=0;o<=r.length;o++)a.push(o*n),i.push(r[o%r.length]);var s=new e.ColorKeyframeTrack(".material[0].color",a,i);return new e.AnimationClip(null,t,[s])};var pa=function(){function t(e,t){this.mesh=e,this.iks=t||[],this._valid()}var r,a,i,n,o,s,l,u,c,h;function d(t,r){e.Object3D.call(this),this.root=t,this.iks=r||[],this.matrix.copy(t.matrixWorld),this.matrixAutoUpdate=!1,this.sphereGeometry=new e.SphereGeometry(.25,16,8),this.targetSphereMaterial=new e.MeshBasicMaterial({color:new e.Color(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new e.MeshBasicMaterial({color:new e.Color(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new e.MeshBasicMaterial({color:new e.Color(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new e.LineBasicMaterial({color:new e.Color(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init()}return t.prototype={constructor:t,update:(r=new e.Quaternion,a=new e.Vector3,i=new e.Vector3,n=new e.Vector3,o=new e.Vector3,s=new e.Vector3,l=new e.Quaternion,u=new e.Vector3,c=new e.Vector3,h=new e.Vector3,function(){for(var e=this.mesh.skeleton.bones,t=this.iks,d=Math,f=0,p=t.length;f<p;f++){var m=t[f],v=e[m.effector],g=e[m.target];a.setFromMatrixPosition(g.matrixWorld);for(var y=m.links,x=void 0!==m.iteration?m.iteration:1,b=0;b<x;b++){for(var A=!1,w=0,M=y.length;w<M;w++){var S=e[y[w].index];if(!1===y[w].enabled)break;var T=y[w].limitation,C=y[w].rotationMin,F=y[w].rotationMax;S.matrixWorld.decompose(s,l,u),l.invert(),n.setFromMatrixPosition(v.matrixWorld),o.subVectors(n,s),o.applyQuaternion(l),o.normalize(),i.subVectors(a,s),i.applyQuaternion(l),i.normalize();var E=i.dot(o);if(E>1?E=1:E<-1&&(E=-1),!((E=d.acos(E))<1e-5)){if(void 0!==m.minAngle&&E<m.minAngle&&(E=m.minAngle),void 0!==m.maxAngle&&E>m.maxAngle&&(E=m.maxAngle),c.crossVectors(o,i),c.normalize(),r.setFromAxisAngle(c,E),S.quaternion.multiply(r),void 0!==T){var B=S.quaternion.w;B>1&&(B=1);var L=d.sqrt(1-B*B);S.quaternion.set(T.x*L,T.y*L,T.z*L,B)}void 0!==C&&S.rotation.setFromVector3(S.rotation.toVector3(h).max(C)),void 0!==F&&S.rotation.setFromVector3(S.rotation.toVector3(h).min(F)),S.updateMatrixWorld(!0),A=!0}}if(!A)break}}return this}),createHelper:function(){return new d(this.mesh,this.mesh.geometry.userData.MMD.iks)},_valid:function(){for(var e=this.iks,t=this.mesh.skeleton.bones,r=0,a=e.length;r<a;r++){var i=e[r],n=t[i.effector],o=i.links,s=void 0,l=void 0;s=n;for(var u=0,c=o.length;u<c;u++)l=t[o[u].index],s.parent!==l&&console.warn("THREE.CCDIKSolver: bone "+s.name+" is not the child of bone "+l.name),s=l}}},d.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:d,updateMatrixWorld:function(){var t=new e.Matrix4,r=new e.Vector3;function a(e,t){return r.setFromMatrixPosition(e.matrixWorld).applyMatrix4(t)}function i(e,t,r,i){var n=a(r,i);e[3*t+0]=n.x,e[3*t+1]=n.y,e[3*t+2]=n.z}return function(r){var n=this.root;if(this.visible){var o=0,s=this.iks,l=n.skeleton.bones;t.copy(n.matrixWorld).invert();for(var u=0,c=s.length;u<c;u++){var h=s[u],d=l[h.target],f=l[h.effector],p=this.children[o++],m=this.children[o++];p.position.copy(a(d,t)),m.position.copy(a(f,t));for(var v=0,g=h.links.length;v<g;v++){var y=l[h.links[v].index];this.children[o++].position.copy(a(y,t))}var x=this.children[o++],b=x.geometry.attributes.position.array;i(b,0,d,t),i(b,1,f,t);for(var A=0,w=h.links.length;A<w;A++){i(b,A+2,y=l[h.links[A].index],t)}x.geometry.attributes.position.needsUpdate=!0}}this.matrix.copy(n.matrixWorld),e.Object3D.prototype.updateMatrixWorld.call(this,r)}}(),_init:function(){var t=this,r=this.iks;function a(r){return new e.Line(function(t){var r=new e.BufferGeometry,a=new Float32Array(3*(2+t.links.length));return r.setAttribute("position",new e.BufferAttribute(a,3)),r}(r),t.lineMaterial)}for(var i=0,n=r.length;i<n;i++){var o=r[i];this.add(new e.Mesh(t.sphereGeometry,t.targetSphereMaterial)),this.add(new e.Mesh(t.sphereGeometry,t.effectorSphereMaterial));for(var s=0,l=o.links.length;s<l;s++)this.add(new e.Mesh(t.sphereGeometry,t.linkSphereMaterial));this.add(a(o))}}}),t}(),ma=function(){function t(t,a,i,n){if("undefined"==typeof Ammo)throw new Error("THREE.MMDPhysics: Import ammo.js https://github.com/kripken/ammo.js");i=i||[],n=n||{},this.manager=new r,this.mesh=t,this.unitStep=void 0!==n.unitStep?n.unitStep:1/65,this.maxStepNum=void 0!==n.maxStepNum?n.maxStepNum:3,this.gravity=new e.Vector3(0,-98,0),void 0!==n.gravity&&this.gravity.copy(n.gravity),this.world=void 0!==n.world?n.world:null,this.bodies=[],this.constraints=[],this._init(t,a,i)}function r(){this.threeVector3s=[],this.threeMatrix4s=[],this.threeQuaternions=[],this.threeEulers=[],this.transforms=[],this.quaternions=[],this.vector3s=[]}function a(e,t,r,a){this.mesh=e,this.world=t,this.params=r,this.manager=a,this.body=null,this.bone=null,this.boneOffsetForm=null,this.boneOffsetFormInverse=null,this._init()}function i(e,t,r,a,i,n){this.mesh=e,this.world=t,this.bodyA=r,this.bodyB=a,this.params=i,this.manager=n,this.constraint=null,this._init()}function n(t,r){e.Object3D.call(this),this.root=t,this.physics=r,this.matrix.copy(t.matrixWorld),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new e.MeshBasicMaterial({color:new e.Color(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new e.MeshBasicMaterial({color:new e.Color(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new e.MeshBasicMaterial({color:new e.Color(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init()}var o,s,l,u;return t.prototype={constructor:t,update:function(e){var t,r=this.manager,a=this.mesh,i=!1,n=r.allocThreeVector3(),o=r.allocThreeQuaternion(),s=r.allocThreeVector3();return a.matrixWorld.decompose(n,o,s),1===s.x&&1===s.y&&1===s.z||(i=!0),i&&(null!==(t=a.parent)&&(a.parent=null),s.copy(this.mesh.scale),a.scale.set(1,1,1),a.updateMatrixWorld(!0)),this._updateRigidBodies(),this._stepSimulation(e),this._updateBones(),i&&(null!==t&&(a.parent=t),a.scale.copy(s)),r.freeThreeVector3(s),r.freeThreeQuaternion(o),r.freeThreeVector3(n),this},reset:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].reset();return this},warmup:function(e){for(var t=0;t<e;t++)this.update(1/60);return this},setGravity:function(e){return this.world.setGravity(new Ammo.btVector3(e.x,e.y,e.z)),this.gravity.copy(e),this},createHelper:function(){return new n(this.mesh,this)},_init:function(e,t,r){var a=this.manager,i=e.parent;null!==i&&(i=null);var n=a.allocThreeVector3(),o=a.allocThreeQuaternion(),s=a.allocThreeVector3();n.copy(e.position),o.copy(e.quaternion),s.copy(e.scale),e.position.set(0,0,0),e.quaternion.set(0,0,0,1),e.scale.set(1,1,1),e.updateMatrixWorld(!0),null===this.world&&(this.world=this._createWorld(),this.setGravity(this.gravity)),this._initRigidBodies(t),this._initConstraints(r),null!==i&&(e.parent=i),e.position.copy(n),e.quaternion.copy(o),e.scale.copy(s),e.updateMatrixWorld(!0),this.reset(),a.freeThreeVector3(n),a.freeThreeQuaternion(o),a.freeThreeVector3(s)},_createWorld:function(){var e=new Ammo.btDefaultCollisionConfiguration,t=new Ammo.btCollisionDispatcher(e),r=new Ammo.btDbvtBroadphase,a=new Ammo.btSequentialImpulseConstraintSolver;return new Ammo.btDiscreteDynamicsWorld(t,r,a,e)},_initRigidBodies:function(e){for(var t=0,r=e.length;t<r;t++)this.bodies.push(new a(this.mesh,this.world,e[t],this.manager))},_initConstraints:function(e){for(var t=0,r=e.length;t<r;t++){var a=e[t],n=this.bodies[a.rigidBodyIndex1],o=this.bodies[a.rigidBodyIndex2];this.constraints.push(new i(this.mesh,this.world,n,o,a,this.manager))}},_stepSimulation:function(e){var t=this.unitStep,r=e,a=1+(e/t|0);r<t&&(r=t,a=1),a>this.maxStepNum&&(a=this.maxStepNum),this.world.stepSimulation(r,a,t)},_updateRigidBodies:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateFromBone()},_updateBones:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateBone()}},r.prototype={constructor:r,allocThreeVector3:function(){return this.threeVector3s.length>0?this.threeVector3s.pop():new e.Vector3},freeThreeVector3:function(e){this.threeVector3s.push(e)},allocThreeMatrix4:function(){return this.threeMatrix4s.length>0?this.threeMatrix4s.pop():new e.Matrix4},freeThreeMatrix4:function(e){this.threeMatrix4s.push(e)},allocThreeQuaternion:function(){return this.threeQuaternions.length>0?this.threeQuaternions.pop():new e.Quaternion},freeThreeQuaternion:function(e){this.threeQuaternions.push(e)},allocThreeEuler:function(){return this.threeEulers.length>0?this.threeEulers.pop():new e.Euler},freeThreeEuler:function(e){this.threeEulers.push(e)},allocTransform:function(){return this.transforms.length>0?this.transforms.pop():new Ammo.btTransform},freeTransform:function(e){this.transforms.push(e)},allocQuaternion:function(){return this.quaternions.length>0?this.quaternions.pop():new Ammo.btQuaternion},freeQuaternion:function(e){this.quaternions.push(e)},allocVector3:function(){return this.vector3s.length>0?this.vector3s.pop():new Ammo.btVector3},freeVector3:function(e){this.vector3s.push(e)},setIdentity:function(e){e.setIdentity()},getBasis:function(e){var t=this.allocQuaternion();return e.getBasis().getRotation(t),t},getBasisAsMatrix3:function(e){var t=this.getBasis(e),r=this.quaternionToMatrix3(t);return this.freeQuaternion(t),r},getOrigin:function(e){return e.getOrigin()},setOrigin:function(e,t){e.getOrigin().setValue(t.x(),t.y(),t.z())},copyOrigin:function(e,t){var r=t.getOrigin();this.setOrigin(e,r)},setBasis:function(e,t){e.setRotation(t)},setBasisFromMatrix3:function(e,t){var r=this.matrix3ToQuaternion(t);this.setBasis(e,r),this.freeQuaternion(r)},setOriginFromArray3:function(e,t){e.getOrigin().setValue(t[0],t[1],t[2])},setOriginFromThreeVector3:function(e,t){e.getOrigin().setValue(t.x,t.y,t.z)},setBasisFromArray3:function(e,t){var r=this.allocThreeQuaternion(),a=this.allocThreeEuler();a.set(t[0],t[1],t[2]),this.setBasisFromThreeQuaternion(e,r.setFromEuler(a)),this.freeThreeEuler(a),this.freeThreeQuaternion(r)},setBasisFromThreeQuaternion:function(e,t){var r=this.allocQuaternion();r.setX(t.x),r.setY(t.y),r.setZ(t.z),r.setW(t.w),this.setBasis(e,r),this.freeQuaternion(r)},multiplyTransforms:function(e,t){var r=this.allocTransform();this.setIdentity(r);var a=this.getBasisAsMatrix3(e),i=this.getBasisAsMatrix3(t),n=this.getOrigin(e),o=this.getOrigin(t),s=this.multiplyMatrix3ByVector3(a,o),l=this.addVector3(s,n);this.setOrigin(r,l);var u=this.multiplyMatrices3(a,i);return this.setBasisFromMatrix3(r,u),this.freeVector3(s),this.freeVector3(l),r},inverseTransform:function(e){var t=this.allocTransform(),r=this.getBasisAsMatrix3(e),a=this.getOrigin(e),i=this.transposeMatrix3(r),n=this.negativeVector3(a),o=this.multiplyMatrix3ByVector3(i,n);return this.setOrigin(t,o),this.setBasisFromMatrix3(t,i),this.freeVector3(n),this.freeVector3(o),t},multiplyMatrices3:function(e,t){var r=[],a=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),n=this.rowOfMatrix3(e,2),o=this.columnOfMatrix3(t,0),s=this.columnOfMatrix3(t,1),l=this.columnOfMatrix3(t,2);return r[0]=this.dotVectors3(a,o),r[1]=this.dotVectors3(a,s),r[2]=this.dotVectors3(a,l),r[3]=this.dotVectors3(i,o),r[4]=this.dotVectors3(i,s),r[5]=this.dotVectors3(i,l),r[6]=this.dotVectors3(n,o),r[7]=this.dotVectors3(n,s),r[8]=this.dotVectors3(n,l),this.freeVector3(a),this.freeVector3(i),this.freeVector3(n),this.freeVector3(o),this.freeVector3(s),this.freeVector3(l),r},addVector3:function(e,t){var r=this.allocVector3();return r.setValue(e.x()+t.x(),e.y()+t.y(),e.z()+t.z()),r},dotVectors3:function(e,t){return e.x()*t.x()+e.y()*t.y()+e.z()*t.z()},rowOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[3*t+0],e[3*t+1],e[3*t+2]),r},columnOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[t+0],e[t+3],e[t+6]),r},negativeVector3:function(e){var t=this.allocVector3();return t.setValue(-e.x(),-e.y(),-e.z()),t},multiplyMatrix3ByVector3:function(e,t){var r=this.allocVector3(),a=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),n=this.rowOfMatrix3(e,2),o=this.dotVectors3(a,t),s=this.dotVectors3(i,t),l=this.dotVectors3(n,t);return r.setValue(o,s,l),this.freeVector3(a),this.freeVector3(i),this.freeVector3(n),r},transposeMatrix3:function(e){var t=[];return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},quaternionToMatrix3:function(e){var t=[],r=e.x(),a=e.y(),i=e.z(),n=e.w(),o=r*r,s=a*a,l=i*i,u=r*a,c=a*i,h=i*r,d=r*n,f=a*n,p=i*n;return t[0]=1-2*(s+l),t[1]=2*(u-p),t[2]=2*(h+f),t[3]=2*(u+p),t[4]=1-2*(l+o),t[5]=2*(c-d),t[6]=2*(h-f),t[7]=2*(c+d),t[8]=1-2*(o+s),t},matrix3ToQuaternion:function(e){var t,r,a,i,n,o=e[0]+e[4]+e[8];o>0?(n=.25*(t=2*Math.sqrt(o+1)),r=(e[7]-e[5])/t,a=(e[2]-e[6])/t,i=(e[3]-e[1])/t):e[0]>e[4]&&e[0]>e[8]?(t=2*Math.sqrt(1+e[0]-e[4]-e[8]),n=(e[7]-e[5])/t,r=.25*t,a=(e[1]+e[3])/t,i=(e[2]+e[6])/t):e[4]>e[8]?(t=2*Math.sqrt(1+e[4]-e[0]-e[8]),n=(e[2]-e[6])/t,r=(e[1]+e[3])/t,a=.25*t,i=(e[5]+e[7])/t):(t=2*Math.sqrt(1+e[8]-e[0]-e[4]),n=(e[3]-e[1])/t,r=(e[2]+e[6])/t,a=(e[5]+e[7])/t,i=.25*t);var s=this.allocQuaternion();return s.setX(r),s.setY(a),s.setZ(i),s.setW(n),s}},a.prototype={constructor:t.RigidBody,reset:function(){return this._setTransformFromBone(),this},updateFromBone:function(){return-1!==this.params.boneIndex&&0===this.params.type&&this._setTransformFromBone(),this},updateBone:function(){return 0===this.params.type||-1===this.params.boneIndex||(this._updateBoneRotation(),1===this.params.type&&this._updateBonePosition(),this.bone.updateMatrixWorld(!0),2===this.params.type&&this._setPositionFromBone()),this},_init:function(){var t=this.manager,r=this.params,a=this.mesh.skeleton.bones,i=-1===r.boneIndex?new e.Bone:a[r.boneIndex],n=function(e){switch(e.shapeType){case 0:return new Ammo.btSphereShape(e.width);case 1:return new Ammo.btBoxShape(new Ammo.btVector3(e.width,e.height,e.depth));case 2:return new Ammo.btCapsuleShape(e.width,e.height);default:throw"unknown shape type "+e.shapeType}}(r),o=0===r.type?0:r.weight,s=t.allocVector3();s.setValue(0,0,0),0!==o&&n.calculateLocalInertia(o,s);var l=t.allocTransform();t.setIdentity(l),t.setOriginFromArray3(l,r.position),t.setBasisFromArray3(l,r.rotation);var u=t.allocThreeVector3(),c=t.allocTransform();t.setIdentity(c),t.setOriginFromThreeVector3(c,i.getWorldPosition(u));var h=t.multiplyTransforms(c,l),d=new Ammo.btDefaultMotionState(h),f=new Ammo.btRigidBodyConstructionInfo(o,d,n,s);f.set_m_friction(r.friction),f.set_m_restitution(r.restitution);var p=new Ammo.btRigidBody(f);0===r.type&&(p.setCollisionFlags(2|p.getCollisionFlags()),p.setActivationState(4)),p.setDamping(r.positionDamping,r.rotationDamping),p.setSleepingThresholds(0,0),this.world.addRigidBody(p,1<<r.groupIndex,r.groupTarget),this.body=p,this.bone=i,this.boneOffsetForm=l,this.boneOffsetFormInverse=t.inverseTransform(l),t.freeVector3(s),t.freeTransform(h),t.freeTransform(c),t.freeThreeVector3(u)},_getBoneTransform:function(){var e=this.manager,t=e.allocThreeVector3(),r=e.allocThreeQuaternion(),a=e.allocThreeVector3();this.bone.matrixWorld.decompose(t,r,a);var i=e.allocTransform();e.setOriginFromThreeVector3(i,t),e.setBasisFromThreeQuaternion(i,r);var n=e.multiplyTransforms(i,this.boneOffsetForm);return e.freeTransform(i),e.freeThreeVector3(a),e.freeThreeQuaternion(r),e.freeThreeVector3(t),n},_getWorldTransformForBone:function(){var e=this.manager,t=this.body.getCenterOfMassTransform();return e.multiplyTransforms(t,this.boneOffsetFormInverse)},_setTransformFromBone:function(){var e=this.manager,t=this._getBoneTransform();this.body.setCenterOfMassTransform(t),this.body.getMotionState().setWorldTransform(t),e.freeTransform(t)},_setPositionFromBone:function(){var e=this.manager,t=this._getBoneTransform(),r=e.allocTransform();this.body.getMotionState().getWorldTransform(r),e.copyOrigin(r,t),this.body.setCenterOfMassTransform(r),this.body.getMotionState().setWorldTransform(r),e.freeTransform(r),e.freeTransform(t)},_updateBoneRotation:function(){var e=this.manager,t=this._getWorldTransformForBone(),r=e.getBasis(t),a=e.allocThreeQuaternion(),i=e.allocThreeQuaternion(),n=e.allocThreeQuaternion();a.set(r.x(),r.y(),r.z(),r.w()),i.setFromRotationMatrix(this.bone.matrixWorld),i.conjugate(),i.multiply(a),n.setFromRotationMatrix(this.bone.matrix),this.bone.quaternion.copy(i.multiply(n).normalize()),e.freeThreeQuaternion(a),e.freeThreeQuaternion(i),e.freeThreeQuaternion(n),e.freeQuaternion(r),e.freeTransform(t)},_updateBonePosition:function(){var e=this.manager,t=this._getWorldTransformForBone(),r=e.allocThreeVector3(),a=e.getOrigin(t);r.set(a.x(),a.y(),a.z()),this.bone.parent&&this.bone.parent.worldToLocal(r),this.bone.position.copy(r),e.freeThreeVector3(r),e.freeTransform(t)}},i.prototype={constructor:i,_init:function(){var e=this.manager,t=this.params,r=this.bodyA,a=this.bodyB,i=e.allocTransform();e.setIdentity(i),e.setOriginFromArray3(i,t.position),e.setBasisFromArray3(i,t.rotation);var n=e.allocTransform(),o=e.allocTransform();r.body.getMotionState().getWorldTransform(n),a.body.getMotionState().getWorldTransform(o);var s=e.inverseTransform(n),l=e.inverseTransform(o),u=e.multiplyTransforms(s,i),c=e.multiplyTransforms(l,i),h=new Ammo.btGeneric6DofSpringConstraint(r.body,a.body,u,c,!0),d=e.allocVector3(),f=e.allocVector3(),p=e.allocVector3(),m=e.allocVector3();d.setValue(t.translationLimitation1[0],t.translationLimitation1[1],t.translationLimitation1[2]),f.setValue(t.translationLimitation2[0],t.translationLimitation2[1],t.translationLimitation2[2]),p.setValue(t.rotationLimitation1[0],t.rotationLimitation1[1],t.rotationLimitation1[2]),m.setValue(t.rotationLimitation2[0],t.rotationLimitation2[1],t.rotationLimitation2[2]),h.setLinearLowerLimit(d),h.setLinearUpperLimit(f),h.setAngularLowerLimit(p),h.setAngularUpperLimit(m);for(var v=0;v<3;v++)0!==t.springPosition[v]&&(h.enableSpring(v,!0),h.setStiffness(v,t.springPosition[v]));for(var g=0;g<3;g++)0!==t.springRotation[g]&&(h.enableSpring(g+3,!0),h.setStiffness(g+3,t.springRotation[g]));if(void 0!==h.setParam)for(var y=0;y<6;y++)h.setParam(2,.475,y);this.world.addConstraint(h,!0),this.constraint=h,e.freeTransform(i),e.freeTransform(n),e.freeTransform(o),e.freeTransform(s),e.freeTransform(l),e.freeTransform(u),e.freeTransform(c),e.freeVector3(d),e.freeVector3(f),e.freeVector3(p),e.freeVector3(m)}},n.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:n,updateMatrixWorld:(o=new e.Vector3,s=new e.Quaternion,l=new e.Vector3,u=new e.Matrix4,function(t){var r=this.root;if(this.visible){var a=this.physics.bodies;u.copy(r.matrixWorld).decompose(o,s,l).compose(o,s,l.set(1,1,1)).invert();for(var i=0,n=a.length;i<n;i++){var c=a[i].body,h=this.children[i],d=c.getCenterOfMassTransform(),f=d.getOrigin(),p=d.getRotation();h.position.set(f.x(),f.y(),f.z()).applyMatrix4(u),h.quaternion.setFromRotationMatrix(u).multiply(s.set(p.x(),p.y(),p.z(),p.w()))}}this.matrix.copy(r.matrixWorld).decompose(o,s,l).compose(o,s,l.set(1,1,1)),e.Object3D.prototype.updateMatrixWorld.call(this,t)}),_init:function(){var t=this.physics.bodies;function r(t){switch(t.shapeType){case 0:return new e.SphereGeometry(t.width,16,8);case 1:return new e.BoxGeometry(2*t.width,2*t.height,2*t.depth,8,8,8);case 2:return new a(t.width,t.height,16,8);default:return null}}function a(t,r,a,i){var n=new e.CylinderGeometry(t,t,r,a,i,!0),o=new e.Mesh(new e.SphereGeometry(t,a,i,0,2*Math.PI,0,Math.PI/2)),s=new e.Mesh(new e.SphereGeometry(t,a,i,0,2*Math.PI,Math.PI/2,Math.PI/2));return o.position.set(0,r/2,0),s.position.set(0,-r/2,0),o.updateMatrix(),s.updateMatrix(),n.merge(o.geometry,o.matrix),n.merge(s.geometry,s.matrix),n}for(var i=0,n=t.length;i<n;i++){var o=t[i].params;this.add(new e.Mesh(r(o),this.materials[o.type]))}}}),t}(),va=function(){function t(t){t=t||{},this.meshes=[],this.camera=null,this.cameraTarget=new e.Object3D,this.cameraTarget.name="target",this.audio=null,this.audioManager=null,this.objects=new WeakMap,this.configuration={sync:void 0===t.sync||t.sync,afterglow:void 0!==t.afterglow?t.afterglow:0,resetPhysicsOnLoop:void 0===t.resetPhysicsOnLoop||t.resetPhysicsOnLoop},this.enabled={animation:!0,ik:!0,grant:!0,physics:!0,cameraAnimation:!0},this.onBeforePhysics=function(){},this.sharedPhysics=!1,this.masterPhysics=null}function r(e,t){t=t||{},this.audio=e,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==t.delayTime?t.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime}function a(e,t){this.mesh=e,this.grants=t||[]}var i;return t.prototype={constructor:t,add:function(e,t){if(t=t||{},e.isSkinnedMesh)this._addMesh(e,t);else if(e.isCamera)this._setupCamera(e,t);else{if("Audio"!==e.type)throw new Error("THREE.MMDAnimationHelper.add: accepts only THREE.SkinnedMesh or THREE.Camera or THREE.Audio instance.");this._setupAudio(e,t)}return this.configuration.sync&&this._syncDuration(),this},remove:function(e){if(e.isSkinnedMesh)this._removeMesh(e);else if(e.isCamera)this._clearCamera(e);else{if("Audio"!==e.type)throw new Error("THREE.MMDAnimationHelper.remove: accepts only THREE.SkinnedMesh or THREE.Camera or THREE.Audio instance.");this._clearAudio(e)}return this.configuration.sync&&this._syncDuration(),this},update:function(e){null!==this.audioManager&&this.audioManager.control(e);for(var t=0;t<this.meshes.length;t++)this._animateMesh(this.meshes[t],e);return this.sharedPhysics&&this._updateSharedPhysics(e),null!==this.camera&&this._animateCamera(this.camera,e),this},pose:function(t,r,a){!1!==(a=a||{}).resetPose&&t.pose();for(var i=t.skeleton.bones,n=r.bones,o={},s=0,l=i.length;s<l;s++)o[i[s].name]=s;for(var u=new e.Vector3,c=new e.Quaternion,h=0,d=n.length;h<d;h++){var f=n[h],p=o[f.name];if(void 0!==p){var m=i[p];m.position.add(u.fromArray(f.translation)),m.quaternion.multiply(c.fromArray(f.quaternion))}}return t.updateMatrixWorld(!0),!1!==a.ik&&this._createCCDIKSolver(t).update(a.saveOriginalBonesBeforeIK),!1!==a.grant&&this.createGrantSolver(t).update(),this},enable:function(e,t){if(void 0===this.enabled[e])throw new Error("THREE.MMDAnimationHelper.enable: unknown key "+e);if(this.enabled[e]=t,"physics"===e)for(var r=0,a=this.meshes.length;r<a;r++)this._optimizeIK(this.meshes[r],t);return this},createGrantSolver:function(e){return new a(e,e.geometry.userData.MMD.grants)},_addMesh:function(e,t){if(this.meshes.indexOf(e)>=0)throw new Error("THREE.MMDAnimationHelper._addMesh: SkinnedMesh '"+e.name+"' has already been added.");return this.meshes.push(e),this.objects.set(e,{looped:!1}),this._setupMeshAnimation(e,t.animation),!1!==t.physics&&this._setupMeshPhysics(e,t),this},_setupCamera:function(e,t){if(this.camera===e)throw new Error("THREE.MMDAnimationHelper._setupCamera: Camera '"+e.name+"' has already been set.");return this.camera&&this.clearCamera(this.camera),this.camera=e,e.add(this.cameraTarget),this.objects.set(e,{}),void 0!==t.animation&&this._setupCameraAnimation(e,t.animation),this},_setupAudio:function(e,t){if(this.audio===e)throw new Error("THREE.MMDAnimationHelper._setupAudio: Audio '"+e.name+"' has already been set.");return this.audio&&this.clearAudio(this.audio),this.audio=e,this.audioManager=new r(e,t),this.objects.set(this.audioManager,{duration:this.audioManager.duration}),this},_removeMesh:function(e){for(var t=!1,r=0,a=0,i=this.meshes.length;a<i;a++)this.meshes[a]!==e?this.meshes[r++]=this.meshes[a]:(this.objects.delete(e),t=!0);if(!t)throw new Error("THREE.MMDAnimationHelper._removeMesh: SkinnedMesh '"+e.name+"' has not been added yet.");return this.meshes.length=r,this},_clearCamera:function(e){if(e!==this.camera)throw new Error("THREE.MMDAnimationHelper._clearCamera: Camera '"+e.name+"' has not been set yet.");return this.camera.remove(this.cameraTarget),this.objects.delete(this.camera),this.camera=null,this},_clearAudio:function(e){if(e!==this.audio)throw new Error("THREE.MMDAnimationHelper._clearAudio: Audio '"+e.name+"' has not been set yet.");return this.objects.delete(this.audioManager),this.audio=null,this.audioManager=null,this},_setupMeshAnimation:function(t,r){var a=this.objects.get(t);if(void 0!==r){var i=Array.isArray(r)?r:[r];a.mixer=new e.AnimationMixer(t);for(var n=0,o=i.length;n<o;n++)a.mixer.clipAction(i[n]).play();a.mixer.addEventListener("loop",(function(e){var t=e.action._clip.tracks;t.length>0&&".bones"!==t[0].name.slice(0,6)||(a.looped=!0)}))}return a.ikSolver=this._createCCDIKSolver(t),a.grantSolver=this.createGrantSolver(t),this},_setupCameraAnimation:function(t,r){var a=Array.isArray(r)?r:[r],i=this.objects.get(t);i.mixer=new e.AnimationMixer(t);for(var n=0,o=a.length;n<o;n++)i.mixer.clipAction(a[n]).play()},_setupMeshPhysics:function(e,t){var r=this.objects.get(e);if(void 0===t.world&&this.sharedPhysics){var a=this._getMasterPhysics();null!==a&&(world=a.world)}r.physics=this._createMMDPhysics(e,t),r.mixer&&!1!==t.animationWarmup&&(this._animateMesh(e,0),r.physics.reset()),r.physics.warmup(void 0!==t.warmup?t.warmup:60),this._optimizeIK(e,!0)},_animateMesh:function(e,t){var r=this.objects.get(e),a=r.mixer,i=r.ikSolver,n=r.grantSolver,o=r.physics,s=r.looped;a&&this.enabled.animation&&(this._restoreBones(e),a.update(t),this._saveBones(e),i&&this.enabled.ik&&(e.updateMatrixWorld(!0),i.update()),n&&this.enabled.grant&&n.update()),!0===s&&this.enabled.physics&&(o&&this.configuration.resetPhysicsOnLoop&&o.reset(),r.looped=!1),o&&this.enabled.physics&&!this.sharedPhysics&&(this.onBeforePhysics(e),o.update(t))},_animateCamera:function(e,t){var r=this.objects.get(e).mixer;r&&this.enabled.cameraAnimation&&(r.update(t),e.updateProjectionMatrix(),e.up.set(0,1,0),e.up.applyQuaternion(e.quaternion),e.lookAt(this.cameraTarget.position))},_optimizeIK:function(e,t){for(var r=e.geometry.userData.MMD.iks,a=e.geometry.userData.MMD.bones,i=0,n=r.length;i<n;i++)for(var o=r[i].links,s=0,l=o.length;s<l;s++){var u=o[s];u.enabled=!0!==t||!(a[u.index].rigidBodyType>0)}},_createCCDIKSolver:function(e){if(void 0===pa)throw new Error("THREE.MMDAnimationHelper: Import CCDIKSolver.");return new pa(e,e.geometry.userData.MMD.iks)},_createMMDPhysics:function(e,t){if(void 0===ma)throw new Error("THREE.MMDPhysics: Import MMDPhysics.");return new ma(e,e.geometry.userData.MMD.rigidBodies,e.geometry.userData.MMD.constraints,t)},_syncDuration:function(){for(var e=0,t=this.objects,r=this.meshes,a=this.camera,i=this.audioManager,n=0,o=r.length;n<o;n++){if(void 0!==(f=this.objects.get(r[n]).mixer))for(var s=0;s<f._actions.length;s++){var l=f._actions[s]._clip;t.has(l)||t.set(l,{duration:l.duration}),e=Math.max(e,t.get(l).duration)}}if(null!==a&&void 0!==(f=this.objects.get(a).mixer))for(var u=0,c=f._actions.length;u<c;u++){l=f._actions[u]._clip;t.has(l)||t.set(l,{duration:l.duration}),e=Math.max(e,t.get(l).duration)}null!==i&&(e=Math.max(e,t.get(i).duration)),e+=this.configuration.afterglow;for(var h=0,d=this.meshes.length;h<d;h++){var f;if(void 0!==(f=this.objects.get(this.meshes[h]).mixer))for(var p=0,m=f._actions.length;p<m;p++)f._actions[p]._clip.duration=e}if(null!==a&&void 0!==(f=this.objects.get(a).mixer))for(var v=0,g=f._actions.length;v<g;v++)f._actions[v]._clip.duration=e;null!==i&&(i.duration=e)},_updatePropertyMixersBuffer:function(e){for(var t=this.objects.get(e).mixer,r=t._bindings,a=t._accuIndex,i=0,n=r.length;i<n;i++){var o=r[i],s=o.buffer,l=(a+1)*o.valueSize;o.binding.getValue(s,l)}},_saveBones:function(e){var t=this.objects.get(e),r=e.skeleton.bones,a=t.backupBones;void 0===a&&(a=new Float32Array(7*r.length),t.backupBones=a);for(var i=0,n=r.length;i<n;i++){var o=r[i];o.position.toArray(a,7*i),o.quaternion.toArray(a,7*i+3)}},_restoreBones:function(e){var t=this.objects.get(e).backupBones;if(void 0!==t)for(var r=e.skeleton.bones,a=0,i=r.length;a<i;a++){var n=r[a];n.position.fromArray(t,7*a),n.quaternion.fromArray(t,7*a+3)}},_getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var e=0,t=this.meshes.length;e<t;e++){var r=this.meshes[e].physics;if(null!=r)return this.masterPhysics=r,this.masterPhysics}return null},_updateSharedPhysics:function(e){if(0!==this.meshes.length&&this.enabled.physics&&this.sharedPhysics){var t=this._getMasterPhysics();if(null!==t){for(var r=0,a=this.meshes.length;r<a;r++){null!=(o=this.meshes[r].physics)&&o.updateRigidBodies()}t.stepSimulation(e);for(var i=0,n=this.meshes.length;i<n;i++){var o;null!=(o=this.meshes[i].physics)&&o.updateBones()}}}}},r.prototype={constructor:r,control:function(e){return this.elapsed+=e,this.currentTime+=e,this._shouldStopAudio()&&this.audio.stop(),this._shouldStartAudio()&&this.audio.play(),this},_shouldStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime)&&!(this.currentTime-this.delayTime>this.audioDuration)},_shouldStopAudio:function(){return this.audio.isPlaying&&this.currentTime>=this.duration}},a.prototype={constructor:a,update:(i=new e.Quaternion,function(){for(var e=this.mesh.skeleton.bones,t=this.grants,r=0,a=t.length;r<a;r++){var n=t[r],o=e[n.index],s=e[n.parentIndex];n.isLocal?(n.affectPosition,n.affectRotation):(n.affectPosition,n.affectRotation&&(i.set(0,0,0,1),i.slerp(s.quaternion,n.ratio),o.quaternion.multiply(i)))}return this})},t}(),ga=function t(r,a){e.Mesh.call(this,r),this.type="Reflector";var i=this,n=void 0!==(a=a||{}).color?new e.Color(a.color):new e.Color(8355711),o=a.textureWidth||512,s=a.textureHeight||512,l=a.clipBias||0,u=a.shader||t.ReflectorShader,c=new e.Plane,h=new e.Vector3,d=new e.Vector3,f=new e.Vector3,p=new e.Matrix4,m=new e.Vector3(0,0,-1),v=new e.Vector4,g=new e.Vector3,y=new e.Vector3,x=new e.Vector4,b=new e.Matrix4,A=new e.PerspectiveCamera,w={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat},M=new e.WebGLRenderTarget(o,s,w);e.MathUtils.isPowerOfTwo(o)&&e.MathUtils.isPowerOfTwo(s)||(M.texture.generateMipmaps=!1);var S=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(u.uniforms),fragmentShader:u.fragmentShader,vertexShader:u.vertexShader});S.uniforms.tDiffuse.value=M.texture,S.uniforms.color.value=n,S.uniforms.textureMatrix.value=b,this.material=S,this.onBeforeRender=function(e,t,r){if(d.setFromMatrixPosition(i.matrixWorld),f.setFromMatrixPosition(r.matrixWorld),p.extractRotation(i.matrixWorld),h.set(0,0,1),h.applyMatrix4(p),g.subVectors(d,f),!(g.dot(h)>0)){g.reflect(h).negate(),g.add(d),p.extractRotation(r.matrixWorld),m.set(0,0,-1),m.applyMatrix4(p),m.add(f),y.subVectors(d,m),y.reflect(h).negate(),y.add(d),A.position.copy(g),A.up.set(0,1,0),A.up.applyMatrix4(p),A.up.reflect(h),A.lookAt(y),A.far=r.far,A.updateMatrixWorld(),A.projectionMatrix.copy(r.projectionMatrix),b.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),b.multiply(A.projectionMatrix),b.multiply(A.matrixWorldInverse),b.multiply(i.matrixWorld),c.setFromNormalAndCoplanarPoint(h,d),c.applyMatrix4(A.matrixWorldInverse),v.set(c.normal.x,c.normal.y,c.normal.z,c.constant);var a=A.projectionMatrix;x.x=(Math.sign(v.x)+a.elements[8])/a.elements[0],x.y=(Math.sign(v.y)+a.elements[9])/a.elements[5],x.z=-1,x.w=(1+a.elements[10])/a.elements[14],v.multiplyScalar(2/v.dot(x)),a.elements[2]=v.x,a.elements[6]=v.y,a.elements[10]=v.z+1-l,a.elements[14]=v.w,M.texture.encoding=e.outputEncoding,i.visible=!1;var n=e.getRenderTarget(),o=e.xr.enabled,s=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(M),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,A),e.xr.enabled=o,e.shadowMap.autoUpdate=s,e.setRenderTarget(n);var u=r.viewport;void 0!==u&&e.state.viewport(u),i.visible=!0}},this.getRenderTarget=function(){return M}};(ga.prototype=Object.create(e.Mesh.prototype)).constructor=ga,ga.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var ya=function t(r,a){e.Mesh.call(this,r),this.type="Refractor";var i=this,n=void 0!==(a=a||{}).color?new e.Color(a.color):new e.Color(8355711),o=a.textureWidth||512,s=a.textureHeight||512,l=a.clipBias||0,u=a.shader||t.RefractorShader,c=new e.PerspectiveCamera;c.matrixAutoUpdate=!1,c.userData.refractor=!0;var h=new e.Plane,d=new e.Matrix4,f={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat},p=new e.WebGLRenderTarget(o,s,f);e.MathUtils.isPowerOfTwo(o)&&e.MathUtils.isPowerOfTwo(s)||(p.texture.generateMipmaps=!1),this.material=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,transparent:!0}),this.material.uniforms.color.value=n,this.material.uniforms.tDiffuse.value=p.texture,this.material.uniforms.textureMatrix.value=d;var m,v,g,y,x,b,A,w=function(){var t=new e.Vector3,r=new e.Vector3,a=new e.Matrix4,n=new e.Vector3,o=new e.Vector3;return function(e){return t.setFromMatrixPosition(i.matrixWorld),r.setFromMatrixPosition(e.matrixWorld),n.subVectors(t,r),a.extractRotation(i.matrixWorld),o.set(0,0,1),o.applyMatrix4(a),n.dot(o)<0}}(),M=(m=new e.Vector3,v=new e.Vector3,g=new e.Quaternion,y=new e.Vector3,function(){i.matrixWorld.decompose(v,g,y),m.set(0,0,1).applyQuaternion(g).normalize(),m.negate(),h.setFromNormalAndCoplanarPoint(m,v)}),S=(x=new e.Plane,b=new e.Vector4,A=new e.Vector4,function(e){c.matrixWorld.copy(e.matrixWorld),c.matrixWorldInverse.copy(c.matrixWorld).invert(),c.projectionMatrix.copy(e.projectionMatrix),c.far=e.far,x.copy(h),x.applyMatrix4(c.matrixWorldInverse),b.set(x.normal.x,x.normal.y,x.normal.z,x.constant);var t=c.projectionMatrix;A.x=(Math.sign(b.x)+t.elements[8])/t.elements[0],A.y=(Math.sign(b.y)+t.elements[9])/t.elements[5],A.z=-1,A.w=(1+t.elements[10])/t.elements[14],b.multiplyScalar(2/b.dot(A)),t.elements[2]=b.x,t.elements[6]=b.y,t.elements[10]=b.z+1-l,t.elements[14]=b.w});this.onBeforeRender=function(e,t,r){p.texture.encoding=e.outputEncoding,!0!==r.userData.refractor&&!0!=!w(r)&&(M(),function(e){d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(e.projectionMatrix),d.multiply(e.matrixWorldInverse),d.multiply(i.matrixWorld)}(r),S(r),function(e,t,r){i.visible=!1;var a=e.getRenderTarget(),n=e.xr.enabled,o=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(p),!1===e.autoClear&&e.clear(),e.render(t,c),e.xr.enabled=n,e.shadowMap.autoUpdate=o,e.setRenderTarget(a);var s=r.viewport;void 0!==s&&e.state.viewport(s),i.visible=!0}(e,t,r))},this.getRenderTarget=function(){return p}};(ya.prototype=Object.create(e.Mesh.prototype)).constructor=ya,ya.RefractorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var xa,ba=function(t){var r=new e.MeshBasicMaterial({color:0,transparent:!0,opacity:.6,depthWrite:!1});e.Mesh.call(this,t.geometry,r),this.meshMatrix=t.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1};(ba.prototype=Object.create(e.Mesh.prototype)).constructor=ba,ba.prototype.update=(xa=new e.Matrix4,function(e,t){var r=e.normal.x*t.x+e.normal.y*t.y+e.normal.z*t.z+-e.constant*t.w,a=xa.elements;a[0]=r-t.x*e.normal.x,a[4]=-t.x*e.normal.y,a[8]=-t.x*e.normal.z,a[12]=-t.x*-e.constant,a[1]=-t.y*e.normal.x,a[5]=r-t.y*e.normal.y,a[9]=-t.y*e.normal.z,a[13]=-t.y*-e.constant,a[2]=-t.z*e.normal.x,a[6]=-t.z*e.normal.y,a[10]=r-t.z*e.normal.z,a[14]=-t.z*-e.constant,a[3]=-t.w*e.normal.x,a[7]=-t.w*e.normal.y,a[11]=-t.w*e.normal.z,a[15]=r-t.w*-e.constant,this.matrix.multiplyMatrices(xa,this.meshMatrix)});var Aa=function t(){e.Mesh.call(this,t.Geometry,new e.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var r=new e.Vector3,a=new e.Vector3,i=new e.DataTexture(new Uint8Array(768),16,16,e.RGBFormat);i.minFilter=e.NearestFilter,i.magFilter=e.NearestFilter,i.wrapS=e.ClampToEdgeWrapping,i.wrapT=e.ClampToEdgeWrapping;var n=new e.DataTexture(new Uint8Array(768),16,16,e.RGBFormat);n.minFilter=e.NearestFilter,n.magFilter=e.NearestFilter,n.wrapS=e.ClampToEdgeWrapping,n.wrapT=e.ClampToEdgeWrapping;var o=t.Geometry,s=new e.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),l=new e.RawShaderMaterial({uniforms:{map:{value:i},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),u=new e.Mesh(o,s),c=[],h=Ta.Shader,d=new e.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:n},color:{value:new e.Color(16777215)},scale:{value:new e.Vector2},screenPosition:{value:new e.Vector3}},vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:e.AdditiveBlending,transparent:!0,depthWrite:!1}),f=new e.Mesh(o,d);this.addElement=function(e){c.push(e)};var p=new e.Vector2,m=new e.Vector2,v=new e.Box2,g=new e.Vector4;this.onBeforeRender=function(e,t,h){e.getCurrentViewport(g);var y=g.w/g.z,x=g.z/2,b=g.w/2,A=16/g.w;if(p.set(A*y,A),v.min.set(g.x,g.y),v.max.set(g.x+(g.z-16),g.y+(g.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4(h.matrixWorldInverse),!(a.z>0)&&(r.copy(a).applyMatrix4(h.projectionMatrix),m.x=g.x+r.x*x+x-8,m.y=g.y+r.y*b+b-8,v.containsPoint(m))){e.copyFramebufferToTexture(m,i),(C=s.uniforms).scale.value=p,C.screenPosition.value=r,e.renderBufferDirect(h,null,o,s,u,null),e.copyFramebufferToTexture(m,n),(C=l.uniforms).scale.value=p,C.screenPosition.value=r,e.renderBufferDirect(h,null,o,l,u,null);for(var w=2*-r.x,M=2*-r.y,S=0,T=c.length;S<T;S++){var C,F=c[S];(C=d.uniforms).color.value.copy(F.color),C.map.value=F.texture,C.screenPosition.value.x=r.x+w*F.distance,C.screenPosition.value.y=r.y+M*F.distance;A=F.size/g.w,y=g.w/g.z;C.scale.value.set(A*y,A),d.uniformsNeedUpdate=!0,e.renderBufferDirect(h,null,o,d,f,null)}}},this.dispose=function(){s.dispose(),l.dispose(),d.dispose(),i.dispose(),n.dispose();for(var e=0,t=c.length;e<t;e++)c[e].texture.dispose()}};(Aa.prototype=Object.create(e.Mesh.prototype)).constructor=Aa,Aa.prototype.isLensflare=!0;var wa,Ma,Sa,Ta=function(t,r,a,i){this.texture=t,this.size=r||1,this.distance=a||0,this.color=i||new e.Color(16777215)};Ta.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Aa.Geometry=(wa=new e.BufferGeometry,Ma=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),Sa=new e.InterleavedBuffer(Ma,5),wa.setIndex([0,1,2,0,2,3]),wa.setAttribute("position",new e.InterleavedBufferAttribute(Sa,3,0,!1)),wa.setAttribute("uv",new e.InterleavedBufferAttribute(Sa,2,3,!1)),wa);var Ca=function(t,r){e.Mesh.call(this,t);var a=this,i=void 0!==(r=r||{}).textureWidth?r.textureWidth:512,n=void 0!==r.textureHeight?r.textureHeight:512,o=void 0!==r.clipBias?r.clipBias:0,s=void 0!==r.alpha?r.alpha:1,l=void 0!==r.time?r.time:0,u=void 0!==r.waterNormals?r.waterNormals:null,c=void 0!==r.sunDirection?r.sunDirection:new e.Vector3(.70707,.70707,0),h=new e.Color(void 0!==r.sunColor?r.sunColor:16777215),d=new e.Color(void 0!==r.waterColor?r.waterColor:8355711),f=void 0!==r.eye?r.eye:new e.Vector3(0,0,0),p=void 0!==r.distortionScale?r.distortionScale:20,m=void 0!==r.side?r.side:e.FrontSide,v=void 0!==r.fog&&r.fog,g=new e.Plane,y=new e.Vector3,x=new e.Vector3,b=new e.Vector3,A=new e.Matrix4,w=new e.Vector3(0,0,-1),M=new e.Vector4,S=new e.Vector3,T=new e.Vector3,C=new e.Vector4,F=new e.Matrix4,E=new e.PerspectiveCamera,B={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat},L=new e.WebGLRenderTarget(i,n,B);e.MathUtils.isPowerOfTwo(i)&&e.MathUtils.isPowerOfTwo(n)||(L.texture.generateMipmaps=!1);var P={uniforms:e.UniformsUtils.merge([e.UniformsLib.fog,e.UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new e.Matrix4},sunColor:{value:new e.Color(8355711)},sunDirection:{value:new e.Vector3(.70707,.70707,0)},eye:{value:new e.Vector3},waterColor:{value:new e.Color(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","#include <common>","#include <fog_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","#include <beginnormal_vertex>","#include <defaultnormal_vertex>","#include <logdepthbuf_vertex>","#include <fog_vertex>","#include <shadowmap_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}","#include <common>","#include <packing>","#include <bsdfs>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <lights_pars_begin>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","void main() {","#include <logdepthbuf_fragment>","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );","#include <tonemapping_fragment>","#include <fog_fragment>","}"].join("\n")},D=new e.ShaderMaterial({fragmentShader:P.fragmentShader,vertexShader:P.vertexShader,uniforms:e.UniformsUtils.clone(P.uniforms),lights:!0,side:m,fog:v});D.uniforms.mirrorSampler.value=L.texture,D.uniforms.textureMatrix.value=F,D.uniforms.alpha.value=s,D.uniforms.time.value=l,D.uniforms.normalSampler.value=u,D.uniforms.sunColor.value=h,D.uniforms.waterColor.value=d,D.uniforms.sunDirection.value=c,D.uniforms.distortionScale.value=p,D.uniforms.eye.value=f,a.material=D,a.onBeforeRender=function(t,r,i){if(x.setFromMatrixPosition(a.matrixWorld),b.setFromMatrixPosition(i.matrixWorld),A.extractRotation(a.matrixWorld),y.set(0,0,1),y.applyMatrix4(A),S.subVectors(x,b),!(S.dot(y)>0)){S.reflect(y).negate(),S.add(x),A.extractRotation(i.matrixWorld),w.set(0,0,-1),w.applyMatrix4(A),w.add(b),T.subVectors(x,w),T.reflect(y).negate(),T.add(x),E.position.copy(S),E.up.set(0,1,0),E.up.applyMatrix4(A),E.up.reflect(y),E.lookAt(T),E.far=i.far,E.updateMatrixWorld(),E.projectionMatrix.copy(i.projectionMatrix),F.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),F.multiply(E.projectionMatrix),F.multiply(E.matrixWorldInverse),g.setFromNormalAndCoplanarPoint(y,x),g.applyMatrix4(E.matrixWorldInverse),M.set(g.normal.x,g.normal.y,g.normal.z,g.constant);var n=E.projectionMatrix;if(C.x=(Math.sign(M.x)+n.elements[8])/n.elements[0],C.y=(Math.sign(M.y)+n.elements[9])/n.elements[5],C.z=-1,C.w=(1+n.elements[10])/n.elements[14],M.multiplyScalar(2/M.dot(C)),n.elements[2]=M.x,n.elements[6]=M.y,n.elements[10]=M.z+1-o,n.elements[14]=M.w,f.setFromMatrixPosition(i.matrixWorld),t.outputEncoding!==e.LinearEncoding)return console.warn("THREE.Water: WebGLRenderer must use LinearEncoding as outputEncoding."),void(a.onBeforeRender=function(){});if(t.toneMapping!==e.NoToneMapping)return console.warn("THREE.Water: WebGLRenderer must use NoToneMapping as toneMapping."),void(a.onBeforeRender=function(){});var s=t.getRenderTarget(),l=t.xr.enabled,u=t.shadowMap.autoUpdate;a.visible=!1,t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.setRenderTarget(L),t.state.buffers.depth.setMask(!0),!1===t.autoClear&&t.clear(),t.render(r,E),a.visible=!0,t.xr.enabled=l,t.shadowMap.autoUpdate=u,t.setRenderTarget(s);var c=i.viewport;void 0!==c&&t.state.viewport(c)}}};(Ca.prototype=Object.create(e.Mesh.prototype)).constructor=Ca;var Fa=function(t,r,a,i){e.ImmediateRenderObject.call(this,r);var n=this,o=new Float32Array(36),s=new Float32Array(36),l=new Float32Array(36);function u(e,t,r){return e+(t-e)*r}function c(e,t,r,a,i,c,h,d,f,p){var m=(r-h)/(d-h),v=n.normal_cache;o[t+0]=a+m*n.delta,o[t+1]=i,o[t+2]=c,s[t+0]=u(v[e+0],v[e+3],m),s[t+1]=u(v[e+1],v[e+4],m),s[t+2]=u(v[e+2],v[e+5],m),l[t+0]=u(n.palette[3*f+0],n.palette[3*p+0],m),l[t+1]=u(n.palette[3*f+1],n.palette[3*p+1],m),l[t+2]=u(n.palette[3*f+2],n.palette[3*p+2],m)}function h(e,t,r,a,i,c,h,d,f,p){var m=(r-h)/(d-h),v=n.normal_cache;o[t+0]=a,o[t+1]=i+m*n.delta,o[t+2]=c;var g=e+3*n.yd;s[t+0]=u(v[e+0],v[g+0],m),s[t+1]=u(v[e+1],v[g+1],m),s[t+2]=u(v[e+2],v[g+2],m),l[t+0]=u(n.palette[3*f+0],n.palette[3*p+0],m),l[t+1]=u(n.palette[3*f+1],n.palette[3*p+1],m),l[t+2]=u(n.palette[3*f+2],n.palette[3*p+2],m)}function d(e,t,r,a,i,c,h,d,f,p){var m=(r-h)/(d-h),v=n.normal_cache;o[t+0]=a,o[t+1]=i,o[t+2]=c+m*n.delta;var g=e+3*n.zd;s[t+0]=u(v[e+0],v[g+0],m),s[t+1]=u(v[e+1],v[g+1],m),s[t+2]=u(v[e+2],v[g+2],m),l[t+0]=u(n.palette[3*f+0],n.palette[3*p+0],m),l[t+1]=u(n.palette[3*f+1],n.palette[3*p+1],m),l[t+2]=u(n.palette[3*f+2],n.palette[3*p+2],m)}function f(e){var t=3*e;0===n.normal_cache[t]&&(n.normal_cache[t+0]=n.field[e-1]-n.field[e+1],n.normal_cache[t+1]=n.field[e-n.yd]-n.field[e+n.yd],n.normal_cache[t+2]=n.field[e-n.zd]-n.field[e+n.zd])}function p(e,t,r,a,i,u){var p=a+1,v=a+n.yd,g=a+n.zd,y=p+n.yd,x=p+n.zd,b=a+n.yd+n.zd,A=p+n.yd+n.zd,w=0,M=n.field[a],S=n.field[p],T=n.field[v],C=n.field[y],F=n.field[g],E=n.field[x],B=n.field[b],L=n.field[A];M<i&&(w|=1),S<i&&(w|=2),T<i&&(w|=8),C<i&&(w|=4),F<i&&(w|=16),E<i&&(w|=32),B<i&&(w|=128),L<i&&(w|=64);var P=Ea[w];if(0===P)return 0;var D=n.delta,N=e+D,R=t+D,_=r+D;1&P&&(f(a),f(p),c(3*a,0,i,e,t,r,M,S,a,p)),2&P&&(f(p),f(y),h(3*p,3,i,N,t,r,S,C,p,y)),4&P&&(f(v),f(y),c(3*v,6,i,e,R,r,T,C,v,y)),8&P&&(f(a),f(v),h(3*a,9,i,e,t,r,M,T,a,v)),16&P&&(f(g),f(x),c(3*g,12,i,e,t,_,F,E,g,x)),32&P&&(f(x),f(A),h(3*x,15,i,N,t,_,E,L,x,A)),64&P&&(f(b),f(A),c(3*b,18,i,e,R,_,B,L,b,A)),128&P&&(f(g),f(b),h(3*g,21,i,e,t,_,F,B,g,b)),256&P&&(f(a),f(g),d(3*a,24,i,e,t,r,M,F,a,g)),512&P&&(f(p),f(x),d(3*p,27,i,N,t,r,S,E,p,x)),1024&P&&(f(y),f(A),d(3*y,30,i,N,R,r,C,L,y,A)),2048&P&&(f(v),f(b),d(3*v,33,i,e,R,r,T,B,v,b)),w<<=4;for(var I,O,U,k=0,V=0;-1!=Ba[w+V];)O=(I=w+V)+1,U=I+2,m(o,s,l,3*Ba[I],3*Ba[O],3*Ba[U],u),V+=3,k++;return k}function m(e,t,r,a,i,o,s){var l=3*n.count;if(n.positionArray[l+0]=e[a],n.positionArray[l+1]=e[a+1],n.positionArray[l+2]=e[a+2],n.positionArray[l+3]=e[i],n.positionArray[l+4]=e[i+1],n.positionArray[l+5]=e[i+2],n.positionArray[l+6]=e[o],n.positionArray[l+7]=e[o+1],n.positionArray[l+8]=e[o+2],!0===n.material.flatShading){var u=(t[a+0]+t[i+0]+t[o+0])/3,c=(t[a+1]+t[i+1]+t[o+1])/3,h=(t[a+2]+t[i+2]+t[o+2])/3;n.normalArray[l+0]=u,n.normalArray[l+1]=c,n.normalArray[l+2]=h,n.normalArray[l+3]=u,n.normalArray[l+4]=c,n.normalArray[l+5]=h,n.normalArray[l+6]=u,n.normalArray[l+7]=c,n.normalArray[l+8]=h}else n.normalArray[l+0]=t[a+0],n.normalArray[l+1]=t[a+1],n.normalArray[l+2]=t[a+2],n.normalArray[l+3]=t[i+0],n.normalArray[l+4]=t[i+1],n.normalArray[l+5]=t[i+2],n.normalArray[l+6]=t[o+0],n.normalArray[l+7]=t[o+1],n.normalArray[l+8]=t[o+2];if(n.enableUvs){var d=2*n.count;n.uvArray[d+0]=e[a+0],n.uvArray[d+1]=e[a+2],n.uvArray[d+2]=e[i+0],n.uvArray[d+3]=e[i+2],n.uvArray[d+4]=e[o+0],n.uvArray[d+5]=e[o+2]}n.enableColors&&(n.colorArray[l+0]=r[a+0],n.colorArray[l+1]=r[a+1],n.colorArray[l+2]=r[a+2],n.colorArray[l+3]=r[i+0],n.colorArray[l+4]=r[i+1],n.colorArray[l+5]=r[i+2],n.colorArray[l+6]=r[o+0],n.colorArray[l+7]=r[o+1],n.colorArray[l+8]=r[o+2]),n.count+=3,n.count>=n.maxCount-3&&(n.hasPositions=!0,n.hasNormals=!0,n.enableUvs&&(n.hasUvs=!0),n.enableColors&&(n.hasColors=!0),s(n))}function v(e,t,r){var a=new Float32Array(e.length+r);return a.set(e,0),a.set(t.slice(0,r),e.length),a}this.enableUvs=void 0!==a&&a,this.enableColors=void 0!==i&&i,this.init=function(e){this.resolution=e,this.isolation=80,this.size=e,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.palette=new Float32Array(3*this.size3),this.maxCount=4096,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.normalArray=new Float32Array(3*this.maxCount),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(t){if(0!==this.count){for(var r=3*this.count;r<this.positionArray.length;r++)this.positionArray[r]=0;this.hasPositions=!0,this.hasNormals=!0,this.enableUvs&&this.material.map&&(this.hasUvs=!0),this.enableColors&&this.material.vertexColors!==e.NoColors&&(this.hasColors=!0),t(this)}},this.addBall=function(t,r,a,i,n,o){var s=Math.sign(i);i=Math.abs(i);var l=!(null==o),u=new e.Color(t,r,a);if(l)try{u=o instanceof e.Color?o:Array.isArray(o)?new e.Color(Math.min(Math.abs(o[0]),1),Math.min(Math.abs(o[1]),1),Math.min(Math.abs(o[2]),1)):new e.Color(o)}catch(i){u=new e.Color(t,r,a)}var c=this.size*Math.sqrt(i/n),h=a*this.size,d=r*this.size,f=t*this.size,p=Math.floor(h-c);p<1&&(p=1);var m=Math.floor(h+c);m>this.size-1&&(m=this.size-1);var v=Math.floor(d-c);v<1&&(v=1);var g=Math.floor(d+c);g>this.size-1&&(g=this.size-1);var y=Math.floor(f-c);y<1&&(y=1);var x,b,A,w,M,S,T,C,F,E,B,L=Math.floor(f+c);for(L>this.size-1&&(L=this.size-1),A=p;A<m;A++)for(M=this.size2*A,F=(C=A/this.size-a)*C,b=v;b<g;b++)for(w=M+this.size*b,E=(T=b/this.size-r)*T,x=y;x<L;x++)if((B=i/(1e-6+(S=x/this.size-t)*S+E+F)-n)>0){this.field[w+x]+=B*s;var P=Math.sqrt((x-f)*(x-f)+(b-d)*(b-d)+(A-h)*(A-h))/c,D=1-P*P*P*(P*(6*P-15)+10);this.palette[3*(w+x)+0]+=u.r*D,this.palette[3*(w+x)+1]+=u.g*D,this.palette[3*(w+x)+2]+=u.b*D}},this.addPlaneX=function(e,t){var r,a,i,n,o,s,l=this.size,u=this.yd,c=this.zd,h=this.field,d=l*Math.sqrt(e/t);for(d>l&&(d=l),r=0;r<d;r++)if((n=e/(1e-4+(o=r/l)*o)-t)>0)for(a=0;a<l;a++)for(s=r+a*u,i=0;i<l;i++)h[c*i+s]+=n},this.addPlaneY=function(e,t){var r,a,i,n,o,s,l,u=this.size,c=this.yd,h=this.zd,d=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),a=0;a<f;a++)if((n=e/(1e-4+(o=a/u)*o)-t)>0)for(s=a*c,r=0;r<u;r++)for(l=s+r,i=0;i<u;i++)d[h*i+l]+=n},this.addPlaneZ=function(e,t){var r,a,i,n,o,s,l,u=this.size,c=this.yd,h=this.zd,d=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),i=0;i<f;i++)if((n=e/(1e-4+(o=i/u)*o)-t)>0)for(s=h*i,a=0;a<u;a++)for(l=s+a*c,r=0;r<u;r++)d[l+r]+=n},this.setCell=function(e,t,r,a){var i=this.size2*r+this.size*t+e;this.field[i]=a},this.getCell=function(e,t,r){var a=this.size2*r+this.size*t+e;return this.field[a]},this.blur=function(e){void 0===e&&(e=1);for(var t=this.field,r=t.slice(),a=this.size,i=this.size2,n=0;n<a;n++)for(var o=0;o<a;o++)for(var s=0;s<a;s++){for(var l=i*s+a*o+n,u=r[l],c=1,h=-1;h<=1;h+=2){var d=h+n;if(!(d<0||d>=a))for(var f=-1;f<=1;f+=2){var p=f+o;if(!(p<0||p>=a))for(var m=-1;m<=1;m+=2){var v=m+s;if(!(v<0||v>=a))u+=e*(r[i*v+a*p+d]-u)/++c}}}t[l]=u}},this.reset=function(){var e;for(e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0,this.palette[3*e]=this.palette[3*e+1]=this.palette[3*e+2]=0},this.render=function(e){this.begin();for(var t=this.size-2,r=1;r<t;r++)for(var a=this.size2*r,i=(r-this.halfsize)/this.halfsize,n=1;n<t;n++)for(var o=a+this.size*n,s=(n-this.halfsize)/this.halfsize,l=1;l<t;l++){p((l-this.halfsize)/this.halfsize,s,i,o+l,this.isolation,e)}this.end(e)},this.generateGeometry=function(){return console.warn("THREE.MarchingCubes: generateGeometry() now returns BufferGeometry"),this.generateBufferGeometry()},this.generateBufferGeometry=function(){var t=new e.BufferGeometry,r=new Float32Array,a=new Float32Array,i=new Float32Array,n=new Float32Array,o=this;return this.render((function(e){o.hasPositions&&(r=v(r,e.positionArray,3*e.count)),o.hasNormals&&(a=v(a,e.normalArray,3*e.count)),o.hasColors&&(i=v(i,e.colorArray,3*e.count)),o.hasUvs&&(n=v(n,e.uvArray,2*e.count)),e.count=0})),this.hasPositions&&t.setAttribute("position",new e.BufferAttribute(r,3)),this.hasNormals&&t.setAttribute("normal",new e.BufferAttribute(a,3)),this.hasColors&&t.setAttribute("color",new e.BufferAttribute(i,3)),this.hasUvs&&t.setAttribute("uv",new e.BufferAttribute(n,2)),t},this.init(t)};(Fa.prototype=Object.create(e.ImmediateRenderObject.prototype)).constructor=Fa;var Ea=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),Ba=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),La=function(e){var t=this;void 0===e&&(e=Math),b.default(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),b.default(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),b.default(this,"p",[]),b.default(this,"perm",[]),b.default(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),b.default(this,"dot",(function(e,t,r){return e[0]*t+e[1]*r})),b.default(this,"dot3",(function(e,t,r,a){return e[0]*t+e[1]*r+e[2]*a})),b.default(this,"dot4",(function(e,t,r,a,i){return e[0]*t+e[1]*r+e[2]*a+e[3]*i})),b.default(this,"noise",(function(e,r){var a=(e+r)*(.5*(Math.sqrt(3)-1)),i=Math.floor(e+a),n=Math.floor(r+a),o=(3-Math.sqrt(3))/6,s=(i+n)*o,l=e-(i-s),u=r-(n-s),c=0,h=1;l>u&&(c=1,h=0);var d=l-c+o,f=u-h+o,p=l-1+2*o,m=u-1+2*o,v=255&i,g=255&n,y=t.perm[v+t.perm[g]]%12,x=t.perm[v+c+t.perm[g+h]]%12,b=t.perm[v+1+t.perm[g+1]]%12,A=.5-l*l-u*u,w=.5-d*d-f*f,M=.5-p*p-m*m;return 70*((A<0?0:(A*=A)*A*t.dot(t.grad3[y],l,u))+(w<0?0:(w*=w)*w*t.dot(t.grad3[x],d,f))+(M<0?0:(M*=M)*M*t.dot(t.grad3[b],p,m)))})),b.default(this,"noise3d",(function(e,r,a){var i,n,o,s,l,u,c=(e+r+a)*(1/3),h=Math.floor(e+c),d=Math.floor(r+c),f=Math.floor(a+c),p=1/6,m=(h+d+f)*p,v=e-(h-m),g=r-(d-m),y=a-(f-m);v>=g?g>=y?(i=1,n=0,o=0,s=1,l=1,u=0):v>=y?(i=1,n=0,o=0,s=1,l=0,u=1):(i=0,n=0,o=1,s=1,l=0,u=1):g<y?(i=0,n=0,o=1,s=0,l=1,u=1):v<y?(i=0,n=1,o=0,s=0,l=1,u=1):(i=0,n=1,o=0,s=1,l=1,u=0);var x=v-i+p,b=g-n+p,A=y-o+p,w=v-s+2*p,M=g-l+2*p,S=y-u+2*p,T=v-1+.5,C=g-1+.5,F=y-1+.5,E=255&h,B=255&d,L=255&f,P=t.perm[E+t.perm[B+t.perm[L]]]%12,D=t.perm[E+i+t.perm[B+n+t.perm[L+o]]]%12,N=t.perm[E+s+t.perm[B+l+t.perm[L+u]]]%12,R=t.perm[E+1+t.perm[B+1+t.perm[L+1]]]%12,_=.6-v*v-g*g-y*y,I=.6-x*x-b*b-A*A,O=.6-w*w-M*M-S*S,U=.6-T*T-C*C-F*F;return 32*((_<0?0:(_*=_)*_*t.dot3(t.grad3[P],v,g,y))+(I<0?0:(I*=I)*I*t.dot3(t.grad3[D],x,b,A))+(O<0?0:(O*=O)*O*t.dot3(t.grad3[N],w,M,S))+(U<0?0:(U*=U)*U*t.dot3(t.grad3[R],T,C,F)))})),b.default(this,"noise4d",(function(e,r,a,i){var n,o,s,l,u,c,h,d,f,p,m,v,g=t.grad4,y=t.simplex,x=t.perm,b=(Math.sqrt(5)-1)/4,A=(5-Math.sqrt(5))/20,w=(e+r+a+i)*b,M=Math.floor(e+w),S=Math.floor(r+w),T=Math.floor(a+w),C=Math.floor(i+w),F=(M+S+T+C)*A,E=e-(M-F),B=r-(S-F),L=a-(T-F),P=i-(C-F),D=(E>B?32:0)+(E>L?16:0)+(B>L?8:0)+(E>P?4:0)+(B>P?2:0)+(L>P?1:0),N=E-(n=y[D][0]>=3?1:0)+A,R=B-(o=y[D][1]>=3?1:0)+A,_=L-(s=y[D][2]>=3?1:0)+A,I=P-(l=y[D][3]>=3?1:0)+A,O=E-(u=y[D][0]>=2?1:0)+2*A,U=B-(c=y[D][1]>=2?1:0)+2*A,k=L-(h=y[D][2]>=2?1:0)+2*A,V=P-(d=y[D][3]>=2?1:0)+2*A,G=E-(f=y[D][0]>=1?1:0)+3*A,j=B-(p=y[D][1]>=1?1:0)+3*A,z=L-(m=y[D][2]>=1?1:0)+3*A,H=P-(v=y[D][3]>=1?1:0)+3*A,W=E-1+4*A,X=B-1+4*A,Q=L-1+4*A,Y=P-1+4*A,J=255&M,K=255&S,q=255&T,Z=255&C,$=x[J+x[K+x[q+x[Z]]]]%32,ee=x[J+n+x[K+o+x[q+s+x[Z+l]]]]%32,te=x[J+u+x[K+c+x[q+h+x[Z+d]]]]%32,re=x[J+f+x[K+p+x[q+m+x[Z+v]]]]%32,ae=x[J+1+x[K+1+x[q+1+x[Z+1]]]]%32,ie=.6-E*E-B*B-L*L-P*P,ne=.6-N*N-R*R-_*_-I*I,oe=.6-O*O-U*U-k*k-V*V,se=.6-G*G-j*j-z*z-H*H,le=.6-W*W-X*X-Q*Q-Y*Y;return 27*((ie<0?0:(ie*=ie)*ie*t.dot4(g[$],E,B,L,P))+(ne<0?0:(ne*=ne)*ne*t.dot4(g[ee],N,R,_,I))+(oe<0?0:(oe*=oe)*oe*t.dot4(g[te],O,U,k,V))+(se<0?0:(se*=se)*se*t.dot4(g[re],G,j,z,H))+(le<0?0:(le*=le)*le*t.dot4(g[ae],W,X,Q,Y)))}));for(var r=0;r<256;r++)this.p[r]=Math.floor(256*e.random());for(var a=0;a<512;a++)this.perm[a]=this.p[255&a]},Pa=function(t){function r(e){var a;return(a=t.call(this)||this).type="LightningStrike",e=e||{},a.init(r.copyParameters(e,e)),a.createMesh(),a}g.default(r,t);var a=r.prototype;return a.update=function(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),e<this.subrays[0].endPropagationTime?this.state=r.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?this.state=r.RAY_VANISHING:this.state=r.RAY_STEADY,this.visible=!0):(this.visible=!1,e<this.rayParameters.birthTime?this.state=r.RAY_UNBORN:this.state=r.RAY_EXTINGUISHED))},a.init=function(t){this.rayParameters=t,this.maxIterations=void 0!==t.maxIterations?Math.floor(t.maxIterations):9,t.maxIterations=this.maxIterations,this.isStatic=void 0!==t.isStatic&&t.isStatic,t.isStatic=this.isStatic,this.ramification=void 0!==t.ramification?Math.floor(t.ramification):5,t.ramification=this.ramification,this.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?Math.floor(t.maxSubrayRecursion):3,t.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,t.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==t.generateUVs&&t.generateUVs,t.generateUVs=this.generateUVs,void 0!==t.randomGenerator?(this.randomGenerator=t.randomGenerator,this.seedGenerator=t.randomGenerator,void 0!==t.noiseSeed&&this.seedGenerator.setSeed(t.noiseSeed)):(this.randomGenerator=r.createRandomGenerator(),this.seedGenerator=Math),void 0!==t.onDecideSubrayCreation?this.onDecideSubrayCreation=t.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==t.onSubrayCreation&&(this.onSubrayCreation=t.onSubrayCreation)),this.state=r.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),t.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(var a=0;a<this.maxSubrays;a++)this.subrays.push(this.createSubray());this.raySegments=[];for(var i=0;i<this.maxRaySegments;i++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new La(this.seedGenerator),this.simplexY=new La(this.seedGenerator),this.simplexZ=new La(this.seedGenerator),this.forwards=new e.Vector3,this.forwardsFill=new e.Vector3,this.side=new e.Vector3,this.down=new e.Vector3,this.middlePos=new e.Vector3,this.middleLinPos=new e.Vector3,this.newPos=new e.Vector3,this.vPos=new e.Vector3,this.cross1=new e.Vector3},a.createMesh=function(){var t=1<<this.maxIterations,r=3*(t+1)*this.maxSubrays,a=18*t*this.maxSubrays;this.vertices=new Float32Array(3*r),this.indices=new Uint32Array(a),this.generateUVs&&(this.uvs=new Float32Array(2*r)),this.fillMesh(0),this.setIndex(new e.Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new e.Float32BufferAttribute(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new e.Float32BufferAttribute(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=e.DynamicDrawUsage,this.positionAttribute.usage=e.DynamicDrawUsage,this.generateUVs&&(this.uvsAttribute.usage=e.DynamicDrawUsage)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)},a.updateMesh=function(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)},a.fillMesh=function(e){var t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,(function(r){var a=t.currentSubray;e<a.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<a.endPropagationTime?t.timeFraction>=r.fraction0*a.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<a.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=a.vanishingTimeFactor+r.fraction1*(1-a.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))}))},a.addNewSubray=function(){return this.subrays[this.numSubrays++]},a.initSubray=function(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0},a.fractalRay=function(t,r){this.time=t,this.currentSegmentCallback=r,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(var a=0;a<this.numSubrays;a++){var i=this.subrays[a];this.currentSubray=i,this.randomGenerator.setSeed(i.seed),i.endPropagationTime=e.MathUtils.lerp(i.birthTime,i.deathTime,i.propagationTimeFactor),i.beginVanishingTime=e.MathUtils.lerp(i.deathTime,i.birthTime,1-i.vanishingTimeFactor);var n=this.randomGenerator.random;i.linPos0.set(n(),n(),n()).multiplyScalar(1e3),i.linPos1.set(n(),n(),n()).multiplyScalar(1e3),this.timeFraction=(t-i.birthTime)/(i.deathTime-i.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;var o=this.getNewSegment();o.iteration=0,o.pos0.copy(i.pos0),o.pos1.copy(i.pos1),o.linPos0.copy(i.linPos0),o.linPos1.copy(i.linPos1),o.up0.copy(i.up0),o.up1.copy(i.up1),o.radius0=i.radius0,o.radius1=i.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-i.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,i.recursion)/(1<<i.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null},a.fractalRayRecursive=function(e){if(e.iteration>=this.currentSubray.maxIterations)this.currentSegmentCallback(e);else{this.forwards.subVectors(e.pos1,e.pos0);var t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());var r=.5*(e.radius0+e.radius1),a=.5*(e.fraction0+e.fraction1),i=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);var n=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(n.x,n.y,n.z,i),this.simplexY.noise4d(n.x,n.y,n.z,i),this.simplexZ.noise4d(n.x,n.y,n.z,i)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);var o=this.getNewSegment();o.pos0.copy(e.pos0),o.pos1.copy(this.newPos),o.linPos0.copy(e.linPos0),o.linPos1.copy(this.middleLinPos),o.up0.copy(e.up0),o.up1.copy(e.up1),o.radius0=e.radius0,o.radius1=r,o.fraction0=e.fraction0,o.fraction1=a,o.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,o.iteration=e.iteration+1;var s=this.getNewSegment();s.pos0.copy(this.newPos),s.pos1.copy(e.pos1),s.linPos0.copy(this.middleLinPos),s.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),s.up0.crossVectors(this.forwards,this.cross1).normalize(),s.up1.copy(e.up1),s.radius0=r,s.radius1=e.radius1,s.fraction0=a,s.fraction1=e.fraction1,s.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,s.iteration=e.iteration+1,this.fractalRayRecursive(o),this.fractalRayRecursive(s)}},a.createPrism=function(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()},a.createTriangleVerticesWithoutUVs=function(e,t,a,i){this.side.crossVectors(t,a).multiplyScalar(i*r.COS30DEG),this.down.copy(t).multiplyScalar(-i*r.SIN30DEG);var n=this.vPos,o=this.vertices;n.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=n.x,o[this.currentCoordinate++]=n.y,o[this.currentCoordinate++]=n.z,n.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=n.x,o[this.currentCoordinate++]=n.y,o[this.currentCoordinate++]=n.z,n.copy(t).multiplyScalar(i).add(e),o[this.currentCoordinate++]=n.x,o[this.currentCoordinate++]=n.y,o[this.currentCoordinate++]=n.z,this.currentVertex+=3},a.createTriangleVerticesWithUVs=function(e,t,a,i,n){this.side.crossVectors(t,a).multiplyScalar(i*r.COS30DEG),this.down.copy(t).multiplyScalar(-i*r.SIN30DEG);var o=this.vPos,s=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),s[this.currentCoordinate++]=o.x,s[this.currentCoordinate++]=o.y,s[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=n,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),s[this.currentCoordinate++]=o.x,s[this.currentCoordinate++]=o.y,s[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=n,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(i).add(e),s[this.currentCoordinate++]=o.x,s[this.currentCoordinate++]=o.y,s[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=n,l[this.currentUVCoordinate++]=1,this.currentVertex+=3},a.createPrismFaces=function(e){var t=this.indices;e=this.currentVertex-6;t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5},a.createDefaultSubrayCreationCallbacks=function(){var t=this.randomGenerator.random;this.onDecideSubrayCreation=function(r,a){var i=a.currentSubray,n=a.rayParameters.subrayPeriod,o=a.rayParameters.subrayDutyCycle,s=a.rayParameters.isEternal&&0==i.recursion?-t()*n:e.MathUtils.lerp(i.birthTime,i.endPropagationTime,r.fraction0)-t()*n,l=a.time-s,u=Math.floor(l/n),c=t()*(u+1),h=0;if(l%n<=o*n&&(h=a.subrayProbability),i.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&t()<h){var d=a.addNewSubray(),f=a.randomGenerator.getSeed();d.seed=c,a.randomGenerator.setSeed(c),d.recursion=i.recursion+1,d.maxIterations=Math.max(1,i.maxIterations-1),d.linPos0.set(t(),t(),t()).multiplyScalar(1e3),d.linPos1.set(t(),t(),t()).multiplyScalar(1e3),d.up0.copy(i.up0),d.up1.copy(i.up1),d.radius0=r.radius0*a.rayParameters.radius0Factor,d.radius1=Math.min(a.rayParameters.minRadius,r.radius1*a.rayParameters.radius1Factor),d.birthTime=s+u*n,d.deathTime=d.birthTime+n*o,a.rayParameters.isEternal||0!=i.recursion||(d.birthTime=Math.max(d.birthTime,i.birthTime),d.deathTime=Math.min(d.deathTime,i.deathTime)),d.timeScale=2*i.timeScale,d.roughness=i.roughness,d.straightness=i.straightness,d.propagationTimeFactor=i.propagationTimeFactor,d.vanishingTimeFactor=i.vanishingTimeFactor,a.onSubrayCreation(r,i,d,a),a.randomGenerator.setSeed(f)}};var r=new e.Vector3,a=new e.Vector3,i=new e.Vector3,n=new e.Vector3;this.onSubrayCreation=function(e,t,r,a){a.subrayCylinderPosition(e,t,r,.5,.6,.2)},this.subrayConePosition=function(e,o,s,l,u,c){s.pos0.copy(e.pos0),r.subVectors(o.pos1,o.pos0),a.copy(r).normalize(),r.multiplyScalar(e.fraction0+(1-e.fraction0)*(t()*l));var h=r.length();i.crossVectors(o.up0,a);var d=2*Math.PI*t();i.multiplyScalar(Math.cos(d)),n.copy(o.up0).multiplyScalar(Math.sin(d)),s.pos1.copy(i).add(n).multiplyScalar(h*u*(c+t()*(1-c))).add(r).add(o.pos0)},this.subrayCylinderPosition=function(e,o,s,l,u,c){s.pos0.copy(e.pos0),r.subVectors(o.pos1,o.pos0),a.copy(r).normalize(),r.multiplyScalar(e.fraction0+(1-e.fraction0)*((2*t()-1)*l));var h=r.length();i.crossVectors(o.up0,a);var d=2*Math.PI*t();i.multiplyScalar(Math.cos(d)),n.copy(o.up0).multiplyScalar(Math.sin(d)),s.pos1.copy(i).add(n).multiplyScalar(h*u*(c+t()*(1-c))).add(r).add(o.pos0)}},a.createSubray=function(){return{seed:0,maxIterations:0,recursion:0,pos0:new e.Vector3,pos1:new e.Vector3,linPos0:new e.Vector3,linPos1:new e.Vector3,up0:new e.Vector3,up1:new e.Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}},a.createSegment=function(){return{iteration:0,pos0:new e.Vector3,pos1:new e.Vector3,linPos0:new e.Vector3,linPos1:new e.Vector3,up0:new e.Vector3,up1:new e.Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}},a.getNewSegment=function(){return this.raySegments[this.currentSegmentIndex++]},a.copy=function(e){return t.prototype.copy.call(this,e),this.init(r.copyParameters({},e.rayParameters)),this},a.clone=function(){return new this.constructor(r.copyParameters({},this.rayParameters))},r}(e.BufferGeometry);Pa.prototype.isLightningStrike=!0,Pa.RAY_INITIALIZED=0,Pa.RAY_UNBORN=1,Pa.RAY_PROPAGATING=2,Pa.RAY_STEADY=3,Pa.RAY_VANISHING=4,Pa.RAY_EXTINGUISHED=5,Pa.COS30DEG=Math.cos(30*Math.PI/180),Pa.SIN30DEG=Math.sin(30*Math.PI/180),Pa.createRandomGenerator=function(){for(var e=2053,t=[],r=0;r<e;r++)t.push(Math.random());var a={currentSeed:0,random:function(){var r=t[a.currentSeed];return a.currentSeed=(a.currentSeed+1)%e,r},getSeed:function(){return a.currentSeed/e},setSeed:function(t){a.currentSeed=Math.floor(t*e)%e}};return a},Pa.copyParameters=function(t,r){r=r||{};var a=function(e){return r===t?e:e.clone()};return(t=t||{}).sourceOffset=void 0!==r.sourceOffset?a(r.sourceOffset):new e.Vector3(0,100,0),t.destOffset=void 0!==r.destOffset?a(r.destOffset):new e.Vector3(0,0,0),t.timeScale=void 0!==r.timeScale?r.timeScale:1,t.roughness=void 0!==r.roughness?r.roughness:.9,t.straightness=void 0!==r.straightness?r.straightness:.7,t.up0=void 0!==r.up0?a(r.up0):new e.Vector3(0,0,1),t.up1=void 0!==r.up1?a(r.up1):new e.Vector3(0,0,1),t.radius0=void 0!==r.radius0?r.radius0:1,t.radius1=void 0!==r.radius1?r.radius1:1,t.radius0Factor=void 0!==r.radius0Factor?r.radius0Factor:.5,t.radius1Factor=void 0!==r.radius1Factor?r.radius1Factor:.2,t.minRadius=void 0!==r.minRadius?r.minRadius:.2,t.isEternal=void 0!==r.isEternal?r.isEternal:void 0===r.birthTime||void 0===r.deathTime,t.birthTime=r.birthTime,t.deathTime=r.deathTime,t.propagationTimeFactor=void 0!==r.propagationTimeFactor?r.propagationTimeFactor:.1,t.vanishingTimeFactor=void 0!==r.vanishingTimeFactor?r.vanishingTimeFactor:.9,t.subrayPeriod=void 0!==r.subrayPeriod?r.subrayPeriod:4,t.subrayDutyCycle=void 0!==r.subrayDutyCycle?r.subrayDutyCycle:.6,t.maxIterations=void 0!==r.maxIterations?r.maxIterations:9,t.isStatic=void 0!==r.isStatic&&r.isStatic,t.ramification=void 0!==r.ramification?r.ramification:5,t.maxSubrayRecursion=void 0!==r.maxSubrayRecursion?r.maxSubrayRecursion:3,t.recursionProbability=void 0!==r.recursionProbability?r.recursionProbability:.6,t.generateUVs=void 0!==r.generateUVs&&r.generateUVs,t.randomGenerator=r.randomGenerator,t.noiseSeed=r.noiseSeed,t.onDecideSubrayCreation=r.onDecideSubrayCreation,t.onSubrayCreation=r.onSubrayCreation,t};var Da=function(t){e.Object3D.call(this),t=t||{},this.stormParams=t,t.size=void 0!==t.size?t.size:1e3,t.minHeight=void 0!==t.minHeight?t.minHeight:80,t.maxHeight=void 0!==t.maxHeight?t.maxHeight:100,t.maxSlope=void 0!==t.maxSlope?t.maxSlope:1.1,t.maxLightnings=void 0!==t.maxLightnings?t.maxLightnings:3,t.lightningMinPeriod=void 0!==t.lightningMinPeriod?t.lightningMinPeriod:3,t.lightningMaxPeriod=void 0!==t.lightningMaxPeriod?t.lightningMaxPeriod:7,t.lightningMinDuration=void 0!==t.lightningMinDuration?t.lightningMinDuration:1,t.lightningMaxDuration=void 0!==t.lightningMaxDuration?t.lightningMaxDuration:2.5,this.lightningParameters=Pa.copyParameters(t.lightningParameters,t.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=void 0!==t.lightningMaterial?t.lightningMaterial:new e.MeshBasicMaterial({color:11599871}),void 0!==t.onRayPosition?this.onRayPosition=t.onRayPosition:this.onRayPosition=function(r,a){a.set((Math.random()-.5)*t.size,0,(Math.random()-.5)*t.size);var i=e.MathUtils.lerp(t.minHeight,t.maxHeight,Math.random());r.set(t.maxSlope*(2*Math.random()-1),1,t.maxSlope*(2*Math.random()-1)).multiplyScalar(i).add(a)},this.onLightningDown=t.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(var r=0;r<this.stormParams.maxLightnings;r++){var a=new Pa(Pa.copyParameters({},this.lightningParameters)),i=new e.Mesh(a,this.lightningMaterial);this.deadLightningsMeshes.push(i)}};(Da.prototype=Object.create(e.Object3D.prototype)).constructor=Da,Da.prototype.isLightningStorm=!0,Da.prototype.update=function(t){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(t)*Math.random(),this.inited=!0),t>=this.nextLightningTime){var r=this.deadLightningsMeshes.pop();if(r){var a=Pa.copyParameters(r.geometry.rayParameters,this.lightningParameters);a.birthTime=t,a.deathTime=t+e.MathUtils.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(a.sourceOffset,a.destOffset),a.noiseSeed=Math.random(),this.add(r),this.lightningsMeshes.push(r)}this.nextLightningTime=this.getNextLightningTime(t)}for(var i=0,n=this.lightningsMeshes.length;i<n;){var o=this.lightningsMeshes[i],s=o.geometry,l=s.state;s.update(t),l===Pa.RAY_PROPAGATING&&s.state>l&&this.onLightningDown&&this.onLightningDown(s),s.state===Pa.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(o),1),this.deadLightningsMeshes.push(o),this.remove(o),n--):i++}},Da.prototype.getNextLightningTime=function(t){return t+e.MathUtils.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)},Da.prototype.copy=function(t){return e.Object3D.prototype.copy.call(this,t),this.stormParams.size=t.stormParams.size,this.stormParams.minHeight=t.stormParams.minHeight,this.stormParams.maxHeight=t.stormParams.maxHeight,this.stormParams.maxSlope=t.stormParams.maxSlope,this.stormParams.maxLightnings=t.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=t.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=t.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=t.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=t.stormParams.lightningMaxDuration,this.lightningParameters=Pa.copyParameters({},t.lightningParameters),this.lightningMaterial=t.stormParams.lightningMaterial,this.onLightningDown=t.onLightningDown,this},Pa.prototype.clone=function(){return new this.constructor(this.stormParams).copy(this)};var Na=function(e,t){ga.call(this,e,t),this.geometry.setDrawRange(0,0)};Na.prototype=Object.create(ga.prototype);var Ra=function t(r,a){e.Mesh.call(this,r),this.type="ReflectorForSSRPass";var i=this,n=void 0!==(a=a||{}).color?new e.Color(a.color):new e.Color(8355711),o=a.textureWidth||512,s=a.textureHeight||512,l=a.clipBias||0,u=a.shader||t.ReflectorShader,c=a.useDepthTexture,h=new e.Vector3(0,1,0),d=new e.Vector3,f=new e.Vector3;i.needsUpdate=!1,i.maxDistance=t.ReflectorShader.uniforms.maxDistance.value,i.opacity=t.ReflectorShader.uniforms.opacity.value,i._isDistanceAttenuation=t.ReflectorShader.defines.isDistanceAttenuation,Object.defineProperty(i,"isDistanceAttenuation",{get:function(){return i._isDistanceAttenuation},set:function(e){i._isDistanceAttenuation!==e&&(i._isDistanceAttenuation=e,i.material.defines.isDistanceAttenuation=e,i.material.needsUpdate=!0)}}),i._isFresnel=t.ReflectorShader.defines.isFresnel,Object.defineProperty(i,"isFresnel",{get:function(){return i._isFresnel},set:function(e){i._isFresnel!==e&&(i._isFresnel=e,i.material.defines.isFresnel=e,i.material.needsUpdate=!0)}});var p=new e.Plane,m=new e.Vector3,v=new e.Vector3,g=new e.Vector3,y=new e.Matrix4,x=new e.Vector3(0,0,-1),b=new e.Vector4,A=new e.Vector3,w=new e.Vector3,M=new e.Vector4,S=new e.Matrix4,T=new e.PerspectiveCamera;if(c){var C=new e.DepthTexture;C.type=e.UnsignedShortType,C.minFilter=e.NearestFilter,C.maxFilter=e.NearestFilter}var F={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat,depthTexture:c?C:null},E=new e.WebGLRenderTarget(o,s,F);e.MathUtils.isPowerOfTwo(o)&&e.MathUtils.isPowerOfTwo(s)||(E.texture.generateMipmaps=!1);var B=new e.ShaderMaterial({transparent:c,defines:Object.assign({useDepthTexture:c},t.ReflectorShader.defines),uniforms:e.UniformsUtils.clone(u.uniforms),fragmentShader:u.fragmentShader,vertexShader:u.vertexShader});B.uniforms.tDiffuse.value=E.texture,B.uniforms.color.value=n,B.uniforms.textureMatrix.value=S,c&&(B.uniforms.tDepth.value=E.depthTexture),this.material=B,this.doRender=function(e,t,r){if(B.uniforms.maxDistance.value=i.maxDistance*(r.position.length()/r.position.y),B.uniforms.opacity.value=i.opacity,d.copy(r.position).normalize(),f.copy(d).reflect(h),B.uniforms.fresnel.value=(d.dot(f)+1)/2,v.setFromMatrixPosition(i.matrixWorld),g.setFromMatrixPosition(r.matrixWorld),y.extractRotation(i.matrixWorld),m.set(0,0,1),m.applyMatrix4(y),A.subVectors(v,g),!(A.dot(m)>0)){A.reflect(m).negate(),A.add(v),y.extractRotation(r.matrixWorld),x.set(0,0,-1),x.applyMatrix4(y),x.add(g),w.subVectors(v,x),w.reflect(m).negate(),w.add(v),T.position.copy(A),T.up.set(0,1,0),T.up.applyMatrix4(y),T.up.reflect(m),T.lookAt(w),T.far=r.far,T.updateMatrixWorld(),T.projectionMatrix.copy(r.projectionMatrix),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(T.projectionMatrix),S.multiply(T.matrixWorldInverse),S.multiply(i.matrixWorld),p.setFromNormalAndCoplanarPoint(m,v),p.applyMatrix4(T.matrixWorldInverse),b.set(p.normal.x,p.normal.y,p.normal.z,p.constant);var a=T.projectionMatrix;M.x=(Math.sign(b.x)+a.elements[8])/a.elements[0],M.y=(Math.sign(b.y)+a.elements[9])/a.elements[5],M.z=-1,M.w=(1+a.elements[10])/a.elements[14],b.multiplyScalar(2/b.dot(M)),a.elements[2]=b.x,a.elements[6]=b.y,a.elements[10]=b.z+1-l,a.elements[14]=b.w,E.texture.encoding=e.outputEncoding;var n=e.getRenderTarget(),o=e.xr.enabled,s=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(E),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,T),e.xr.enabled=o,e.shadowMap.autoUpdate=s,e.setRenderTarget(n);var u=r.viewport;void 0!==u&&e.state.viewport(u)}},this.getRenderTarget=function(){return E}};(Ra.prototype=Object.create(e.Mesh.prototype)).constructor=Ra,Ra.ReflectorShader={defines:{isDistanceAttenuation:!0,isFresnel:!0},uniforms:{color:{value:null},tDiffuse:{value:null},tDepth:{value:null},textureMatrix:{value:null},maxDistance:{value:180},opacity:{value:.5},fresnel:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:"\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDepth;\n\t\tuniform float maxDistance;\n\t\tuniform float opacity;\n\t\tuniform float fresnel;\n\t\tvarying vec4 vUv;\n\t\tfloat blendOverlay( float base, float blend ) {\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\t\t}\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\t\t}\n\t\tvoid main() {\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\t#ifdef useDepthTexture\n\t\t\t\tfloat op=opacity;\n\t\t\t\tfloat depth = texture2DProj( tDepth, vUv ).r;\n\t\t\t\tif(depth>maxDistance) discard;\n\t\t\t\t#ifdef isDistanceAttenuation\n\t\t\t\t\tfloat ratio=1.-(depth/maxDistance);\n\t\t\t\t\tfloat attenuation=ratio*ratio;\n\t\t\t\t\top=opacity*attenuation;\n\t\t\t\t#endif\n\t\t\t\t#ifdef isFresnel\n\t\t\t\t\top*=fresnel;\n\t\t\t\t#endif\n\t\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), op );\n\t\t\t#else\n\t\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\t\t\t#endif\n\t\t}\n\t"};var _a=function(t){function r(){return t.call(this,new e.BoxGeometry(1,1,1),r.material)||this}return g.default(r,t),r}(e.Mesh);b.default(_a,"SkyShader",{uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new e.Vector3},up:{value:new e.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")}),b.default(_a,"material",new e.ShaderMaterial({name:"SkyShader",fragmentShader:_a.SkyShader.fragmentShader,vertexShader:_a.SkyShader.vertexShader,uniforms:e.UniformsUtils.clone(_a.SkyShader.uniforms),side:e.BackSide,depthWrite:!1}));var Ia=function t(r,a){e.Mesh.call(this,r),this.type="Water2";var i=this,n=void 0!==(a=a||{}).color?new e.Color(a.color):new e.Color(16777215),o=a.textureWidth||512,s=a.textureHeight||512,l=a.clipBias||0,u=a.flowDirection||new e.Vector2(1,0),c=a.flowSpeed||.03,h=a.reflectivity||.02,d=a.scale||1,f=a.shader||t.WaterShader,p=void 0!==a.encoding?a.encoding:e.LinearEncoding,m=new e.TextureLoader,v=a.flowMap||void 0,g=a.normalMap0||m.load("textures/water/Water_1_M_Normal.jpg"),y=a.normalMap1||m.load("textures/water/Water_2_M_Normal.jpg"),x=.15,b=.075,A=new e.Matrix4,w=new e.Clock;if(void 0!==ga)if(void 0!==ya){var M=new ga(r,{textureWidth:o,textureHeight:s,clipBias:l,encoding:p}),S=new ya(r,{textureWidth:o,textureHeight:s,clipBias:l,encoding:p});M.matrixAutoUpdate=!1,S.matrixAutoUpdate=!1,this.material=new e.ShaderMaterial({uniforms:e.UniformsUtils.merge([e.UniformsLib.fog,f.uniforms]),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,transparent:!0,fog:!0}),void 0!==v?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:v}):this.material.uniforms.flowDirection={type:"v2",value:u},g.wrapS=g.wrapT=e.RepeatWrapping,y.wrapS=y.wrapT=e.RepeatWrapping,this.material.uniforms.tReflectionMap.value=M.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=S.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=g,this.material.uniforms.tNormalMap1.value=y,this.material.uniforms.color.value=n,this.material.uniforms.reflectivity.value=h,this.material.uniforms.textureMatrix.value=A,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=b,this.material.uniforms.config.value.z=b,this.material.uniforms.config.value.w=d,this.onBeforeRender=function(e,t,r){var a,n;!function(e){A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(e.projectionMatrix),A.multiply(e.matrixWorldInverse),A.multiply(i.matrixWorld)}(r),a=w.getDelta(),(n=i.material.uniforms.config).value.x+=c*a,n.value.y=n.value.x+b,n.value.x>=x?(n.value.x=0,n.value.y=b):n.value.y>=x&&(n.value.y=n.value.y-x),i.visible=!1,M.matrixWorld.copy(i.matrixWorld),S.matrixWorld.copy(i.matrixWorld),M.onBeforeRender(e,t,r),S.onBeforeRender(e,t,r),i.visible=!0}}else console.error("THREE.Water: Required component Refractor not found.");else console.error("THREE.Water: Required component Reflector not found.")};(Ia.prototype=Object.create(e.Mesh.prototype)).constructor=Ia,Ia.WaterShader={uniforms:{color:{type:"c",value:null},reflectivity:{type:"f",value:0},tReflectionMap:{type:"t",value:null},tRefractionMap:{type:"t",value:null},tNormalMap0:{type:"t",value:null},tNormalMap1:{type:"t",value:null},textureMatrix:{type:"m4",value:null},config:{type:"v4",value:new e.Vector4}},vertexShader:["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","uniform mat4 textureMatrix;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tvUv = uv;","\tvCoord = textureMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvToEye = cameraPosition - worldPosition.xyz;","\tvec4 mvPosition =  viewMatrix * worldPosition;","\tgl_Position = projectionMatrix * mvPosition;","\t#include <logdepthbuf_vertex>","\t#include <fog_vertex>","}"].join("\n"),fragmentShader:["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform sampler2D tReflectionMap;","uniform sampler2D tRefractionMap;","uniform sampler2D tNormalMap0;","uniform sampler2D tNormalMap1;","#ifdef USE_FLOWMAP","\tuniform sampler2D tFlowMap;","#else","\tuniform vec2 flowDirection;","#endif","uniform vec3 color;","uniform float reflectivity;","uniform vec4 config;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\t#include <logdepthbuf_fragment>","\tfloat flowMapOffset0 = config.x;","\tfloat flowMapOffset1 = config.y;","\tfloat halfCycle = config.z;","\tfloat scale = config.w;","\tvec3 toEye = normalize( vToEye );","\tvec2 flow;","\t#ifdef USE_FLOWMAP","\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;","\t#else","\t\tflow = flowDirection;","\t#endif","\tflow.x *= - 1.0;","\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );","\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );","\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;","\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );","\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );","\tfloat theta = max( dot( toEye, normal ), 0.0 );","\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 coord = vCoord.xyz / vCoord.w;","\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;","\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );","\tvec4 refractColor = texture2D( tRefractionMap, uv );","\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","}"].join("\n")};var Oa,Ua={createMeshesFromInstancedMesh:function(t){for(var r=new e.Group,a=t.count,i=t.geometry,n=t.material,o=0;o<a;o++){var s=new e.Mesh(i,n);t.getMatrixAt(o,s.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),r.add(s)}return r.copy(t),r.updateMatrixWorld(),r},createMultiMaterialObject:function(t,r){for(var a=new e.Group,i=0,n=r.length;i<n;i++)a.add(new e.Mesh(t,r[i]));return a},detach:function(e,t,r){console.warn("THREE.SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead."),r.attach(e)},attach:function(e,t,r){console.warn("THREE.SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead."),r.attach(e)}},ka=((Oa=new e.RawShaderMaterial({uniforms:{roughnessMap:{value:null},normalMap:{value:null},texelSize:{value:new e.Vector2(1,1)}},vertexShader:"\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\n\t\t\t\tvUv = uv;\n\n\t\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t\t}\n\t\t",fragmentShader:"\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tuniform sampler2D roughnessMap;\n\t\t\tuniform sampler2D normalMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\n\t\t\tvec4 envMapTexelToLinear( vec4 a ) { return a; }\n\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tfloat roughnessToVariance( float roughness ) {\n\n\t\t\t\tfloat variance = 0.0;\n\n\t\t\t\tif ( roughness >= r1 ) {\n\n\t\t\t\t\tvariance = ( r0 - roughness ) * ( v1 - v0 ) / ( r0 - r1 ) + v0;\n\n\t\t\t\t} else if ( roughness >= r4 ) {\n\n\t\t\t\t\tvariance = ( r1 - roughness ) * ( v4 - v1 ) / ( r1 - r4 ) + v1;\n\n\t\t\t\t} else if ( roughness >= r5 ) {\n\n\t\t\t\t\tvariance = ( r4 - roughness ) * ( v5 - v4 ) / ( r4 - r5 ) + v4;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfloat roughness2 = roughness * roughness;\n\n\t\t\t\t\tvariance = 1.79 * roughness2 * roughness2;\n\n\t\t\t\t}\n\n\t\t\t\treturn variance;\n\n\t\t\t}\n\n\t\t\tfloat varianceToRoughness( float variance ) {\n\n\t\t\t\tfloat roughness = 0.0;\n\n\t\t\t\tif ( variance >= v1 ) {\n\n\t\t\t\t\troughness = ( v0 - variance ) * ( r1 - r0 ) / ( v0 - v1 ) + r0;\n\n\t\t\t\t} else if ( variance >= v4 ) {\n\n\t\t\t\t\troughness = ( v1 - variance ) * ( r4 - r1 ) / ( v1 - v4 ) + r1;\n\n\t\t\t\t} else if ( variance >= v5 ) {\n\n\t\t\t\t\troughness = ( v4 - variance ) * ( r5 - r4 ) / ( v4 - v5 ) + r4;\n\n\t\t\t\t} else {\n\n\t\t\t\t\troughness = pow( 0.559 * variance, 0.25 ); // 0.559 = 1.0 / 1.79\n\n\t\t\t\t}\n\n\t\t\t\treturn roughness;\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = texture2D( roughnessMap, vUv, - 1.0 );\n\n\t\t\t\tif ( texelSize.x == 0.0 ) return;\n\n\t\t\t\tfloat roughness = gl_FragColor.g;\n\n\t\t\t\tfloat variance = roughnessToVariance( roughness );\n\n\t\t\t\tvec3 avgNormal;\n\n\t\t\t\tfor ( float x = - 1.0; x < 2.0; x += 2.0 ) {\n\n\t\t\t\t\tfor ( float y = - 1.0; y < 2.0; y += 2.0 ) {\n\n\t\t\t\t\t\tvec2 uv = vUv + vec2( x, y ) * 0.25 * texelSize;\n\n\t\t\t\t\t\tavgNormal += normalize( texture2D( normalMap, uv, - 1.0 ).xyz - 0.5 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvariance += 1.0 - 0.25 * length( avgNormal );\n\n\t\t\t\tgl_FragColor.g = varianceToRoughness( variance );\n\n\t\t\t}\n\t\t",blending:e.NoBlending,depthTest:!1,depthWrite:!1})).type="RoughnessMipmapper",Oa),Va=new e.Mesh(new e.PlaneGeometry(2,2),ka),Ga=new e.OrthographicCamera(0,1,0,1,0,1),ja=null,za=null;function Ha(e){(za=e).compile(Va,Ga)}Ha.prototype={constructor:Ha,generateMipmaps:function(t){if("roughnessMap"in t!=!1){var r=t.roughnessMap,a=t.normalMap;if(null!==r&&null!==a&&r.generateMipmaps&&!t.userData.roughnessUpdated){t.userData.roughnessUpdated=!0;var i=Math.max(r.image.width,a.image.width),n=Math.max(r.image.height,a.image.height);if(e.MathUtils.isPowerOfTwo(i)&&e.MathUtils.isPowerOfTwo(n)){var o=za.getRenderTarget(),s=za.autoClear;if(za.autoClear=!1,null!==ja&&ja.width===i&&ja.height===n||(null!==ja&&ja.dispose(),(ja=new e.WebGLRenderTarget(i,n,{depthBuffer:!1})).scissorTest=!0),i!==r.image.width||n!==r.image.height){var l={wrapS:r.wrapS,wrapT:r.wrapT,magFilter:r.magFilter,minFilter:r.minFilter,depthBuffer:!1},u=new e.WebGLRenderTarget(i,n,l);u.texture.generateMipmaps=!0,za.setRenderTarget(u),t.roughnessMap=u.texture,t.metalnessMap==r&&(t.metalnessMap=t.roughnessMap),t.aoMap==r&&(t.aoMap=t.roughnessMap)}ka.uniforms.roughnessMap.value=r,ka.uniforms.normalMap.value=a;for(var c=new e.Vector2(0,0),h=ka.uniforms.texelSize.value,d=0;i>=1&&n>=1;++d,i/=2,n/=2)h.set(1/i,1/n),0==d&&h.set(0,0),ja.viewport.set(c.x,c.y,i,n),ja.scissor.set(c.x,c.y,i,n),za.setRenderTarget(ja),za.render(Va,Ga),za.copyFramebufferToTexture(c,t.roughnessMap,d),ka.uniforms.roughnessMap.value=t.roughnessMap;r!==t.roughnessMap&&r.dispose(),za.setRenderTarget(o),za.autoClear=s}}}},dispose:function(){ka.dispose(),Va.geometry.dispose(),null!=ja&&ja.dispose()}};var Wa,Xa,Qa,Ya,Ja,Ka,qa,Za,$a,ei,ti,ri,ai={retarget:(qa=new e.Vector3,Za=new e.Quaternion,$a=new e.Vector3,ei=new e.Matrix4,ti=new e.Matrix4,ri=new e.Matrix4,function(e,t,r){(r=r||{}).preserveMatrix=void 0===r.preserveMatrix||r.preserveMatrix,r.preservePosition=void 0===r.preservePosition||r.preservePosition,r.preserveHipPosition=void 0!==r.preserveHipPosition&&r.preserveHipPosition,r.useTargetMatrix=void 0!==r.useTargetMatrix&&r.useTargetMatrix,r.hip=void 0!==r.hip?r.hip:"hip",r.names=r.names||{};var a,i,n,o,s,l,u=t.isObject3D?t.skeleton.bones:this.getBones(t),c=e.isObject3D?e.skeleton.bones:this.getBones(e);if(e.isObject3D?e.skeleton.pose():(r.useTargetMatrix=!0,r.preserveMatrix=!1),r.preservePosition)for(s=[],l=0;l<c.length;l++)s.push(c[l].position.clone());if(r.preserveMatrix)for(e.updateMatrixWorld(),e.matrixWorld.identity(),l=0;l<e.children.length;++l)e.children[l].updateMatrixWorld(!0);if(r.offsets)for(a=[],l=0;l<c.length;++l)i=c[l],n=r.names[i.name]||i.name,r.offsets&&r.offsets[n]&&(i.matrix.multiply(r.offsets[n]),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld()),a.push(i.matrixWorld.clone());for(l=0;l<c.length;++l){if(i=c[l],n=r.names[i.name]||i.name,o=this.getBoneByName(n,u),ri.copy(i.matrixWorld),o){if(o.updateMatrixWorld(),r.useTargetMatrix?ti.copy(o.matrixWorld):(ti.copy(e.matrixWorld).invert(),ti.multiply(o.matrixWorld)),$a.setFromMatrixScale(ti),ti.scale($a.set(1/$a.x,1/$a.y,1/$a.z)),ri.makeRotationFromQuaternion(Za.setFromRotationMatrix(ti)),e.isObject3D){var h=c.indexOf(i),d=a?a[h]:ei.copy(e.skeleton.boneInverses[h]).invert();ri.multiply(d)}ri.copyPosition(ti)}i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(ri)):i.matrix.copy(ri),r.preserveHipPosition&&n===r.hip&&i.matrix.setPosition(qa.set(0,i.position.y,0)),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld()}if(r.preservePosition)for(l=0;l<c.length;++l)i=c[l],(n=r.names[i.name]||i.name)!==r.hip&&i.position.copy(s[l]);r.preserveMatrix&&e.updateMatrixWorld(!0)}),retargetClip:function(t,r,a,i){(i=i||{}).useFirstFramePosition=void 0!==i.useFirstFramePosition&&i.useFirstFramePosition,i.fps=void 0!==i.fps?i.fps:30,i.names=i.names||[],r.isObject3D||(r=this.getHelperFromSkeleton(r));var n,o,s,l,u,c,h=Math.round(a.duration*(i.fps/1e3)*1e3),d=1/i.fps,f=[],p=new e.AnimationMixer(r),m=this.getBones(t.skeleton),v=[];for(p.clipAction(a).play(),p.update(0),r.updateMatrixWorld(),u=0;u<h;++u){var g=u*d;for(this.retarget(t,r,i),c=0;c<m.length;++c)l=i.names[m[c].name]||m[c].name,this.getBoneByName(l,r.skeleton)&&(o=m[c],s=v[c]=v[c]||{bone:o},i.hip===l&&(s.pos||(s.pos={times:new Float32Array(h),values:new Float32Array(3*h)}),i.useFirstFramePosition&&(0===u&&(n=o.position.clone()),o.position.sub(n)),s.pos.times[u]=g,o.position.toArray(s.pos.values,3*u)),s.quat||(s.quat={times:new Float32Array(h),values:new Float32Array(4*h)}),s.quat.times[u]=g,o.quaternion.toArray(s.quat.values,4*u));p.update(d),r.updateMatrixWorld()}for(u=0;u<v.length;++u)(s=v[u])&&(s.pos&&f.push(new e.VectorKeyframeTrack(".bones["+s.bone.name+"].position",s.pos.times,s.pos.values)),f.push(new e.QuaternionKeyframeTrack(".bones["+s.bone.name+"].quaternion",s.quat.times,s.quat.values)));return p.uncacheAction(a),new e.AnimationClip(a.name,-1,f)},getHelperFromSkeleton:function(t){var r=new e.SkeletonHelper(t.bones[0]);return r.skeleton=t,r},getSkeletonOffsets:(Wa=new e.Vector3,Xa=new e.Vector3,Qa=new e.Vector3,Ya=new e.Vector3,Ja=new e.Vector2,Ka=new e.Vector2,function(t,r,a){(a=a||{}).hip=void 0!==a.hip?a.hip:"hip",a.names=a.names||{},r.isObject3D||(r=this.getHelperFromSkeleton(r));var i,n,o,s,l=Object.keys(a.names),u=Object.values(a.names),c=r.isObject3D?r.skeleton.bones:this.getBones(r),h=t.isObject3D?t.skeleton.bones:this.getBones(t),d=[];for(t.skeleton.pose(),s=0;s<h.length;++s)if(i=h[s],o=a.names[i.name]||i.name,(n=this.getBoneByName(o,c))&&o!==a.hip){var f=this.getNearestBone(i.parent,l),p=this.getNearestBone(n.parent,u);f.updateMatrixWorld(),p.updateMatrixWorld(),Wa.setFromMatrixPosition(f.matrixWorld),Xa.setFromMatrixPosition(i.matrixWorld),Qa.setFromMatrixPosition(p.matrixWorld),Ya.setFromMatrixPosition(n.matrixWorld),Ja.subVectors(new e.Vector2(Xa.x,Xa.y),new e.Vector2(Wa.x,Wa.y)).normalize(),Ka.subVectors(new e.Vector2(Ya.x,Ya.y),new e.Vector2(Qa.x,Qa.y)).normalize();var m=Ja.angle()-Ka.angle(),v=(new e.Matrix4).makeRotationFromEuler(new e.Euler(0,0,m));i.matrix.multiply(v),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld(),d[o]=v}return d}),renameBones:function(e,t){for(var r=this.getBones(e),a=0;a<r.length;++a){var i=r[a];t[i.name]&&(i.name=t[i.name])}return this},getBones:function(e){return Array.isArray(e)?e:e.bones},getBoneByName:function(e,t){for(var r=0,a=this.getBones(t);r<a.length;r++)if(e===a[r].name)return a[r]},getNearestBone:function(e,t){for(;e.isBone;){if(-1!==t.indexOf(e.name))return e;e=e.parent}},findBoneTrackData:function(e,t){for(var r=/\[(.*)\]\.(.*)/,a={name:e},i=0;i<t.length;++i){var n=r.exec(t[i].name);n&&e===n[1]&&(a[n[2]]=i)}return a},getEqualsBonesNames:function(e,t){var r=this.getBones(e),a=this.getBones(t),i=[];e:for(var n=0;n<r.length;n++)for(var o=r[n].name,s=0;s<a.length;s++)if(o===a[s].name){i.push(o);continue e}return i},clone:function(e){var t=new Map,r=new Map,a=e.clone();return ii(e,a,(function(e,a){t.set(a,e),r.set(e,a)})),a.traverse((function(e){if(e.isSkinnedMesh){var a=e,i=t.get(e),n=i.skeleton.bones;a.skeleton=i.skeleton.clone(),a.bindMatrix.copy(i.bindMatrix),a.skeleton.bones=n.map((function(e){return r.get(e)})),a.bind(a.skeleton,a.bindMatrix)}})),a}};function ii(e,t,r){r(e,t);for(var a=0;a<e.children.length;a++)ii(e.children[a],t.children[a],r)}var ni={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","\tgl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},oi=function(t){var r,a=this,i=void 0!==t.name&&""!==t.name,n=10,o=10,s=256,l=256,u=new e.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,10);u.position.set(0,0,2);var c,h,d=new e.Scene,f=ni,p=e.UniformsUtils.clone(f.uniforms),m=new e.ShaderMaterial({uniforms:p,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}),v=new e.PlaneGeometry(s,l),g=new e.Mesh(v,m);if(d.add(g),i){var y=(c=document.createElement("canvas")).getContext("2d");y.font="Bold 20px Arial";var x=y.measureText(t.name).width;c.width=x,c.height=25,y.font="Bold 20px Arial",y.fillStyle="rgba( 255, 0, 0, 1 )",y.fillText(t.name,0,20);var b=new e.Texture(c);b.magFilter=e.LinearFilter,b.minFilter=e.LinearFilter,b.needsUpdate=!0;var A=new e.MeshBasicMaterial({map:b,side:e.DoubleSide});A.transparent=!0;var w=new e.PlaneGeometry(c.width,c.height);h=new e.Mesh(w,A),d.add(h)}this.enabled=!0,this.size={width:s,height:l,set:function(e,t){this.width=e,this.height=t,g.scale.set(this.width/s,this.height/l,1),a.position.set(a.position.x,a.position.y)}},this.position={x:n,y:o,set:function(e,t){this.x=e,this.y=t;var r=a.size.width,n=a.size.height;g.position.set(-window.innerWidth/2+r/2+this.x,window.innerHeight/2-n/2-this.y,0),i&&h.position.set(g.position.x,g.position.y-a.size.height/2+c.height/2,0)}},this.render=function(e){this.enabled&&(p.tDiffuse.value=t.shadow.map.texture,r=e.autoClear,e.autoClear=!1,e.clearDepth(),e.render(d,u),e.autoClear=r)},this.updateForWindowResize=function(){this.enabled&&(u.left=window.innerWidth/-2,u.right=window.innerWidth/2,u.top=window.innerHeight/2,u.bottom=window.innerHeight/-2,u.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()};oi.prototype.constructor=oi;var si={compressNormals:function(t,r){t.geometry||console.error("Mesh must contain geometry. ");var a=t.geometry.attributes.normal;if(a||console.error("Geometry must contain normal attribute. "),!a.isPacked){3!=a.itemSize&&console.error("normal.itemSize is not 3, which cannot be encoded. ");var i,n=a.array,o=a.count;if("DEFAULT"==r){i=new Uint8Array(3*o);for(var s=0;s<n.length;s+=3){var l=this.EncodingFuncs.defaultEncode(n[s],n[s+1],n[s+2],1);i[s+0]=l[0],i[s+1]=l[1],i[s+2]=l[2]}t.geometry.setAttribute("normal",new e.BufferAttribute(i,3,!0)),t.geometry.attributes.normal.bytes=1*i.length}else if("OCT1Byte"==r){i=new Int8Array(2*o);for(var u=0;u<n.length;u+=3){var c=this.EncodingFuncs.octEncodeBest(n[u],n[u+1],n[u+2],1);i[u/3*2+0]=c[0],i[u/3*2+1]=c[1]}t.geometry.setAttribute("normal",new e.BufferAttribute(i,2,!0)),t.geometry.attributes.normal.bytes=1*i.length}else if("OCT2Byte"==r){i=new Int16Array(2*o);for(var h=0;h<n.length;h+=3){var d=this.EncodingFuncs.octEncodeBest(n[h],n[h+1],n[h+2],2);i[h/3*2+0]=d[0],i[h/3*2+1]=d[1]}t.geometry.setAttribute("normal",new e.BufferAttribute(i,2,!0)),t.geometry.attributes.normal.bytes=2*i.length}else if("ANGLES"==r){i=new Uint16Array(2*o);for(var f=0;f<n.length;f+=3){var p=this.EncodingFuncs.anglesEncode(n[f],n[f+1],n[f+2]);i[f/3*2+0]=p[0],i[f/3*2+1]=p[1]}t.geometry.setAttribute("normal",new e.BufferAttribute(i,2,!0)),t.geometry.attributes.normal.bytes=2*i.length}else console.error("Unrecognized encoding method, should be `DEFAULT` or `ANGLES` or `OCT`. ");t.geometry.attributes.normal.needsUpdate=!0,t.geometry.attributes.normal.isPacked=!0,t.geometry.attributes.normal.packingMethod=r,t.material instanceof li||(t.material=(new li).copy(t.material)),"ANGLES"==r&&(t.material.defines.USE_PACKED_NORMAL=0),"OCT1Byte"==r&&(t.material.defines.USE_PACKED_NORMAL=1),"OCT2Byte"==r&&(t.material.defines.USE_PACKED_NORMAL=1),"DEFAULT"==r&&(t.material.defines.USE_PACKED_NORMAL=2)}},compressPositions:function(t){t.geometry||console.error("Mesh must contain geometry. ");var r=t.geometry.attributes.position;if(r||console.error("Geometry must contain position attribute. "),!r.isPacked){3!=r.itemSize&&console.error("position.itemSize is not 3, which cannot be packed. ");var a=r.array,i=this.EncodingFuncs.quantizedEncode(a,2),n=i.quantized,o=i.decodeMat;null==t.geometry.boundingBox&&t.geometry.computeBoundingBox(),null==t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),t.geometry.setAttribute("position",new e.BufferAttribute(n,3)),t.geometry.attributes.position.isPacked=!0,t.geometry.attributes.position.needsUpdate=!0,t.geometry.attributes.position.bytes=2*n.length,t.material instanceof li||(t.material=(new li).copy(t.material)),t.material.defines.USE_PACKED_POSITION=0,t.material.uniforms.quantizeMatPos.value=o,t.material.uniforms.quantizeMatPos.needsUpdate=!0}},compressUvs:function(t){t.geometry||console.error("Mesh must contain geometry property. ");var r=t.geometry.attributes.uv;if(r||console.error("Geometry must contain uv attribute. "),!r.isPacked){for(var a,i={min:1/0,max:-1/0},n=r.array,o=0;o<n.length;o++)i.min=Math.min(i.min,n[o]),i.max=Math.max(i.max,n[o]);if(i.min>=-1&&i.max<=1){a=new Uint16Array(n.length);for(var s=0;s<n.length;s+=2){var l=this.EncodingFuncs.defaultEncode(n[s],n[s+1],0,2);a[s]=l[0],a[s+1]=l[1]}t.geometry.setAttribute("uv",new e.BufferAttribute(a,2,!0)),t.geometry.attributes.uv.isPacked=!0,t.geometry.attributes.uv.needsUpdate=!0,t.geometry.attributes.uv.bytes=2*a.length,t.material instanceof li||(t.material=(new li).copy(t.material)),t.material.defines.USE_PACKED_UV=0}else a=this.EncodingFuncs.quantizedEncodeUV(n,2),t.geometry.setAttribute("uv",new e.BufferAttribute(a.quantized,2)),t.geometry.attributes.uv.isPacked=!0,t.geometry.attributes.uv.needsUpdate=!0,t.geometry.attributes.uv.bytes=2*a.quantized.length,t.material instanceof li||(t.material=(new li).copy(t.material)),t.material.defines.USE_PACKED_UV=1,t.material.uniforms.quantizeMatUV.value=a.decodeMat,t.material.uniforms.quantizeMatUV.needsUpdate=!0}},EncodingFuncs:{defaultEncode:function(e,t,r,a){if(1==a){var i=Math.round(.5*(e+1)*255),n=Math.round(.5*(t+1)*255),o=Math.round(.5*(r+1)*255);return new Uint8Array([i,n,o])}if(2==a){var s=Math.round(.5*(e+1)*65535),l=Math.round(.5*(t+1)*65535),u=Math.round(.5*(r+1)*65535);return new Uint16Array([s,l,u])}console.error("number of bytes must be 1 or 2")},defaultDecode:function(e,t){return 1==t?[e[0]/255*2-1,e[1]/255*2-1,e[2]/255*2-1]:2==t?[e[0]/65535*2-1,e[1]/65535*2-1,e[2]/65535*2-1]:void console.error("number of bytes must be 1 or 2")},anglesEncode:function(e,t,r){var a=parseInt(.5*(1+Math.atan2(t,e)/Math.PI)*65535),i=parseInt(.5*(1+r)*65535);return new Uint16Array([a,i])},octEncodeBest:function(e,t,r,a){var i,n,o,s,l;return o=i=u(e,t,r,"floor","floor"),n=c(i),l=h(e,t,r,n),n=c(i=u(e,t,r,"ceil","floor")),(s=h(e,t,r,n))>l&&(o=i,l=s),n=c(i=u(e,t,r,"floor","ceil")),(s=h(e,t,r,n))>l&&(o=i,l=s),n=c(i=u(e,t,r,"ceil","ceil")),(s=h(e,t,r,n))>l&&(o=i),o;function u(e,t,i,n,o){var s=e/(Math.abs(e)+Math.abs(t)+Math.abs(i)),l=t/(Math.abs(e)+Math.abs(t)+Math.abs(i));if(r<0){var u=(1-Math.abs(l))*(s>=0?1:-1),c=(1-Math.abs(s))*(l>=0?1:-1);s=u,l=c;var h=1-Math.abs(s)-Math.abs(l);h>0&&(h+=.001,s+=s>0?h/2:-h/2,l+=l>0?h/2:-h/2)}return 1==a?new Int8Array([Math[n](127.5*s+(s<0?1:0)),Math[o](127.5*l+(l<0?1:0))]):2==a?new Int16Array([Math[n](32767.5*s+(s<0?1:0)),Math[o](32767.5*l+(l<0?1:0))]):void 0}function c(e){var t=e[0],r=e[1];1==a?(t/=t<0?127:128,r/=r<0?127:128):2==a&&(t/=t<0?32767:32768,r/=r<0?32767:32768);var i=1-Math.abs(t)-Math.abs(r);if(i<0){var n=t;t=(1-Math.abs(r))*(t>=0?1:-1),r=(1-Math.abs(n))*(r>=0?1:-1)}var o=Math.sqrt(t*t+r*r+i*i);return[t/o,r/o,i/o]}function h(e,t,r,a){return e*a[0]+t*a[1]+r*a[2]}},quantizedEncode:function(t,r){var a,i;1==r?(a=new Uint8Array(t.length),i=255):2==r?(a=new Uint16Array(t.length),i=65535):console.error("number of bytes error! ");var n=new e.Matrix4,o=new Float32Array(3),s=new Float32Array(3);o[0]=o[1]=o[2]=Number.MAX_VALUE,s[0]=s[1]=s[2]=-Number.MAX_VALUE;for(var l=0;l<t.length;l+=3)o[0]=Math.min(o[0],t[l+0]),o[1]=Math.min(o[1],t[l+1]),o[2]=Math.min(o[2],t[l+2]),s[0]=Math.max(s[0],t[l+0]),s[1]=Math.max(s[1],t[l+1]),s[2]=Math.max(s[2],t[l+2]);n.scale(new e.Vector3((s[0]-o[0])/i,(s[1]-o[1])/i,(s[2]-o[2])/i)),n.elements[12]=o[0],n.elements[13]=o[1],n.elements[14]=o[2],n.transpose();for(var u=new Float32Array([s[0]!==o[0]?i/(s[0]-o[0]):0,s[1]!==o[1]?i/(s[1]-o[1]):0,s[2]!==o[2]?i/(s[2]-o[2]):0]),c=0;c<t.length;c+=3)a[c+0]=Math.floor((t[c+0]-o[0])*u[0]),a[c+1]=Math.floor((t[c+1]-o[1])*u[1]),a[c+2]=Math.floor((t[c+2]-o[2])*u[2]);return{quantized:a,decodeMat:n}},quantizedEncodeUV:function(t,r){var a,i;1==r?(a=new Uint8Array(t.length),i=255):2==r?(a=new Uint16Array(t.length),i=65535):console.error("number of bytes error! ");var n=new e.Matrix3,o=new Float32Array(2),s=new Float32Array(2);o[0]=o[1]=Number.MAX_VALUE,s[0]=s[1]=-Number.MAX_VALUE;for(var l=0;l<t.length;l+=2)o[0]=Math.min(o[0],t[l+0]),o[1]=Math.min(o[1],t[l+1]),s[0]=Math.max(s[0],t[l+0]),s[1]=Math.max(s[1],t[l+1]);n.scale((s[0]-o[0])/i,(s[1]-o[1])/i),n.elements[6]=o[0],n.elements[7]=o[1],n.transpose();for(var u=new Float32Array([s[0]!==o[0]?i/(s[0]-o[0]):0,s[1]!==o[1]?i/(s[1]-o[1]):0]),c=0;c<t.length;c+=2)a[c+0]=Math.floor((t[c+0]-o[0])*u[0]),a[c+1]=Math.floor((t[c+1]-o[1])*u[1]);return{quantized:a,decodeMat:n}}}},li=function(t){function r(r){var a;return(a=t.call(this)||this).defines={},a.type="PackedPhongMaterial",a.uniforms=e.UniformsUtils.merge([e.ShaderLib.phong.uniforms,{quantizeMatPos:{value:null},quantizeMatUV:{value:null}}]),a.vertexShader=["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","varying vec3 vNormal;","#endif",e.ShaderChunk.common,e.ShaderChunk.uv_pars_vertex,e.ShaderChunk.uv2_pars_vertex,e.ShaderChunk.displacementmap_pars_vertex,e.ShaderChunk.envmap_pars_vertex,e.ShaderChunk.color_pars_vertex,e.ShaderChunk.fog_pars_vertex,e.ShaderChunk.morphtarget_pars_vertex,e.ShaderChunk.skinning_pars_vertex,e.ShaderChunk.shadowmap_pars_vertex,e.ShaderChunk.logdepthbuf_pars_vertex,e.ShaderChunk.clipping_planes_pars_vertex,"#ifdef USE_PACKED_NORMAL\n\t\t\t\t\t#if USE_PACKED_NORMAL == 0\n\t\t\t\t\t\tvec3 decodeNormal(vec3 packedNormal)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfloat x = packedNormal.x * 2.0 - 1.0;\n\t\t\t\t\t\t\tfloat y = packedNormal.y * 2.0 - 1.0;\n\t\t\t\t\t\t\tvec2 scth = vec2(sin(x * PI), cos(x * PI));\n\t\t\t\t\t\t\tvec2 scphi = vec2(sqrt(1.0 - y * y), y);\n\t\t\t\t\t\t\treturn normalize( vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y) );\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#if USE_PACKED_NORMAL == 1\n\t\t\t\t\t\tvec3 decodeNormal(vec3 packedNormal)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec3 v = vec3(packedNormal.xy, 1.0 - abs(packedNormal.x) - abs(packedNormal.y));\n\t\t\t\t\t\t\tif (v.z < 0.0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tv.xy = (1.0 - abs(v.yx)) * vec2((v.x >= 0.0) ? +1.0 : -1.0, (v.y >= 0.0) ? +1.0 : -1.0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn normalize(v);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#if USE_PACKED_NORMAL == 2\n\t\t\t\t\t\tvec3 decodeNormal(vec3 packedNormal)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec3 v = (packedNormal * 2.0) - 1.0;\n\t\t\t\t\t\t\treturn normalize(v);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\t\t\t\t#endif","#ifdef USE_PACKED_POSITION\n\t\t\t\t\t#if USE_PACKED_POSITION == 0\n\t\t\t\t\t\tuniform mat4 quantizeMatPos;\n\t\t\t\t\t#endif\n\t\t\t\t#endif","#ifdef USE_PACKED_UV\n\t\t\t\t\t#if USE_PACKED_UV == 1\n\t\t\t\t\t\tuniform mat3 quantizeMatUV;\n\t\t\t\t\t#endif\n\t\t\t\t#endif","#ifdef USE_PACKED_UV\n\t\t\t\t\t#if USE_PACKED_UV == 0\n\t\t\t\t\t\tvec2 decodeUV(vec2 packedUV)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec2 uv = (packedUV * 2.0) - 1.0;\n\t\t\t\t\t\t\treturn uv;\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#if USE_PACKED_UV == 1\n\t\t\t\t\t\tvec2 decodeUV(vec2 packedUV)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvec2 uv = ( vec3(packedUV, 1.0) * quantizeMatUV ).xy;\n\t\t\t\t\t\t\treturn uv;\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\t\t\t\t#endif","void main() {",e.ShaderChunk.uv_vertex,"#ifdef USE_UV\n\t\t\t\t\t#ifdef USE_PACKED_UV\n\t\t\t\t\t\tvUv = decodeUV(vUv);\n\t\t\t\t\t#endif\n\t\t\t\t#endif",e.ShaderChunk.uv2_vertex,e.ShaderChunk.color_vertex,e.ShaderChunk.beginnormal_vertex,"#ifdef USE_PACKED_NORMAL\n\t\t\t\t\tobjectNormal = decodeNormal(objectNormal);\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef USE_TANGENT\n\t\t\t\t\tvec3 objectTangent = vec3( tangent.xyz );\n\t\t\t\t#endif\n\t\t\t\t",e.ShaderChunk.morphnormal_vertex,e.ShaderChunk.skinbase_vertex,e.ShaderChunk.skinnormal_vertex,e.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif",e.ShaderChunk.begin_vertex,"#ifdef USE_PACKED_POSITION\n\t\t\t\t\t#if USE_PACKED_POSITION == 0\n\t\t\t\t\t\ttransformed = ( vec4(transformed, 1.0) * quantizeMatPos ).xyz;\n\t\t\t\t\t#endif\n\t\t\t\t#endif",e.ShaderChunk.morphtarget_vertex,e.ShaderChunk.skinning_vertex,e.ShaderChunk.displacementmap_vertex,e.ShaderChunk.project_vertex,e.ShaderChunk.logdepthbuf_vertex,e.ShaderChunk.clipping_planes_vertex,"vViewPosition = - mvPosition.xyz;",e.ShaderChunk.worldpos_vertex,e.ShaderChunk.envmap_vertex,e.ShaderChunk.shadowmap_vertex,e.ShaderChunk.fog_vertex,"}"].join("\n"),a.fragmentShader=["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",e.ShaderChunk.common,e.ShaderChunk.packing,e.ShaderChunk.dithering_pars_fragment,e.ShaderChunk.color_pars_fragment,e.ShaderChunk.uv_pars_fragment,e.ShaderChunk.uv2_pars_fragment,e.ShaderChunk.map_pars_fragment,e.ShaderChunk.alphamap_pars_fragment,e.ShaderChunk.aomap_pars_fragment,e.ShaderChunk.lightmap_pars_fragment,e.ShaderChunk.emissivemap_pars_fragment,e.ShaderChunk.envmap_common_pars_fragment,e.ShaderChunk.envmap_pars_fragment,e.ShaderChunk.cube_uv_reflection_fragment,e.ShaderChunk.fog_pars_fragment,e.ShaderChunk.bsdfs,e.ShaderChunk.lights_pars_begin,e.ShaderChunk.lights_phong_pars_fragment,e.ShaderChunk.shadowmap_pars_fragment,e.ShaderChunk.bumpmap_pars_fragment,e.ShaderChunk.normalmap_pars_fragment,e.ShaderChunk.specularmap_pars_fragment,e.ShaderChunk.logdepthbuf_pars_fragment,e.ShaderChunk.clipping_planes_pars_fragment,"void main() {",e.ShaderChunk.clipping_planes_fragment,"vec4 diffuseColor = vec4( diffuse, opacity );","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","vec3 totalEmissiveRadiance = emissive;",e.ShaderChunk.logdepthbuf_fragment,e.ShaderChunk.map_fragment,e.ShaderChunk.color_fragment,e.ShaderChunk.alphamap_fragment,e.ShaderChunk.alphatest_fragment,e.ShaderChunk.specularmap_fragment,e.ShaderChunk.normal_fragment_begin,e.ShaderChunk.normal_fragment_maps,e.ShaderChunk.emissivemap_fragment,e.ShaderChunk.lights_phong_fragment,e.ShaderChunk.lights_fragment_begin,e.ShaderChunk.lights_fragment_maps,e.ShaderChunk.lights_fragment_end,e.ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;",e.ShaderChunk.envmap_fragment,"gl_FragColor = vec4( outgoingLight, diffuseColor.a );",e.ShaderChunk.tonemapping_fragment,e.ShaderChunk.encodings_fragment,e.ShaderChunk.fog_fragment,e.ShaderChunk.premultiplied_alpha_fragment,e.ShaderChunk.dithering_fragment,"}"].join("\n"),a.setValues(r),a}return g.default(r,t),r}(e.MeshPhongMaterial),ui={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new e.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","/*","make sure that these two values are the same for your camera, otherwise distances will be wrong.","*/","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","/*","next part is experimental","not looking good with small sample and ring count","looks okay starting from samples = 4, rings = 4","*/","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","\t//pentagonal shape","\tfloat scale = float(rings) - 1.3;","\tvec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","\tvec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","\tvec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","\tvec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","\tvec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","\tvec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","\tvec4  one = vec4( 1.0 );","\tvec4 P = vec4((coords),vec2(scale, scale));","\tvec4 dist = vec4(0.0);","\tfloat inorout = -4.0;","\tdist.x = dot( P, HS0 );","\tdist.y = dot( P, HS1 );","\tdist.z = dot( P, HS2 );","\tdist.w = dot( P, HS3 );","\tdist = smoothstep( -feather, feather, dist );","\tinorout += dot( dist, one );","\tdist.x = dot( P, HS4 );","\tdist.y = HS5.w - abs( P.z );","\tdist = smoothstep( -feather, feather, dist );","\tinorout += dist.x;","\treturn clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","\t// Depth buffer blur","\tfloat d = 0.0;","\tfloat kernel[9];","\tvec2 offset[9];","\tvec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","\toffset[0] = vec2(-wh.x,-wh.y);","\toffset[1] = vec2( 0.0, -wh.y);","\toffset[2] = vec2( wh.x -wh.y);","\toffset[3] = vec2(-wh.x,  0.0);","\toffset[4] = vec2( 0.0,   0.0);","\toffset[5] = vec2( wh.x,  0.0);","\toffset[6] = vec2(-wh.x, wh.y);","\toffset[7] = vec2( 0.0,  wh.y);","\toffset[8] = vec2( wh.x, wh.y);","\tkernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","\tkernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","\tkernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","\tfor( int i=0; i<9; i++ ) {","\t\tfloat tmp = texture2D(tDepth, coords + offset[i]).r;","\t\td += tmp * kernel[i];","\t}","\treturn d;","}","vec3 color(vec2 coords,float blur) {","\t//processing the sample","\tvec3 col = vec3(0.0);","\tvec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","\tcol.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","\tcol.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","\tcol.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","\tvec3 lumcoeff = vec3(0.299,0.587,0.114);","\tfloat lum = dot(col.rgb, lumcoeff);","\tfloat thresh = max((lum-threshold)*gain, 0.0);","\treturn col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","\tfloat edge = 0.002*depth; //distance based edge smoothing","\tfloat m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","\tfloat e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","\tcol = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","\tcol = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","\treturn col;","}","float linearize(float depth) {","\treturn -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","\tfloat dist = distance(vUv.xy, vec2(0.5,0.5));","\tdist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","\treturn clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","\tfloat rings2 = float(rings);","\tfloat step = PI*2.0 / float(ringsamples);","\tfloat pw = cos(j*step)*i;","\tfloat ph = sin(j*step)*i;","\tfloat p = 1.0;","\tif (pentagon) {","\t\tp = penta(vec2(pw,ph));","\t}","\tcol += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","\treturn 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","\t//scene depth calculation","\tfloat depth = linearize(texture2D(tDepth,vUv.xy).x);","\t// Blur depth?","\tif ( depthblur ) {","\t\tdepth = linearize(bdepth(vUv.xy));","\t}","\t//focal plane calculation","\tfloat fDepth = focalDepth;","\tif (shaderFocus) {","\t\tfDepth = linearize(texture2D(tDepth,focusCoords).x);","\t}","\t// dof blur factor calculation","\tfloat blur = 0.0;","\tif (manualdof) {","\t\tfloat a = depth-fDepth; // Focal plane","\t\tfloat b = (a-fdofstart)/fdofdist; // Far DoF","\t\tfloat c = (-a-ndofstart)/ndofdist; // Near Dof","\t\tblur = (a>0.0) ? b : c;","\t} else {","\t\tfloat f = focalLength; // focal length in mm","\t\tfloat d = fDepth*1000.0; // focal plane in mm","\t\tfloat o = depth*1000.0; // depth in mm","\t\tfloat a = (o*f)/(o-f);","\t\tfloat b = (d*f)/(d-f);","\t\tfloat c = (d-f)/(d*fstop*CoC);","\t\tblur = abs(a-b)*c;","\t}","\tblur = clamp(blur,0.0,1.0);","\t// calculation of pattern for dithering","\tvec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","\t// getting blur x and y step factor","\tfloat w = (1.0/textureWidth)*blur*maxblur+noise.x;","\tfloat h = (1.0/textureHeight)*blur*maxblur+noise.y;","\t// calculation of final color","\tvec3 col = vec3(0.0);","\tif(blur < 0.05) {","\t\t//some optimization thingy","\t\tcol = texture2D(tColor, vUv.xy).rgb;","\t} else {","\t\tcol = texture2D(tColor, vUv.xy).rgb;","\t\tfloat s = 1.0;","\t\tint ringsamples;","\t\tfor (int i = 1; i <= rings; i++) {","\t\t\t/*unboxstart*/","\t\t\tringsamples = i * samples;","\t\t\tfor (int j = 0 ; j < maxringsamples ; j++) {","\t\t\t\tif (j >= ringsamples) break;","\t\t\t\ts += gather(float(i), float(j), ringsamples, col, w, h, blur);","\t\t\t}","\t\t\t/*unboxend*/","\t\t}","\t\tcol /= s; //divide by sample count","\t}","\tif (showFocus) {","\t\tcol = debugFocus(col, blur, depth);","\t}","\tif (vignetting) {","\t\tcol *= vignette();","\t}","\tgl_FragColor.rgb = col;","\tgl_FragColor.a = 1.0;","} "].join("\n")},ci={uniforms:{mNear:{value:1},mFar:{value:1e3}},vertexShader:["varying float vViewZDepth;","void main() {","\t#include <begin_vertex>","\t#include <project_vertex>","\tvViewZDepth = - mvPosition.z;","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","varying float vViewZDepth;","void main() {","\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );","\tgl_FragColor = vec4( vec3( color ), 1.0 );","} "].join("\n")},hi=function(t){function r(r,a,i,n){var o;(o=t.call(this,r,a,i,n)||this).type="CinematicCamera",o.postprocessing={enabled:!0},o.shaderSettings={rings:3,samples:4};var s=ci;return o.materialDepth=new e.ShaderMaterial({uniforms:s.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),o.materialDepth.uniforms.mNear.value=i,o.materialDepth.uniforms.mFar.value=n,o.setLens(),o.initPostProcessing(),o}g.default(r,t);var a=r.prototype;return a.setLens=function(e,t,r,a){void 0===e&&(e=35),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e),void 0===r&&(r=8),void 0===a&&(a=.019),this.fNumber=r,this.coc=a,this.aperture=e/this.fNumber,this.hyperFocal=e*e/(this.aperture*this.coc)},a.linearize=function(e){var t=this.far,r=this.near;return-t*r/(e*(t-r)-t)},a.smoothstep=function(e,t,r){var a=this.saturate((r-e)/(t-e));return a*a*(3-2*a)},a.saturate=function(e){return Math.max(0,Math.min(1,e))},a.focusAt=function(e){void 0===e&&(e=20);var t=this.getFocalLength();this.focus=e,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-t)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-t)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance},a.initPostProcessing=function(){if(this.postprocessing.enabled){this.postprocessing.scene=new e.Scene,this.postprocessing.camera=new e.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera);var t={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat};this.postprocessing.rtTextureDepth=new e.WebGLRenderTarget(window.innerWidth,window.innerHeight,t),this.postprocessing.rtTextureColor=new e.WebGLRenderTarget(window.innerWidth,window.innerHeight,t);var r=ui;this.postprocessing.bokeh_uniforms=e.UniformsUtils.clone(r.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=window.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=window.innerHeight,this.postprocessing.materialBokeh=new e.ShaderMaterial({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples,DEPTH_PACKING:1}}),this.postprocessing.quad=new e.Mesh(new e.PlaneGeometry(window.innerWidth,window.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}},a.renderCinematic=function(e,t){if(this.postprocessing.enabled){var r=t.getRenderTarget();t.clear(),e.overrideMaterial=null,t.setRenderTarget(this.postprocessing.rtTextureColor),t.clear(),t.render(e,this),e.overrideMaterial=this.materialDepth,t.setRenderTarget(this.postprocessing.rtTextureDepth),t.clear(),t.render(e,this),t.setRenderTarget(null),t.render(this.postprocessing.scene,this.postprocessing.camera),t.setRenderTarget(r)}},r}(e.PerspectiveCamera),di=function(){var t=new e.Triangle,r=new e.Vector3;function a(e){var t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}return a.prototype={constructor:a,setWeightAttribute:function(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this},build:function(){for(var e=this.positionAttribute,r=this.weightAttribute,a=new Float32Array(e.count/3),i=0;i<e.count;i+=3){var n=1;r&&(n=r.getX(i)+r.getX(i+1)+r.getX(i+2)),t.a.fromBufferAttribute(e,i),t.b.fromBufferAttribute(e,i+1),t.c.fromBufferAttribute(e,i+2),n*=t.getArea(),a[i/3]=n}this.distribution=new Float32Array(e.count/3);for(var o=0,s=0;s<a.length;s++)o+=a[s],this.distribution[s]=o;return this},setRandomGenerator:function(e){return this.randomFunction=e,this},sample:function(e,t,r){var a=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*a);return this.sampleFace(i,e,t,r)},binarySearch:function(e){for(var t=this.distribution,r=0,a=t.length-1,i=-1;r<=a;){var n=Math.ceil((r+a)/2);if(0===n||t[n-1]<=e&&t[n]>e){i=n;break}e<t[n]?a=n-1:r=n+1}return i},sampleFace:function(e,a,i,n){var o=this.randomFunction(),s=this.randomFunction();return o+s>1&&(o=1-o,s=1-s),t.a.fromBufferAttribute(this.positionAttribute,3*e),t.b.fromBufferAttribute(this.positionAttribute,3*e+1),t.c.fromBufferAttribute(this.positionAttribute,3*e+2),a.set(0,0,0).addScaledVector(t.a,o).addScaledVector(t.b,s).addScaledVector(t.c,1-(o+s)),void 0!==i&&t.getNormal(i),void 0!==n&&void 0!==this.colorAttribute&&(t.a.fromBufferAttribute(this.colorAttribute,3*e),t.b.fromBufferAttribute(this.colorAttribute,3*e+1),t.c.fromBufferAttribute(this.colorAttribute,3*e+2),r.set(0,0,0).addScaledVector(t.a,o).addScaledVector(t.b,s).addScaledVector(t.c,1-(o+s)),n.r=r.x,n.g=r.y,n.b=r.z),this}},a}(),fi={c:null,u:[new e.Vector3,new e.Vector3,new e.Vector3],e:[]},pi={c:null,u:[new e.Vector3,new e.Vector3,new e.Vector3],e:[]},mi=[[],[],[]],vi=[[],[],[]],gi=[],yi=new e.Vector3,xi=new e.Vector3,bi=new e.Vector3,Ai=new e.Vector3,wi=new e.Vector3,Mi=new e.Vector3,Si=new e.Matrix3,Ti=new e.Box3,Ci=new e.Matrix4,Fi=new e.Matrix4,Ei=new e.Ray;function Bi(t,r,a){void 0===t&&(t=new e.Vector3),void 0===r&&(r=new e.Vector3),void 0===a&&(a=new e.Matrix3),this.center=t,this.halfSize=r,this.rotation=a}Object.assign(Bi.prototype,{set:function(e,t,r){return this.center=e,this.halfSize=t,this.rotation=r,this},copy:function(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this},clone:function(){return(new this.constructor).copy(this)},getSize:function(e){return e.copy(this.halfSize).multiplyScalar(2)},clampPoint:function(t,r){var a=this.halfSize;Ai.subVectors(t,this.center),this.rotation.extractBasis(yi,xi,bi),r.copy(this.center);var i=e.MathUtils.clamp(Ai.dot(yi),-a.x,a.x);r.add(yi.multiplyScalar(i));var n=e.MathUtils.clamp(Ai.dot(xi),-a.y,a.y);r.add(xi.multiplyScalar(n));var o=e.MathUtils.clamp(Ai.dot(bi),-a.z,a.z);return r.add(bi.multiplyScalar(o)),r},containsPoint:function(e){return Ai.subVectors(e,this.center),this.rotation.extractBasis(yi,xi,bi),Math.abs(Ai.dot(yi))<=this.halfSize.x&&Math.abs(Ai.dot(xi))<=this.halfSize.y&&Math.abs(Ai.dot(bi))<=this.halfSize.z},intersectsBox3:function(e){return this.intersectsOBB(Pi.fromBox3(e))},intersectsSphere:function(e){return this.clampPoint(e.center,Mi),Mi.distanceToSquared(e.center)<=e.radius*e.radius},intersectsOBB:function(e,t){void 0===t&&(t=Number.EPSILON),fi.c=this.center,fi.e[0]=this.halfSize.x,fi.e[1]=this.halfSize.y,fi.e[2]=this.halfSize.z,this.rotation.extractBasis(fi.u[0],fi.u[1],fi.u[2]),pi.c=e.center,pi.e[0]=e.halfSize.x,pi.e[1]=e.halfSize.y,pi.e[2]=e.halfSize.z,e.rotation.extractBasis(pi.u[0],pi.u[1],pi.u[2]);for(var r=0;r<3;r++)for(var a=0;a<3;a++)mi[r][a]=fi.u[r].dot(pi.u[a]);Ai.subVectors(pi.c,fi.c),gi[0]=Ai.dot(fi.u[0]),gi[1]=Ai.dot(fi.u[1]),gi[2]=Ai.dot(fi.u[2]);for(var i=0;i<3;i++)for(var n=0;n<3;n++)vi[i][n]=Math.abs(mi[i][n])+t;for(var o,s,l=0;l<3;l++)if(o=fi.e[l],s=pi.e[0]*vi[l][0]+pi.e[1]*vi[l][1]+pi.e[2]*vi[l][2],Math.abs(gi[l])>o+s)return!1;for(var u=0;u<3;u++)if(o=fi.e[0]*vi[0][u]+fi.e[1]*vi[1][u]+fi.e[2]*vi[2][u],s=pi.e[u],Math.abs(gi[0]*mi[0][u]+gi[1]*mi[1][u]+gi[2]*mi[2][u])>o+s)return!1;return o=fi.e[1]*vi[2][0]+fi.e[2]*vi[1][0],s=pi.e[1]*vi[0][2]+pi.e[2]*vi[0][1],!(Math.abs(gi[2]*mi[1][0]-gi[1]*mi[2][0])>o+s)&&(o=fi.e[1]*vi[2][1]+fi.e[2]*vi[1][1],s=pi.e[0]*vi[0][2]+pi.e[2]*vi[0][0],!(Math.abs(gi[2]*mi[1][1]-gi[1]*mi[2][1])>o+s)&&(o=fi.e[1]*vi[2][2]+fi.e[2]*vi[1][2],s=pi.e[0]*vi[0][1]+pi.e[1]*vi[0][0],!(Math.abs(gi[2]*mi[1][2]-gi[1]*mi[2][2])>o+s)&&(o=fi.e[0]*vi[2][0]+fi.e[2]*vi[0][0],s=pi.e[1]*vi[1][2]+pi.e[2]*vi[1][1],!(Math.abs(gi[0]*mi[2][0]-gi[2]*mi[0][0])>o+s)&&(o=fi.e[0]*vi[2][1]+fi.e[2]*vi[0][1],s=pi.e[0]*vi[1][2]+pi.e[2]*vi[1][0],!(Math.abs(gi[0]*mi[2][1]-gi[2]*mi[0][1])>o+s)&&(o=fi.e[0]*vi[2][2]+fi.e[2]*vi[0][2],s=pi.e[0]*vi[1][1]+pi.e[1]*vi[1][0],!(Math.abs(gi[0]*mi[2][2]-gi[2]*mi[0][2])>o+s)&&(o=fi.e[0]*vi[1][0]+fi.e[1]*vi[0][0],s=pi.e[1]*vi[2][2]+pi.e[2]*vi[2][1],!(Math.abs(gi[1]*mi[0][0]-gi[0]*mi[1][0])>o+s)&&(o=fi.e[0]*vi[1][1]+fi.e[1]*vi[0][1],s=pi.e[0]*vi[2][2]+pi.e[2]*vi[2][0],!(Math.abs(gi[1]*mi[0][1]-gi[0]*mi[1][1])>o+s)&&(o=fi.e[0]*vi[1][2]+fi.e[1]*vi[0][2],s=pi.e[0]*vi[2][1]+pi.e[1]*vi[2][0],!(Math.abs(gi[1]*mi[0][2]-gi[0]*mi[1][2])>o+s)))))))))},intersectsPlane:function(e){this.rotation.extractBasis(yi,xi,bi);var t=this.halfSize.x*Math.abs(e.normal.dot(yi))+this.halfSize.y*Math.abs(e.normal.dot(xi))+this.halfSize.z*Math.abs(e.normal.dot(bi)),r=e.normal.dot(this.center)-e.constant;return Math.abs(r)<=t},intersectRay:function(e,t){var r,a,i,n;return this.getSize(wi),Ti.setFromCenterAndSize(Ai.set(0,0,0),wi),r=Ci,a=this.rotation,i=r.elements,n=a.elements,i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=0,i[4]=n[3],i[5]=n[4],i[6]=n[5],i[7]=0,i[8]=n[6],i[9]=n[7],i[10]=n[8],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,Ci.setPosition(this.center),Fi.copy(Ci).invert(),Ei.copy(e).applyMatrix4(Fi),Ei.intersectBox(Ti,t)?t.applyMatrix4(Ci):null},intersectsRay:function(e){return null!==this.intersectRay(e,Ai)},fromBox3:function(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this},equals:function(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)},applyMatrix4:function(e){var t=e.elements,r=Ai.set(t[0],t[1],t[2]).length(),a=Ai.set(t[4],t[5],t[6]).length(),i=Ai.set(t[8],t[9],t[10]).length();e.determinant()<0&&(r=-r),Si.setFromMatrix4(e);var n=1/r,o=1/a,s=1/i;return Si.elements[0]*=n,Si.elements[1]*=n,Si.elements[2]*=n,Si.elements[3]*=o,Si.elements[4]*=o,Si.elements[5]*=o,Si.elements[6]*=s,Si.elements[7]*=s,Si.elements[8]*=s,this.rotation.multiply(Si),this.halfSize.x*=r,this.halfSize.y*=a,this.halfSize.z*=i,Ai.setFromMatrixPosition(e),this.center.add(Ai),this}});var Li,Pi=new Bi,Di=function(){var t=new e.Vector3,r=new e.Vector3,a=new e.Vector3;function i(t,r,a){this.start=null==t?new e.Vector3(0,0,0):t,this.end=null==r?new e.Vector3(0,1,0):r,this.radius=null==a?1:a}return Object.assign(i.prototype,{clone:function(){return new i(this.start.clone(),this.end.clone(),this.radius)},set:function(e,t,r){this.start.copy(e),this.end.copy(t),this.radius=r},copy:function(e){this.start.copy(e.start),this.end.copy(e.end),this.radius=e.radius},getCenter:function(e){return e.copy(this.end).add(this.start).multiplyScalar(.5)},translate:function(e){this.start.add(e),this.end.add(e)},checkAABBAxis:function(e,t,r,a,i,n,o,s,l){return(i-e<l||i-r<l)&&(e-n<l||r-n<l)&&(o-t<l||o-a<l)&&(t-s<l||a-s<l)},intersectsBox:function(e){return this.checkAABBAxis(this.start.x,this.start.y,this.end.x,this.end.y,e.min.x,e.max.x,e.min.y,e.max.y,this.radius)&&this.checkAABBAxis(this.start.x,this.start.z,this.end.x,this.end.z,e.min.x,e.max.x,e.min.z,e.max.z,this.radius)&&this.checkAABBAxis(this.start.y,this.start.z,this.end.y,this.end.z,e.min.y,e.max.y,e.min.z,e.max.z,this.radius)},lineLineMinimumPoints:function(e,i){var n,o,s=t.copy(e.end).sub(e.start),l=r.copy(i.end).sub(i.start),u=a.copy(i.start).sub(e.start),c=s.dot(l),h=s.dot(s),d=l.dot(l),f=l.dot(u),p=s.dot(u),m=h*d-c*c;if(Math.abs(m)<1e-10){var v=-f/d,g=(c-f)/d;Math.abs(v-.5)<Math.abs(g-.5)?(n=0,o=v):(n=1,o=g)}else o=((n=(f*c+p*d)/m)*c-f)/d;return o=Math.max(0,Math.min(1,o)),n=Math.max(0,Math.min(1,n)),[s.multiplyScalar(n).add(e.start),l.multiplyScalar(o).add(i.start)]}}),i}(),Ni={setHSV:function(t,r,a,i){return r=e.MathUtils.euclideanModulo(r,1),a=e.MathUtils.clamp(a,0,1),i=e.MathUtils.clamp(i,0,1),t.setHSL(r,a*i/((r=(2-a)*i)<1?r:2-r),.5*r)},getHSV:(Li={},function(e,t){return void 0===t&&(console.warn("THREE.ColorConverter: .getHSV() target is now required"),t={h:0,s:0,l:0}),e.getHSL(Li),Li.s*=Li.l<.5?Li.l:1-Li.l,t.h=Li.h,t.s=2*Li.s/(Li.l+Li.s),t.v=Li.l+Li.s,t}),setCMYK:function(e,t,r,a,i){var n=(1-t)*(1-i),o=(1-r)*(1-i),s=(1-a)*(1-i);return e.setRGB(n,o,s)},getCMYK:function(e,t){void 0===t&&(console.warn("THREE.ColorConverter: .getCMYK() target is now required"),t={c:0,m:0,y:0,k:0});var r=e.r,a=e.g,i=e.b,n=1-Math.max(r,a,i),o=(1-r-n)/(1-n),s=(1-a-n)/(1-n),l=(1-i-n)/(1-n);return t.c=o,t.m=s,t.y=l,t.k=n,t}},Ri=function(){var t=new e.Vector3,r=new e.Vector3,a=new e.Plane,i=new e.Line3,n=new e.Line3,o=new e.Sphere,s=new Di;function l(e){this.triangles=[],this.box=e,this.subTrees=[]}return Object.assign(l.prototype,{addTriangle:function(t){return this.bounds||(this.bounds=new e.Box3),this.bounds.min.x=Math.min(this.bounds.min.x,t.a.x,t.b.x,t.c.x),this.bounds.min.y=Math.min(this.bounds.min.y,t.a.y,t.b.y,t.c.y),this.bounds.min.z=Math.min(this.bounds.min.z,t.a.z,t.b.z,t.c.z),this.bounds.max.x=Math.max(this.bounds.max.x,t.a.x,t.b.x,t.c.x),this.bounds.max.y=Math.max(this.bounds.max.y,t.a.y,t.b.y,t.c.y),this.bounds.max.z=Math.max(this.bounds.max.z,t.a.z,t.b.z,t.c.z),this.triangles.push(t),this},calcBox:function(){return this.box=this.bounds.clone(),this.box.min.x-=.01,this.box.min.y-=.01,this.box.min.z-=.01,this},split:function(a){if(this.box){for(var i,n,o,s=[],u=r.copy(this.box.max).sub(this.box.min).multiplyScalar(.5),c=0;c<2;c++)for(var h=0;h<2;h++)for(var d=0;d<2;d++)i=new e.Box3,n=t.set(c,h,d),i.min.copy(this.box.min).add(n.multiply(u)),i.max.copy(i.min).add(u),s.push(new l(i));for(;o=this.triangles.pop();)for(var f=0;f<s.length;f++)s[f].box.intersectsTriangle(o)&&s[f].triangles.push(o);for(var p=0;p<s.length;p++){var m=s[p].triangles.length;m>8&&a<16&&s[p].split(a+1),0!=m&&this.subTrees.push(s[p])}return this}},build:function(){return this.calcBox(),this.split(0),this},getRayTriangles:function(e,t){for(var r=0;r<this.subTrees.length;r++){var a=this.subTrees[r];if(e.intersectsBox(a.box))if(a.triangles.length>0)for(var i=0;i<a.triangles.length;i++)-1===t.indexOf(a.triangles[i])&&t.push(a.triangles[i]);else a.getRayTriangles(e,t)}return t},triangleCapsuleIntersect:function(e,r){var o,s,l,u;r.getPlane(a);var c=a.distanceToPoint(e.start)-e.radius,h=a.distanceToPoint(e.end)-e.radius;if(c>0&&h>0||c<-e.radius&&h<-e.radius)return!1;var d=Math.abs(c/(Math.abs(c)+Math.abs(h))),f=t.copy(e.start).lerp(e.end,d);if(r.containsPoint(f))return{normal:a.normal.clone(),point:f.clone(),depth:Math.abs(Math.min(c,h))};var p=e.radius*e.radius;l=i.set(e.start,e.end);for(var m=[[r.a,r.b],[r.b,r.c],[r.c,r.a]],v=0;v<m.length;v++){u=n.set(m[v][0],m[v][1]);var g=e.lineLineMinimumPoints(l,u);if(o=g[0],s=g[1],o.distanceToSquared(s)<p)return{normal:o.clone().sub(s).normalize(),point:s.clone(),depth:e.radius-o.distanceTo(s)}}return!1},triangleSphereIntersect:function(e,n){if(n.getPlane(a),!e.intersectsPlane(a))return!1;var o=Math.abs(a.distanceToSphere(e)),s=e.radius*e.radius-o*o,l=a.projectPoint(e.center,t);if(n.containsPoint(e.center))return{normal:a.normal.clone(),point:l.clone(),depth:Math.abs(a.distanceToSphere(e))};for(var u=[[n.a,n.b],[n.b,n.c],[n.c,n.a]],c=0;c<u.length;c++){i.set(u[c][0],u[c][1]),i.closestPointToPoint(l,!0,r);var h=r.distanceToSquared(e.center);if(h<s)return{normal:e.center.clone().sub(r).normalize(),point:r.clone(),depth:e.radius-Math.sqrt(h)}}return!1},getSphereTriangles:function(e,t){for(var r=0;r<this.subTrees.length;r++){var a=this.subTrees[r];if(e.intersectsBox(a.box))if(a.triangles.length>0)for(var i=0;i<a.triangles.length;i++)-1===t.indexOf(a.triangles[i])&&t.push(a.triangles[i]);else a.getSphereTriangles(e,t)}},getCapsuleTriangles:function(e,t){for(var r=0;r<this.subTrees.length;r++){var a=this.subTrees[r];if(e.intersectsBox(a.box))if(a.triangles.length>0)for(var i=0;i<a.triangles.length;i++)-1===t.indexOf(a.triangles[i])&&t.push(a.triangles[i]);else a.getCapsuleTriangles(e,t)}},sphereIntersect:function(e){o.copy(e);var t,r=[],a=!1;this.getSphereTriangles(e,r);for(var i=0;i<r.length;i++)(t=this.triangleSphereIntersect(o,r[i]))&&(a=!0,o.center.add(t.normal.multiplyScalar(t.depth)));if(a){var n=o.center.clone().sub(e.center),s=n.length();return{normal:n.normalize(),depth:s}}return!1},capsuleIntersect:function(r){s.copy(r);var a,i=[],n=!1;this.getCapsuleTriangles(s,i);for(var o=0;o<i.length;o++)(a=this.triangleCapsuleIntersect(s,i[o]))&&(n=!0,s.translate(a.normal.multiplyScalar(a.depth)));if(n){var l=s.getCenter(new e.Vector3).sub(r.getCenter(t)),u=l.length();return{normal:l.normalize(),depth:u}}return!1},rayIntersect:function(e){if(0!==e.direction.length()){var r,a,i,n=[],o=1e100;this.getRayTriangles(e,n);for(var s=0;s<n.length;s++)if(i=e.intersectTriangle(n[s].a,n[s].b,n[s].c,!0,t)){var l=i.sub(e.origin).length();o>l&&(a=i.clone().add(e.origin),o=l,r=n[s])}return o<1e100&&{distance:o,triangle:r,position:a}}},fromGraphNode:function(t){var r=this;return t.traverse((function(t){if("Mesh"===t.type){t.updateMatrix(),t.updateWorldMatrix();var a,i=!1;t.geometry.index?(i=!0,a=t.geometry.clone().toNonIndexed()):a=t.geometry;for(var n=a.attributes.position.array,o=t.matrixWorld,s=0;s<n.length;s+=9){var l=new e.Vector3(n[s],n[s+1],n[s+2]),u=new e.Vector3(n[s+3],n[s+4],n[s+5]),c=new e.Vector3(n[s+6],n[s+7],n[s+8]);l.applyMatrix4(o),u.applyMatrix4(o),c.applyMatrix4(o),r.addTriangle(new e.Triangle(l,u,c))}i&&a.dispose()}})),this.build(),this}}),l}(),_i=function(e,t){return this.lut=[],this.setColorMap(e,t),this};_i.prototype={constructor:_i,lut:[],map:[],n:256,minV:0,maxV:1,set:function(e){return e instanceof _i&&this.copy(e),this},setMin:function(e){return this.minV=e,this},setMax:function(e){return this.maxV=e,this},setColorMap:function(t,r){this.map=Oi[t]||Oi.rainbow,this.n=r||32;var a=1/this.n;this.lut.length=0;for(var i=0;i<=1;i+=a)for(var n=0;n<this.map.length-1;n++)if(i>=this.map[n][0]&&i<this.map[n+1][0]){var o=this.map[n][0],s=this.map[n+1][0],l=new e.Color(this.map[n][1]),u=new e.Color(this.map[n+1][1]),c=l.lerp(u,(i-o)/(s-o));this.lut.push(c)}return this},copy:function(e){return this.lut=e.lut,this.map=e.map,this.n=e.n,this.minV=e.minV,this.maxV=e.maxV,this},getColor:function(e){e<=this.minV?e=this.minV:e>=this.maxV&&(e=this.maxV),e=(e-this.minV)/(this.maxV-this.minV);var t=Math.round(e*this.n);return t==this.n&&(t-=1),this.lut[t]},addColorMap:function(e,t){Oi[e]=t},createCanvas:function(){var e=document.createElement("canvas");return e.width=1,e.height=this.n,this.updateCanvas(e),e},updateCanvas:function(t){for(var r=t.getContext("2d",{alpha:!1}),a=r.getImageData(0,0,1,this.n),i=a.data,n=0,o=1/this.n,s=1;s>=0;s-=o)for(var l=this.map.length-1;l>=0;l--)if(s<this.map[l][0]&&s>=this.map[l-1][0]){var u=this.map[l-1][0],c=this.map[l][0],h=new e.Color(this.map[l-1][1]),d=new e.Color(this.map[l][1]),f=h.lerp(d,(s-u)/(c-u));i[4*n]=Math.round(255*f.r),i[4*n+1]=Math.round(255*f.g),i[4*n+2]=Math.round(255*f.b),i[4*n+3]=255,n+=1}return r.putImageData(a,0,0),t}};var Ii,Oi={rainbow:[[0,255],[.2,65535],[.5,65280],[.8,16776960],[1,16711680]],cooltowarm:[[0,3952322],[.2,10206463],[.5,14474460],[.8,16163717],[1,11797542]],blackbody:[[0,0],[.2,7864320],[.5,15086080],[.8,16776960],[1,16777215]],grayscale:[[0,0],[.2,4210752],[.5,8355712],[.8,12566463],[1,16777215]]};exports.STATE=void 0,(Ii=exports.STATE||(exports.STATE={}))[Ii.NONE=-1]="NONE",Ii[Ii.ROTATE=0]="ROTATE",Ii[Ii.DOLLY=1]="DOLLY",Ii[Ii.PAN=2]="PAN",Ii[Ii.TOUCH_ROTATE=3]="TOUCH_ROTATE",Ii[Ii.TOUCH_PAN=4]="TOUCH_PAN",Ii[Ii.TOUCH_DOLLY_PAN=5]="TOUCH_DOLLY_PAN",Ii[Ii.TOUCH_DOLLY_ROTATE=6]="TOUCH_DOLLY_ROTATE";var Ui=function(t){function r(r,a){var i;return i=t.call(this)||this,b.default(x.default(i),"object",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"enabled",!0),b.default(x.default(i),"target",new e.Vector3),b.default(x.default(i),"trackball",!1),b.default(x.default(i),"minDistance",0),b.default(x.default(i),"maxDistance",1/0),b.default(x.default(i),"minZoom",0),b.default(x.default(i),"maxZoom",1/0),b.default(x.default(i),"minPolarAngle",0),b.default(x.default(i),"maxPolarAngle",Math.PI),b.default(x.default(i),"minAzimuthAngle",-1/0),b.default(x.default(i),"maxAzimuthAngle",1/0),b.default(x.default(i),"enableDamping",!1),b.default(x.default(i),"dampingFactor",.05),b.default(x.default(i),"enableZoom",!0),b.default(x.default(i),"zoomSpeed",1),b.default(x.default(i),"enableRotate",!0),b.default(x.default(i),"rotateSpeed",1),b.default(x.default(i),"enablePan",!0),b.default(x.default(i),"panSpeed",1),b.default(x.default(i),"screenSpacePanning",!1),b.default(x.default(i),"keyPanSpeed",7),b.default(x.default(i),"autoRotate",!1),b.default(x.default(i),"autoRotateSpeed",2),b.default(x.default(i),"enableKeys",!0),b.default(x.default(i),"keys",{LEFT:37,UP:38,RIGHT:39,BOTTOM:40}),b.default(x.default(i),"mouseButtons",void 0),b.default(x.default(i),"touches",{ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN}),b.default(x.default(i),"target0",void 0),b.default(x.default(i),"position0",void 0),b.default(x.default(i),"quaternion0",void 0),b.default(x.default(i),"zoom0",void 0),b.default(x.default(i),"spherical",new e.Spherical),b.default(x.default(i),"sphericalDelta",new e.Spherical),b.default(x.default(i),"changeEvent",{type:"change"}),b.default(x.default(i),"startEvent",{type:"start"}),b.default(x.default(i),"endEvent",{type:"end"}),b.default(x.default(i),"state",exports.STATE.NONE),b.default(x.default(i),"EPS",1e-6),b.default(x.default(i),"scale",1),b.default(x.default(i),"panOffset",new e.Vector3),b.default(x.default(i),"zoomChanged",!1),b.default(x.default(i),"rotateStart",new e.Vector2),b.default(x.default(i),"rotateEnd",new e.Vector2),b.default(x.default(i),"rotateDelta",new e.Vector2),b.default(x.default(i),"panStart",new e.Vector2),b.default(x.default(i),"panEnd",new e.Vector2),b.default(x.default(i),"panDelta",new e.Vector2),b.default(x.default(i),"dollyStart",new e.Vector2),b.default(x.default(i),"dollyEnd",new e.Vector2),b.default(x.default(i),"dollyDelta",new e.Vector2),b.default(x.default(i),"offset",new e.Vector3),b.default(x.default(i),"lastPosition",new e.Vector3),b.default(x.default(i),"lastQuaternion",new e.Quaternion),b.default(x.default(i),"q",new e.Quaternion),b.default(x.default(i),"v",new e.Vector3),b.default(x.default(i),"vec",new e.Vector3),b.default(x.default(i),"quat",void 0),b.default(x.default(i),"quatInverse",void 0),b.default(x.default(i),"getPolarAngle",(function(){return i.spherical.phi})),b.default(x.default(i),"getAzimuthalAngle",(function(){return i.spherical.theta})),b.default(x.default(i),"saveState",(function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.quaternion0.copy(i.object.quaternion),i.zoom0=i.object.zoom})),b.default(x.default(i),"reset",(function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.quaternion.copy(i.quaternion0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(i.changeEvent),i.update(),i.state=exports.STATE.NONE})),b.default(x.default(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",i.onContextMenu,!1),i.domElement.removeEventListener("mousedown",i.onMouseDown,!1),i.domElement.removeEventListener("wheel",i.onMouseWheel,!1),i.domElement.removeEventListener("touchstart",i.onTouchStart,!1),i.domElement.removeEventListener("touchend",i.onTouchEnd,!1),i.domElement.removeEventListener("touchmove",i.onTouchMove,!1),document.removeEventListener("mousemove",i.onMouseMove,!1),document.removeEventListener("mouseup",i.onMouseUp,!1),i.domElement.removeEventListener("keydown",i.onKeyDown,!1)})),b.default(x.default(i),"update",(function(){var e=i.object.position;if(i.offset.copy(e).sub(i.target),i.trackball){if(i.sphericalDelta.theta){i.vec.set(0,1,0).applyQuaternion(i.object.quaternion);var t=i.enableDamping?i.dampingFactor:1;i.q.setFromAxisAngle(i.vec,i.sphericalDelta.theta*t),i.object.quaternion.premultiply(i.q),i.offset.applyQuaternion(i.q)}if(i.sphericalDelta.phi){i.vec.set(1,0,0).applyQuaternion(i.object.quaternion);var r=i.enableDamping?i.dampingFactor:1;i.q.setFromAxisAngle(i.vec,i.sphericalDelta.phi*r),i.object.quaternion.premultiply(i.q),i.offset.applyQuaternion(i.q)}i.offset.multiplyScalar(i.scale),i.offset.clampLength(i.minDistance,i.maxDistance)}else i.offset.applyQuaternion(i.quat),i.autoRotate&&i.state===exports.STATE.NONE&&i.rotateLeft(i.getAutoRotationAngle()),i.spherical.setFromVector3(i.offset),i.enableDamping?(i.spherical.theta+=i.sphericalDelta.theta*i.dampingFactor,i.spherical.phi+=i.sphericalDelta.phi*i.dampingFactor):(i.spherical.theta+=i.sphericalDelta.theta,i.spherical.phi+=i.sphericalDelta.phi),i.spherical.theta=Math.max(i.minAzimuthAngle,Math.min(i.maxAzimuthAngle,i.spherical.theta)),i.spherical.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,i.spherical.phi)),i.spherical.makeSafe(),i.spherical.radius*=i.scale,i.spherical.radius=Math.max(i.minDistance,Math.min(i.maxDistance,i.spherical.radius)),i.offset.setFromSpherical(i.spherical),i.offset.applyQuaternion(i.quatInverse);return!0===i.enableDamping?i.target.addScaledVector(i.panOffset,i.dampingFactor):i.target.add(i.panOffset),e.copy(i.target).add(i.offset),!1===i.trackball&&i.object.lookAt(i.target),!0===i.enableDamping?(i.sphericalDelta.theta*=1-i.dampingFactor,i.sphericalDelta.phi*=1-i.dampingFactor,i.panOffset.multiplyScalar(1-i.dampingFactor)):(i.sphericalDelta.set(0,0,0),i.panOffset.set(0,0,0)),i.scale=1,!!(i.zoomChanged||i.lastPosition.distanceToSquared(i.object.position)>i.EPS||8*(1-i.lastQuaternion.dot(i.object.quaternion))>i.EPS)&&(i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position),i.lastQuaternion.copy(i.object.quaternion),i.zoomChanged=!1,!0)})),b.default(x.default(i),"getAutoRotationAngle",(function(){return 2*Math.PI/60/60*i.autoRotateSpeed})),b.default(x.default(i),"getZoomScale",(function(){return Math.pow(.95,i.zoomSpeed)})),b.default(x.default(i),"rotateLeft",(function(e){i.sphericalDelta.theta-=e})),b.default(x.default(i),"rotateUp",(function(e){i.sphericalDelta.phi-=e})),b.default(x.default(i),"panLeft",(function(e,t){i.v.setFromMatrixColumn(t,0),i.v.multiplyScalar(-e),i.panOffset.add(i.v)})),b.default(x.default(i),"panUp",(function(e,t){!0===i.screenSpacePanning?i.v.setFromMatrixColumn(t,1):(i.v.setFromMatrixColumn(t,0),i.v.crossVectors(i.object.up,i.v)),i.v.multiplyScalar(e),i.panOffset.add(i.v)})),b.default(x.default(i),"pan",(function(t,r){var a=i.domElement;if(i.object instanceof e.PerspectiveCamera){var n=i.object.position;i.offset.copy(n).sub(i.target);var o=i.offset.length();o*=Math.tan(i.object.fov/2*Math.PI/180),i.panLeft(2*t*o/a.clientHeight,i.object.matrix),i.panUp(2*r*o/a.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(i.panLeft(t*(i.object.right-i.object.left)/i.object.zoom/a.clientWidth,i.object.matrix),i.panUp(r*(i.object.top-i.object.bottom)/i.object.zoom/a.clientHeight,i.object.matrix)):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)})),b.default(x.default(i),"dollyIn",(function(t){i.object instanceof e.PerspectiveCamera?i.scale/=t:i.object instanceof e.OrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*t)),i.object.updateProjectionMatrix(),i.zoomChanged=!0):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)})),b.default(x.default(i),"dollyOut",(function(t){i.object instanceof e.PerspectiveCamera?i.scale*=t:i.object instanceof e.OrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/t)),i.object.updateProjectionMatrix(),i.zoomChanged=!0):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)})),b.default(x.default(i),"handleMouseDownRotate",(function(e){i.rotateStart.set(e.clientX,e.clientY)})),b.default(x.default(i),"handleMouseDownDolly",(function(e){i.dollyStart.set(e.clientX,e.clientY)})),b.default(x.default(i),"handleMouseDownPan",(function(e){i.panStart.set(e.clientX,e.clientY)})),b.default(x.default(i),"handleMouseMoveRotate",(function(e){i.rotateEnd.set(e.clientX,e.clientY),i.rotateDelta.subVectors(i.rotateEnd,i.rotateStart).multiplyScalar(i.rotateSpeed);var t=i.domElement;i.rotateLeft(2*Math.PI*i.rotateDelta.x/t.clientHeight),i.rotateUp(2*Math.PI*i.rotateDelta.y/t.clientHeight),i.rotateStart.copy(i.rotateEnd),i.update()})),b.default(x.default(i),"handleMouseMoveDolly",(function(e){i.dollyEnd.set(e.clientX,e.clientY),i.dollyDelta.subVectors(i.dollyEnd,i.dollyStart),i.dollyDelta.y>0?i.dollyIn(i.getZoomScale()):i.dollyDelta.y<0&&i.dollyOut(i.getZoomScale()),i.dollyStart.copy(i.dollyEnd),i.update()})),b.default(x.default(i),"handleMouseMovePan",(function(e){i.panEnd.set(e.clientX,e.clientY),i.panDelta.subVectors(i.panEnd,i.panStart).multiplyScalar(i.panSpeed),i.pan(i.panDelta.x,i.panDelta.y),i.panStart.copy(i.panEnd),i.update()})),b.default(x.default(i),"handleMouseWheel",(function(e){e.deltaY<0?i.dollyOut(i.getZoomScale()):e.deltaY>0&&i.dollyIn(i.getZoomScale()),i.update()})),b.default(x.default(i),"handleKeyDown",(function(e){var t=!1;switch(e.keyCode){case i.keys.UP:i.pan(0,i.keyPanSpeed),t=!0;break;case i.keys.BOTTOM:i.pan(0,-i.keyPanSpeed),t=!0;break;case i.keys.LEFT:i.pan(i.keyPanSpeed,0),t=!0;break;case i.keys.RIGHT:i.pan(-i.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),i.update())})),b.default(x.default(i),"handleTouchStartRotate",(function(e){if(1==e.touches.length)i.rotateStart.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);i.rotateStart.set(t,r)}})),b.default(x.default(i),"handleTouchStartPan",(function(e){if(1==e.touches.length)i.panStart.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);i.panStart.set(t,r)}})),b.default(x.default(i),"handleTouchStartDolly",(function(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);i.dollyStart.set(0,a)})),b.default(x.default(i),"handleTouchStartDollyPan",(function(e){i.enableZoom&&i.handleTouchStartDolly(e),i.enablePan&&i.handleTouchStartPan(e)})),b.default(x.default(i),"handleTouchStartDollyRotate",(function(e){i.enableZoom&&i.handleTouchStartDolly(e),i.enableRotate&&i.handleTouchStartRotate(e)})),b.default(x.default(i),"handleTouchMoveRotate",(function(e){if(1==e.touches.length)i.rotateEnd.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);i.rotateEnd.set(t,r)}i.rotateDelta.subVectors(i.rotateEnd,i.rotateStart).multiplyScalar(i.rotateSpeed);var a=i.domElement;i.rotateLeft(2*Math.PI*i.rotateDelta.x/a.clientHeight),i.rotateUp(2*Math.PI*i.rotateDelta.y/a.clientHeight),i.rotateStart.copy(i.rotateEnd)})),b.default(x.default(i),"handleTouchMovePan",(function(e){if(1==e.touches.length)i.panEnd.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);i.panEnd.set(t,r)}i.panDelta.subVectors(i.panEnd,i.panStart).multiplyScalar(i.panSpeed),i.pan(i.panDelta.x,i.panDelta.y),i.panStart.copy(i.panEnd)})),b.default(x.default(i),"handleTouchMoveDolly",(function(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);i.dollyEnd.set(0,a),i.dollyDelta.set(0,Math.pow(i.dollyEnd.y/i.dollyStart.y,i.zoomSpeed)),i.dollyIn(i.dollyDelta.y),i.dollyStart.copy(i.dollyEnd)})),b.default(x.default(i),"handleTouchMoveDollyPan",(function(e){i.enableZoom&&i.handleTouchMoveDolly(e),i.enablePan&&i.handleTouchMovePan(e)})),b.default(x.default(i),"handleTouchMoveDollyRotate",(function(e){i.enableZoom&&i.handleTouchMoveDolly(e),i.enableRotate&&i.handleTouchMoveRotate(e)})),b.default(x.default(i),"onMouseDown",(function(t){if(!1!==i.enabled){var r;switch(t.preventDefault(),i.domElement.focus?i.domElement.focus():window.focus(),t.button){case 0:r=i.mouseButtons.LEFT;break;case 1:r=i.mouseButtons.MIDDLE;break;case 2:r=i.mouseButtons.RIGHT;break;default:r=-1}switch(r){case e.MOUSE.DOLLY:if(!1===i.enableZoom)return;i.handleMouseDownDolly(t),i.state=exports.STATE.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enablePan)return;i.handleMouseDownPan(t),i.state=exports.STATE.PAN}else{if(!1===i.enableRotate)return;i.handleMouseDownRotate(t),i.state=exports.STATE.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enableRotate)return;i.handleMouseDownRotate(t),i.state=exports.STATE.ROTATE}else{if(!1===i.enablePan)return;i.handleMouseDownPan(t),i.state=exports.STATE.PAN}break;default:i.state=exports.STATE.NONE}i.state!==exports.STATE.NONE&&(document.addEventListener("mousemove",i.onMouseMove,!1),document.addEventListener("mouseup",i.onMouseUp,!1),i.dispatchEvent(i.startEvent))}})),b.default(x.default(i),"onMouseMove",(function(e){if(!1!==i.enabled)switch(e.preventDefault(),i.state){case exports.STATE.ROTATE:if(!1===i.enableRotate)return;i.handleMouseMoveRotate(e);break;case exports.STATE.DOLLY:if(!1===i.enableZoom)return;i.handleMouseMoveDolly(e);break;case exports.STATE.PAN:if(!1===i.enablePan)return;i.handleMouseMovePan(e)}})),b.default(x.default(i),"onMouseUp",(function(){!1!==i.enabled&&(document.removeEventListener("mousemove",i.onMouseMove,!1),document.removeEventListener("mouseup",i.onMouseUp,!1),i.dispatchEvent(i.endEvent),i.state=exports.STATE.NONE)})),b.default(x.default(i),"onMouseWheel",(function(e){!1===i.enabled||!1===i.enableZoom||i.state!==exports.STATE.NONE&&i.state!==exports.STATE.ROTATE||(e.preventDefault(),i.dispatchEvent(i.startEvent),i.handleMouseWheel(e),i.dispatchEvent(i.endEvent))})),b.default(x.default(i),"onKeyDown",(function(e){!1!==i.enabled&&!1!==i.enableKeys&&!1!==i.enablePan&&i.handleKeyDown(e)})),b.default(x.default(i),"onTouchStart",(function(t){if(!1!==i.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(i.touches.ONE){case e.TOUCH.ROTATE:if(!1===i.enableRotate)return;i.handleTouchStartRotate(t),i.state=exports.STATE.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===i.enablePan)return;i.handleTouchStartPan(t),i.state=exports.STATE.TOUCH_PAN;break;default:i.state=exports.STATE.NONE}break;case 2:switch(i.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.handleTouchStartDollyPan(t),i.state=exports.STATE.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;i.handleTouchStartDollyRotate(t),i.state=exports.STATE.TOUCH_DOLLY_ROTATE;break;default:i.state=exports.STATE.NONE}break;default:i.state=exports.STATE.NONE}i.state!==exports.STATE.NONE&&i.dispatchEvent(i.startEvent)}})),b.default(x.default(i),"onTouchMove",(function(e){if(!1!==i.enabled)switch(e.preventDefault(),i.state){case exports.STATE.TOUCH_ROTATE:if(!1===i.enableRotate)return;i.handleTouchMoveRotate(e),i.update();break;case exports.STATE.TOUCH_PAN:if(!1===i.enablePan)return;i.handleTouchMovePan(e),i.update();break;case exports.STATE.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.handleTouchMoveDollyPan(e),i.update();break;case exports.STATE.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;i.handleTouchMoveDollyRotate(e),i.update();break;default:i.state=exports.STATE.NONE}})),b.default(x.default(i),"onTouchEnd",(function(){!1!==i.enabled&&(i.dispatchEvent(i.endEvent),i.state=exports.STATE.NONE)})),b.default(x.default(i),"onContextMenu",(function(e){!1!==i.enabled&&e.preventDefault()})),void 0===a&&console.warn('THREE.CameraControls: The second parameter "domElement" is now mandatory.'),a instanceof Document&&console.error('THREE.CameraControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.object=r,i.domElement=a,i.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.quaternion0=i.object.quaternion.clone(),i.zoom0=i.object.zoom,i.quat=(new e.Quaternion).setFromUnitVectors(i.object.up,new e.Vector3(0,1,0)),i.quatInverse=i.quat.clone().invert(),i.lastPosition=new e.Vector3,i.lastQuaternion=new e.Quaternion,i.domElement.addEventListener("contextmenu",i.onContextMenu,!1),i.domElement.addEventListener("mousedown",i.onMouseDown,!1),i.domElement.addEventListener("wheel",i.onMouseWheel,!1),i.domElement.addEventListener("touchstart",i.onTouchStart,!1),i.domElement.addEventListener("touchend",i.onTouchEnd,!1),i.domElement.addEventListener("touchmove",i.onTouchMove,!1),i.domElement.addEventListener("keydown",i.onKeyDown,!1),-1===i.domElement.tabIndex&&(i.domElement.tabIndex=0),i.object.lookAt(i.target),i.update(),i.saveState(),i}g.default(r,t);var a=r.prototype;return a.handleMouseUp=function(){},a.handleTouchEnd=function(){},r}(e.EventDispatcher),ki=function(t){function r(r,a){var i;return i=t.call(this,r,a)||this,b.default(x.default(i),"mouseButtons",void 0),b.default(x.default(i),"touches",void 0),i.mouseButtons={LEFT:e.MOUSE.ROTATE,RIGHT:e.MOUSE.PAN},i.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},i}return g.default(r,t),r}(Ui),Vi=function(t){function r(r,a){var i;return i=t.call(this,r,a)||this,b.default(x.default(i),"mouseButtons",void 0),b.default(x.default(i),"touches",void 0),i.mouseButtons={LEFT:e.MOUSE.PAN,RIGHT:e.MOUSE.ROTATE},i.touches={ONE:e.TOUCH.PAN,TWO:e.TOUCH.DOLLY_ROTATE},i}return g.default(r,t),r}(Ui),Gi=function(t){function r(r,a){var i;return i=t.call(this,r,a)||this,b.default(x.default(i),"trackball",void 0),b.default(x.default(i),"screenSpacePanning",void 0),b.default(x.default(i),"autoRotate",void 0),b.default(x.default(i),"mouseButtons",void 0),b.default(x.default(i),"touches",void 0),i.trackball=!0,i.screenSpacePanning=!0,i.autoRotate=!1,i.mouseButtons={LEFT:e.MOUSE.ROTATE,RIGHT:e.MOUSE.PAN},i.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},i}return g.default(r,t),r}(Ui),ji=function(t){function r(r,a){var i;return i=t.call(this)||this,b.default(x.default(i),"object",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"enabled",!0),b.default(x.default(i),"movementSpeed",1),b.default(x.default(i),"lookSpeed",.005),b.default(x.default(i),"lookVertical",!0),b.default(x.default(i),"autoForward",!1),b.default(x.default(i),"activeLook",!0),b.default(x.default(i),"heightSpeed",!1),b.default(x.default(i),"heightCoef",1),b.default(x.default(i),"heightMin",0),b.default(x.default(i),"heightMax",1),b.default(x.default(i),"constrainVertical",!1),b.default(x.default(i),"verticalMin",0),b.default(x.default(i),"verticalMax",Math.PI),b.default(x.default(i),"mouseDragOn",!1),b.default(x.default(i),"autoSpeedFactor",0),b.default(x.default(i),"mouseX",0),b.default(x.default(i),"mouseY",0),b.default(x.default(i),"moveForward",!1),b.default(x.default(i),"moveBackward",!1),b.default(x.default(i),"moveLeft",!1),b.default(x.default(i),"moveRight",!1),b.default(x.default(i),"moveUp",!1),b.default(x.default(i),"moveDown",!1),b.default(x.default(i),"viewHalfX",0),b.default(x.default(i),"viewHalfY",0),b.default(x.default(i),"lat",0),b.default(x.default(i),"lon",0),b.default(x.default(i),"lookDirection",new e.Vector3),b.default(x.default(i),"spherical",new e.Spherical),b.default(x.default(i),"target",new e.Vector3),b.default(x.default(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",i.contextmenu),i.domElement.removeEventListener("mousedown",i.onMouseDown),i.domElement.removeEventListener("mousemove",i.onMouseMove),i.domElement.removeEventListener("mouseup",i.onMouseUp),window.removeEventListener("keydown",i.onKeyDown),window.removeEventListener("keyup",i.onKeyUp)})),b.default(x.default(i),"handleResize",(function(){i.domElement instanceof Document?(i.viewHalfX=window.innerWidth/2,i.viewHalfY=window.innerHeight/2):(i.viewHalfX=i.domElement.offsetWidth/2,i.viewHalfY=i.domElement.offsetHeight/2)})),b.default(x.default(i),"onMouseDown",(function(e){if(i.domElement instanceof HTMLElement&&i.domElement.focus(),e.preventDefault(),i.activeLook)switch(e.button){case 0:i.moveForward=!0;break;case 2:i.moveBackward=!0}i.mouseDragOn=!0})),b.default(x.default(i),"onMouseUp",(function(e){if(e.preventDefault(),i.activeLook)switch(e.button){case 0:i.moveForward=!1;break;case 2:i.moveBackward=!1}i.mouseDragOn=!1})),b.default(x.default(i),"onMouseMove",(function(e){i.domElement instanceof Document?(i.mouseX=e.pageX-i.viewHalfX,i.mouseY=e.pageY-i.viewHalfY):(i.mouseX=e.pageX-i.domElement.offsetLeft-i.viewHalfX,i.mouseY=e.pageY-i.domElement.offsetTop-i.viewHalfY)})),b.default(x.default(i),"onKeyDown",(function(e){switch(e.code){case"ArrowUp":case"KeyW":i.moveForward=!0;break;case"ArrowLeft":case"KeyA":i.moveLeft=!0;break;case"ArrowDown":case"KeyS":i.moveBackward=!0;break;case"ArrowRight":case"KeyD":i.moveRight=!0;break;case"KeyR":i.moveUp=!0;break;case"KeyF":i.moveDown=!0}})),b.default(x.default(i),"onKeyUp",(function(e){switch(e.code){case"ArrowUp":case"KeyW":i.moveForward=!1;break;case"ArrowLeft":case"KeyA":i.moveLeft=!1;break;case"ArrowDown":case"KeyS":i.moveBackward=!1;break;case"ArrowRight":case"KeyD":i.moveRight=!1;break;case"KeyR":i.moveUp=!1;break;case"KeyF":i.moveDown=!1}})),b.default(x.default(i),"lookAt",(function(t,r,a){return t instanceof e.Vector3?i.target.copy(t):r&&a&&i.target.set(t,r,a),i.object.lookAt(i.target),i.setOrientation(x.default(i)),x.default(i)})),b.default(x.default(i),"targetPosition",new e.Vector3),b.default(x.default(i),"update",(function(t){if(!1!==i.enabled){if(i.heightSpeed){var r=e.MathUtils.clamp(i.object.position.y,i.heightMin,i.heightMax)-i.heightMin;i.autoSpeedFactor=t*(r*i.heightCoef)}else i.autoSpeedFactor=0;var a=t*i.movementSpeed;(i.moveForward||i.autoForward&&!i.moveBackward)&&i.object.translateZ(-(a+i.autoSpeedFactor)),i.moveBackward&&i.object.translateZ(a),i.moveLeft&&i.object.translateX(-a),i.moveRight&&i.object.translateX(a),i.moveUp&&i.object.translateY(a),i.moveDown&&i.object.translateY(-a);var n=t*i.lookSpeed;i.activeLook||(n=0);var o=1;i.constrainVertical&&(o=Math.PI/(i.verticalMax-i.verticalMin)),i.lon-=i.mouseX*n,i.lookVertical&&(i.lat-=i.mouseY*n*o),i.lat=Math.max(-85,Math.min(85,i.lat));var s=e.MathUtils.degToRad(90-i.lat),l=e.MathUtils.degToRad(i.lon);i.constrainVertical&&(s=e.MathUtils.mapLinear(s,0,Math.PI,i.verticalMin,i.verticalMax));var u=i.object.position;i.targetPosition.setFromSphericalCoords(1,s,l).add(u),i.object.lookAt(i.targetPosition)}})),b.default(x.default(i),"contextmenu",(function(e){return e.preventDefault()})),b.default(x.default(i),"setOrientation",(function(t){var r=t.object.quaternion;i.lookDirection.set(0,0,-1).applyQuaternion(r),i.spherical.setFromVector3(i.lookDirection),i.lat=90-e.MathUtils.radToDeg(i.spherical.phi),i.lon=e.MathUtils.radToDeg(i.spherical.theta)})),void 0===a&&(console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.'),a=document),i.object=r,i.domElement=a,i.domElement instanceof HTMLElement&&i.domElement.setAttribute("tabindex","-1"),i.handleResize(),i.setOrientation(x.default(i)),i.domElement.addEventListener("contextmenu",i.contextmenu),i.domElement.addEventListener("mousemove",i.onMouseMove),i.domElement.addEventListener("mousedown",i.onMouseDown),i.domElement.addEventListener("mouseup",i.onMouseUp),window.addEventListener("keydown",i.onKeyDown),window.addEventListener("keyup",i.onKeyUp),i}return g.default(r,t),r}(e.EventDispatcher),zi=function(t){function r(r,a){var i;i=t.call(this)||this,b.default(x.default(i),"isTransformControls",!0),b.default(x.default(i),"visible",!1),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"raycaster",new e.Raycaster),b.default(x.default(i),"gizmo",void 0),b.default(x.default(i),"plane",void 0),b.default(x.default(i),"tempVector",new e.Vector3),b.default(x.default(i),"tempVector2",new e.Vector3),b.default(x.default(i),"tempQuaternion",new e.Quaternion),b.default(x.default(i),"unit",{X:new e.Vector3(1,0,0),Y:new e.Vector3(0,1,0),Z:new e.Vector3(0,0,1)}),b.default(x.default(i),"pointStart",new e.Vector3),b.default(x.default(i),"pointEnd",new e.Vector3),b.default(x.default(i),"offset",new e.Vector3),b.default(x.default(i),"rotationAxis",new e.Vector3),b.default(x.default(i),"startNorm",new e.Vector3),b.default(x.default(i),"endNorm",new e.Vector3),b.default(x.default(i),"rotationAngle",0),b.default(x.default(i),"cameraPosition",new e.Vector3),b.default(x.default(i),"cameraQuaternion",new e.Quaternion),b.default(x.default(i),"cameraScale",new e.Vector3),b.default(x.default(i),"parentPosition",new e.Vector3),b.default(x.default(i),"parentQuaternion",new e.Quaternion),b.default(x.default(i),"parentQuaternionInv",new e.Quaternion),b.default(x.default(i),"parentScale",new e.Vector3),b.default(x.default(i),"worldPositionStart",new e.Vector3),b.default(x.default(i),"worldQuaternionStart",new e.Quaternion),b.default(x.default(i),"worldScaleStart",new e.Vector3),b.default(x.default(i),"worldPosition",new e.Vector3),b.default(x.default(i),"worldQuaternion",new e.Quaternion),b.default(x.default(i),"worldQuaternionInv",new e.Quaternion),b.default(x.default(i),"worldScale",new e.Vector3),b.default(x.default(i),"eye",new e.Vector3),b.default(x.default(i),"positionStart",new e.Vector3),b.default(x.default(i),"quaternionStart",new e.Quaternion),b.default(x.default(i),"scaleStart",new e.Vector3),b.default(x.default(i),"camera",void 0),b.default(x.default(i),"object",void 0),b.default(x.default(i),"enabled",!0),b.default(x.default(i),"axis",null),b.default(x.default(i),"mode","translate"),b.default(x.default(i),"translationSnap",null),b.default(x.default(i),"rotationSnap",null),b.default(x.default(i),"scaleSnap",null),b.default(x.default(i),"space","world"),b.default(x.default(i),"size",1),b.default(x.default(i),"dragging",!1),b.default(x.default(i),"showX",!0),b.default(x.default(i),"showY",!0),b.default(x.default(i),"showZ",!0),b.default(x.default(i),"changeEvent",{type:"change"}),b.default(x.default(i),"mouseDownEvent",{type:"mouseDown"}),b.default(x.default(i),"mouseUpEvent",{type:"mouseUp",mode:i.mode}),b.default(x.default(i),"objectChangeEvent",{type:"objectChange"}),b.default(x.default(i),"intersectObjectWithRay",(function(e,t,r){for(var a=t.intersectObject(e,!0),i=0;i<a.length;i++)if(a[i].object.visible||r)return a[i];return!1})),b.default(x.default(i),"attach",(function(e){return i.object=e,i.visible=!0,x.default(i)})),b.default(x.default(i),"detach",(function(){return i.object=void 0,i.visible=!1,i.axis=null,x.default(i)})),b.default(x.default(i),"updateMatrixWorld",(function(){void 0!==i.object&&(i.object.updateMatrixWorld(),null===i.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):i.object.parent.matrixWorld.decompose(i.parentPosition,i.parentQuaternion,i.parentScale),i.object.matrixWorld.decompose(i.worldPosition,i.worldQuaternion,i.worldScale),i.parentQuaternionInv.copy(i.parentQuaternion).invert(),i.worldQuaternionInv.copy(i.worldQuaternion).invert()),i.camera.updateMatrixWorld(),i.camera.matrixWorld.decompose(i.cameraPosition,i.cameraQuaternion,i.cameraScale),i.eye.copy(i.cameraPosition).sub(i.worldPosition).normalize(),t.prototype.updateMatrixWorld.call(x.default(i))})),b.default(x.default(i),"pointerHover",(function(e){if(void 0!==i.object&&!0!==i.dragging){i.raycaster.setFromCamera(e,i.camera);var t=i.intersectObjectWithRay(i.gizmo.picker[i.mode],i.raycaster);i.axis=t?t.object.name:null}})),b.default(x.default(i),"pointerDown",(function(e){if(void 0!==i.object&&!0!==i.dragging&&0===e.button&&null!==i.axis){i.raycaster.setFromCamera(e,i.camera);var t=i.intersectObjectWithRay(i.plane,i.raycaster,!0);if(t){var r=i.space;if("scale"===i.mode?r="local":"E"!==i.axis&&"XYZE"!==i.axis&&"XYZ"!==i.axis||(r="world"),"local"===r&&"rotate"===i.mode){var a=i.rotationSnap;"X"===i.axis&&a&&(i.object.rotation.x=Math.round(i.object.rotation.x/a)*a),"Y"===i.axis&&a&&(i.object.rotation.y=Math.round(i.object.rotation.y/a)*a),"Z"===i.axis&&a&&(i.object.rotation.z=Math.round(i.object.rotation.z/a)*a)}i.object.updateMatrixWorld(),i.object.parent&&i.object.parent.updateMatrixWorld(),i.positionStart.copy(i.object.position),i.quaternionStart.copy(i.object.quaternion),i.scaleStart.copy(i.object.scale),i.object.matrixWorld.decompose(i.worldPositionStart,i.worldQuaternionStart,i.worldScaleStart),i.pointStart.copy(t.point).sub(i.worldPositionStart)}i.dragging=!0,i.mouseDownEvent.type=i.mode,i.dispatchEvent(i.mouseDownEvent)}})),b.default(x.default(i),"pointerMove",(function(e){var t=i.axis,r=i.mode,a=i.object,n=i.space;if("scale"===r?n="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(n="world"),void 0!==a&&null!==t&&!1!==i.dragging&&-1===e.button){i.raycaster.setFromCamera(e,i.camera);var o=i.intersectObjectWithRay(i.plane,i.raycaster,!0);if(o){if(i.pointEnd.copy(o.point).sub(i.worldPositionStart),"translate"===r)i.offset.copy(i.pointEnd).sub(i.pointStart),"local"===n&&"XYZ"!==t&&i.offset.applyQuaternion(i.worldQuaternionInv),-1===t.indexOf("X")&&(i.offset.x=0),-1===t.indexOf("Y")&&(i.offset.y=0),-1===t.indexOf("Z")&&(i.offset.z=0),"local"===n&&"XYZ"!==t?i.offset.applyQuaternion(i.quaternionStart).divide(i.parentScale):i.offset.applyQuaternion(i.parentQuaternionInv).divide(i.parentScale),a.position.copy(i.offset).add(i.positionStart),i.translationSnap&&("local"===n&&(a.position.applyQuaternion(i.tempQuaternion.copy(i.quaternionStart).invert()),-1!==t.search("X")&&(a.position.x=Math.round(a.position.x/i.translationSnap)*i.translationSnap),-1!==t.search("Y")&&(a.position.y=Math.round(a.position.y/i.translationSnap)*i.translationSnap),-1!==t.search("Z")&&(a.position.z=Math.round(a.position.z/i.translationSnap)*i.translationSnap),a.position.applyQuaternion(i.quaternionStart)),"world"===n&&(a.parent&&a.position.add(i.tempVector.setFromMatrixPosition(a.parent.matrixWorld)),-1!==t.search("X")&&(a.position.x=Math.round(a.position.x/i.translationSnap)*i.translationSnap),-1!==t.search("Y")&&(a.position.y=Math.round(a.position.y/i.translationSnap)*i.translationSnap),-1!==t.search("Z")&&(a.position.z=Math.round(a.position.z/i.translationSnap)*i.translationSnap),a.parent&&a.position.sub(i.tempVector.setFromMatrixPosition(a.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){var s=i.pointEnd.length()/i.pointStart.length();i.pointEnd.dot(i.pointStart)<0&&(s*=-1),i.tempVector2.set(s,s,s)}else i.tempVector.copy(i.pointStart),i.tempVector2.copy(i.pointEnd),i.tempVector.applyQuaternion(i.worldQuaternionInv),i.tempVector2.applyQuaternion(i.worldQuaternionInv),i.tempVector2.divide(i.tempVector),-1===t.search("X")&&(i.tempVector2.x=1),-1===t.search("Y")&&(i.tempVector2.y=1),-1===t.search("Z")&&(i.tempVector2.z=1);a.scale.copy(i.scaleStart).multiply(i.tempVector2),i.scaleSnap&&i.object&&(-1!==t.search("X")&&(i.object.scale.x=Math.round(a.scale.x/i.scaleSnap)*i.scaleSnap||i.scaleSnap),-1!==t.search("Y")&&(a.scale.y=Math.round(a.scale.y/i.scaleSnap)*i.scaleSnap||i.scaleSnap),-1!==t.search("Z")&&(a.scale.z=Math.round(a.scale.z/i.scaleSnap)*i.scaleSnap||i.scaleSnap))}else if("rotate"===r){i.offset.copy(i.pointEnd).sub(i.pointStart);var l=20/i.worldPosition.distanceTo(i.tempVector.setFromMatrixPosition(i.camera.matrixWorld));"E"===t?(i.rotationAxis.copy(i.eye),i.rotationAngle=i.pointEnd.angleTo(i.pointStart),i.startNorm.copy(i.pointStart).normalize(),i.endNorm.copy(i.pointEnd).normalize(),i.rotationAngle*=i.endNorm.cross(i.startNorm).dot(i.eye)<0?1:-1):"XYZE"===t?(i.rotationAxis.copy(i.offset).cross(i.eye).normalize(),i.rotationAngle=i.offset.dot(i.tempVector.copy(i.rotationAxis).cross(i.eye))*l):"X"!==t&&"Y"!==t&&"Z"!==t||(i.rotationAxis.copy(i.unit[t]),i.tempVector.copy(i.unit[t]),"local"===n&&i.tempVector.applyQuaternion(i.worldQuaternion),i.rotationAngle=i.offset.dot(i.tempVector.cross(i.eye).normalize())*l),i.rotationSnap&&(i.rotationAngle=Math.round(i.rotationAngle/i.rotationSnap)*i.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(a.quaternion.copy(i.quaternionStart),a.quaternion.multiply(i.tempQuaternion.setFromAxisAngle(i.rotationAxis,i.rotationAngle)).normalize()):(i.rotationAxis.applyQuaternion(i.parentQuaternionInv),a.quaternion.copy(i.tempQuaternion.setFromAxisAngle(i.rotationAxis,i.rotationAngle)),a.quaternion.multiply(i.quaternionStart).normalize())}i.dispatchEvent(i.changeEvent),i.dispatchEvent(i.objectChangeEvent)}}})),b.default(x.default(i),"pointerUp",(function(e){0===e.button&&(i.dragging&&null!==i.axis&&(i.mouseUpEvent.mode=i.mode,i.dispatchEvent(i.mouseUpEvent)),i.dragging=!1,i.axis=null)})),b.default(x.default(i),"getPointer",(function(e){var t;if(i.domElement&&null!==(t=i.domElement.ownerDocument)&&void 0!==t&&t.pointerLockElement)return{x:0,y:0,button:e.button};var r,a=e.changedTouches?e.changedTouches[0]:e,n=null===(r=i.domElement)||void 0===r?void 0:r.getBoundingClientRect();return{x:(a.clientX-n.left)/n.width*2-1,y:-(a.clientY-n.top)/n.height*2+1,button:e.button}})),b.default(x.default(i),"onPointerHover",(function(e){if(i.enabled)switch(e.pointerType){case"mouse":case"pen":i.pointerHover(i.getPointer(e))}})),b.default(x.default(i),"onPointerDown",(function(e){var t;i.enabled&&(i.domElement.style.touchAction="none",null===(t=i.domElement.ownerDocument)||void 0===t||t.addEventListener("pointermove",i.onPointerMove),i.pointerHover(i.getPointer(e)),i.pointerDown(i.getPointer(e)))})),b.default(x.default(i),"onPointerMove",(function(e){i.enabled&&i.pointerMove(i.getPointer(e))})),b.default(x.default(i),"onPointerUp",(function(e){var t;i.enabled&&(i.domElement.style.touchAction="",null===(t=i.domElement.ownerDocument)||void 0===t||t.removeEventListener("pointermove",i.onPointerMove),i.pointerUp(i.getPointer(e)))})),b.default(x.default(i),"getMode",(function(){return i.mode})),b.default(x.default(i),"setMode",(function(e){i.mode=e})),b.default(x.default(i),"setTranslationSnap",(function(e){i.translationSnap=e})),b.default(x.default(i),"setRotationSnap",(function(e){i.rotationSnap=e})),b.default(x.default(i),"setScaleSnap",(function(e){i.scaleSnap=e})),b.default(x.default(i),"setSize",(function(e){i.size=e})),b.default(x.default(i),"setSpace",(function(e){i.space=e})),b.default(x.default(i),"update",(function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")})),b.default(x.default(i),"dispose",(function(){var e,t;i.domElement.removeEventListener("pointerdown",i.onPointerDown),i.domElement.removeEventListener("pointermove",i.onPointerHover),null===(e=i.domElement.ownerDocument)||void 0===e||e.removeEventListener("pointermove",i.onPointerMove),null===(t=i.domElement.ownerDocument)||void 0===t||t.removeEventListener("pointerup",i.onPointerUp),i.traverse((function(e){var t=e;t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}))})),void 0===a&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),i.domElement=document),i.domElement=a,i.camera=r,i.gizmo=new Hi,i.add(i.gizmo),i.plane=new Wi,i.add(i.plane);var n=function(e,t){var r=t;Object.defineProperty(x.default(i),e,{get:function(){return void 0!==r?r:t},set:function(t){r!==t&&(r=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),i[e]=t,i.plane[e]=t,i.gizmo[e]=t};return n("camera",i.camera),n("object",i.object),n("enabled",i.enabled),n("axis",i.axis),n("mode",i.mode),n("translationSnap",i.translationSnap),n("rotationSnap",i.rotationSnap),n("scaleSnap",i.scaleSnap),n("space",i.space),n("size",i.size),n("dragging",i.dragging),n("showX",i.showX),n("showY",i.showY),n("showZ",i.showZ),n("worldPosition",i.worldPosition),n("worldPositionStart",i.worldPositionStart),n("worldQuaternion",i.worldQuaternion),n("worldQuaternionStart",i.worldQuaternionStart),n("cameraPosition",i.cameraPosition),n("cameraQuaternion",i.cameraQuaternion),n("pointStart",i.pointStart),n("pointEnd",i.pointEnd),n("rotationAxis",i.rotationAxis),n("rotationAngle",i.rotationAngle),n("eye",i.eye),a.addEventListener("pointerdown",i.onPointerDown),a.addEventListener("pointermove",i.onPointerHover),i.domElement.ownerDocument.addEventListener("pointerup",i.onPointerUp),i}return g.default(r,t),r}(e.Object3D),Hi=function(t){function r(){var r;r=t.call(this)||this,b.default(x.default(r),"isTransformControlsGizmo",!0),b.default(x.default(r),"type","TransformControlsGizmo"),b.default(x.default(r),"tempVector",new e.Vector3(0,0,0)),b.default(x.default(r),"tempEuler",new e.Euler),b.default(x.default(r),"alignVector",new e.Vector3(0,1,0)),b.default(x.default(r),"zeroVector",new e.Vector3(0,0,0)),b.default(x.default(r),"lookAtMatrix",new e.Matrix4),b.default(x.default(r),"tempQuaternion",new e.Quaternion),b.default(x.default(r),"tempQuaternion2",new e.Quaternion),b.default(x.default(r),"identityQuaternion",new e.Quaternion),b.default(x.default(r),"unitX",new e.Vector3(1,0,0)),b.default(x.default(r),"unitY",new e.Vector3(0,1,0)),b.default(x.default(r),"unitZ",new e.Vector3(0,0,1)),b.default(x.default(r),"gizmo",void 0),b.default(x.default(r),"picker",void 0),b.default(x.default(r),"helper",void 0),b.default(x.default(r),"rotationAxis",new e.Vector3),b.default(x.default(r),"cameraPosition",new e.Vector3),b.default(x.default(r),"worldPositionStart",new e.Vector3),b.default(x.default(r),"worldQuaternionStart",new e.Quaternion),b.default(x.default(r),"worldPosition",new e.Vector3),b.default(x.default(r),"worldQuaternion",new e.Quaternion),b.default(x.default(r),"eye",new e.Vector3),b.default(x.default(r),"camera",null),b.default(x.default(r),"enabled",!0),b.default(x.default(r),"axis",null),b.default(x.default(r),"mode","translate"),b.default(x.default(r),"space","world"),b.default(x.default(r),"size",1),b.default(x.default(r),"dragging",!1),b.default(x.default(r),"showX",!0),b.default(x.default(r),"showY",!0),b.default(x.default(r),"showZ",!0),b.default(x.default(r),"updateMatrixWorld",(function(){var a=r.space;"scale"===r.mode&&(a="local");var i="local"===a?r.worldQuaternion:r.identityQuaternion;r.gizmo.translate.visible="translate"===r.mode,r.gizmo.rotate.visible="rotate"===r.mode,r.gizmo.scale.visible="scale"===r.mode,r.helper.translate.visible="translate"===r.mode,r.helper.rotate.visible="rotate"===r.mode,r.helper.scale.visible="scale"===r.mode;var n=[];n=(n=(n=n.concat(r.picker[r.mode].children)).concat(r.gizmo[r.mode].children)).concat(r.helper[r.mode].children);for(var o=function(t){var a=n[t];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(r.worldPosition);var o=void 0;if(o=r.camera.isOrthographicCamera?(r.camera.top-r.camera.bottom)/r.camera.zoom:r.worldPosition.distanceTo(r.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*r.camera.fov/360)/r.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(o*r.size/7),"helper"===a.tag)return a.visible=!1,"AXIS"===a.name?(a.position.copy(r.worldPositionStart),a.visible=!!r.axis,"X"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,0,0)),a.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))>.9&&(a.visible=!1)),"Y"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,0,Math.PI/2)),a.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))>.9&&(a.visible=!1)),"Z"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,Math.PI/2,0)),a.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))>.9&&(a.visible=!1)),"XYZE"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,Math.PI/2,0)),r.alignVector.copy(r.rotationAxis),a.quaternion.setFromRotationMatrix(r.lookAtMatrix.lookAt(r.zeroVector,r.alignVector,r.unitY)),a.quaternion.multiply(r.tempQuaternion),a.visible=r.dragging),"E"===r.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(r.worldPositionStart),a.visible=r.dragging):"END"===a.name?(a.position.copy(r.worldPosition),a.visible=r.dragging):"DELTA"===a.name?(a.position.copy(r.worldPositionStart),a.quaternion.copy(r.worldQuaternionStart),r.tempVector.set(1e-10,1e-10,1e-10).add(r.worldPositionStart).sub(r.worldPosition).multiplyScalar(-1),r.tempVector.applyQuaternion(r.worldQuaternionStart.clone().invert()),a.scale.copy(r.tempVector),a.visible=r.dragging):(a.quaternion.copy(i),r.dragging?a.position.copy(r.worldPositionStart):a.position.copy(r.worldPosition),r.axis&&(a.visible=-1!==r.axis.search(a.name))),"continue";if(a.quaternion.copy(i),"translate"===r.mode||"scale"===r.mode){var s=.99;"X"!==a.name&&"XYZX"!==a.name||Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))>s&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Y"!==a.name&&"XYZY"!==a.name||Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))>s&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Z"!==a.name&&"XYZZ"!==a.name||Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))>s&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XY"===a.name&&Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"YZ"===a.name&&Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XZ"===a.name&&Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),-1!==a.name.search("X")&&(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))}else"rotate"===r.mode&&(r.tempQuaternion2.copy(i),r.alignVector.copy(r.eye).applyQuaternion(r.tempQuaternion.copy(i).invert()),-1!==a.name.search("E")&&a.quaternion.setFromRotationMatrix(r.lookAtMatrix.lookAt(r.eye,r.zeroVector,r.unitY)),"X"===a.name&&(r.tempQuaternion.setFromAxisAngle(r.unitX,Math.atan2(-r.alignVector.y,r.alignVector.z)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),a.quaternion.copy(r.tempQuaternion)),"Y"===a.name&&(r.tempQuaternion.setFromAxisAngle(r.unitY,Math.atan2(r.alignVector.x,r.alignVector.z)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),a.quaternion.copy(r.tempQuaternion)),"Z"===a.name&&(r.tempQuaternion.setFromAxisAngle(r.unitZ,Math.atan2(r.alignVector.y,r.alignVector.x)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),a.quaternion.copy(r.tempQuaternion)));a.visible=a.visible&&(-1===a.name.indexOf("X")||r.showX),a.visible=a.visible&&(-1===a.name.indexOf("Y")||r.showY),a.visible=a.visible&&(-1===a.name.indexOf("Z")||r.showZ),a.visible=a.visible&&(-1===a.name.indexOf("E")||r.showX&&r.showY&&r.showZ),a.material.opacity=a.material.opacity||a.material.opacity,a.material.color=a.material.color||a.material.color.clone(),a.material.color.copy(a.material.color),a.material.opacity=a.material.opacity,r.enabled?r.axis&&(a.name===r.axis||r.axis.split("").some((function(e){return a.name===e}))?(a.material.opacity=1,a.material.color.lerp(new e.Color(1,1,1),.5)):(a.material.opacity*=.25,a.material.color.lerp(new e.Color(1,1,1),.5))):(a.material.opacity*=.5,a.material.color.lerp(new e.Color(1,1,1),.5))},s=0;s<n.length;s++)o(s);t.prototype.updateMatrixWorld.call(x.default(r))}));var a=new e.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:e.DoubleSide,fog:!1,toneMapped:!1}),i=new e.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=a.clone();n.opacity=.15;var o=a.clone();o.opacity=.33;var s=a.clone();s.color.set(16711680);var l=a.clone();l.color.set(65280);var u=a.clone();u.color.set(255);var c=a.clone();c.opacity=.25;var h=c.clone();h.color.set(16776960);var d=c.clone();d.color.set(65535);var f=c.clone();f.color.set(16711935),a.clone().color.set(16776960);var p=i.clone();p.color.set(16711680);var m=i.clone();m.color.set(65280);var v=i.clone();v.color.set(255);var g=i.clone();g.color.set(65535);var y=i.clone();y.color.set(16711935);var A=i.clone();A.color.set(16776960);var w=i.clone();w.color.set(7895160);var M=A.clone();M.opacity=.25;var S=new e.CylinderGeometry(0,.05,.2,12,1,!1),T=new e.BoxGeometry(.125,.125,.125),C=new e.BufferGeometry;C.setAttribute("position",new e.Float32BufferAttribute([0,0,0,1,0,0],3));var F=function(t,r){for(var a=new e.BufferGeometry,i=[],n=0;n<=64*r;++n)i.push(0,Math.cos(n/32*Math.PI)*t,Math.sin(n/32*Math.PI)*t);return a.setAttribute("position",new e.Float32BufferAttribute(i,3)),a},E={X:[[new e.Mesh(S,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new e.Mesh(S,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new e.Line(C,p)]],Y:[[new e.Mesh(S,l),[0,1,0],null,null,"fwd"],[new e.Mesh(S,l),[0,1,0],[Math.PI,0,0],null,"bwd"],[new e.Line(C,m),null,[0,0,Math.PI/2]]],Z:[[new e.Mesh(S,u),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new e.Mesh(S,u),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new e.Line(C,v),null,[0,-Math.PI/2,0]]],XYZ:[[new e.Mesh(new e.OctahedronGeometry(.1,0),c.clone()),[0,0,0],[0,0,0]]],XY:[[new e.Mesh(new e.PlaneGeometry(.295,.295),h.clone()),[.15,.15,0]],[new e.Line(C,A),[.18,.3,0],null,[.125,1,1]],[new e.Line(C,A),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new e.Mesh(new e.PlaneGeometry(.295,.295),d.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new e.Line(C,g),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new e.Line(C,g),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new e.Mesh(new e.PlaneGeometry(.295,.295),f.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new e.Line(C,y),[.18,0,.3],null,[.125,1,1]],[new e.Line(C,y),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},B={X:[[new e.Mesh(new e.CylinderGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new e.Mesh(new e.CylinderGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new e.Mesh(new e.CylinderGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new e.Mesh(new e.OctahedronGeometry(.2,0),n)]],XY:[[new e.Mesh(new e.PlaneGeometry(.4,.4),n),[.2,.2,0]]],YZ:[[new e.Mesh(new e.PlaneGeometry(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new e.Mesh(new e.PlaneGeometry(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},L={START:[[new e.Mesh(new e.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],END:[[new e.Mesh(new e.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],DELTA:[[new e.Line(function(){var t=new e.BufferGeometry;return t.setAttribute("position",new e.Float32BufferAttribute([0,0,0,1,1,1],3)),t}(),o),null,null,null,"helper"]],X:[[new e.Line(C,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new e.Line(C,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new e.Line(C,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},P={X:[[new e.Line(F(1,.5),p)],[new e.Mesh(new e.OctahedronGeometry(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new e.Line(F(1,.5),m),null,[0,0,-Math.PI/2]],[new e.Mesh(new e.OctahedronGeometry(.04,0),l),[0,0,.99],null,[3,1,1]]],Z:[[new e.Line(F(1,.5),v),null,[0,Math.PI/2,0]],[new e.Mesh(new e.OctahedronGeometry(.04,0),u),[.99,0,0],null,[1,3,1]]],E:[[new e.Line(F(1.25,1),M),null,[0,Math.PI/2,0]],[new e.Mesh(new e.CylinderGeometry(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new e.Mesh(new e.CylinderGeometry(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new e.Mesh(new e.CylinderGeometry(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new e.Mesh(new e.CylinderGeometry(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new e.Line(F(1,1),w),null,[0,Math.PI/2,0]]]},D={AXIS:[[new e.Line(C,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},N={X:[[new e.Mesh(new e.TorusGeometry(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new e.Mesh(new e.TorusGeometry(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new e.Mesh(new e.TorusGeometry(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new e.Mesh(new e.TorusGeometry(1.25,.1,2,24),n)]],XYZE:[[new e.Mesh(new e.SphereGeometry(.7,10,8),n)]]},R={X:[[new e.Mesh(T,s),[.8,0,0],[0,0,-Math.PI/2]],[new e.Line(C,p),null,null,[.8,1,1]]],Y:[[new e.Mesh(T,l),[0,.8,0]],[new e.Line(C,m),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new e.Mesh(T,u),[0,0,.8],[Math.PI/2,0,0]],[new e.Line(C,v),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new e.Mesh(T,h),[.85,.85,0],null,[2,2,.2]],[new e.Line(C,A),[.855,.98,0],null,[.125,1,1]],[new e.Line(C,A),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new e.Mesh(T,d),[0,.85,.85],null,[.2,2,2]],[new e.Line(C,g),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new e.Line(C,g),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new e.Mesh(T,f),[.85,0,.85],null,[2,.2,2]],[new e.Line(C,y),[.855,0,.98],null,[.125,1,1]],[new e.Line(C,y),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new e.Mesh(new e.BoxGeometry(.125,.125,.125),c.clone()),[1.1,0,0]]],XYZY:[[new e.Mesh(new e.BoxGeometry(.125,.125,.125),c.clone()),[0,1.1,0]]],XYZZ:[[new e.Mesh(new e.BoxGeometry(.125,.125,.125),c.clone()),[0,0,1.1]]]},_={X:[[new e.Mesh(new e.CylinderGeometry(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new e.Mesh(new e.CylinderGeometry(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new e.Mesh(new e.CylinderGeometry(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new e.Mesh(T,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new e.Mesh(T,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new e.Mesh(T,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new e.Mesh(new e.BoxGeometry(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new e.Mesh(new e.BoxGeometry(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new e.Mesh(new e.BoxGeometry(.2,.2,.2),n),[0,0,1.1]]]},I={X:[[new e.Line(C,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new e.Line(C,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new e.Line(C,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},O=function(t){var r=new e.Object3D;for(var a in t)for(var i=t[a].length;i--;){var n=t[a][i][0].clone(),o=t[a][i][1],s=t[a][i][2],l=t[a][i][3],u=t[a][i][4];n.name=a,n.tag=u,o&&n.position.set(o[0],o[1],o[2]),s&&n.rotation.set(s[0],s[1],s[2]),l&&n.scale.set(l[0],l[1],l[2]),n.updateMatrix();var c=n.geometry.clone();c.applyMatrix4(n.matrix),n.geometry=c,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),r.add(n)}return r};return r.gizmo={},r.picker={},r.helper={},r.add(r.gizmo.translate=O(E)),r.add(r.gizmo.rotate=O(P)),r.add(r.gizmo.scale=O(R)),r.add(r.picker.translate=O(B)),r.add(r.picker.rotate=O(N)),r.add(r.picker.scale=O(_)),r.add(r.helper.translate=O(L)),r.add(r.helper.rotate=O(D)),r.add(r.helper.scale=O(I)),r.picker.translate.visible=!1,r.picker.rotate.visible=!1,r.picker.scale.visible=!1,r}return g.default(r,t),r}(e.Object3D),Wi=function(t){function r(){var r;return r=t.call(this,new e.PlaneGeometry(1e5,1e5,2,2),new e.MeshBasicMaterial({visible:!1,wireframe:!0,side:e.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1}))||this,b.default(x.default(r),"isTransformControlsPlane",!0),b.default(x.default(r),"type","TransformControlsPlane"),b.default(x.default(r),"unitX",new e.Vector3(1,0,0)),b.default(x.default(r),"unitY",new e.Vector3(0,1,0)),b.default(x.default(r),"unitZ",new e.Vector3(0,0,1)),b.default(x.default(r),"tempVector",new e.Vector3),b.default(x.default(r),"dirVector",new e.Vector3),b.default(x.default(r),"alignVector",new e.Vector3),b.default(x.default(r),"tempMatrix",new e.Matrix4),b.default(x.default(r),"identityQuaternion",new e.Quaternion),b.default(x.default(r),"cameraQuaternion",new e.Quaternion),b.default(x.default(r),"worldPosition",new e.Vector3),b.default(x.default(r),"worldQuaternion",new e.Quaternion),b.default(x.default(r),"eye",new e.Vector3),b.default(x.default(r),"axis",null),b.default(x.default(r),"mode","translate"),b.default(x.default(r),"space","world"),b.default(x.default(r),"updateMatrixWorld",(function(){var e=r.space;switch(r.position.copy(r.worldPosition),"scale"===r.mode&&(e="local"),r.unitX.set(1,0,0).applyQuaternion("local"===e?r.worldQuaternion:r.identityQuaternion),r.unitY.set(0,1,0).applyQuaternion("local"===e?r.worldQuaternion:r.identityQuaternion),r.unitZ.set(0,0,1).applyQuaternion("local"===e?r.worldQuaternion:r.identityQuaternion),r.alignVector.copy(r.unitY),r.mode){case"translate":case"scale":switch(r.axis){case"X":r.alignVector.copy(r.eye).cross(r.unitX),r.dirVector.copy(r.unitX).cross(r.alignVector);break;case"Y":r.alignVector.copy(r.eye).cross(r.unitY),r.dirVector.copy(r.unitY).cross(r.alignVector);break;case"Z":r.alignVector.copy(r.eye).cross(r.unitZ),r.dirVector.copy(r.unitZ).cross(r.alignVector);break;case"XY":r.dirVector.copy(r.unitZ);break;case"YZ":r.dirVector.copy(r.unitX);break;case"XZ":r.alignVector.copy(r.unitZ),r.dirVector.copy(r.unitY);break;case"XYZ":case"E":r.dirVector.set(0,0,0)}break;case"rotate":default:r.dirVector.set(0,0,0)}0===r.dirVector.length()?r.quaternion.copy(r.cameraQuaternion):(r.tempMatrix.lookAt(r.tempVector.set(0,0,0),r.dirVector,r.alignVector),r.quaternion.setFromRotationMatrix(r.tempMatrix)),t.prototype.updateMatrixWorld.call(x.default(r))})),r}return g.default(r,t),r}(e.Mesh),Xi=function(t){function r(r,a,i){var n;return n=t.call(this)||this,b.default(x.default(n),"enabled",!0),b.default(x.default(n),"transformGroup",!1),b.default(x.default(n),"_objects",void 0),b.default(x.default(n),"_camera",void 0),b.default(x.default(n),"_domElement",void 0),b.default(x.default(n),"_plane",new e.Plane),b.default(x.default(n),"_raycaster",new e.Raycaster),b.default(x.default(n),"_mouse",new e.Vector2),b.default(x.default(n),"_offset",new e.Vector3),b.default(x.default(n),"_intersection",new e.Vector3),b.default(x.default(n),"_worldPosition",new e.Vector3),b.default(x.default(n),"_inverseMatrix",new e.Matrix4),b.default(x.default(n),"_intersections",[]),b.default(x.default(n),"_selected",null),b.default(x.default(n),"_hovered",null),b.default(x.default(n),"activate",(function(){n._domElement.addEventListener("pointermove",n.onPointerMove),n._domElement.addEventListener("pointerdown",n.onPointerDown),n._domElement.addEventListener("pointerup",n.onPointerCancel),n._domElement.addEventListener("pointerleave",n.onPointerCancel),n._domElement.addEventListener("touchmove",n.onTouchMove),n._domElement.addEventListener("touchstart",n.onTouchStart),n._domElement.addEventListener("touchend",n.onTouchEnd)})),b.default(x.default(n),"deactivate",(function(){n._domElement.removeEventListener("pointermove",n.onPointerMove),n._domElement.removeEventListener("pointerdown",n.onPointerDown),n._domElement.removeEventListener("pointerup",n.onPointerCancel),n._domElement.removeEventListener("pointerleave",n.onPointerCancel),n._domElement.removeEventListener("touchmove",n.onTouchMove),n._domElement.removeEventListener("touchstart",n.onTouchStart),n._domElement.removeEventListener("touchend",n.onTouchEnd),n._domElement.style.cursor=""})),b.default(x.default(n),"dispose",(function(){return n.deactivate()})),b.default(x.default(n),"getObjects",(function(){return n._objects})),b.default(x.default(n),"onMouseMove",(function(e){var t=n._domElement.getBoundingClientRect();if(n._mouse.x=(e.clientX-t.left)/t.width*2-1,n._mouse.y=-(e.clientY-t.top)/t.height*2+1,n._raycaster.setFromCamera(n._mouse,n._camera),n._selected&&n.enabled)return n._raycaster.ray.intersectPlane(n._plane,n._intersection)&&n._selected.position.copy(n._intersection.sub(n._offset).applyMatrix4(n._inverseMatrix)),void n.dispatchEvent({type:"drag",object:n._selected});if(n._intersections.length=0,n._raycaster.setFromCamera(n._mouse,n._camera),n._raycaster.intersectObjects(n._objects,!0,n._intersections),n._intersections.length>0){var r=n._intersections[0].object;n._plane.setFromNormalAndCoplanarPoint(n._camera.getWorldDirection(n._plane.normal),n._worldPosition.setFromMatrixPosition(r.matrixWorld)),n._hovered!==r&&(n.dispatchEvent({type:"hoveron",object:r}),n._domElement.style.cursor="pointer",n._hovered=r)}else null!==n._hovered&&(n.dispatchEvent({type:"hoveroff",object:n._hovered}),n._domElement.style.cursor="auto",n._hovered=null)})),b.default(x.default(n),"onMouseDown",(function(e){e.preventDefault(),n._intersections.length=0,n._raycaster.setFromCamera(n._mouse,n._camera),n._raycaster.intersectObjects(n._objects,!0,n._intersections),n._intersections.length>0&&(n._selected=!0===n.transformGroup?n._objects[0]:n._intersections[0].object,n._raycaster.ray.intersectPlane(n._plane,n._intersection)&&n._selected.parent&&(n._inverseMatrix.copy(n._selected.parent.matrixWorld).invert(),n._offset.copy(n._intersection).sub(n._worldPosition.setFromMatrixPosition(n._selected.matrixWorld))),n._domElement.style.cursor="move",n.dispatchEvent({type:"dragstart",object:n._selected}))})),b.default(x.default(n),"onMouseCancel",(function(e){e.preventDefault(),n._selected&&(n.dispatchEvent({type:"dragend",object:n._selected}),n._selected=null),n._domElement.style.cursor=n._hovered?"pointer":"auto"})),b.default(x.default(n),"onPointerMove",(function(e){switch(e.preventDefault(),e.pointerType){case"mouse":case"pen":n.onMouseMove(e)}})),b.default(x.default(n),"onPointerDown",(function(e){switch(e.preventDefault(),e.pointerType){case"mouse":case"pen":n.onMouseDown(e)}})),b.default(x.default(n),"onPointerCancel",(function(e){switch(e.preventDefault(),e.pointerType){case"mouse":case"pen":n.onMouseCancel(e)}})),b.default(x.default(n),"onTouchMove",(function(e){e.preventDefault();var t=e.changedTouches[0],r=n._domElement.getBoundingClientRect();if(n._mouse.x=(t.clientX-r.left)/r.width*2-1,n._mouse.y=-(t.clientY-r.top)/r.height*2+1,n._raycaster.setFromCamera(n._mouse,n._camera),n._selected&&n.enabled)return n._raycaster.ray.intersectPlane(n._plane,n._intersection)&&n._selected.position.copy(n._intersection.sub(n._offset).applyMatrix4(n._inverseMatrix)),void n.dispatchEvent({type:"drag",object:n._selected})})),b.default(x.default(n),"onTouchStart",(function(e){e.preventDefault();var t=e.changedTouches[0],r=n._domElement.getBoundingClientRect();n._mouse.x=(t.clientX-r.left)/r.width*2-1,n._mouse.y=-(t.clientY-r.top)/r.height*2+1,n._intersections.length=0,n._raycaster.setFromCamera(n._mouse,n._camera),n._raycaster.intersectObjects(n._objects,!0,n._intersections),n._intersections.length>0&&(n._selected=!0===n.transformGroup?n._objects[0]:n._intersections[0].object,n._plane.setFromNormalAndCoplanarPoint(n._camera.getWorldDirection(n._plane.normal),n._worldPosition.setFromMatrixPosition(n._selected.matrixWorld)),n._raycaster.ray.intersectPlane(n._plane,n._intersection)&&n._selected.parent&&(n._inverseMatrix.copy(n._selected.parent.matrixWorld).invert(),n._offset.copy(n._intersection).sub(n._worldPosition.setFromMatrixPosition(n._selected.matrixWorld))),n._domElement.style.cursor="move",n.dispatchEvent({type:"dragstart",object:n._selected}))})),b.default(x.default(n),"onTouchEnd",(function(e){e.preventDefault(),n._selected&&(n.dispatchEvent({type:"dragend",object:n._selected}),n._selected=null),n._domElement.style.cursor="auto"})),n._objects=r,n._camera=a,n._domElement=i,n.activate(),n}return g.default(r,t),r}(e.EventDispatcher),Qi=function(t){function r(r,a){var i;return i=t.call(this)||this,b.default(x.default(i),"camera",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"isLocked",!1),b.default(x.default(i),"minPolarAngle",0),b.default(x.default(i),"maxPolarAngle",Math.PI),b.default(x.default(i),"changeEvent",{type:"change"}),b.default(x.default(i),"lockEvent",{type:"lock"}),b.default(x.default(i),"unlockEvent",{type:"unlock"}),b.default(x.default(i),"euler",new e.Euler(0,0,0,"YXZ")),b.default(x.default(i),"PI_2",Math.PI/2),b.default(x.default(i),"vec",new e.Vector3),b.default(x.default(i),"onMouseMove",(function(e){if(!1!==i.isLocked){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;i.euler.setFromQuaternion(i.camera.quaternion),i.euler.y-=.002*t,i.euler.x-=.002*r,i.euler.x=Math.max(i.PI_2-i.maxPolarAngle,Math.min(i.PI_2-i.minPolarAngle,i.euler.x)),i.camera.quaternion.setFromEuler(i.euler),i.dispatchEvent(i.changeEvent)}})),b.default(x.default(i),"onPointerlockChange",(function(){i.domElement.ownerDocument.pointerLockElement===i.domElement?(i.dispatchEvent(i.lockEvent),i.isLocked=!0):(i.dispatchEvent(i.unlockEvent),i.isLocked=!1)})),b.default(x.default(i),"onPointerlockError",(function(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")})),b.default(x.default(i),"connect",(function(){i.domElement.ownerDocument.addEventListener("mousemove",i.onMouseMove),i.domElement.ownerDocument.addEventListener("pointerlockchange",i.onPointerlockChange),i.domElement.ownerDocument.addEventListener("pointerlockerror",i.onPointerlockError)})),b.default(x.default(i),"disconnect",(function(){i.domElement.ownerDocument.removeEventListener("mousemove",i.onMouseMove),i.domElement.ownerDocument.removeEventListener("pointerlockchange",i.onPointerlockChange),i.domElement.ownerDocument.removeEventListener("pointerlockerror",i.onPointerlockError)})),b.default(x.default(i),"dispose",(function(){i.disconnect()})),b.default(x.default(i),"getObject",(function(){return i.camera})),b.default(x.default(i),"direction",new e.Vector3(0,0,-1)),b.default(x.default(i),"getDirection",(function(e){return e.copy(i.direction).applyQuaternion(i.camera.quaternion)})),b.default(x.default(i),"moveForward",(function(e){i.vec.setFromMatrixColumn(i.camera.matrix,0),i.vec.crossVectors(i.camera.up,i.vec),i.camera.position.addScaledVector(i.vec,e)})),b.default(x.default(i),"moveRight",(function(e){i.vec.setFromMatrixColumn(i.camera.matrix,0),i.camera.position.addScaledVector(i.vec,e)})),b.default(x.default(i),"lock",(function(){i.domElement.requestPointerLock()})),b.default(x.default(i),"unlock",(function(){i.domElement.ownerDocument.exitPointerLock()})),void 0===a&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),a=document.body),i.domElement=a,i.camera=r,i.connect(),i}return g.default(r,t),r}(e.EventDispatcher),Yi=function(t){function r(r){var a;return a=t.call(this)||this,b.default(x.default(a),"object",void 0),b.default(x.default(a),"changeEvent",{type:"change"}),b.default(x.default(a),"EPS",1e-6),b.default(x.default(a),"enabled",!0),b.default(x.default(a),"deviceOrientation",{alpha:0,beta:0,gamma:0}),b.default(x.default(a),"screenOrientation",0),b.default(x.default(a),"alphaOffset",0),b.default(x.default(a),"onDeviceOrientationChangeEvent",(function(e){a.deviceOrientation=e})),b.default(x.default(a),"onScreenOrientationChangeEvent",(function(){a.screenOrientation=window.orientation||0})),b.default(x.default(a),"zee",new e.Vector3(0,0,1)),b.default(x.default(a),"euler",new e.Euler),b.default(x.default(a),"q0",new e.Quaternion),b.default(x.default(a),"q1",new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),b.default(x.default(a),"setObjectQuaternion",(function(e,t,r,i,n){a.euler.set(r,t,-i,"YXZ"),e.setFromEuler(a.euler),e.multiply(a.q1),e.multiply(a.q0.setFromAxisAngle(a.zee,-n))})),b.default(x.default(a),"connect",(function(){a.onScreenOrientationChangeEvent(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",a.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",a.onDeviceOrientationChangeEvent))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",a.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",a.onDeviceOrientationChangeEvent)),a.enabled=!0})),b.default(x.default(a),"disconnect",(function(){window.removeEventListener("orientationchange",a.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",a.onDeviceOrientationChangeEvent),a.enabled=!1})),b.default(x.default(a),"lastQuaternion",new e.Quaternion),b.default(x.default(a),"update",(function(){if(!1!==a.enabled){var t=a.deviceOrientation;if(t){var r=t.alpha?e.MathUtils.degToRad(t.alpha)+a.alphaOffset:0,i=t.beta?e.MathUtils.degToRad(t.beta):0,n=t.gamma?e.MathUtils.degToRad(t.gamma):0,o=a.screenOrientation?e.MathUtils.degToRad(a.screenOrientation):0;a.setObjectQuaternion(a.object.quaternion,r,i,n,o),8*(1-a.lastQuaternion.dot(a.object.quaternion))>a.EPS&&(a.lastQuaternion.copy(a.object.quaternion),a.dispatchEvent(a.changeEvent))}}})),b.default(x.default(a),"dispose",(function(){return a.disconnect()})),a.object=r,a.object.rotation.reorder("YXZ"),a.connect(),a}return g.default(r,t),r}(e.EventDispatcher),Ji=function(t){function r(r,a){var i;return i=t.call(this)||this,b.default(x.default(i),"enabled",!0),b.default(x.default(i),"screen",{left:0,top:0,width:0,height:0}),b.default(x.default(i),"rotateSpeed",1),b.default(x.default(i),"zoomSpeed",1.2),b.default(x.default(i),"panSpeed",.3),b.default(x.default(i),"noRotate",!1),b.default(x.default(i),"noZoom",!1),b.default(x.default(i),"noPan",!1),b.default(x.default(i),"staticMoving",!1),b.default(x.default(i),"dynamicDampingFactor",.2),b.default(x.default(i),"minDistance",0),b.default(x.default(i),"maxDistance",1/0),b.default(x.default(i),"keys",[65,83,68]),b.default(x.default(i),"mouseButtons",{LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN}),b.default(x.default(i),"object",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"target",new e.Vector3),b.default(x.default(i),"STATE",{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4}),b.default(x.default(i),"EPS",1e-6),b.default(x.default(i),"lastPosition",new e.Vector3),b.default(x.default(i),"lastZoom",1),b.default(x.default(i),"_state",i.STATE.NONE),b.default(x.default(i),"_keyState",i.STATE.NONE),b.default(x.default(i),"_eye",new e.Vector3),b.default(x.default(i),"_movePrev",new e.Vector2),b.default(x.default(i),"_moveCurr",new e.Vector2),b.default(x.default(i),"_lastAxis",new e.Vector3),b.default(x.default(i),"_lastAngle",0),b.default(x.default(i),"_zoomStart",new e.Vector2),b.default(x.default(i),"_zoomEnd",new e.Vector2),b.default(x.default(i),"_touchZoomDistanceStart",0),b.default(x.default(i),"_touchZoomDistanceEnd",0),b.default(x.default(i),"_panStart",new e.Vector2),b.default(x.default(i),"_panEnd",new e.Vector2),b.default(x.default(i),"target0",void 0),b.default(x.default(i),"position0",void 0),b.default(x.default(i),"up0",void 0),b.default(x.default(i),"zoom0",void 0),b.default(x.default(i),"changeEvent",{type:"change"}),b.default(x.default(i),"startEvent",{type:"start"}),b.default(x.default(i),"endEvent",{type:"end"}),b.default(x.default(i),"onScreenVector",new e.Vector2),b.default(x.default(i),"getMouseOnScreen",(function(e,t){return i.onScreenVector.set((e-i.screen.left)/i.screen.width,(t-i.screen.top)/i.screen.height),i.onScreenVector})),b.default(x.default(i),"onCircleVector",new e.Vector2),b.default(x.default(i),"getMouseOnCircle",(function(e,t){return i.onCircleVector.set((e-.5*i.screen.width-i.screen.left)/(.5*i.screen.width),(i.screen.height+2*(i.screen.top-t))/i.screen.width),i.onCircleVector})),b.default(x.default(i),"axis",new e.Vector3),b.default(x.default(i),"quaternion",new e.Quaternion),b.default(x.default(i),"eyeDirection",new e.Vector3),b.default(x.default(i),"objectUpDirection",new e.Vector3),b.default(x.default(i),"objectSidewaysDirection",new e.Vector3),b.default(x.default(i),"moveDirection",new e.Vector3),b.default(x.default(i),"angle",0),b.default(x.default(i),"rotateCamera",(function(){i.moveDirection.set(i._moveCurr.x-i._movePrev.x,i._moveCurr.y-i._movePrev.y,0),i.angle=i.moveDirection.length(),i.angle?(i._eye.copy(i.object.position).sub(i.target),i.eyeDirection.copy(i._eye).normalize(),i.objectUpDirection.copy(i.object.up).normalize(),i.objectSidewaysDirection.crossVectors(i.objectUpDirection,i.eyeDirection).normalize(),i.objectUpDirection.setLength(i._moveCurr.y-i._movePrev.y),i.objectSidewaysDirection.setLength(i._moveCurr.x-i._movePrev.x),i.moveDirection.copy(i.objectUpDirection.add(i.objectSidewaysDirection)),i.axis.crossVectors(i.moveDirection,i._eye).normalize(),i.angle*=i.rotateSpeed,i.quaternion.setFromAxisAngle(i.axis,i.angle),i._eye.applyQuaternion(i.quaternion),i.object.up.applyQuaternion(i.quaternion),i._lastAxis.copy(i.axis),i._lastAngle=i.angle):!i.staticMoving&&i._lastAngle&&(i._lastAngle*=Math.sqrt(1-i.dynamicDampingFactor),i._eye.copy(i.object.position).sub(i.target),i.quaternion.setFromAxisAngle(i._lastAxis,i._lastAngle),i._eye.applyQuaternion(i.quaternion),i.object.up.applyQuaternion(i.quaternion)),i._movePrev.copy(i._moveCurr)})),b.default(x.default(i),"zoomCamera",(function(){var e;i._state===i.STATE.TOUCH_ZOOM_PAN?(e=i._touchZoomDistanceStart/i._touchZoomDistanceEnd,i._touchZoomDistanceStart=i._touchZoomDistanceEnd,i.object.isPerspectiveCamera?i._eye.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom*=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(i._zoomEnd.y-i._zoomStart.y)*i.zoomSpeed)&&e>0&&(i.object.isPerspectiveCamera?i._eye.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?i._zoomStart.copy(i._zoomEnd):i._zoomStart.y+=(i._zoomEnd.y-i._zoomStart.y)*i.dynamicDampingFactor)})),b.default(x.default(i),"mouseChange",new e.Vector2),b.default(x.default(i),"objectUp",new e.Vector3),b.default(x.default(i),"pan",new e.Vector3),b.default(x.default(i),"panCamera",(function(){if(i.mouseChange.copy(i._panEnd).sub(i._panStart),i.mouseChange.lengthSq()){if(i.object.isOrthographicCamera){var e=i.object,t=(e.right-e.left)/i.object.zoom/i.domElement.clientWidth,r=(e.top-e.bottom)/i.object.zoom/i.domElement.clientWidth;i.mouseChange.x*=t,i.mouseChange.y*=r}i.mouseChange.multiplyScalar(i._eye.length()*i.panSpeed),i.pan.copy(i._eye).cross(i.object.up).setLength(i.mouseChange.x),i.pan.add(i.objectUp.copy(i.object.up).setLength(i.mouseChange.y)),i.object.position.add(i.pan),i.target.add(i.pan),i.staticMoving?i._panStart.copy(i._panEnd):i._panStart.add(i.mouseChange.subVectors(i._panEnd,i._panStart).multiplyScalar(i.dynamicDampingFactor))}})),b.default(x.default(i),"checkDistances",(function(){i.noZoom&&i.noPan||(i._eye.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,i._eye.setLength(i.maxDistance)),i._zoomStart.copy(i._zoomEnd)),i._eye.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,i._eye.setLength(i.minDistance)),i._zoomStart.copy(i._zoomEnd)))})),b.default(x.default(i),"handleResize",(function(){var e=i.domElement.getBoundingClientRect(),t=i.domElement.ownerDocument.documentElement;i.screen.left=e.left+window.pageXOffset-t.clientLeft,i.screen.top=e.top+window.pageYOffset-t.clientTop,i.screen.width=e.width,i.screen.height=e.height})),b.default(x.default(i),"update",(function(){i._eye.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,i._eye),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),i.lastPosition.distanceToSquared(i.object.position)>i.EPS&&(i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(i.lastPosition.distanceToSquared(i.object.position)>i.EPS||i.lastZoom!==i.object.zoom)&&(i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position),i.lastZoom=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")})),b.default(x.default(i),"reset",(function(){i._state=i.STATE.NONE,i._keyState=i.STATE.NONE,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i._eye.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position),i.lastZoom=i.object.zoom})),b.default(x.default(i),"keydown",(function(e){!1!==i.enabled&&(window.removeEventListener("keydown",i.keydown),i._keyState===i.STATE.NONE&&(e.keyCode!==i.keys[i.STATE.ROTATE]||i.noRotate?e.keyCode!==i.keys[i.STATE.ZOOM]||i.noZoom?e.keyCode!==i.keys[i.STATE.PAN]||i.noPan||(i._keyState=i.STATE.PAN):i._keyState=i.STATE.ZOOM:i._keyState=i.STATE.ROTATE))})),b.default(x.default(i),"onPointerDown",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseDown(e)}})),b.default(x.default(i),"onPointerMove",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseMove(e)}})),b.default(x.default(i),"onPointerUp",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseUp(e)}})),b.default(x.default(i),"keyup",(function(){!1!==i.enabled&&(i._keyState=i.STATE.NONE,window.addEventListener("keydown",i.keydown))})),b.default(x.default(i),"onMouseDown",(function(e){if(e.preventDefault(),i._state===i.STATE.NONE)switch(e.button){case i.mouseButtons.LEFT:i._state=i.STATE.ROTATE;break;case i.mouseButtons.MIDDLE:i._state=i.STATE.ZOOM;break;case i.mouseButtons.RIGHT:i._state=i.STATE.PAN;break;default:i._state=i.STATE.NONE}var t=i._keyState!==i.STATE.NONE?i._keyState:i._state;t!==i.STATE.ROTATE||i.noRotate?t!==i.STATE.ZOOM||i.noZoom?t!==i.STATE.PAN||i.noPan||(i._panStart.copy(i.getMouseOnScreen(e.pageX,e.pageY)),i._panEnd.copy(i._panStart)):(i._zoomStart.copy(i.getMouseOnScreen(e.pageX,e.pageY)),i._zoomEnd.copy(i._zoomStart)):(i._moveCurr.copy(i.getMouseOnCircle(e.pageX,e.pageY)),i._movePrev.copy(i._moveCurr)),i.domElement.ownerDocument.addEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.addEventListener("pointerup",i.onPointerUp),i.dispatchEvent(i.startEvent)})),b.default(x.default(i),"onMouseMove",(function(e){if(!1!==i.enabled){e.preventDefault();var t=i._keyState!==i.STATE.NONE?i._keyState:i._state;t!==i.STATE.ROTATE||i.noRotate?t!==i.STATE.ZOOM||i.noZoom?t!==i.STATE.PAN||i.noPan||i._panEnd.copy(i.getMouseOnScreen(e.pageX,e.pageY)):i._zoomEnd.copy(i.getMouseOnScreen(e.pageX,e.pageY)):(i._movePrev.copy(i._moveCurr),i._moveCurr.copy(i.getMouseOnCircle(e.pageX,e.pageY)))}})),b.default(x.default(i),"onMouseUp",(function(e){!1!==i.enabled&&(e.preventDefault(),i._state=i.STATE.NONE,i.domElement.ownerDocument.removeEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.removeEventListener("pointerup",i.onPointerUp),i.dispatchEvent(i.endEvent))})),b.default(x.default(i),"mousewheel",(function(e){if(!1!==i.enabled&&!0!==i.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:i._zoomStart.y-=.025*e.deltaY;break;case 1:i._zoomStart.y-=.01*e.deltaY;break;default:i._zoomStart.y-=25e-5*e.deltaY}i.dispatchEvent(i.startEvent),i.dispatchEvent(i.endEvent)}})),b.default(x.default(i),"touchstart",(function(e){if(!1!==i.enabled){switch(e.preventDefault(),e.touches.length){case 1:i._state=i.STATE.TOUCH_ROTATE,i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),i._movePrev.copy(i._moveCurr);break;default:i._state=i.STATE.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;i._touchZoomDistanceEnd=i._touchZoomDistanceStart=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;i._panStart.copy(i.getMouseOnScreen(a,n)),i._panEnd.copy(i._panStart)}i.dispatchEvent(i.startEvent)}})),b.default(x.default(i),"touchmove",(function(e){if(!1!==i.enabled)switch(e.preventDefault(),e.touches.length){case 1:i._movePrev.copy(i._moveCurr),i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;i._touchZoomDistanceEnd=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;i._panEnd.copy(i.getMouseOnScreen(a,n))}})),b.default(x.default(i),"touchend",(function(e){if(!1!==i.enabled){switch(e.touches.length){case 0:i._state=i.STATE.NONE;break;case 1:i._state=i.STATE.TOUCH_ROTATE,i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),i._movePrev.copy(i._moveCurr)}i.dispatchEvent(i.endEvent)}})),b.default(x.default(i),"contextmenu",(function(e){!1!==i.enabled&&e.preventDefault()})),b.default(x.default(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",i.contextmenu),i.domElement.removeEventListener("pointerdown",i.onPointerDown),i.domElement.removeEventListener("wheel",i.mousewheel),i.domElement.removeEventListener("touchstart",i.touchstart),i.domElement.removeEventListener("touchend",i.touchend),i.domElement.removeEventListener("touchmove",i.touchmove),i.domElement.ownerDocument.removeEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.removeEventListener("pointerup",i.onPointerUp),window.removeEventListener("keydown",i.keydown),window.removeEventListener("keyup",i.keyup)})),void 0===a&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),i.object=r,i.domElement=a,i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.up0=i.object.up.clone(),i.zoom0=i.object.zoom,i.domElement.addEventListener("contextmenu",i.contextmenu),i.domElement.addEventListener("pointerdown",i.onPointerDown),i.domElement.addEventListener("wheel",i.mousewheel),i.domElement.addEventListener("touchstart",i.touchstart),i.domElement.addEventListener("touchend",i.touchend),i.domElement.addEventListener("touchmove",i.touchmove),i.domElement.ownerDocument.addEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.addEventListener("pointerup",i.onPointerUp),window.addEventListener("keydown",i.keydown),window.addEventListener("keyup",i.keyup),i.handleResize(),i.update(),i}return g.default(r,t),r}(e.EventDispatcher),Ki=function(t){function r(r,a){var i;i=t.call(this)||this,b.default(x.default(i),"object",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"enabled",!0),b.default(x.default(i),"target",new e.Vector3),b.default(x.default(i),"minDistance",0),b.default(x.default(i),"maxDistance",1/0),b.default(x.default(i),"minZoom",0),b.default(x.default(i),"maxZoom",1/0),b.default(x.default(i),"minPolarAngle",0),b.default(x.default(i),"maxPolarAngle",Math.PI),b.default(x.default(i),"minAzimuthAngle",-1/0),b.default(x.default(i),"maxAzimuthAngle",1/0),b.default(x.default(i),"enableDamping",!1),b.default(x.default(i),"dampingFactor",.05),b.default(x.default(i),"enableZoom",!0),b.default(x.default(i),"zoomSpeed",1),b.default(x.default(i),"enableRotate",!0),b.default(x.default(i),"rotateSpeed",1),b.default(x.default(i),"enablePan",!0),b.default(x.default(i),"panSpeed",1),b.default(x.default(i),"screenSpacePanning",!0),b.default(x.default(i),"keyPanSpeed",7),b.default(x.default(i),"autoRotate",!1),b.default(x.default(i),"autoRotateSpeed",2),b.default(x.default(i),"keys",{LEFT:37,UP:38,RIGHT:39,BOTTOM:40}),b.default(x.default(i),"mouseButtons",{LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN}),b.default(x.default(i),"touches",{ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN}),b.default(x.default(i),"target0",void 0),b.default(x.default(i),"position0",void 0),b.default(x.default(i),"zoom0",void 0),b.default(x.default(i),"_domElementKeyEvents",null),b.default(x.default(i),"getPolarAngle",void 0),b.default(x.default(i),"getAzimuthalAngle",void 0),b.default(x.default(i),"listenToKeyEvents",void 0),b.default(x.default(i),"saveState",void 0),b.default(x.default(i),"reset",void 0),b.default(x.default(i),"update",void 0),b.default(x.default(i),"connect",void 0),b.default(x.default(i),"dispose",void 0),i.object=r,i.domElement=a,i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.zoom0=i.object instanceof e.PerspectiveCamera?i.object.zoom:1,i.getPolarAngle=function(){return d.phi},i.getAzimuthalAngle=function(){return d.theta},i.listenToKeyEvents=function(e){e.addEventListener("keydown",K),i._domElementKeyEvents=e},i.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object instanceof e.PerspectiveCamera?n.object.zoom:1},i.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object instanceof e.PerspectiveCamera&&(n.object.zoom=n.zoom0,n.object.updateProjectionMatrix()),n.dispatchEvent(o),n.update(),c=u.NONE},i.update=function(){var t=new e.Vector3,a=(new e.Quaternion).setFromUnitVectors(r.up,new e.Vector3(0,1,0)),i=a.clone().invert(),s=new e.Vector3,l=new e.Quaternion,g=2*Math.PI;return function(){var e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(a),d.setFromVector3(t),n.autoRotate&&c===u.NONE&&B(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(d.theta+=f.theta*n.dampingFactor,d.phi+=f.phi*n.dampingFactor):(d.theta+=f.theta,d.phi+=f.phi);var r=n.minAzimuthAngle,y=n.maxAzimuthAngle;return isFinite(r)&&isFinite(y)&&(r<-Math.PI?r+=g:r>Math.PI&&(r-=g),y<-Math.PI?y+=g:y>Math.PI&&(y-=g),d.theta=r<=y?Math.max(r,Math.min(y,d.theta)):d.theta>(r+y)/2?Math.max(r,d.theta):Math.min(y,d.theta)),d.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=p,d.radius=Math.max(n.minDistance,Math.min(n.maxDistance,d.radius)),!0===n.enableDamping?n.target.addScaledVector(m,n.dampingFactor):n.target.add(m),t.setFromSpherical(d),t.applyQuaternion(i),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(f.theta*=1-n.dampingFactor,f.phi*=1-n.dampingFactor,m.multiplyScalar(1-n.dampingFactor)):(f.set(0,0,0),m.set(0,0,0)),p=1,!!(v||s.distanceToSquared(n.object.position)>h||8*(1-l.dot(n.object.quaternion))>h)&&(n.dispatchEvent(o),s.copy(n.object.position),l.copy(n.object.quaternion),v=!1,!0)}}(),i.connect=function(e){e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=e,n.domElement.addEventListener("contextmenu",ee),n.domElement.addEventListener("pointerdown",X),n.domElement.addEventListener("wheel",J),n.domElement.addEventListener("touchstart",q),n.domElement.addEventListener("touchend",$),n.domElement.addEventListener("touchmove",Z)},i.dispose=function(){var e,t,r,a,i,o,s,l;null===(e=n.domElement)||void 0===e||e.removeEventListener("contextmenu",ee),null===(t=n.domElement)||void 0===t||t.removeEventListener("pointerdown",X),null===(r=n.domElement)||void 0===r||r.removeEventListener("wheel",J),null===(a=n.domElement)||void 0===a||a.removeEventListener("touchstart",q),null===(i=n.domElement)||void 0===i||i.removeEventListener("touchend",$),null===(o=n.domElement)||void 0===o||o.removeEventListener("touchmove",Z),null===(s=n.domElement)||void 0===s||s.ownerDocument.removeEventListener("pointermove",Q),null===(l=n.domElement)||void 0===l||l.ownerDocument.removeEventListener("pointerup",Y),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",K)};var n=x.default(i),o={type:"change"},s={type:"start"},l={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},c=u.NONE,h=1e-6,d=new e.Spherical,f=new e.Spherical,p=1,m=new e.Vector3,v=!1,g=new e.Vector2,y=new e.Vector2,A=new e.Vector2,w=new e.Vector2,M=new e.Vector2,S=new e.Vector2,T=new e.Vector2,C=new e.Vector2,F=new e.Vector2;function E(){return Math.pow(.95,n.zoomSpeed)}function B(e){f.theta-=e}function L(e){f.phi-=e}var P,D,N=(P=new e.Vector3,function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),m.add(P)}),R=function(){var t=new e.Vector3;return function(e,r){!0===n.screenSpacePanning?t.setFromMatrixColumn(r,1):(t.setFromMatrixColumn(r,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),m.add(t)}}(),_=(D=new e.Vector3,function(t,r){var a=n.domElement;if(a&&n.object instanceof e.PerspectiveCamera&&n.object.isPerspectiveCamera){var i=n.object.position;D.copy(i).sub(n.target);var o=D.length();o*=Math.tan(n.object.fov/2*Math.PI/180),N(2*t*o/a.clientHeight,n.object.matrix),R(2*r*o/a.clientHeight,n.object.matrix)}else a&&n.object instanceof e.OrthographicCamera&&n.object.isOrthographicCamera?(N(t*(n.object.right-n.object.left)/n.object.zoom/a.clientWidth,n.object.matrix),R(r*(n.object.top-n.object.bottom)/n.object.zoom/a.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)});function I(t){n.object instanceof e.PerspectiveCamera&&n.object.isPerspectiveCamera?p/=t:n.object instanceof e.OrthographicCamera&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function O(t){n.object instanceof e.PerspectiveCamera&&n.object.isPerspectiveCamera?p*=t:n.object instanceof e.OrthographicCamera&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function U(e){g.set(e.clientX,e.clientY)}function k(e){w.set(e.clientX,e.clientY)}function V(e){if(1==e.touches.length)g.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);g.set(t,r)}}function G(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,r)}}function j(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);T.set(0,a)}function z(e){if(1==e.touches.length)y.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);y.set(t,r)}A.subVectors(y,g).multiplyScalar(n.rotateSpeed);var a=n.domElement;a&&(B(2*Math.PI*A.x/a.clientHeight),L(2*Math.PI*A.y/a.clientHeight)),g.copy(y)}function H(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,r)}S.subVectors(M,w).multiplyScalar(n.panSpeed),_(S.x,S.y),w.copy(M)}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);C.set(0,a),F.set(0,Math.pow(C.y/T.y,n.zoomSpeed)),I(F.y),T.copy(C)}function X(t){if(!1!==n.enabled)switch(t.pointerType){case"mouse":case"pen":!function(t){var r,a;switch(t.preventDefault(),null!==(r=n.domElement)&&void 0!==r&&r.focus?n.domElement.focus():window.focus(),t.button){case 0:a=n.mouseButtons.LEFT;break;case 1:a=n.mouseButtons.MIDDLE;break;case 2:a=n.mouseButtons.RIGHT;break;default:a=-1}switch(a){case e.MOUSE.DOLLY:if(!1===n.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(t),c=u.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;k(t),c=u.PAN}else{if(!1===n.enableRotate)return;U(t),c=u.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;U(t),c=u.ROTATE}else{if(!1===n.enablePan)return;k(t),c=u.PAN}break;default:c=u.NONE}if(c!==u.NONE){var i,o;null===(i=n.domElement)||void 0===i||i.ownerDocument.addEventListener("pointermove",Q),null===(o=n.domElement)||void 0===o||o.ownerDocument.addEventListener("pointerup",Y),n.dispatchEvent(s)}}(t)}}function Q(e){if(!1!==n.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===n.enabled)return;switch(e.preventDefault(),c){case u.ROTATE:if(!1===n.enableRotate)return;!function(e){y.set(e.clientX,e.clientY),A.subVectors(y,g).multiplyScalar(n.rotateSpeed);var t=n.domElement;t&&(B(2*Math.PI*A.x/t.clientHeight),L(2*Math.PI*A.y/t.clientHeight)),g.copy(y),n.update()}(e);break;case u.DOLLY:if(!1===n.enableZoom)return;!function(e){C.set(e.clientX,e.clientY),F.subVectors(C,T),F.y>0?I(E()):F.y<0&&O(E()),T.copy(C),n.update()}(e);break;case u.PAN:if(!1===n.enablePan)return;!function(e){M.set(e.clientX,e.clientY),S.subVectors(M,w).multiplyScalar(n.panSpeed),_(S.x,S.y),w.copy(M),n.update()}(e)}}(e)}}function Y(e){switch(e.pointerType){case"mouse":case"pen":!function(){var e,t;if(null===(e=n.domElement)||void 0===e||e.ownerDocument.removeEventListener("pointermove",Q),null===(t=n.domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerup",Y),!1===n.enabled)return;n.dispatchEvent(l),c=u.NONE}()}}function J(e){!1===n.enabled||!1===n.enableZoom||c!==u.NONE&&c!==u.ROTATE||(e.preventDefault(),n.dispatchEvent(s),function(e){e.deltaY<0?O(E()):e.deltaY>0&&I(E()),n.update()}(e),n.dispatchEvent(l))}function K(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){var t=!1;switch(e.keyCode){case n.keys.UP:_(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:_(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:_(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:_(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function q(t){if(!1!==n.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(n.touches.ONE){case e.TOUCH.ROTATE:if(!1===n.enableRotate)return;V(t),c=u.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===n.enablePan)return;G(t),c=u.TOUCH_PAN;break;default:c=u.NONE}break;case 2:switch(n.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&j(e),n.enablePan&&G(e)}(t),c=u.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&j(e),n.enableRotate&&V(e)}(t),c=u.TOUCH_DOLLY_ROTATE;break;default:c=u.NONE}break;default:c=u.NONE}c!==u.NONE&&n.dispatchEvent(s)}}function Z(e){if(!1!==n.enabled)switch(e.preventDefault(),c){case u.TOUCH_ROTATE:if(!1===n.enableRotate)return;z(e),n.update();break;case u.TOUCH_PAN:if(!1===n.enablePan)return;H(e),n.update();break;case u.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&W(e),n.enablePan&&H(e)}(e),n.update();break;case u.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&W(e),n.enableRotate&&z(e)}(e),n.update();break;default:c=u.NONE}}function $(){!1!==n.enabled&&(n.dispatchEvent(l),c=u.NONE)}function ee(e){!1!==n.enabled&&e.preventDefault()}return void 0!==a&&i.connect(a),i.update(),i}return g.default(r,t),r}(e.EventDispatcher),qi=function(t){function r(r,a){var i;return(i=t.call(this,r,a)||this).screenSpacePanning=!1,i.mouseButtons.LEFT=e.MOUSE.PAN,i.mouseButtons.RIGHT=e.MOUSE.ROTATE,i.touches.ONE=e.TOUCH.PAN,i.touches.TWO=e.TOUCH.DOLLY_ROTATE,i}return g.default(r,t),r}(Ki);function Zi(e){e.preventDefault()}var $i=function(t){function r(r,a){var i;return i=t.call(this)||this,b.default(x.default(i),"object",void 0),b.default(x.default(i),"domElement",void 0),b.default(x.default(i),"movementSpeed",1),b.default(x.default(i),"rollSpeed",.005),b.default(x.default(i),"dragToLook",!1),b.default(x.default(i),"autoForward",!1),b.default(x.default(i),"changeEvent",{type:"change"}),b.default(x.default(i),"EPS",1e-6),b.default(x.default(i),"tmpQuaternion",new e.Quaternion),b.default(x.default(i),"mouseStatus",0),b.default(x.default(i),"movementSpeedMultiplier",1),b.default(x.default(i),"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),b.default(x.default(i),"moveVector",new e.Vector3(0,0,0)),b.default(x.default(i),"rotationVector",new e.Vector3(0,0,0)),b.default(x.default(i),"keydown",(function(e){if(!e.altKey){switch(e.code){case"ShiftLeft":case"ShiftRight":i.movementSpeedMultiplier=.1;break;case"KeyW":i.moveState.forward=1;break;case"KeyS":i.moveState.back=1;break;case"KeyA":i.moveState.left=1;break;case"KeyD":i.moveState.right=1;break;case"KeyR":i.moveState.up=1;break;case"KeyF":i.moveState.down=1;break;case"ArrowUp":i.moveState.pitchUp=1;break;case"ArrowDown":i.moveState.pitchDown=1;break;case"ArrowLeft":i.moveState.yawLeft=1;break;case"ArrowRight":i.moveState.yawRight=1;break;case"KeyQ":i.moveState.rollLeft=1;break;case"KeyE":i.moveState.rollRight=1}i.updateMovementVector(),i.updateRotationVector()}})),b.default(x.default(i),"keyup",(function(e){switch(e.code){case"ShiftLeft":case"ShiftRight":i.movementSpeedMultiplier=1;break;case"KeyW":i.moveState.forward=0;break;case"KeyS":i.moveState.back=0;break;case"KeyA":i.moveState.left=0;break;case"KeyD":i.moveState.right=0;break;case"KeyR":i.moveState.up=0;break;case"KeyF":i.moveState.down=0;break;case"ArrowUp":i.moveState.pitchUp=0;break;case"ArrowDown":i.moveState.pitchDown=0;break;case"ArrowLeft":i.moveState.yawLeft=0;break;case"ArrowRight":i.moveState.yawRight=0;break;case"KeyQ":i.moveState.rollLeft=0;break;case"KeyE":i.moveState.rollRight=0}i.updateMovementVector(),i.updateRotationVector()})),b.default(x.default(i),"mousedown",(function(e){if(i.domElement===document||i.domElement instanceof Document||i.domElement.focus(),e.preventDefault(),i.dragToLook)i.mouseStatus++;else{switch(e.button){case 0:i.moveState.forward=1;break;case 2:i.moveState.back=1}i.updateMovementVector()}})),b.default(x.default(i),"mousemove",(function(e){if(!i.dragToLook||i.mouseStatus>0){var t=i.getContainerDimensions(),r=t.size[0]/2,a=t.size[1]/2;i.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,i.moveState.pitchDown=(e.pageY-t.offset[1]-a)/a,i.updateRotationVector()}})),b.default(x.default(i),"mouseup",(function(e){if(e.preventDefault(),i.dragToLook)i.mouseStatus--,i.moveState.yawLeft=i.moveState.pitchDown=0;else{switch(e.button){case 0:i.moveState.forward=0;break;case 2:i.moveState.back=0}i.updateMovementVector()}i.updateRotationVector()})),b.default(x.default(i),"lastQuaternion",new e.Quaternion),b.default(x.default(i),"lastPosition",new e.Vector3),b.default(x.default(i),"update",(function(e){var t=e*i.movementSpeed,r=e*i.rollSpeed;i.object.translateX(i.moveVector.x*t),i.object.translateY(i.moveVector.y*t),i.object.translateZ(i.moveVector.z*t),i.tmpQuaternion.set(i.rotationVector.x*r,i.rotationVector.y*r,i.rotationVector.z*r,1).normalize(),i.object.quaternion.multiply(i.tmpQuaternion),(i.lastPosition.distanceToSquared(i.object.position)>i.EPS||8*(1-i.lastQuaternion.dot(i.object.quaternion))>i.EPS)&&(i.dispatchEvent(i.changeEvent),i.lastQuaternion.copy(i.object.quaternion),i.lastPosition.copy(i.object.position))})),b.default(x.default(i),"updateMovementVector",(function(){var e=i.moveState.forward||i.autoForward&&!i.moveState.back?1:0;i.moveVector.x=-i.moveState.left+i.moveState.right,i.moveVector.y=-i.moveState.down+i.moveState.up,i.moveVector.z=-e+i.moveState.back})),b.default(x.default(i),"updateRotationVector",(function(){i.rotationVector.x=-i.moveState.pitchDown+i.moveState.pitchUp,i.rotationVector.y=-i.moveState.yawRight+i.moveState.yawLeft,i.rotationVector.z=-i.moveState.rollRight+i.moveState.rollLeft})),b.default(x.default(i),"getContainerDimensions",(function(){return i.domElement==document||i.domElement instanceof Document?{size:[window.innerWidth,window.innerHeight],offset:[0,0]}:{size:[i.domElement.offsetWidth,i.domElement.offsetHeight],offset:[i.domElement.offsetLeft,i.domElement.offsetTop]}})),b.default(x.default(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",Zi),i.domElement.removeEventListener("mousemove",i.mousemove),i.domElement.removeEventListener("mousedown",i.mousedown),i.domElement.removeEventListener("mouseup",i.mouseup),window.removeEventListener("keydown",i.keydown),window.removeEventListener("keyup",i.keyup)})),void 0===a&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),a=document),i.object=r,i.domElement=a,!a||a instanceof Document||a.setAttribute("tabindex",-1),i.domElement.addEventListener("contextmenu",Zi),i.domElement.addEventListener("mousemove",i.mousemove),i.domElement.addEventListener("mousedown",i.mousedown),i.domElement.addEventListener("mouseup",i.mouseup),window.addEventListener("keydown",i.keydown),window.addEventListener("keyup",i.keyup),i.updateMovementVector(),i.updateRotationVector(),i}return g.default(r,t),r}(e.EventDispatcher),en={defines:{USE_3DTEXTURE:1},uniforms:{lut3d:{value:null},lut:{value:null},lutSize:{value:0},tDiffuse:{value:null},intensity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}\n\n\t",fragmentShader:"\n\t\tprecision highp sampler3D;\n\n\t\tuniform float lutSize;\n\t\t#if USE_3DTEXTURE\n\t\tuniform sampler3D lut3d;\n\t\t#else\n\t\tuniform sampler2D lut;\n\n\t\tvec3 lutLookup( sampler2D tex, float size, vec3 rgb ) {\n\n\t\t\tfloat sliceHeight = 1.0 / size;\n\t\t\tfloat yPixelHeight = 1.0 / ( size * size );\n\n\t\t\t// Get the slices on either side of the sample\n\t\t\tfloat slice = rgb.b * size;\n\t\t\tfloat interp = fract( slice );\n\t\t\tfloat slice0 = slice - interp;\n\t\t\tfloat centeredInterp = interp - 0.5;\n\n\t\t\tfloat slice1 = slice0 + sign( centeredInterp );\n\n\t\t\t// Pull y sample in by half a pixel in each direction to avoid color\n\t\t\t// bleeding from adjacent slices.\n\t\t\tfloat greenOffset = clamp( rgb.g * sliceHeight, yPixelHeight * 0.5, sliceHeight - yPixelHeight * 0.5 );\n\n\t\t\tvec2 uv0 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice0 * sliceHeight + greenOffset\n\t\t\t);\n\t\t\tvec2 uv1 = vec2(\n\t\t\t\trgb.r,\n\t\t\t\tslice1 * sliceHeight + greenOffset\n\t\t\t);\n\n\t\t\tvec3 sample0 = texture2D( tex, uv0 ).rgb;\n\t\t\tvec3 sample1 = texture2D( tex, uv1 ).rgb;\n\n\t\t\treturn mix( sample0, sample1, abs( centeredInterp ) );\n\n\t\t}\n\t\t#endif\n\n\t\tvarying vec2 vUv;\n\t\tuniform float intensity;\n\t\tuniform sampler2D tDiffuse;\n\t\tvoid main() {\n\n\t\t\tvec4 val = texture2D( tDiffuse, vUv );\n\t\t\tvec4 lutVal;\n\n\t\t\t// pull the sample in by half a pixel so the sample begins\n\t\t\t// at the center of the edge pixels.\n\t\t\tfloat pixelWidth = 1.0 / lutSize;\n\t\t\tfloat halfPixelWidth = 0.5 / lutSize;\n\t\t\tvec3 uvw = vec3( halfPixelWidth ) + val.rgb * ( 1.0 - pixelWidth );\n\n\t\t\t#if USE_3DTEXTURE\n\n\t\t\tlutVal = vec4( texture( lut3d, uvw ).rgb, val.a );\n\n\t\t\t#else\n\n\t\t\tlutVal = vec4( lutLookup( lut, lutSize, uvw ), val.a );\n\n\t\t\t#endif\n\n\t\t\tgl_FragColor = vec4( mix( val, lutVal, intensity ) );\n\n\t\t}\n\n\t"},tn=function(e){function t(t){var r;return void 0===t&&(t={}),(r=e.call(this,en)||this).lut=t.lut||null,r.intensity="intensity"in t?t.intensity:1,r}return g.default(t,e),A.default(t,[{key:"lut",get:function(){return this.material.uniforms.lut.value||this.material.uniforms.lut3d.value},set:function(e){var t=this.material;if(e!==this.lut&&(t.uniforms.lut3d.value=null,t.uniforms.lut.value=null,e)){var r=e.isDataTexture3D?1:0;r!==t.defines.USE_3DTEXTURE&&(t.defines.USE_3DTEXTURE=r,t.needsUpdate=!0),t.uniforms.lutSize.value=e.image.width,e.isDataTexture3D?t.uniforms.lut3d.value=e:t.uniforms.lut.value=e}}},{key:"intensity",get:function(){return this.material.uniforms.intensity.value},set:function(e){this.material.uniforms.intensity.value=e}}]),t}(Qr),rn=function(t,r){this.needsSwap=!1,this.clearColor=void 0!==t?t:0,this.clearAlpha=void 0!==r?r:0,this._oldClearColor=new e.Color};rn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:rn,render:function(e,t,r){var a;this.clearColor&&(e.getClearColor(this._oldClearColor),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:r),e.clear(),this.clearColor&&e.setClearColor(this._oldClearColor,a)}});var an={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","\tif(byp<1) {","\t\tvec2 p = vUv;","\t\tfloat xs = floor(gl_FragCoord.x / 0.5);","\t\tfloat ys = floor(gl_FragCoord.y / 0.5);","\t\tvec4 normal = texture2D (tDisp, p*seed*seed);","\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","\t\t\tif(seed_x>0.){","\t\t\t\tp.y = 1. - (p.y + distortion_y);","\t\t\t}","\t\t\telse {","\t\t\t\tp.y = distortion_y;","\t\t\t}","\t\t}","\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","\t\t\tif(seed_y>0.){","\t\t\t\tp.x=distortion_x;","\t\t\t}","\t\t\telse {","\t\t\t\tp.x = 1. - (p.x + distortion_x);","\t\t\t}","\t\t}","\t\tp.x+=normal.x*seed_x*(seed/5.);","\t\tp.y+=normal.y*seed_y*(seed/5.);","\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));","\t\tvec4 cr = texture2D(tDiffuse, p + offset);","\t\tvec4 cga = texture2D(tDiffuse, p);","\t\tvec4 cb = texture2D(tDiffuse, p - offset);","\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","\t\tgl_FragColor = gl_FragColor+ snow;","\t}","\telse {","\t\tgl_FragColor=texture2D (tDiffuse, vUv);","\t}","}"].join("\n")},nn=function(t){void 0===an&&console.error("THREE.GlitchPass relies on DigitalGlitch");var r=an;this.uniforms=e.UniformsUtils.clone(r.uniforms),null==t&&(t=64),this.uniforms.tDisp.value=this.generateHeightmap(t),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.fsQuad=new Xr(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()};nn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:nn,render:function(t,r,a){this.uniforms.tDiffuse.value=a.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=e.MathUtils.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=e.MathUtils.randFloat(-1,1),this.uniforms.seed_y.value=e.MathUtils.randFloat(-1,1),this.uniforms.distortion_x.value=e.MathUtils.randFloat(0,1),this.uniforms.distortion_y.value=e.MathUtils.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=e.MathUtils.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=e.MathUtils.randFloat(0,1),this.uniforms.distortion_y.value=e.MathUtils.randFloat(0,1),this.uniforms.seed_x.value=e.MathUtils.randFloat(-.3,.3),this.uniforms.seed_y.value=e.MathUtils.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(r),this.clear&&t.clear(),this.fsQuad.render(t))},generateTrigger:function(){this.randX=e.MathUtils.randInt(120,240)},generateHeightmap:function(t){for(var r=new Float32Array(t*t*3),a=t*t,i=0;i<a;i++){var n=e.MathUtils.randFloat(0,1);r[3*i+0]=n,r[3*i+1]=n,r[3*i+2]=n}return new e.DataTexture(r,t,t,e.RGBFormat,e.FloatType)}});var on={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:["varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define SQRT2_MINUS_ONE 0.41421356","#define SQRT2_HALF_MINUS_ONE 0.20710678","#define PI2 6.28318531","#define SHAPE_DOT 1","#define SHAPE_ELLIPSE 2","#define SHAPE_LINE 3","#define SHAPE_SQUARE 4","#define BLENDING_LINEAR 1","#define BLENDING_MULTIPLY 2","#define BLENDING_ADD 3","#define BLENDING_LIGHTER 4","#define BLENDING_DARKER 5","uniform sampler2D tDiffuse;","uniform float radius;","uniform float rotateR;","uniform float rotateG;","uniform float rotateB;","uniform float scatter;","uniform float width;","uniform float height;","uniform int shape;","uniform bool disable;","uniform float blending;","uniform int blendingMode;","varying vec2 vUV;","uniform bool greyscale;","const int samples = 8;","float blend( float a, float b, float t ) {","\treturn a * ( 1.0 - t ) + b * t;","}","float hypot( float x, float y ) {","\treturn sqrt( x * x + y * y );","}","float rand( vec2 seed ){","return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}","float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {","\tfloat dist = hypot( coord.x - p.x, coord.y - p.y );","\tfloat rad = channel;","\tif ( shape == SHAPE_DOT ) {","\t\trad = pow( abs( rad ), 1.125 ) * rad_max;","\t} else if ( shape == SHAPE_ELLIPSE ) {","\t\trad = pow( abs( rad ), 1.125 ) * rad_max;","\t\tif ( dist != 0.0 ) {","\t\t\tfloat dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );","\t\t\tdist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;","\t\t}","\t} else if ( shape == SHAPE_LINE ) {","\t\trad = pow( abs( rad ), 1.5) * rad_max;","\t\tfloat dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;","\t\tdist = hypot( normal.x * dot_p, normal.y * dot_p );","\t} else if ( shape == SHAPE_SQUARE ) {","\t\tfloat theta = atan( p.y - coord.y, p.x - coord.x ) - angle;","\t\tfloat sin_t = abs( sin( theta ) );","\t\tfloat cos_t = abs( cos( theta ) );","\t\trad = pow( abs( rad ), 1.4 );","\t\trad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );","\t}","\treturn rad - dist;","}","struct Cell {","\tvec2 normal;","\tvec2 p1;","\tvec2 p2;","\tvec2 p3;","\tvec2 p4;","\tfloat samp2;","\tfloat samp1;","\tfloat samp3;","\tfloat samp4;","};","vec4 getSample( vec2 point ) {","\tvec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );","\tfloat base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;","\tfloat step = PI2 / float( samples );","\tfloat dist = radius * 0.66;","\tfor ( int i = 0; i < samples; ++i ) {","\t\tfloat r = base + step * float( i );","\t\tvec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );","\t\ttex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );","\t}","\ttex /= float( samples ) + 1.0;","\treturn tex;","}","float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {","\tfloat dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;","\tif ( channel == 0 ) {","\t\tc.samp1 = getSample( c.p1 ).r;","\t\tc.samp2 = getSample( c.p2 ).r;","\t\tc.samp3 = getSample( c.p3 ).r;","\t\tc.samp4 = getSample( c.p4 ).r;","\t} else if (channel == 1) {","\t\tc.samp1 = getSample( c.p1 ).g;","\t\tc.samp2 = getSample( c.p2 ).g;","\t\tc.samp3 = getSample( c.p3 ).g;","\t\tc.samp4 = getSample( c.p4 ).g;","\t} else {","\t\tc.samp1 = getSample( c.p1 ).b;","\t\tc.samp3 = getSample( c.p3 ).b;","\t\tc.samp2 = getSample( c.p2 ).b;","\t\tc.samp4 = getSample( c.p4 ).b;","\t}","\tdist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );","\tdist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );","\tdist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );","\tdist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );","\tres = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;","\tres = clamp( res, 0.0, 1.0 );","\treturn res;","}","Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {","\tCell c;","\tvec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );","\tfloat threshold = step * 0.5;","\tfloat dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );","\tfloat dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );","\tvec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );","\tfloat offset_normal = mod( hypot( offset.x, offset.y ), step );","\tfloat normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;","\tfloat normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;","\tfloat offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );","\tfloat line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;","\tfloat line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;","\tc.normal = n;","\tc.p1.x = p.x - n.x * normal_scale + n.y * line_scale;","\tc.p1.y = p.y - n.y * normal_scale - n.x * line_scale;","\tif ( scatter != 0.0 ) {","\t\tfloat off_mag = scatter * threshold * 0.5;","\t\tfloat off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;","\t\tc.p1.x += cos( off_angle ) * off_mag;","\t\tc.p1.y += sin( off_angle ) * off_mag;","\t}","\tfloat normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );","\tfloat line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );","\tc.p2.x = c.p1.x - n.x * normal_step;","\tc.p2.y = c.p1.y - n.y * normal_step;","\tc.p3.x = c.p1.x + n.y * line_step;","\tc.p3.y = c.p1.y - n.x * line_step;","\tc.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;","\tc.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;","\treturn c;","}","float blendColour( float a, float b, float t ) {","\tif ( blendingMode == BLENDING_LINEAR ) {","\t\treturn blend( a, b, 1.0 - t );","\t} else if ( blendingMode == BLENDING_ADD ) {","\t\treturn blend( a, min( 1.0, a + b ), t );","\t} else if ( blendingMode == BLENDING_MULTIPLY ) {","\t\treturn blend( a, max( 0.0, a * b ), t );","\t} else if ( blendingMode == BLENDING_LIGHTER ) {","\t\treturn blend( a, max( a, b ), t );","\t} else if ( blendingMode == BLENDING_DARKER ) {","\t\treturn blend( a, min( a, b ), t );","\t} else {","\t\treturn blend( a, b, 1.0 - t );","\t}","}","void main() {","\tif ( ! disable ) {","\t\tvec2 p = vec2( vUV.x * width, vUV.y * height );","\t\tvec2 origin = vec2( 0, 0 );","\t\tfloat aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;","\t\tCell cell_r = getReferenceCell( p, origin, rotateR, radius );","\t\tCell cell_g = getReferenceCell( p, origin, rotateG, radius );","\t\tCell cell_b = getReferenceCell( p, origin, rotateB, radius );","\t\tfloat r = getDotColour( cell_r, p, 0, rotateR, aa );","\t\tfloat g = getDotColour( cell_g, p, 1, rotateG, aa );","\t\tfloat b = getDotColour( cell_b, p, 2, rotateB, aa );","\t\tvec4 colour = texture2D( tDiffuse, vUV );","\t\tr = blendColour( r, colour.r, blending );","\t\tg = blendColour( g, colour.g, blending );","\t\tb = blendColour( b, colour.b, blending );","\t\tif ( greyscale ) {","\t\t\tr = g = b = (r + b + g) / 3.0;","\t\t}","\t\tgl_FragColor = vec4( r, g, b, 1.0 );","\t} else {","\t\tgl_FragColor = texture2D( tDiffuse, vUV );","\t}","}"].join("\n")},sn=function(t,r,a){for(var i in void 0===on&&console.error("THREE.HalftonePass requires HalftoneShader"),this.uniforms=e.UniformsUtils.clone(on.uniforms),this.material=new e.ShaderMaterial({uniforms:this.uniforms,fragmentShader:on.fragmentShader,vertexShader:on.vertexShader}),this.uniforms.width.value=t,this.uniforms.height.value=r,a)a.hasOwnProperty(i)&&this.uniforms.hasOwnProperty(i)&&(this.uniforms[i].value=a[i]);this.fsQuad=new Xr(this.material)};sn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:sn,render:function(e,t,r){this.material.uniforms.tDiffuse.value=r.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))},setSize:function(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}});var ln={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new e.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","\tvUv = uv;","\tSMAAEdgeDetectionVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","\tvec4 delta;","\tvec3 C = texture2D( colorTex, texcoord ).rgb;","\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","\tvec3 t = abs( C - Cleft );","\tdelta.x = max( max( t.r, t.g ), t.b );","\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","\tt = abs( C - Ctop );","\tdelta.y = max( max( t.r, t.g ), t.b );","\tvec2 edges = step( threshold, delta.xy );","\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","\t\tdiscard;","\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","\tt = abs( C - Cright );","\tdelta.z = max( max( t.r, t.g ), t.b );","\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","\tt = abs( C - Cbottom );","\tdelta.w = max( max( t.r, t.g ), t.b );","\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","\tt = abs( C - Cleftleft );","\tdelta.z = max( max( t.r, t.g ), t.b );","\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","\tt = abs( C - Ctoptop );","\tdelta.w = max( max( t.r, t.g ), t.b );","\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );","\tedges.xy *= step( 0.5 * maxDelta, delta.xy );","\treturn vec4( edges, 0.0, 0.0 );","}","void main() {","\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},un={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new e.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","\tvPixcoord = texcoord / resolution;","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","\tvUv = uv;","\tSMAABlendingWeightCalculationVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","#if __VERSION__ == 100","vec2 round( vec2 x ) {","\treturn sign( x ) * floor( abs( x ) + 0.5 );","}","#endif","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","\te.r = bias + e.r * scale;","\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 0.0, 1.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;","\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","\t}","\ttexcoord.x += 0.25 * resolution.x;","\ttexcoord.x += resolution.x;","\ttexcoord.x += 2.0 * resolution.x;","\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","\treturn texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 0.0, 1.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;","\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","\t}","\ttexcoord.x -= 0.25 * resolution.x;","\ttexcoord.x -= resolution.x;","\ttexcoord.x -= 2.0 * resolution.x;","\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","\treturn texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 1.0, 0.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution;","\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","\t}","\ttexcoord.y -= 0.25 * resolution.y;","\ttexcoord.y -= resolution.y;","\ttexcoord.y -= 2.0 * resolution.y;","\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","\treturn texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 1.0, 0.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;","\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","\t}","\ttexcoord.y += 0.25 * resolution.y;","\ttexcoord.y += resolution.y;","\ttexcoord.y += 2.0 * resolution.y;","\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","\treturn texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","\treturn texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","\tvec2 e = texture2D( edgesTex, texcoord ).rg;","\tif ( e.g > 0.0 ) {","\t\tvec2 d;","\t\tvec2 coords;","\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","\t\tcoords.y = offset[ 1 ].y;","\t\td.x = coords.x;","\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;","\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","\t\td.y = coords.x;","\t\td = d / resolution.x - pixcoord.x;","\t\tvec2 sqrt_d = sqrt( abs( d ) );","\t\tcoords.y -= 1.0 * resolution.y;","\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","\t}","\tif ( e.r > 0.0 ) {","\t\tvec2 d;","\t\tvec2 coords;","\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","\t\tcoords.x = offset[ 0 ].x;","\t\td.x = coords.y;","\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;","\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","\t\td.y = coords.y;","\t\td = d / resolution.y - pixcoord.y;","\t\tvec2 sqrt_d = sqrt( abs( d ) );","\t\tcoords.y -= 1.0 * resolution.y;","\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","\t}","\treturn weights;","}","void main() {","\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},cn={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new e.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","\tvUv = uv;","\tSMAANeighborhoodBlendingVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","\tvec4 a;","\ta.xz = texture2D( blendTex, texcoord ).xz;","\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;","\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;","\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","\t\treturn texture2D( colorTex, texcoord, 0.0 );","\t} else {","\t\tvec2 offset;","\t\toffset.x = a.a > a.b ? a.a : -a.b;","\t\toffset.y = a.g > a.r ? -a.g : a.r;","\t\tif ( abs( offset.x ) > abs( offset.y )) {","\t\t\toffset.y = 0.0;","\t\t} else {","\t\t\toffset.x = 0.0;","\t\t}","\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );","\t\ttexcoord += sign( offset ) * resolution;","\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );","\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","\t\tC.xyz = pow(C.xyz, vec3(2.2));","\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));","\t\tvec4 mixed = mix(C, Cop, s);","\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","\t\treturn mixed;","\t}","}","void main() {","\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")},hn=function(t,r){this.edgesRT=new e.WebGLRenderTarget(t,r,{depthBuffer:!1,generateMipmaps:!1,minFilter:e.LinearFilter,format:e.RGBFormat}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new e.WebGLRenderTarget(t,r,{depthBuffer:!1,generateMipmaps:!1,minFilter:e.LinearFilter,format:e.RGBAFormat}),this.weightsRT.texture.name="SMAAPass.weights";var a=this,i=new Image;i.src=this.getAreaTexture(),i.onload=function(){a.areaTexture.needsUpdate=!0},this.areaTexture=new e.Texture,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=i,this.areaTexture.format=e.RGBFormat,this.areaTexture.minFilter=e.LinearFilter,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;var n=new Image;n.src=this.getSearchTexture(),n.onload=function(){a.searchTexture.needsUpdate=!0},this.searchTexture=new e.Texture,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=n,this.searchTexture.magFilter=e.NearestFilter,this.searchTexture.minFilter=e.NearestFilter,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,void 0===ln&&console.error("THREE.SMAAPass relies on SMAAShader"),this.uniformsEdges=e.UniformsUtils.clone(ln.uniforms),this.uniformsEdges.resolution.value.set(1/t,1/r),this.materialEdges=new e.ShaderMaterial({defines:Object.assign({},ln.defines),uniforms:this.uniformsEdges,vertexShader:ln.vertexShader,fragmentShader:ln.fragmentShader}),this.uniformsWeights=e.UniformsUtils.clone(un.uniforms),this.uniformsWeights.resolution.value.set(1/t,1/r),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new e.ShaderMaterial({defines:Object.assign({},un.defines),uniforms:this.uniformsWeights,vertexShader:un.vertexShader,fragmentShader:un.fragmentShader}),this.uniformsBlend=e.UniformsUtils.clone(cn.uniforms),this.uniformsBlend.resolution.value.set(1/t,1/r),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new e.ShaderMaterial({uniforms:this.uniformsBlend,vertexShader:cn.vertexShader,fragmentShader:cn.fragmentShader}),this.needsSwap=!1,this.fsQuad=new Xr(null)};hn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:hn,render:function(e,t,r){this.uniformsEdges.tDiffuse.value=r.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=r.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))},setSize:function(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var dn={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")},fn=function(t,r,a,i){void 0===dn&&console.error("THREE.FilmPass relies on FilmShader");var n=dn;this.uniforms=e.UniformsUtils.clone(n.uniforms),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),void 0!==i&&(this.uniforms.grayscale.value=i),void 0!==t&&(this.uniforms.nIntensity.value=t),void 0!==r&&(this.uniforms.sIntensity.value=r),void 0!==a&&(this.uniforms.sCount.value=a),this.fsQuad=new Xr(this.material)};fn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:fn,render:function(e,t,r,a){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=a,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}});var pn={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},mn=function(t,r,a,i){this.renderScene=r,this.renderCamera=a,this.selectedObjects=void 0!==i?i:[],this.visibleEdgeColor=new e.Color(1,1,1),this.hiddenEdgeColor=new e.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==t?new e.Vector2(t.x,t.y):new e.Vector2(256,256);var n={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat},o=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new e.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=e.DoubleSide,this.renderTargetMaskBuffer=new e.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new e.MeshDepthMaterial,this.depthMaterial.side=e.DoubleSide,this.depthMaterial.depthPacking=e.RGBADepthPacking,this.depthMaterial.blending=e.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=e.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(e,t){var r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new e.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new e.WebGLRenderTarget(o,s,n),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new e.WebGLRenderTarget(o,s,n),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new e.WebGLRenderTarget(Math.round(o/2),Math.round(s/2),n),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new e.WebGLRenderTarget(o,s,n),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new e.WebGLRenderTarget(Math.round(o/2),Math.round(s/2),n),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(o,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(o/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===pn&&console.error("THREE.OutlinePass relies on CopyShader");var l=pn;this.copyUniforms=e.UniformsUtils.clone(l.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:e.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new e.Color,this.oldClearAlpha=1,this.fsQuad=new Xr(null),this.tempPulseColor1=new e.Color,this.tempPulseColor2=new e.Color,this.textureMatrix=new e.Matrix4};mn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:mn,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var r=Math.round(e/this.downSampleRatio),a=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,a),this.renderTargetBlurBuffer1.setSize(r,a),this.renderTargetEdgeBuffer1.setSize(r,a),this.separableBlurMaterial1.uniforms.texSize.value.set(r,a),r=Math.round(r/2),a=Math.round(a/2),this.renderTargetBlurBuffer2.setSize(r,a),this.renderTargetEdgeBuffer2.setSize(r,a),this.separableBlurMaterial2.uniforms.texSize.value.set(r,a)},changeVisibilityOfSelectedObjects:function(e){var t=this._visibilityCache;function r(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(var a=0;a<this.selectedObjects.length;a++){this.selectedObjects[a].traverse(r)}},changeVisibilityOfNonSelectedObjects:function(e){var t=this._visibilityCache,r=[];function a(e){e.isMesh&&r.push(e)}for(var i=0;i<this.selectedObjects.length;i++){this.selectedObjects[i].traverse(a)}this.renderScene.traverse((function(a){if(a.isMesh||a.isSprite){for(var i=!1,n=0;n<r.length;n++){if(r[n].id===a.id){i=!0;break}}if(!1===i){var o=a.visible;!1!==e&&!0!==t.get(a)||(a.visible=e),t.set(a,o)}}else(a.isPoints||a.isLine)&&(!0===e?a.visible=t.get(a):(t.set(a,a.visible),a.visible=e))}))},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,r,a,i){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();var n=e.autoClear;e.autoClear=!1,i&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var o=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=o,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=mn.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=mn.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=mn.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=mn.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,i&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.setRenderTarget(null),this.fsQuad.render(e))},getPrepareMaskMaterial:function(){return new e.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new e.Vector2(.5,.5)},textureMatrix:{value:null}},vertexShader:["#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\t#include <skinbase_vertex>","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\tvPosition = mvPosition;","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new e.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new e.Vector2(.5,.5)},visibleEdgeColor:{value:new e.Vector3(1,1,1)},hiddenEdgeColor:{value:new e.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new e.ShaderMaterial({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new e.Vector2(.5,.5)},direction:{value:new e.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new e.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:e.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),mn.BlurDirectionX=new e.Vector2(1,0),mn.BlurDirectionY=new e.Vector2(0,1);var vn={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new e.Vector2},cameraProjectionMatrix:{value:new e.Matrix4},cameraInverseProjectionMatrix:{value:new e.Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},gn={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n")},yn={uniforms:{tDiffuse:{value:null},resolution:{value:new e.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")},xn=function(t,r,a,i){this.width=void 0!==a?a:512,this.height=void 0!==i?i:512,this.clear=!0,this.camera=r,this.scene=t,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=new Map,this.generateSampleKernel(),this.generateRandomKernelRotations();var n=new e.DepthTexture;n.type=e.UnsignedShortType,this.beautyRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.normalRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.NearestFilter,magFilter:e.NearestFilter,format:e.RGBAFormat,depthTexture:n}),this.ssaoRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.blurRenderTarget=this.ssaoRenderTarget.clone(),void 0===vn&&console.error("THREE.SSAOPass: The pass relies on SSAOShader."),this.ssaoMaterial=new e.ShaderMaterial({defines:Object.assign({},vn.defines),uniforms:e.UniformsUtils.clone(vn.uniforms),vertexShader:vn.vertexShader,fragmentShader:vn.fragmentShader,blending:e.NoBlending}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new e.MeshNormalMaterial,this.normalMaterial.blending=e.NoBlending,this.blurMaterial=new e.ShaderMaterial({defines:Object.assign({},yn.defines),uniforms:e.UniformsUtils.clone(yn.uniforms),vertexShader:yn.vertexShader,fragmentShader:yn.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new e.ShaderMaterial({defines:Object.assign({},gn.defines),uniforms:e.UniformsUtils.clone(gn.uniforms),vertexShader:gn.vertexShader,fragmentShader:gn.fragmentShader,blending:e.NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(pn.uniforms),vertexShader:pn.vertexShader,fragmentShader:pn.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:e.DstColorFactor,blendDst:e.ZeroFactor,blendEquation:e.AddEquation,blendSrcAlpha:e.DstAlphaFactor,blendDstAlpha:e.ZeroFactor,blendEquationAlpha:e.AddEquation}),this.fsQuad=new Xr(null),this.originalClearColor=new e.Color};xn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:xn,dispose:function(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()},render:function(t,r){switch(t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.overrideVisibility(),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(t,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.output){case xn.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case xn.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case xn.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case xn.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:r);break;case xn.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case xn.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=e.CustomBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}},renderPass:function(e,t,r,a,i){e.getClearColor(this.originalClearColor);var n=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},renderOverride:function(e,t,r,a,i){e.getClearColor(this.originalClearColor);var n=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,a=t.clearColor||a,i=t.clearAlpha||i,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},setSize:function(e,t){this.width=e,this.height=t,this.beautyRenderTarget.setSize(e,t),this.ssaoRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.blurRenderTarget.setSize(e,t),this.ssaoMaterial.uniforms.resolution.value.set(e,t),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(e,t)},generateSampleKernel:function(){for(var t=this.kernelSize,r=this.kernel,a=0;a<t;a++){var i=new e.Vector3;i.x=2*Math.random()-1,i.y=2*Math.random()-1,i.z=Math.random(),i.normalize();var n=a/t;n=e.MathUtils.lerp(.1,1,n*n),i.multiplyScalar(n),r.push(i)}},generateRandomKernelRotations:function(){void 0===La&&console.error("THREE.SSAOPass: The pass relies on SimplexNoise.");for(var t=new La,r=new Float32Array(64),a=0;a<16;a++){var i=4*a,n=2*Math.random()-1,o=2*Math.random()-1,s=t.noise3d(n,o,0);r[i]=s,r[i+1]=s,r[i+2]=s,r[i+3]=1}this.noiseTexture=new e.DataTexture(r,4,4,e.RGBAFormat,e.FloatType),this.noiseTexture.wrapS=e.RepeatWrapping,this.noiseTexture.wrapT=e.RepeatWrapping},overrideVisibility:function(){var e=this.scene,t=this._visibilityCache;e.traverse((function(e){t.set(e,e.visible),(e.isPoints||e.isLine)&&(e.visible=!1)}))},restoreVisibility:function(){var e=this.scene,t=this._visibilityCache;e.traverse((function(e){var r=t.get(e);e.visible=r})),t.clear()}}),xn.OUTPUT={Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5};var bn=function(t){void 0===pn&&console.error("THREE.SavePass relies on CopyShader");var r=pn;this.textureID="tDiffuse",this.uniforms=e.UniformsUtils.clone(r.uniforms),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.renderTarget=t,void 0===this.renderTarget&&(this.renderTarget=new e.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new Xr(this.material)};bn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:bn,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}});var An={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")},wn=function(t,r,a){this.scene=t,this.camera=r;var i=void 0!==a.focus?a.focus:1,n=void 0!==a.aspect?a.aspect:r.aspect,o=void 0!==a.aperture?a.aperture:.025,s=void 0!==a.maxblur?a.maxblur:1,l=a.width||window.innerWidth||1,u=a.height||window.innerHeight||1;this.renderTargetDepth=new e.WebGLRenderTarget(l,u,{minFilter:e.NearestFilter,magFilter:e.NearestFilter}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new e.MeshDepthMaterial,this.materialDepth.depthPacking=e.RGBADepthPacking,this.materialDepth.blending=e.NoBlending,void 0===An&&console.error("THREE.BokehPass relies on BokehShader");var c=An,h=e.UniformsUtils.clone(c.uniforms);h.tDepth.value=this.renderTargetDepth.texture,h.focus.value=i,h.aspect.value=n,h.aperture.value=o,h.maxblur.value=s,h.nearClip.value=r.near,h.farClip.value=r.far,this.materialBokeh=new e.ShaderMaterial({defines:Object.assign({},c.defines),uniforms:h,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),this.uniforms=h,this.needsSwap=!1,this.fsQuad=new Xr(this.materialBokeh),this._oldClearColor=new e.Color};wn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:wn,render:function(e,t,r){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);var a=e.getClearAlpha(),i=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(a),e.autoClear=i}});var Mn=function(t,r){void 0===pn&&console.error("THREE.TexturePass relies on CopyShader");var a=pn;this.map=t,this.opacity=void 0!==r?r:1,this.uniforms=e.UniformsUtils.clone(a.uniforms),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.fsQuad=new Xr(null)};Mn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Mn,render:function(e,t,r){var a=e.autoClear;e.autoClear=!1,this.fsQuad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(),this.fsQuad.render(e),e.autoClear=a}});var Sn={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},Tn={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")},Cn=function(t,r){this.resolution=void 0!==r?r:256,this.needsInit=!0,this.adaptive=void 0===t||!!t,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===pn&&console.error("THREE.AdaptiveToneMappingPass relies on CopyShader");var a=pn;this.copyUniforms=e.UniformsUtils.clone(a.uniforms),this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,blending:e.NoBlending,depthTest:!1}),void 0===Sn&&console.error("THREE.AdaptiveToneMappingPass relies on LuminosityShader"),this.materialLuminance=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(Sn.uniforms),vertexShader:Sn.vertexShader,fragmentShader:Sn.fragmentShader,blending:e.NoBlending}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","\tfloat fLastLum = max( minLuminance, lastLum.r );","\tfloat fCurrentLum = max( minLuminance, currentLum.r );","\tfCurrentLum *= fCurrentLum;","\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","\tgl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:e.NoBlending}),void 0===Tn&&console.error("THREE.AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(Tn.uniforms),vertexShader:Tn.vertexShader,fragmentShader:Tn.fragmentShader,blending:e.NoBlending}),this.fsQuad=new Xr(null)};Cn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Cn,render:function(e,t,r,a){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=r.texture.type,this.previousLuminanceRT.texture.type=r.texture.type,this.currentLuminanceRT.texture.type=r.texture.type,this.needsInit=!1),this.adaptive&&(this.fsQuad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=r.texture,e.setRenderTarget(this.currentLuminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=a,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.setRenderTarget(this.luminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.setRenderTarget(this.previousLuminanceRT),this.fsQuad.render(e)),this.fsQuad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=r.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))},reset:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var t={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat};this.luminanceRT=new e.WebGLRenderTarget(this.resolution,this.resolution,t),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new e.WebGLRenderTarget(this.resolution,this.resolution,t),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,t.minFilter=e.LinearMipmapLinearFilter,t.generateMipmaps=!0,this.currentLuminanceRT=new e.WebGLRenderTarget(this.resolution,this.resolution,t),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.fsQuad.material=new e.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))},setMinLuminance:function(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)},setMaxLuminance:function(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)},setAverageLuminance:function(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)},setMiddleGrey:function(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}});var Fn={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new e.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},En=function(t,r,a,i){this.strength=void 0!==r?r:1,this.radius=a,this.threshold=i,this.resolution=void 0!==t?new e.Vector2(t.x,t.y):new e.Vector2(256,256),this.clearColor=new e.Color(0,0,0);var n={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new e.WebGLRenderTarget(o,s,n),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var l=0;l<this.nMips;l++){var u=new e.WebGLRenderTarget(o,s,n);u.texture.name="UnrealBloomPass.h"+l,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u);var c=new e.WebGLRenderTarget(o,s,n);c.texture.name="UnrealBloomPass.v"+l,c.texture.generateMipmaps=!1,this.renderTargetsVertical.push(c),o=Math.round(o/2),s=Math.round(s/2)}void 0===Fn&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");var h=Fn;this.highPassUniforms=e.UniformsUtils.clone(h.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new e.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,defines:{}}),this.separableBlurMaterials=[];for(var d=[3,5,7,9,11],f=(o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2),0);f<this.nMips;f++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(d[f])),this.separableBlurMaterials[f].uniforms.texSize.value=new e.Vector2(o,s),o=Math.round(o/2),s=Math.round(s/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=r,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===pn&&console.error("THREE.UnrealBloomPass relies on CopyShader");var p=pn;this.copyUniforms=e.UniformsUtils.clone(p.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,blending:e.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new e.Color,this.oldClearAlpha=1,this.basic=new e.MeshBasicMaterial,this.fsQuad=new Xr(null)};En.prototype=Object.assign(Object.create(Wr.prototype),{constructor:En,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(var t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,r){var a=Math.round(t/2),i=Math.round(r/2);this.renderTargetBright.setSize(a,i);for(var n=0;n<this.nMips;n++)this.renderTargetsHorizontal[n].setSize(a,i),this.renderTargetsVertical[n].setSize(a,i),this.separableBlurMaterials[n].uniforms.texSize.value=new e.Vector2(a,i),a=Math.round(a/2),i=Math.round(i/2)},render:function(e,t,r,a,i){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();var n=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var o=this.renderTargetBright,s=0;s<this.nMips;s++)this.fsQuad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=o.texture,this.separableBlurMaterials[s].uniforms.direction.value=En.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[s]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=En.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[s]),e.clear(),this.fsQuad.render(e),o=this.renderTargetsVertical[s];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n},getSeperableBlurMaterial:function(t){return new e.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new e.Vector2(.5,.5)},direction:{value:new e.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(t){return new e.ShaderMaterial({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),En.BlurDirectionX=new e.Vector2(1,0),En.BlurDirectionY=new e.Vector2(0,1);var Bn=function(t,r,a){this.camera=t,this.needsSwap=!1,this.cubeShader=e.ShaderLib.cube,this.cubeMesh=new e.Mesh(new e.BoxGeometry(10,10,10),new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(this.cubeShader.uniforms),vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:e.BackSide})),Object.defineProperty(this.cubeMesh.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),this.envMap=r,this.opacity=void 0!==a?a:1,this.cubeScene=new e.Scene,this.cubeCamera=new e.PerspectiveCamera,this.cubeScene.add(this.cubeMesh)};Bn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Bn,render:function(e,t,r){var a=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.envMap.value=this.envMap,this.cubeMesh.material.uniforms.flipEnvMap.value=this.envMap.isCubeTexture&&this.envMap._needsFlipEnvMap?-1:1,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(),e.render(this.cubeScene,this.cubeCamera),e.autoClear=a}});var Ln={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new e.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new e.Matrix4},cameraInverseProjectionMatrix:{value:new e.Matrix4},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},Pn={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new e.Vector2(512,512)},sampleUvOffsets:{value:[new e.Vector2(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},Dn={createSampleWeights:function(e,t){for(var r=function(e,t){return Math.exp(-e*e/(t*t*2))/(Math.sqrt(2*Math.PI)*t)},a=[],i=0;i<=e;i++)a.push(r(i,t));return a},createSampleOffsets:function(e,t){for(var r=[],a=0;a<=e;a++)r.push(t.clone().multiplyScalar(a));return r},configure:function(e,t,r,a){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=Dn.createSampleOffsets(t,a),e.uniforms.sampleWeights.value=Dn.createSampleWeights(t,r),e.needsUpdate=!0}},Nn=function(t,r,a,i,n){(this.scene=t,this.camera=r,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==a&&a,this.supportsNormalTexture=void 0!==i&&i,this.originalClearColor=new e.Color,this._oldClearColor=new e.Color,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==n?new e.Vector2(n.x,n.y):new e.Vector2(256,256),this.saoRenderTarget=new e.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new e.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:e.NearestFilter,magFilter:e.NearestFilter,format:e.RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension)&&((a=new e.DepthTexture).type=e.UnsignedShortType,this.beautyRenderTarget.depthTexture=a,this.beautyRenderTarget.depthBuffer=!0);this.depthMaterial=new e.MeshDepthMaterial,this.depthMaterial.depthPacking=e.RGBADepthPacking,this.depthMaterial.blending=e.NoBlending,this.normalMaterial=new e.MeshNormalMaterial,this.normalMaterial.blending=e.NoBlending,void 0===Ln&&console.error("THREE.SAOPass relies on SAOShader"),this.saoMaterial=new e.ShaderMaterial({defines:Object.assign({},Ln.defines),fragmentShader:Ln.fragmentShader,vertexShader:Ln.vertexShader,uniforms:e.UniformsUtils.clone(Ln.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=e.NoBlending,void 0===Pn&&console.error("THREE.SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(Pn.uniforms),defines:Object.assign({},Pn.defines),vertexShader:Pn.vertexShader,fragmentShader:Pn.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=e.NoBlending,this.hBlurMaterial=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(Pn.uniforms),defines:Object.assign({},Pn.defines),vertexShader:Pn.vertexShader,fragmentShader:Pn.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?a:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=e.NoBlending,void 0===pn&&console.error("THREE.SAOPass relies on CopyShader"),this.materialCopy=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(pn.uniforms),vertexShader:pn.vertexShader,fragmentShader:pn.fragmentShader,blending:e.NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=e.CustomBlending,this.materialCopy.blendSrc=e.DstColorFactor,this.materialCopy.blendDst=e.ZeroFactor,this.materialCopy.blendEquation=e.AddEquation,this.materialCopy.blendSrcAlpha=e.DstAlphaFactor,this.materialCopy.blendDstAlpha=e.ZeroFactor,this.materialCopy.blendEquationAlpha=e.AddEquation,void 0===ni&&console.error("THREE.SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(ni.uniforms),vertexShader:ni.vertexShader,fragmentShader:ni.fragmentShader,blending:e.NoBlending}),this.fsQuad=new Xr(null)};Nn.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},Nn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Nn,render:function(t,r,a){if(this.renderToScreen&&(this.materialCopy.blending=e.NoBlending,this.materialCopy.uniforms.tDiffuse.value=a.texture,this.materialCopy.needsUpdate=!0,this.renderPass(t,this.materialCopy,null)),1!==this.params.output){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();var i=t.autoClear;t.autoClear=!1,t.setRenderTarget(this.depthRenderTarget),t.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var n=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=n,this.hBlurMaterial.uniforms.depthCutoff.value=n,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(Dn.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new e.Vector2(0,1)),Dn.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new e.Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),t.setClearColor(0),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(t,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var o=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,o=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?o.blending=e.CustomBlending:o.blending=e.NoBlending,this.renderPass(t,o,this.renderToScreen?null:a),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=i}},renderPass:function(e,t,r,a,i){e.getClearColor(this.originalClearColor);var n=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},renderOverride:function(e,t,r,a,i){e.getClearColor(this.originalClearColor);var n=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,a=t.clearColor||a,i=t.clearAlpha||i,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},setSize:function(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}});var Rn={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")},_n=function(t){function r(r,a){var i;void 0===r&&(r=.96),void 0===a&&(a=Rn),i=t.call(this)||this,b.default(x.default(i),"shader",void 0),b.default(x.default(i),"uniforms",void 0),b.default(x.default(i),"textureComp",void 0),b.default(x.default(i),"textureOld",void 0),b.default(x.default(i),"shaderMaterial",void 0),b.default(x.default(i),"compFsQuad",void 0),b.default(x.default(i),"copyFsQuad",void 0),i.shader=a,i.uniforms=e.UniformsUtils.clone(a.uniforms),i.uniforms.damp.value=r,i.textureComp=new e.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:e.LinearFilter,magFilter:e.NearestFilter,format:e.RGBAFormat}),i.textureOld=new e.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:e.LinearFilter,magFilter:e.NearestFilter,format:e.RGBAFormat}),i.shaderMaterial=new e.ShaderMaterial({uniforms:i.uniforms,vertexShader:i.shader.vertexShader,fragmentShader:i.shader.fragmentShader}),i.compFsQuad=new Xr(i.shaderMaterial);var n=new e.MeshBasicMaterial;return i.copyFsQuad=new Xr(n),i}g.default(r,t);var a=r.prototype;return a.render=function(e,t,r){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=r.texture,e.setRenderTarget(this.textureComp),this.compFsQuad.render(e),this.copyFsQuad.material.map=this.textureComp.texture,this.renderToScreen?(e.setRenderTarget(null),this.copyFsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.copyFsQuad.render(e));var a=this.textureOld;this.textureOld=this.textureComp,this.textureComp=a},a.setSize=function(e,t){this.textureComp.setSize(e,t),this.textureOld.setSize(e,t)},r}(Wr),In=function(e){function t(t,r){var a;return a=e.call(this)||this,b.default(x.default(a),"scene",void 0),b.default(x.default(a),"camera",void 0),b.default(x.default(a),"inverse",void 0),a.scene=t,a.camera=r,a.clear=!0,a.needsSwap=!1,a.inverse=!1,a}return g.default(t,e),t.prototype.render=function(e,t,r){var a,i,n=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(a=0,i=1):(a=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),o.buffers.stencil.setFunc(n.ALWAYS,a,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(n.EQUAL,1,4294967295),o.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP),o.buffers.stencil.setLocked(!0)},t}(Wr),On=function(e){function t(){var t;return(t=e.call(this)||this).needsSwap=!1,t}return g.default(t,e),t.prototype.render=function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)},t}(Wr),Un=function(){function t(t,r){if(b.default(this,"renderer",void 0),b.default(this,"_pixelRatio",void 0),b.default(this,"_width",void 0),b.default(this,"_height",void 0),b.default(this,"renderTarget1",void 0),b.default(this,"renderTarget2",void 0),b.default(this,"writeBuffer",void 0),b.default(this,"readBuffer",void 0),b.default(this,"renderToScreen",void 0),b.default(this,"passes",[]),b.default(this,"copyPass",void 0),b.default(this,"clock",void 0),this.renderer=t,void 0===r){var a={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat},i=t.getSize(new e.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=i.width,this._height=i.height,(r=new e.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,a)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=r.width,this._height=r.height;this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,void 0===pn&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===Qr&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Qr(pn),this.clock=new e.Clock}var r=t.prototype;return r.swapBuffers=function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},r.addPass=function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},r.insertPass=function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},r.removePass=function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)},r.isLastEnabledPass=function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},r.render=function(e){void 0===e&&(e=this.clock.getDelta());for(var t=this.renderer.getRenderTarget(),r=!1,a=this.passes.length,i=0;i<a;i++){var n=this.passes[i];if(!1!==n.enabled){if(n.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),n.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),n.needsSwap){if(r){var o=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==In&&(n instanceof In?r=!0:n instanceof On&&(r=!1))}}this.renderer.setRenderTarget(t)},r.reset=function(t){if(void 0===t){var r=this.renderer.getSize(new e.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=r.width,this._height=r.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},r.setSize=function(e,t){this._width=e,this._height=t;var r=this._width*this._pixelRatio,a=this._height*this._pixelRatio;this.renderTarget1.setSize(r,a),this.renderTarget2.setSize(r,a);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(r,a)},r.setPixelRatio=function(e){this._pixelRatio=e,this.setSize(this._width,this._height)},t}(),kn={uniforms:{tDiffuse:{value:null},tSize:{value:new e.Vector2(256,256)},center:{value:new e.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")},Vn=function(t,r,a){void 0===kn&&console.error("THREE.DotScreenPass relies on DotScreenShader");var i=kn;this.uniforms=e.UniformsUtils.clone(i.uniforms),void 0!==t&&this.uniforms.center.value.copy(t),void 0!==r&&(this.uniforms.angle.value=r),void 0!==a&&(this.uniforms.scale.value=a),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),this.fsQuad=new Xr(this.material)};Vn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Vn,render:function(e,t,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.tSize.value.set(r.width,r.height),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}});var Gn={defines:{MAX_STEP:0,isPerspectiveCamera:!0,isDistanceAttenuation:!0,isFresnel:!0,isInfiniteThick:!1,isSelective:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new e.Vector2},cameraProjectionMatrix:{value:new e.Matrix4},cameraInverseProjectionMatrix:{value:new e.Matrix4},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},surfDist:{value:.007},thickTolerance:{value:.03}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n\n  ",fragmentShader:"\n\t\t// precision highp float;\n\t\tprecision highp sampler2D;\n\t\tvarying vec2 vUv;\n\t\tuniform sampler2D tDepth;\n\t\tuniform sampler2D tNormal;\n\t\tuniform sampler2D tMetalness;\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float cameraRange;\n\t\tuniform vec2 resolution;\n\t\tuniform float opacity;\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float maxDistance;\n\t\tuniform float surfDist;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\t\tuniform float thickTolerance;\n\t\t#include <packing>\n\t\tfloat pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {\n\t\t\t//x0: point, x1: linePointA, x2: linePointB\n\t\t\t//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html\n\t\t\treturn length(cross(x0-x1,x0-x2))/length(x2-x1);\n\t\t}\n\t\tfloat pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){\n\t\t\t// https://mathworld.wolfram.com/Point-PlaneDistance.html\n\t\t\t//// https://en.wikipedia.org/wiki/Plane_(geometry)\n\t\t\t//// http://paulbourke.net/geometry/pointlineplane/\n\t\t\tfloat a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;\n\t\t\tfloat x0=point.x,y0=point.y,z0=point.z;\n\t\t\tfloat x=planePoint.x,y=planePoint.y,z=planePoint.z;\n\t\t\tfloat d=-(a*x+b*y+c*z);\n\t\t\tfloat distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);\n\t\t\treturn distance;\n\t\t}\n\t\tfloat getDepth( const in vec2 uv ) {\n\t\t\treturn texture2D( tDepth, uv ).x;\n\t\t}\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#ifdef isPerspectiveCamera\n\t\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\t\tvec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {\n\t\t\tvec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc\n\t\t\tclipPosition *= clipW; //clip\n\t\t\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view\n\t\t}\n\t\tvec3 getViewNormal( const in vec2 uv ) {\n\t\t\treturn unpackRGBToNormal( texture2D( tNormal, uv ).xyz );\n\t\t}\n\t\tvec2 viewPositionToXY(vec3 viewPosition){\n\t\t\tvec2 xy;\n\t\t\tvec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);\n\t\t\txy=clip.xy;//clip\n\t\t\tfloat clipW=clip.w;\n\t\t\txy/=clipW;//NDC\n\t\t\txy=(xy+1.)/2.;//uv\n\t\t\txy*=resolution;//screen\n\t\t\treturn xy;\n\t\t}\n\t\tvoid main(){\n\t\t\t#ifdef isSelective\n\t\t\t\tfloat metalness=texture2D(tMetalness,vUv).r;\n\t\t\t\tif(metalness==0.) return;\n\t\t\t#endif\n\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tfloat viewZ = getViewZ( depth );\n\t\t\tif(-viewZ>=cameraFar) return;\n\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];\n\t\t\tvec3 viewPosition=getViewPosition( vUv, depth, clipW );\n\n\t\t\tvec2 d0=gl_FragCoord.xy;\n\t\t\tvec2 d1;\n\n\t\t\tvec3 viewNormal=getViewNormal( vUv );\n\n\t\t\t#ifdef isPerspectiveCamera\n\t\t\t\tvec3 viewIncidenceDir=normalize(viewPosition);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);\n\t\t\t#else\n\t\t\t\tvec3 viewIncidenceDir=vec3(0,0,-1);\n\t\t\t\tvec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);\n\t\t\t#endif\n\n\t\t\tfloat maxReflectRayLen=maxDistance/dot(-viewIncidenceDir,viewNormal);\n\t\t\t// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html\n\t\t\t// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen=cos(theta)\n\t\t\t// maxDistance/maxReflectRayLen==dot(a,b)\n\t\t\t// maxReflectRayLen==maxDistance/dot(a,b)\n\n\t\t\tvec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;\n\t\t\t#ifdef isPerspectiveCamera\n\t\t\t\tif(d1viewPosition.z>-cameraNear){\n\t\t\t\t\t//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx\n\t\t\t\t\tfloat t=(-cameraNear-viewPosition.z)/viewReflectDir.z;\n\t\t\t\t\td1viewPosition=viewPosition+viewReflectDir*t;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\td1=viewPositionToXY(d1viewPosition);\n\n\t\t\tfloat totalLen=length(d1-d0);\n\t\t\tfloat xLen=d1.x-d0.x;\n\t\t\tfloat yLen=d1.y-d0.y;\n\t\t\tfloat totalStep=max(abs(xLen),abs(yLen));\n\t\t\tfloat xSpan=xLen/totalStep;\n\t\t\tfloat ySpan=yLen/totalStep;\n\t\t\tfor(float i=0.;i<MAX_STEP;i++){\n\t\t\t\tif(i>=totalStep) break;\n\t\t\t\tvec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);\n\t\t\t\tif(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;\n\t\t\t\tfloat s=length(xy-d0)/totalLen;\n\t\t\t\tvec2 uv=xy/resolution;\n\n\t\t\t\tfloat d = getDepth(uv);\n\t\t\t\tfloat vZ = getViewZ( d );\n\t\t\t\tif(-vZ>=cameraFar) continue;\n\t\t\t\tfloat cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];\n\t\t\t\tvec3 vP=getViewPosition( uv, d, cW );\n\n\t\t\t\t#ifdef isPerspectiveCamera\n\t\t\t\t\t// https://www.comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf\n\t\t\t\t\tfloat recipVPZ=1./viewPosition.z;\n\t\t\t\t\tfloat viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));\n\t\t\t\t\tfloat sD=surfDist*cW;\n\t\t\t\t#else\n\t\t\t\t\tfloat viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);\n\t\t\t\t\tfloat sD=surfDist;\n\t\t\t\t#endif\n\t\t\t\tif(viewReflectRayZ-sD>vZ) continue;\n\n\t\t\t\t#ifdef isInfiniteThick\n\t\t\t\t\tif(viewReflectRayZ+thickTolerance*clipW<vP.z) break;\n\t\t\t\t#endif\n\t\t\t\tfloat away=pointToLineDistance(vP,viewPosition,d1viewPosition);\n\n\t\t\t\tfloat op=opacity;\n\n\t\t\t\tif(away<sD){\n\t\t\t\t\tvec3 vN=getViewNormal( uv );\n\t\t\t\t\tif(dot(viewReflectDir,vN)>=0.) continue;\n\t\t\t\t\tfloat distance=pointPlaneDistance(vP,viewPosition,viewNormal);\n\t\t\t\t\tif(distance>maxDistance) break;\n\t\t\t\t\t#ifdef isDistanceAttenuation\n\t\t\t\t\t\tfloat ratio=1.-(distance/maxDistance);\n\t\t\t\t\t\tfloat attenuation=ratio*ratio;\n\t\t\t\t\t\top=opacity*attenuation;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef isFresnel\n\t\t\t\t\t\tfloat fresnel=(dot(viewIncidenceDir,viewReflectDir)+1.)/2.;\n\t\t\t\t\t\top*=fresnel;\n\t\t\t\t\t#endif\n\t\t\t\t\tvec4 reflectColor=texture2D(tDiffuse,uv);\n\t\t\t\t\tgl_FragColor.xyz=reflectColor.xyz;\n\t\t\t\t\tgl_FragColor.a=op;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t"},jn={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvUv = uv;\n    \tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n\n  ",fragmentShader:"\n\n    uniform sampler2D tDepth;\n\n    uniform float cameraNear;\n    uniform float cameraFar;\n\n    varying vec2 vUv;\n\n    #include <packing>\n\n\t\tfloat getLinearDepth( const in vec2 uv ) {\n\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\n\t\t\t\tfloat fragCoordZ = texture2D( tDepth, uv ).x;\n\t\t\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n\t\t\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t#else\n\n\t\t\t\treturn texture2D( tDepth, uv ).x;\n\n\t\t\t#endif\n\n\t\t}\n\n    void main() {\n\n    \tfloat depth = getLinearDepth( vUv );\n\t\t\tfloat d = 1.0 - depth;\n\t\t\t// d=(d-.999)*1000.;\n    \tgl_FragColor = vec4( vec3( d ), 1.0 );\n\n    }\n\n  "},zn={uniforms:{tDiffuse:{value:null},resolution:{value:new e.Vector2},opacity:{value:.5}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvUv = uv;\n    \tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n\n  ",fragmentShader:"\n\n    uniform sampler2D tDiffuse;\n    uniform vec2 resolution;\n    varying vec2 vUv;\n    void main() {\n\t\t\t//reverse engineering from PhotoShop blur filter, then change coefficient\n\n    \tvec2 texelSize = ( 1.0 / resolution );\n\n\t\t\tvec4 c=texture2D(tDiffuse,vUv);\n\n\t\t\tvec2 offset;\n\n\t\t\toffset=(vec2(-1,0))*texelSize;\n\t\t\tvec4 cl=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(1,0))*texelSize;\n\t\t\tvec4 cr=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,-1))*texelSize;\n\t\t\tvec4 cb=texture2D(tDiffuse,vUv+offset);\n\n\t\t\toffset=(vec2(0,1))*texelSize;\n\t\t\tvec4 ct=texture2D(tDiffuse,vUv+offset);\n\n\t\t\t// float coeCenter=.5;\n\t\t\t// float coeSide=.125;\n\t\t\tfloat coeCenter=.2;\n\t\t\tfloat coeSide=.2;\n\t\t\tfloat a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;\n\t\t\tvec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;\n\t\t\tgl_FragColor=vec4(rgb,a);\n\n\t\t}\n\t"},Hn=function(t){var r=t.renderer,a=t.scene,i=t.camera,n=t.width,o=t.height,s=t.selects,l=t.encoding,u=t.isPerspectiveCamera,c=void 0===u||u,h=t.isBouncing,d=void 0!==h&&h,f=t.morphTargets,p=void 0!==f&&f,m=t.groundReflector;this.width=void 0!==n?n:512,this.height=void 0!==o?o:512,this.clear=!0,this.renderer=r,this.scene=a,this.camera=i,this.groundReflector=m,this.opacity=Gn.uniforms.opacity.value,this.output=0,this.maxDistance=Gn.uniforms.maxDistance.value,this.surfDist=Gn.uniforms.surfDist.value,this.encoding=l,this.tempColor=new e.Color,this._selects=s,this.isSelective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get:function(){return this._selects},set:function(e){this._selects!==e&&(this._selects=e,Array.isArray(e)?(this.isSelective=!0,this.ssrMaterial.defines.isSelective=!0,this.ssrMaterial.needsUpdate=!0):(this.isSelective=!1,this.ssrMaterial.defines.isSelective=!1,this.ssrMaterial.needsUpdate=!0))}}),this._isBouncing=d,Object.defineProperty(this,"isBouncing",{get:function(){return this._isBouncing},set:function(e){this._isBouncing!==e&&(this._isBouncing=e,this.ssrMaterial.uniforms.tDiffuse.value=e?this.prevRenderTarget.texture:this.beautyRenderTarget.texture)}}),this.isBlur=!0,this._isDistanceAttenuation=Gn.defines.isDistanceAttenuation,Object.defineProperty(this,"isDistanceAttenuation",{get:function(){return this._isDistanceAttenuation},set:function(e){this._isDistanceAttenuation!==e&&(this._isDistanceAttenuation=e,this.ssrMaterial.defines.isDistanceAttenuation=e,this.ssrMaterial.needsUpdate=!0)}}),this._isFresnel=Gn.defines.isFresnel,Object.defineProperty(this,"isFresnel",{get:function(){return this._isFresnel},set:function(e){this._isFresnel!==e&&(this._isFresnel=e,this.ssrMaterial.defines.isFresnel=e,this.ssrMaterial.needsUpdate=!0)}}),this._isInfiniteThick=Gn.defines.isInfiniteThick,Object.defineProperty(this,"isInfiniteThick",{get:function(){return this._isInfiniteThick},set:function(e){this._isInfiniteThick!==e&&(this._isInfiniteThick=e,this.ssrMaterial.defines.isInfiniteThick=e,this.ssrMaterial.needsUpdate=!0)}}),this.thickTolerance=Gn.uniforms.thickTolerance.value;var v=new e.DepthTexture;v.type=e.UnsignedShortType,v.minFilter=e.NearestFilter,v.maxFilter=e.NearestFilter,this.beautyRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat,depthTexture:v,depthBuffer:!0}),this.prevRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.normalRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.NearestFilter,magFilter:e.NearestFilter,format:e.RGBAFormat,type:e.HalfFloatType}),this.metalnessRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.NearestFilter,magFilter:e.NearestFilter,format:e.RGBAFormat}),this.ssrRenderTarget=new e.WebGLRenderTarget(this.width,this.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),void 0===Gn&&console.error("THREE.SSRPass: The pass relies on SSRShader."),this.ssrMaterial=new e.ShaderMaterial({defines:Object.assign({MAX_STEP:Math.sqrt(window.innerWidth*window.innerWidth+window.innerHeight*window.innerHeight)},Gn.defines),uniforms:e.UniformsUtils.clone(Gn.uniforms),vertexShader:Gn.vertexShader,fragmentShader:Gn.fragmentShader,blending:e.NoBlending}),c||(this.ssrMaterial.defines.isPerspectiveCamera=c,this.ssrMaterial.needsUpdate=!0),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.isSelective=this.isSelective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.surfDist.value=this.surfDist,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new e.MeshNormalMaterial({morphTargets:p}),this.normalMaterial.blending=e.NoBlending,this.metalnessOnMaterial=new e.MeshBasicMaterial({color:"white"}),this.metalnessOffMaterial=new e.MeshBasicMaterial({color:"black"}),this.blurMaterial=new e.ShaderMaterial({defines:Object.assign({},zn.defines),uniforms:e.UniformsUtils.clone(zn.uniforms),vertexShader:zn.vertexShader,fragmentShader:zn.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new e.ShaderMaterial({defines:Object.assign({},zn.defines),uniforms:e.UniformsUtils.clone(zn.uniforms),vertexShader:zn.vertexShader,fragmentShader:zn.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new e.ShaderMaterial({defines:Object.assign({},jn.defines),uniforms:e.UniformsUtils.clone(jn.uniforms),vertexShader:jn.vertexShader,fragmentShader:jn.fragmentShader,blending:e.NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(pn.uniforms),vertexShader:pn.vertexShader,fragmentShader:pn.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:e.SrcAlphaFactor,blendDst:e.OneMinusSrcAlphaFactor,blendEquation:e.AddEquation,blendSrcAlpha:e.SrcAlphaFactor,blendDstAlpha:e.OneMinusSrcAlphaFactor,blendEquationAlpha:e.AddEquation}),this.fsQuad=new Xr(null),this.originalClearColor=new e.Color};Hn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Hn,dispose:function(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()},render:function(t,r){switch(this.encoding&&(this.beautyRenderTarget.texture.encoding=this.encoding),t.setRenderTarget(this.beautyRenderTarget),t.clear(),this.groundReflector&&(this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),t.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,0,0),this.isSelective&&this.renderMetalness(t,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.surfDist.value=this.surfDist,this.ssrMaterial.uniforms.thickTolerance.value=this.thickTolerance,this.renderPass(t,this.ssrMaterial,this.ssrRenderTarget),this.isBlur&&(this.renderPass(t,this.blurMaterial,this.blurRenderTarget),this.renderPass(t,this.blurMaterial2,this.blurRenderTarget2)),this.output){case Hn.OUTPUT.Default:this.isBouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.isBlur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=e.NormalBlending,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r),this.isBlur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=e.NormalBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r));break;case Hn.OUTPUT.SSR:this.isBlur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r),this.isBouncing&&(this.isBlur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=e.NormalBlending,this.renderPass(t,this.copyMaterial,this.prevRenderTarget));break;case Hn.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case Hn.OUTPUT.Depth:this.renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:r);break;case Hn.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case Hn.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=e.NoBlending,this.renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;default:console.warn("THREE.SSRPass: Unknown output type.")}},renderPass:function(e,t,r,a,i){this.originalClearColor.copy(e.getClearColor(this.tempColor));var n=e.getClearAlpha(this.tempColor),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},renderOverride:function(e,t,r,a,i){this.originalClearColor.copy(e.getClearColor(this.tempColor));var n=e.getClearAlpha(this.tempColor),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,a=t.clearColor||a,i=t.clearAlpha||i,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(n)},renderMetalness:function(e,t,r,a,i){var n=this;this.originalClearColor.copy(e.getClearColor(this.tempColor));var o=e.getClearAlpha(this.tempColor),s=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,a=t.clearColor||a,i=t.clearAlpha||i,null!=a&&(e.setClearColor(a),e.setClearAlpha(i||0),e.clear()),this.scene.traverseVisible((function(e){e._SSRPassMaterialBack=e.material,n._selects.includes(e)?e.material=n.metalnessOnMaterial:e.material=n.metalnessOffMaterial})),e.render(this.scene,this.camera),this.scene.traverseVisible((function(e){e.material=e._SSRPassMaterialBack})),e.autoClear=s,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)},setSize:function(e,t){this.width=e,this.height=t,this.ssrMaterial.defines.MAX_STEP=Math.sqrt(e*e+t*t),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(e,t),this.prevRenderTarget.setSize(e,t),this.ssrRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.metalnessRenderTarget.setSize(e,t),this.blurRenderTarget.setSize(e,t),this.blurRenderTarget2.setSize(e,t),this.ssrMaterial.uniforms.resolution.value.set(e,t),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(e,t),this.blurMaterial2.uniforms.resolution.value.set(e,t)}}),Hn.OUTPUT={Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7};var Wn=function(t,r,a,i){this.scene=t,this.camera=r,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==a?a:0,this.clearAlpha=void 0!==i?i:0,this._oldClearColor=new e.Color,void 0===pn&&console.error("THREE.SSAARenderPass relies on CopyShader");var n=pn;this.copyUniforms=e.UniformsUtils.clone(n.uniforms),this.copyMaterial=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:e.AdditiveBlending,depthTest:!1,depthWrite:!1}),this.fsQuad=new Xr(this.copyMaterial)};Wn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Wn,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)},render:function(t,r,a){this.sampleRenderTarget||(this.sampleRenderTarget=new e.WebGLRenderTarget(a.width,a.height,{minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var i=Wn.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],n=t.autoClear;t.autoClear=!1,t.getClearColor(this._oldClearColor);var o=t.getClearAlpha(),s=1/i.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var l=a.width,u=a.height,c=0;c<i.length;c++){var h=i[c];this.camera.setViewOffset&&this.camera.setViewOffset(l,u,.0625*h[0],.0625*h[1],l,u);var d=s;if(this.unbiased)d+=.03125*((c+.5)/i.length-.5);this.copyUniforms.opacity.value=d,t.setClearColor(this.clearColor,this.clearAlpha),t.setRenderTarget(this.sampleRenderTarget),t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(this.renderToScreen?null:r),0===c&&(t.setClearColor(0,0),t.clear()),this.fsQuad.render(t)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),t.autoClear=n,t.setClearColor(this._oldClearColor,o)}});var Xn=function(e,t,r,a){void 0===Wn&&console.error("THREE.TAARenderPass relies on SSAARenderPass"),Wn.call(this,e,t,r,a),this.sampleLevel=0,this.accumulate=!1};Xn.JitterVectors=Wn.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],Xn.prototype=Object.assign(Object.create(Wn.prototype),{constructor:Xn,render:function(t,r,a,i){if(!this.accumulate)return Wn.prototype.render.call(this,t,r,a,i),void(this.accumulateIndex=-1);var n=Xn.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new e.WebGLRenderTarget(a.width,a.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new e.WebGLRenderTarget(a.width,a.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(Wn.prototype.render.call(this,t,this.holdRenderTarget,a,i),this.accumulateIndex=0);var o=t.autoClear;t.autoClear=!1;var s=1/n.length;if(this.accumulateIndex>=0&&this.accumulateIndex<n.length){this.copyUniforms.opacity.value=s,this.copyUniforms.tDiffuse.value=r.texture;for(var l=Math.pow(2,this.sampleLevel),u=0;u<l;u++){var c=n[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(a.width,a.height,.0625*c[0],.0625*c[1],a.width,a.height),t.setRenderTarget(r),t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&t.clear(),this.fsQuad.render(t),this.accumulateIndex++,this.accumulateIndex>=n.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var h=this.accumulateIndex*s;h>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,t.setRenderTarget(r),t.clear(),this.fsQuad.render(t)),h<1&&(this.copyUniforms.opacity.value=1-h,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,t.setRenderTarget(r),0===h&&t.clear(),this.fsQuad.render(t)),t.autoClear=o}});var Qn=function(t){function r(r,a,i,n,o){var s;return void 0===o&&(o=0),s=t.call(this)||this,b.default(x.default(s),"scene",void 0),b.default(x.default(s),"camera",void 0),b.default(x.default(s),"overrideMaterial",void 0),b.default(x.default(s),"clearColor",void 0),b.default(x.default(s),"clearAlpha",void 0),b.default(x.default(s),"clearDepth",!1),b.default(x.default(s),"_oldClearColor",new e.Color),s.scene=r,s.camera=a,s.overrideMaterial=i,s.clearColor=n,s.clearAlpha=o,s.clear=!0,s.needsSwap=!1,s}return g.default(r,t),r.prototype.render=function(e,t,r){var a,i=e.autoClear;e.autoClear=!1;var n=null;void 0!==this.overrideMaterial&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,a),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=n),e.autoClear=i},r}(Wr),Yn={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new e.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){function t(e,t){return Math.exp(-e*e/(2*t*t))}var r,a,i,n,o=2*Math.ceil(3*e)+1;for(o>25&&(o=25),n=.5*(o-1),a=new Array(o),i=0,r=0;r<o;++r)a[r]=t(r-n,e),i+=a[r];for(r=0;r<o;++r)a[r]/=i;return a}},Jn=function t(r,a,i,n){r=void 0!==r?r:1,a=void 0!==a?a:25,i=void 0!==i?i:4,n=void 0!==n?n:256;var o={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBAFormat};this.renderTargetX=new e.WebGLRenderTarget(n,n,o),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new e.WebGLRenderTarget(n,n,o),this.renderTargetY.texture.name="BloomPass.y",void 0===pn&&console.error("THREE.BloomPass relies on CopyShader");var s=pn;this.copyUniforms=e.UniformsUtils.clone(s.uniforms),this.copyUniforms.opacity.value=r,this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,blending:e.AdditiveBlending,transparent:!0}),void 0===Yn&&console.error("THREE.BloomPass relies on ConvolutionShader");var l=Yn;this.convolutionUniforms=e.UniformsUtils.clone(l.uniforms),this.convolutionUniforms.uImageIncrement.value=t.blurX,this.convolutionUniforms.cKernel.value=Yn.buildKernel(i),this.materialConvolution=new e.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{KERNEL_SIZE_FLOAT:a.toFixed(1),KERNEL_SIZE_INT:a.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new Xr(null)};Jn.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Jn,render:function(e,t,r,a,i){i&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=Jn.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Jn.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,i&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.clear&&e.clear(),this.fsQuad.render(e)}}),Jn.blurX=new e.Vector2(.001953125,0),Jn.blurY=new e.Vector2(0,.001953125);var Kn=function(){function t(t,r,a,i,n){if(this.controller=r,this.handModel=t,this.envMap=null,this.handMesh=new e.Group,this.handModel.add(this.handMesh),window.XRHand){var o;n&&n.primitive&&"sphere"!==n.primitive?"box"===n.primitive&&(o=new e.BoxGeometry(1,1,1)):o=new e.SphereGeometry(1,10,10);for(var s=new e.MeshStandardMaterial({color:16777215,roughness:1,metalness:0}),l=new e.MeshStandardMaterial({color:10066329,roughness:1,metalness:0}),u=0,c=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];u<c.length;u++){var h=c[u],d=new e.Mesh(o,-1!==h.indexOf("tip")?l:s);d.castShadow=!0,d.receiveShadow=!0,d.jointName=h,this.handMesh.add(d)}}}return t.prototype.updateMesh=function(){for(var e=this.handMesh.children,t=this.controller.joints,r=0;r<e.length;r++){var a=e[r],i=t[a.jointName];i.visible&&(a.position.copy(i.position),a.quaternion.copy(i.quaternion),a.scale.setScalar(i.jointRadius||.008)),a.visible=i.visible}},t}();function qn(t,r,a,i){for(var n=this.findSpan(t,i,r),o=this.calcBasisFunctions(n,i,t,r),s=new e.Vector4(0,0,0,0),l=0;l<=t;++l){var u=a[n-t+l],c=o[l],h=u.w*c;s.x+=u.x*h,s.y+=u.y*h,s.z+=u.z*h,s.w+=u.w*c}return s}function Zn(e,t,r,a,i){var n=this.calcBSplineDerivatives(e,t,r,a,i);return this.calcRationalCurveDerivatives(n)}function $n(t,r,a,i,n,o,s,l){for(var u=this.findSpan(t,o,a),c=this.findSpan(r,s,i),h=this.calcBasisFunctions(u,o,t,a),d=this.calcBasisFunctions(c,s,r,i),f=[],p=0;p<=r;++p){f[p]=new e.Vector4(0,0,0,0);for(var m=0;m<=t;++m){var v=n[u-t+m][c-r+p].clone(),g=v.w;v.x*=g,v.y*=g,v.z*=g,f[p].add(v.multiplyScalar(h[m]))}}for(var y=new e.Vector4(0,0,0,0),x=0;x<=r;++x)y.add(f[x].multiplyScalar(d[x]));y.divideScalar(y.w),l.set(y.x,y.y,y.z)}var eo=function(t){function r(r,a,i,n,o){var s;(s=t.call(this)||this).degree=r,s.knots=a,s.controlPoints=[],s.startKnot=n||0,s.endKnot=o||s.knots.length-1;for(var l=0;l<i.length;++l){var u=i[l];s.controlPoints[l]=new e.Vector4(u.x,u.y,u.z,u.w)}return s}g.default(r,t);var a=r.prototype;return a.getPoint=function(t,r){var a=r||new e.Vector3,i=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),n=qn(this.degree,this.knots,this.controlPoints,i);return 1!=n.w&&n.divideScalar(n.w),a.set(n.x,n.y,n.z)},a.getTangent=function(t,r){var a=r||new e.Vector3,i=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),n=Zn(this.degree,this.knots,this.controlPoints,i,1);return a.copy(n[1]).normalize(),a},r}(e.Curve),to=function(){var t,r,a;function i(t){e.Loader.call(this,t)}function n(e,t){this.textureLoader=e,this.manager=t}function o(){}function s(){}function u(){}function c(){}function h(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function d(){}function f(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function p(e){return e/46186158e3}i.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:i,load:function(t,r,a,i){var n=this,o=""===n.path?e.LoaderUtils.extractUrlBase(t):n.path,s=new e.FileLoader(this.manager);s.setPath(n.path),s.setResponseType("arraybuffer"),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(r,a){if(s="Kaydara FBX Binary  \0",(o=r).byteLength>=s.length&&s===w(o,0,s.length))t=(new c).parse(r);else{var i=w(r);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function a(t){var a=e[t-1];return e=e.slice(r+t),r++,a}for(var i=0;i<t.length;++i){if(a(1)===t[i])return!1}return!0}(i))throw new Error("THREE.FBXLoader: Unknown format.");if(f(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+f(i));t=(new u).parse(i)}var o,s;return new n(new e.TextureLoader(this.manager).setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin),this.manager).parse(t)}}),n.prototype={constructor:n,parse:function(){r=this.parseConnections();var e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),n=this.parseDeformers(),s=(new o).parse(n);return this.parseScene(n,s,i),a},parseConnections:function(){var e=new Map;"Connections"in t&&t.Connections.connections.forEach((function(t){var r=t[0],a=t[1],i=t[2];e.has(r)||e.set(r,{parents:[],children:[]});var n={ID:a,relationship:i};e.get(r).parents.push(n),e.has(a)||e.set(a,{parents:[],children:[]});var o={ID:r,relationship:i};e.get(a).children.push(o)}));return e},parseImages:function(){var e={},r={};if("Video"in t.Objects){var a=t.Objects.Video;for(var i in a){var n=a[i];if(e[parseInt(i)]=n.RelativeFilename||n.Filename,"Content"in n){var o=n.Content instanceof ArrayBuffer&&n.Content.byteLength>0,s="string"==typeof n.Content&&""!==n.Content;if(o||s){var l=this.parseImage(a[i]);r[n.RelativeFilename||n.Filename]=l}}}}for(var u in e){var c=e[u];void 0!==r[c]?e[u]=r[c]:e[u]=e[u].split("\\").pop()}return e},parseImage:function(e){var t,r=e.Content,a=e.RelativeFilename||e.Filename,i=a.slice(a.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",a),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var n=new Uint8Array(r);return window.URL.createObjectURL(new Blob([n],{type:t}))},parseTextures:function(e){var r=new Map;if("Texture"in t.Objects){var a=t.Objects.Texture;for(var i in a){var n=this.parseTexture(a[i],e);r.set(parseInt(i),n)}}return r},parseTexture:function(t,r){var a=this.loadTexture(t,r);a.ID=t.id,a.name=t.attrName;var i=t.WrapModeU,n=t.WrapModeV,o=void 0!==i?i.value:0,s=void 0!==n?n.value:0;if(a.wrapS=0===o?e.RepeatWrapping:e.ClampToEdgeWrapping,a.wrapT=0===s?e.RepeatWrapping:e.ClampToEdgeWrapping,"Scaling"in t){var l=t.Scaling.value;a.repeat.x=l[0],a.repeat.y=l[1]}return a},loadTexture:function(t,a){var i,n,o=this.textureLoader.path,s=r.get(t.id).children;void 0!==s&&s.length>0&&void 0!==a[s[0].ID]&&(0!==(i=a[s[0].ID]).indexOf("blob:")&&0!==i.indexOf("data:")||this.textureLoader.setPath(void 0));var l=t.FileName.slice(-3).toLowerCase();if("tga"===l){var u=this.manager.getHandler(".tga");null===u?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),n=new e.Texture):n=u.load(i)}else"psd"===l?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),n=new e.Texture):n=this.textureLoader.load(i);return this.textureLoader.setPath(o),n},parseMaterials:function(e){var r=new Map;if("Material"in t.Objects){var a=t.Objects.Material;for(var i in a){var n=this.parseMaterial(a[i],e);null!==n&&r.set(parseInt(i),n)}}return r},parseMaterial:function(t,a){var i=t.id,n=t.attrName,o=t.ShadingModel;if("object"==typeof o&&(o=o.value),!r.has(i))return null;var s,l=this.parseParameters(t,a,i);switch(o.toLowerCase()){case"phong":s=new e.MeshPhongMaterial;break;case"lambert":s=new e.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),s=new e.MeshPhongMaterial}return s.setValues(l),s.name=n,s},parseParameters:function(t,a,i){var n={};t.BumpFactor&&(n.bumpScale=t.BumpFactor.value),t.Diffuse?n.color=(new e.Color).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(n.color=(new e.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(n.displacementScale=t.DisplacementFactor.value),t.Emissive?n.emissive=(new e.Color).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(n.emissive=(new e.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(n.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(n.opacity=parseFloat(t.Opacity.value)),n.opacity<1&&(n.transparent=!0),t.ReflectionFactor&&(n.reflectivity=t.ReflectionFactor.value),t.Shininess&&(n.shininess=t.Shininess.value),t.Specular?n.specular=(new e.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(n.specular=(new e.Color).fromArray(t.SpecularColor.value));var o=this;return r.get(i).children.forEach((function(t){var r=t.relationship;switch(r){case"Bump":n.bumpMap=o.getTexture(a,t.ID);break;case"Maya|TEX_ao_map":n.aoMap=o.getTexture(a,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=o.getTexture(a,t.ID),n.map.encoding=e.sRGBEncoding;break;case"DisplacementColor":n.displacementMap=o.getTexture(a,t.ID);break;case"EmissiveColor":n.emissiveMap=o.getTexture(a,t.ID),n.emissiveMap.encoding=e.sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=o.getTexture(a,t.ID);break;case"ReflectionColor":n.envMap=o.getTexture(a,t.ID),n.envMap.mapping=e.EquirectangularReflectionMapping,n.envMap.encoding=e.sRGBEncoding;break;case"SpecularColor":n.specularMap=o.getTexture(a,t.ID),n.specularMap.encoding=e.sRGBEncoding;break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=o.getTexture(a,t.ID),n.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}})),n},getTexture:function(e,a){return"LayeredTexture"in t.Objects&&a in t.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),a=r.get(a).children[0].ID),e.get(a)},parseDeformers:function(){var e={},a={};if("Deformer"in t.Objects){var i=t.Objects.Deformer;for(var n in i){var o=i[n],s=r.get(parseInt(n));if("Skin"===o.attrType){var l=this.parseSkeleton(s,i);l.ID=n,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,e[n]=l}else if("BlendShape"===o.attrType){var u={id:n};u.rawTargets=this.parseMorphTargets(s,i),u.id=n,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),a[n]=u}}}return{skeletons:e,morphTargets:a}},parseSkeleton:function(t,r){var a=[];return t.children.forEach((function(t){var i=r[t.ID];if("Cluster"===i.attrType){var n={ID:t.ID,indices:[],weights:[],transformLink:(new e.Matrix4).fromArray(i.TransformLink.a)};"Indexes"in i&&(n.indices=i.Indexes.a,n.weights=i.Weights.a),a.push(n)}})),{rawBones:a,bones:[]}},parseMorphTargets:function(e,t){for(var a=[],i=0;i<e.children.length;i++){var n=e.children[i],o=t[n.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=r.get(parseInt(n.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,a.push(s)}return a},parseScene:function(i,n,o){a=new e.Group;var l=this.parseModels(i.skeletons,n,o),u=t.Objects.Model,c=this;l.forEach((function(e){var t=u[e.ID];c.setLookAtProperties(e,t),r.get(e.ID).parents.forEach((function(t){var r=l.get(t.ID);void 0!==r&&r.add(e)})),null===e.parent&&a.add(e)})),this.bindSkeleton(i.skeletons,n,l),this.createAmbientLight(),this.setupMorphMaterials(),a.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);var t=x(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));var h=(new s).parse();1===a.children.length&&a.children[0].isGroup&&(a.children[0].animations=h,a=a.children[0]),a.animations=h},parseModels:function(a,i,n){var o=new Map,s=t.Objects.Model;for(var l in s){var u=parseInt(l),c=s[l],h=r.get(u),d=this.buildSkeleton(h,a,u,c.attrName);if(!d){switch(c.attrType){case"Camera":d=this.createCamera(h);break;case"Light":d=this.createLight(h);break;case"Mesh":d=this.createMesh(h,i,n);break;case"NurbsCurve":d=this.createCurve(h,i);break;case"LimbNode":case"Root":d=new e.Bone;break;case"Null":default:d=new e.Group}d.name=c.attrName?e.PropertyBinding.sanitizeNodeName(c.attrName):"",d.ID=u}this.getTransformData(d,c),o.set(u,d)}return o},buildSkeleton:function(t,r,a,i){var n=null;return t.parents.forEach((function(t){for(var o in r){var s=r[o];s.rawBones.forEach((function(r,o){if(r.ID===t.ID){var l=n;(n=new e.Bone).matrixWorld.copy(r.transformLink),n.name=i?e.PropertyBinding.sanitizeNodeName(i):"",n.ID=a,s.bones[o]=n,null!==l&&n.add(l)}}))}})),n},createCamera:function(r){var a,i;if(r.children.forEach((function(e){var r=t.Objects.NodeAttribute[e.ID];void 0!==r&&(i=r)})),void 0===i)a=new e.Object3D;else{var n=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(n=1);var o=1;void 0!==i.NearPlane&&(o=i.NearPlane.value/1e3);var s=1e3;void 0!==i.FarPlane&&(s=i.FarPlane.value/1e3);var l=window.innerWidth,u=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(l=i.AspectWidth.value,u=i.AspectHeight.value);var c=l/u,h=45;void 0!==i.FieldOfView&&(h=i.FieldOfView.value);var d=i.FocalLength?i.FocalLength.value:null;switch(n){case 0:a=new e.PerspectiveCamera(h,c,o,s),null!==d&&a.setFocalLength(d);break;case 1:a=new e.OrthographicCamera(-l/2,l/2,u/2,-u/2,o,s);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),a=new e.Object3D}}return a},createLight:function(r){var a,i;if(r.children.forEach((function(e){var r=t.Objects.NodeAttribute[e.ID];void 0!==r&&(i=r)})),void 0===i)a=new e.Object3D;else{var n;n=void 0===i.LightType?0:i.LightType.value;var o=16777215;void 0!==i.Color&&(o=(new e.Color).fromArray(i.Color.value));var s=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(s=0);var l=0;void 0!==i.FarAttenuationEnd&&(l=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);switch(n){case 0:a=new e.PointLight(o,s,l,1);break;case 1:a=new e.DirectionalLight(o,s);break;case 2:var u=Math.PI/3;void 0!==i.InnerAngle&&(u=e.MathUtils.degToRad(i.InnerAngle.value));var c=0;void 0!==i.OuterAngle&&(c=e.MathUtils.degToRad(i.OuterAngle.value),c=Math.max(c,1)),a=new e.SpotLight(o,s,l,u,c,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),a=new e.PointLight(o,s)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(a.castShadow=!0)}return a},createMesh:function(t,r,a){var i,n=null,o=null,s=[];return t.children.forEach((function(e){r.has(e.ID)&&(n=r.get(e.ID)),a.has(e.ID)&&s.push(a.get(e.ID))})),s.length>1?o=s:s.length>0?o=s[0]:(o=new e.MeshPhongMaterial({color:13421772}),s.push(o)),"color"in n.attributes&&s.forEach((function(e){e.vertexColors=!0})),n.FBX_Deformer?(s.forEach((function(e){e.skinning=!0})),(i=new e.SkinnedMesh(n,o)).normalizeSkinWeights()):i=new e.Mesh(n,o),i},createCurve:function(t,r){var a=t.children.reduce((function(e,t){return r.has(t.ID)&&(e=r.get(t.ID)),e}),null),i=new e.LineBasicMaterial({color:3342591,linewidth:1});return new e.Line(a,i)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?b(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(i,n){"LookAtProperty"in n&&r.get(i.ID).children.forEach((function(r){if("LookAtProperty"===r.relationship){var n=t.Objects.Model[r.ID];if("Lcl_Translation"in n){var o=n.Lcl_Translation.value;void 0!==i.target?(i.target.position.fromArray(o),a.add(i.target)):i.lookAt((new e.Vector3).fromArray(o))}}}))},bindSkeleton:function(t,a,i){var n=this.parsePoseNodes();for(var o in t){var s=t[o];r.get(parseInt(s.ID)).parents.forEach((function(t){if(a.has(t.ID)){var o=t.ID;r.get(o).parents.forEach((function(t){i.has(t.ID)&&i.get(t.ID).bind(new e.Skeleton(s.bones),n[t.ID])}))}}))}},parsePoseNodes:function(){var r={};if("Pose"in t.Objects){var a=t.Objects.Pose;for(var i in a)if("BindPose"===a[i].attrType){var n=a[i].PoseNode;Array.isArray(n)?n.forEach((function(t){r[t.Node]=(new e.Matrix4).fromArray(t.Matrix.a)})):r[n.Node]=(new e.Matrix4).fromArray(n.Matrix.a)}}return r},createAmbientLight:function(){if("GlobalSettings"in t&&"AmbientColor"in t.GlobalSettings){var r=t.GlobalSettings.AmbientColor.value,i=r[0],n=r[1],o=r[2];if(0!==i||0!==n||0!==o){var s=new e.Color(i,n,o);a.add(new e.AmbientLight(s,1))}}},setupMorphMaterials:function(){var e=this;a.traverse((function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach((function(r,a){e.setupMorphMaterial(t,r,a)})):e.setupMorphMaterial(t,t.material))}))},setupMorphMaterial:function(e,t,r){var i=e.uuid,n=t.uuid,o=!1;if(a.traverse((function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach((function(t){t.uuid===n&&e.uuid!==i&&(o=!0)})):e.material.uuid===n&&e.uuid!==i&&(o=!0))})),!0===o){var s=t.clone();s.morphTargets=!0,void 0===r?e.material=s:e.material[r]=s}else t.morphTargets=!0}},o.prototype={constructor:o,parse:function(e){var a=new Map;if("Geometry"in t.Objects){var i=t.Objects.Geometry;for(var n in i){var o=r.get(parseInt(n)),s=this.parseGeometry(o,i[n],e);a.set(parseInt(n),s)}}return a},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(e,r,a){var i=a.skeletons,n=[],o=e.parents.map((function(e){return t.Objects.Model[e.ID]}));if(0!==o.length){var s=e.children.reduce((function(e,t){return void 0!==i[t.ID]&&(e=i[t.ID]),e}),null);e.children.forEach((function(e){void 0!==a.morphTargets[e.ID]&&n.push(a.morphTargets[e.ID])}));var l=o[0],u={};"RotationOrder"in l&&(u.eulerOrder=b(l.RotationOrder.value)),"InheritType"in l&&(u.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(u.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(u.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(u.scale=l.GeometricScaling.value);var c=x(u);return this.genGeometry(r,s,n,c)}},genGeometry:function(t,r,a,i){var n=new e.BufferGeometry;t.attrName&&(n.name=t.attrName);var o=this.parseGeoNode(t,r),s=this.genBuffers(o),l=new e.Float32BufferAttribute(s.vertex,3);if(l.applyMatrix4(i),n.setAttribute("position",l),s.colors.length>0&&n.setAttribute("color",new e.Float32BufferAttribute(s.colors,3)),r&&(n.setAttribute("skinIndex",new e.Uint16BufferAttribute(s.weightsIndices,4)),n.setAttribute("skinWeight",new e.Float32BufferAttribute(s.vertexWeights,4)),n.FBX_Deformer=r),s.normal.length>0){var u=(new e.Matrix3).getNormalMatrix(i),c=new e.Float32BufferAttribute(s.normal,3);c.applyNormalMatrix(u),n.setAttribute("normal",c)}if(s.uvs.forEach((function(t,r){var a="uv"+(r+1).toString();0===r&&(a="uv"),n.setAttribute(a,new e.Float32BufferAttribute(s.uvs[r],2))})),o.material&&"AllSame"!==o.material.mappingType){var h=s.materialIndex[0],d=0;if(s.materialIndex.forEach((function(e,t){e!==h&&(n.addGroup(d,t-d,h),h=e,d=t)})),n.groups.length>0){var f=n.groups[n.groups.length-1],p=f.start+f.count;p!==s.materialIndex.length&&n.addGroup(p,s.materialIndex.length-p,h)}0===n.groups.length&&n.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(n,t,a,i),n},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var a=0;e.LayerElementUV[a];)e.LayerElementUV[a].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[a])),a++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(a,i){void 0===r.weightTable[a]&&(r.weightTable[a]=[]),r.weightTable[a].push({id:t,weight:e.weights[i]})}))}))),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,a=0,i=!1,n=[],o=[],s=[],l=[],u=[],c=[],h=this;return e.vertexIndices.forEach((function(d,f){var p=!1;d<0&&(d^=-1,p=!0);var m=[],g=[];if(n.push(3*d,3*d+1,3*d+2),e.color){var y=v(f,r,d,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach((function(e){g.push(e.weight),m.push(e.id)})),g.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var x=[0,0,0,0],b=[0,0,0,0];g.forEach((function(e,t){var r=e,a=m[t];b.forEach((function(e,t,i){if(r>e){i[t]=r,r=e;var n=x[t];x[t]=a,a=n}}))})),m=x,g=b}for(;g.length<4;)g.push(0),m.push(0);for(var A=0;A<4;++A)u.push(g[A]),c.push(m[A])}if(e.normal){y=v(f,r,d,e.normal);o.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var w=v(f,r,d,e.material)[0];e.uv&&e.uv.forEach((function(e,t){var a=v(f,r,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(a[0]),l[t].push(a[1])})),a++,p&&(h.genFace(t,e,n,w,o,s,l,u,c,a),r++,a=0,n=[],o=[],s=[],l=[],u=[],c=[])})),t},genFace:function(e,t,r,a,i,n,o,s,l,u){for(var c=function(u){e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(u-1)]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[r[3*u]]),e.vertex.push(t.vertexPositions[r[3*u+1]]),e.vertex.push(t.vertexPositions[r[3*u+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(u-1)]),e.vertexWeights.push(s[4*(u-1)+1]),e.vertexWeights.push(s[4*(u-1)+2]),e.vertexWeights.push(s[4*(u-1)+3]),e.vertexWeights.push(s[4*u]),e.vertexWeights.push(s[4*u+1]),e.vertexWeights.push(s[4*u+2]),e.vertexWeights.push(s[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(u-1)]),e.weightsIndices.push(l[4*(u-1)+1]),e.weightsIndices.push(l[4*(u-1)+2]),e.weightsIndices.push(l[4*(u-1)+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(n[0]),e.colors.push(n[1]),e.colors.push(n[2]),e.colors.push(n[3*(u-1)]),e.colors.push(n[3*(u-1)+1]),e.colors.push(n[3*(u-1)+2]),e.colors.push(n[3*u]),e.colors.push(n[3*u+1]),e.colors.push(n[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(a),e.materialIndex.push(a),e.materialIndex.push(a)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(u-1)]),e.normal.push(i[3*(u-1)+1]),e.normal.push(i[3*(u-1)+2]),e.normal.push(i[3*u]),e.normal.push(i[3*u+1]),e.normal.push(i[3*u+2])),t.uv&&t.uv.forEach((function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][2*(u-1)]),e.uvs[r].push(o[r][2*(u-1)+1]),e.uvs[r].push(o[r][2*u]),e.uvs[r].push(o[r][2*u+1])}))},h=2;h<u;h++)c(h)},addMorphTargets:function(e,r,a,i){if(0!==a.length){e.morphTargetsRelative=!0,e.morphAttributes.position=[];var n=this;a.forEach((function(a){a.rawTargets.forEach((function(a){var o=t.Objects.Geometry[a.geoID];void 0!==o&&n.genMorphGeometry(e,r,o,i,a.name)}))}))}},genMorphGeometry:function(t,r,a,i,n){for(var o=void 0!==r.PolygonVertexIndex?r.PolygonVertexIndex.a:[],s=void 0!==a.Vertices?a.Vertices.a:[],l=void 0!==a.Indexes?a.Indexes.a:[],u=3*t.attributes.position.count,c=new Float32Array(u),h=0;h<l.length;h++){var d=3*l[h];c[d]=s[3*h],c[d+1]=s[3*h+1],c[d+2]=s[3*h+2]}var f={vertexIndices:o,vertexPositions:c},p=this.genBuffers(f),m=new e.Float32BufferAttribute(p.vertex,3);m.name=n||a.attrName,m.applyMatrix4(i),t.morphAttributes.position.push(m)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:a,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:a,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:a,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var a=e.Materials.a,i=[],n=0;n<a.length;++n)i.push(n);return{dataSize:1,buffer:a,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(t){if(void 0===eo)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new e.BufferGeometry;var r=parseInt(t.Order);if(isNaN(r))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new e.BufferGeometry;for(var a,i,n=r-1,o=t.KnotVector.a,s=[],l=t.Points.a,u=0,c=l.length;u<c;u+=4)s.push((new e.Vector4).fromArray(l,u));if("Closed"===t.Form)s.push(s[0]);else if("Periodic"===t.Form){a=n,i=o.length-1-a;for(var h=0;h<n;++h)s.push(s[h])}var d=new eo(n,o,s,a,i).getPoints(7*s.length),f=new Float32Array(3*d.length);d.forEach((function(e,t){e.toArray(f,3*t)}));var p=new e.BufferGeometry;return p.setAttribute("position",new e.BufferAttribute(f,3)),p}},s.prototype={constructor:s,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var a=t[r],i=this.addClip(a);e.push(i)}return e},parseClips:function(){if(void 0!==t.Objects.AnimationCurve){var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var r=this.parseAnimationLayers(e);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var e=t.Objects.AnimationCurveNode,r=new Map;for(var a in e){var i=e[a];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){var n={id:i.id,attr:i.attrName,curves:{}};r.set(n.id,n)}}return r},parseAnimationCurves:function(e){var a=t.Objects.AnimationCurve;for(var i in a){var n={id:a[i].id,times:a[i].KeyTime.a.map(p),values:a[i].KeyValueFloat.a},o=r.get(n.id);if(void 0!==o){var s=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?e.get(s).curves.x=n:l.match(/Y/)?e.get(s).curves.y=n:l.match(/Z/)?e.get(s).curves.z=n:l.match(/d|DeformPercent/)&&e.has(s)&&(e.get(s).curves.morph=n)}}},parseAnimationLayers:function(i){var n=t.Objects.AnimationLayer,o=new Map;for(var s in n){var l=[],u=r.get(parseInt(s));if(void 0!==u)u.children.forEach((function(n,o){if(i.has(n.ID)){var s=i.get(n.ID);if(void 0!==s.curves.x||void 0!==s.curves.y||void 0!==s.curves.z){if(void 0===l[o])if(void 0!==(p=r.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID)){if(void 0===(c=t.Objects.Model[p.toString()]))return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);var u={modelName:c.attrName?e.PropertyBinding.sanitizeNodeName(c.attrName):"",ID:c.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};a.traverse((function(e){e.ID===c.id&&(u.transform=e.matrix,e.userData.transformData&&(u.eulerOrder=e.userData.transformData.eulerOrder))})),u.transform||(u.transform=new e.Matrix4),"PreRotation"in c&&(u.preRotation=c.PreRotation.value),"PostRotation"in c&&(u.postRotation=c.PostRotation.value),l[o]=u}l[o]&&(l[o][s.attr]=s)}else if(void 0!==s.curves.morph){if(void 0===l[o]){var c,h=r.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,d=r.get(h).parents[0].ID,f=r.get(d).parents[0].ID,p=r.get(f).parents[0].ID;u={modelName:(c=t.Objects.Model[p]).attrName?e.PropertyBinding.sanitizeNodeName(c.attrName):"",morphName:t.Objects.Deformer[h].attrName};l[o]=u}l[o][s.attr]=s}}})),o.set(parseInt(s),l)}return o},parseAnimStacks:function(e){var a=t.Objects.AnimationStack,i={};for(var n in a){var o=r.get(parseInt(n)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=e.get(o[0].ID);i[n]={name:a[n].attrName,layer:s}}return i},addClip:function(t){var r=[],a=this;return t.layer.forEach((function(e){r=r.concat(a.generateTracks(e))})),new e.AnimationClip(t.name,-1,r)},generateTracks:function(t){var r=[],a=new e.Vector3,i=new e.Quaternion,n=new e.Vector3;if(t.transform&&t.transform.decompose(a,i,n),a=a.toArray(),i=(new e.Euler).setFromQuaternion(i,t.eulerOrder).toArray(),n=n.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){var o=this.generateVectorTrack(t.modelName,t.T.curves,a,"position");void 0!==o&&r.push(o)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){var s=this.generateRotationTrack(t.modelName,t.R.curves,i,t.preRotation,t.postRotation,t.eulerOrder);void 0!==s&&r.push(s)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){var l=this.generateVectorTrack(t.modelName,t.S.curves,n,"scale");void 0!==l&&r.push(l)}if(void 0!==t.DeformPercent){var u=this.generateMorphTrack(t);void 0!==u&&r.push(u)}return r},generateVectorTrack:function(t,r,a,i){var n=this.getTimesForAllAxes(r),o=this.getKeyframeTrackValues(n,r,a);return new e.VectorKeyframeTrack(t+"."+i,n,o)},generateRotationTrack:function(t,r,a,i,n,o){void 0!==r.x&&(this.interpolateRotations(r.x),r.x.values=r.x.values.map(e.MathUtils.degToRad)),void 0!==r.y&&(this.interpolateRotations(r.y),r.y.values=r.y.values.map(e.MathUtils.degToRad)),void 0!==r.z&&(this.interpolateRotations(r.z),r.z.values=r.z.values.map(e.MathUtils.degToRad));var s=this.getTimesForAllAxes(r),l=this.getKeyframeTrackValues(s,r,a);void 0!==i&&((i=i.map(e.MathUtils.degToRad)).push(o),i=(new e.Euler).fromArray(i),i=(new e.Quaternion).setFromEuler(i)),void 0!==n&&((n=n.map(e.MathUtils.degToRad)).push(o),n=(new e.Euler).fromArray(n),n=(new e.Quaternion).setFromEuler(n).invert());for(var u=new e.Quaternion,c=new e.Euler,h=[],d=0;d<l.length;d+=3)c.set(l[d],l[d+1],l[d+2],o),u.setFromEuler(c),void 0!==i&&u.premultiply(i),void 0!==n&&u.multiply(n),u.toArray(h,d/3*4);return new e.QuaternionKeyframeTrack(t+".quaternion",s,h)},generateMorphTrack:function(t){var r=t.DeformPercent.curves.morph,i=r.values.map((function(e){return e/100})),n=a.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new e.NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+n+"]",r.times,i)},getTimesForAllAxes:function(e){var t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),(t=t.sort((function(e,t){return e-t}))).length>1){for(var r=1,a=t[0],i=1;i<t.length;i++){var n=t[i];n!==a&&(t[r]=n,a=n,r++)}t=t.slice(0,r)}return t},getKeyframeTrackValues:function(e,t,r){var a=r,i=[],n=-1,o=-1,s=-1;return e.forEach((function(e){if(t.x&&(n=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==n){var r=t.x.values[n];i.push(r),a[0]=r}else i.push(a[0]);if(-1!==o){var l=t.y.values[o];i.push(l),a[1]=l}else i.push(a[1]);if(-1!==s){var u=t.z.values[s];i.push(u),a[2]=u}else i.push(a[2])})),i},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],a=e.values[t]-r,i=Math.abs(a);if(i>=180){for(var n=i/180,o=a/n,s=r+o,l=e.times[t-1],u=(e.times[t]-l)/n,c=l+u,h=[],d=[];c<e.times[t];)h.push(c),c+=u,d.push(s),s+=o;e.times=M(e.times,t,h),e.values=M(e.values,t,d)}}}},u.prototype={constructor:u,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new d,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach((function(e,a){var i=e.match(/^[\s\t]*;/),n=e.match(/^[\s\t]*$/);if(!i&&!n){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++a]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),a=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:r},n=this.parseNodeAttr(a),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in o?("PoseNode"===r?o.PoseNode.push(i):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==n.id&&(o[r][n.id]=i)):"number"==typeof n.id?(o[r]={},o[r][n.id]=i):"Properties70"!==r&&(o[r]="PoseNode"===r?[i]:i),"number"==typeof n.id&&(i.id=n.id),""!==n.name&&(i.attrName=n.name),""!==n.type&&(i.attrType=n.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",a="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),a=e[2]),{id:t,name:r,type:a}},parseNodeProperty:function(e,t,r){var a=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===a&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var n=this.getCurrentNode();if("Properties70"!==n.name){if("C"===a){var o=i.split(",").slice(1),s=parseInt(o[0]),l=parseInt(o[1]),u=i.split(",").slice(3);a="connections",function(e,t){for(var r=0,a=e.length,i=t.length;r<i;r++,a++)e[a]=t[r]}(i=[s,l],u=u.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===n[a]&&(n[a]=[])}"Node"===a&&(n.id=i),a in n&&Array.isArray(n[a])?n[a].push(i):"a"!==a?n[a]=i:n.a=i,this.setCurrentProp(n,a),"a"===a&&","!==i.slice(-1)&&(n.a=A(i))}else this.parseNodeSpecialProperty(e,a,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=A(t.a))},parseNodeSpecialProperty:function(e,t,r){var a=r.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=a[0],n=a[1],o=a[2],s=a[3],l=a[4];switch(n){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=A(l)}this.getPrevNode()[i]={type:n,type2:o,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}},c.prototype={constructor:c,parse:function(e){var t=new h(e);t.skip(23);var r=t.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);for(var a=new d;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&a.add(i.name,i)}return a},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},a=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();var n=e.getUint8(),o=e.getString(n);if(0===a)return null;for(var s=[],l=0;l<i;l++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",h=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===a;a>e.getOffset();){var d=this.parseNode(e,t);null!==d&&this.parseSubNode(o,r,d)}return r.propertyList=s,"number"==typeof u&&(r.id=u),""!==c&&(r.attrName=c),""!==h&&(r.attrType=h),""!==o&&(r.name=o),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var a=r.propertyList[0];Array.isArray(a)?(t[r.name]=r,r.a=a):t[r.name]=a}else if("Connections"===e&&"C"===r.name){var i=[];r.propertyList.forEach((function(e,t){0!==t&&i.push(e)})),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===r.name){Object.keys(r).forEach((function(e){t[e]=r[e]}))}else if("Properties70"===e&&"P"===r.name){var n,o=r.propertyList[0],s=r.propertyList[1],l=r.propertyList[2],u=r.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),n="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[o]={type:s,type2:l,flag:u,value:n}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var a=e.getUint32(),i=e.getUint32(),n=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(a);case"d":return e.getFloat64Array(a);case"f":return e.getFloat32Array(a);case"i":return e.getInt32Array(a);case"l":return e.getInt64Array(a)}var o=new h(l.unzlibSync(new Uint8Array(e.getArrayBuffer(n))).buffer);switch(t){case"b":case"c":return o.getBooleanArray(a);case"d":return o.getFloat64Array(a);case"f":return o.getFloat32Array(a);case"i":return o.getInt32Array(a);case"l":return o.getInt64Array(a)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},h.prototype={constructor:h,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(t){for(var r=[],a=0;a<t;a++)r[a]=this.getUint8();var i=r.indexOf(0);return i>=0&&(r=r.slice(0,i)),e.LoaderUtils.decodeText(new Uint8Array(r))}},d.prototype={constructor:d,add:function(e,t){this[e]=t}};var m=[];function v(e,t,r,a){var i;switch(a.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=a.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+a.mappingType)}"IndexToDirect"===a.referenceType&&(i=a.indices[i]);var n=i*a.dataSize,o=n+a.dataSize;return function(e,t,r,a){for(var i=r,n=0;i<a;i++,n++)e[n]=t[i];return e}(m,a.buffer,n,o)}var g=new e.Euler,y=new e.Vector3;function x(t){var r,a=new e.Matrix4,i=new e.Matrix4,n=new e.Matrix4,o=new e.Matrix4,s=new e.Matrix4,l=new e.Matrix4,u=new e.Matrix4,c=new e.Matrix4,h=new e.Matrix4,d=new e.Matrix4,f=new e.Matrix4,p=new e.Matrix4,m=t.inheritType?t.inheritType:0;(t.translation&&a.setPosition(y.fromArray(t.translation)),t.preRotation)&&((r=t.preRotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),i.makeRotationFromEuler(g.fromArray(r)));t.rotation&&((r=t.rotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),n.makeRotationFromEuler(g.fromArray(r)));t.postRotation&&((r=t.postRotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),o.makeRotationFromEuler(g.fromArray(r)),o.invert());t.scale&&s.scale(y.fromArray(t.scale)),t.scalingOffset&&u.setPosition(y.fromArray(t.scalingOffset)),t.scalingPivot&&l.setPosition(y.fromArray(t.scalingPivot)),t.rotationOffset&&c.setPosition(y.fromArray(t.rotationOffset)),t.rotationPivot&&h.setPosition(y.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(f.copy(t.parentMatrix),d.copy(t.parentMatrixWorld));var v=(new e.Matrix4).copy(i).multiply(n).multiply(o),x=new e.Matrix4;x.extractRotation(d);var b=new e.Matrix4;b.copyPosition(d);var A=new e.Matrix4,w=(new e.Matrix4).copy(b).invert().multiply(d);A.copy(x).invert().multiply(w);var M=s,S=new e.Matrix4;if(0===m)S.copy(x).multiply(v).multiply(A).multiply(M);else if(1===m)S.copy(x).multiply(A).multiply(v).multiply(M);else{var T=(new e.Matrix4).scale((new e.Vector3).setFromMatrixScale(f)),C=(new e.Matrix4).copy(T).invert(),F=(new e.Matrix4).copy(A).multiply(C);S.copy(x).multiply(v).multiply(F).multiply(M)}var E=new e.Matrix4;E.copy(h).invert();var B=new e.Matrix4;B.copy(l).invert();var L=new e.Matrix4;L.copy(a).multiply(c).multiply(h).multiply(i).multiply(n).multiply(o).multiply(E).multiply(u).multiply(l).multiply(s).multiply(B);var P=(new e.Matrix4).copyPosition(L),D=(new e.Matrix4).copy(d).multiply(P);return p.copyPosition(D),(L=(new e.Matrix4).copy(p).multiply(S)).premultiply(d.invert()),L}function b(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function A(e){return e.split(",").map((function(e){return parseFloat(e)}))}function w(t,r,a){return void 0===r&&(r=0),void 0===a&&(a=t.byteLength),e.LoaderUtils.decodeText(new Uint8Array(t,r,a))}function M(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return i}(),ro=function(){function e(e,t,r,a,i){var n=this;this.controller=t,this.handModel=e,this.bones=[];var o=new to,s=i&&"lowpoly"===i.model?"_low":"";o.setPath(r),o.load("OculusHand_"+("right"===a?"R":"L")+s+".fbx",(function(e){n.handModel.add(e),e.scale.setScalar(.01);var t=e.getObjectByProperty("type","SkinnedMesh");t.frustumCulled=!1,t.castShadow=!0,t.receiveShadow=!0;var r=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],i=0;["b_%_wrist","b_%_thumb1","b_%_thumb2","b_%_thumb3","b_%_thumb_null",null,"b_%_index1","b_%_index2","b_%_index3","b_%_index_null",null,"b_%_middle1","b_%_middle2","b_%_middle3","b_%_middlenull",null,"b_%_ring1","b_%_ring2","b_%_ring3","b_%_ring_inull","b_%_pinky0","b_%_pinky1","b_%_pinky2","b_%_pinky3","b_%_pinkynull"].forEach((function(t){if(t){var o=e.getObjectByName(t.replace(/%/g,"right"===a?"r":"l"));void 0!==o&&(o.jointName=r[i]),n.bones.push(o)}else n.bones.push(null);i++}))}))}return e.prototype.updateMesh=function(){for(var e=this.controller.joints,t=0;t<this.bones.length;t++){var r=this.bones[t];if(r){var a=e[r.jointName];if(a.visible){var i=a.position;r&&(r.position.copy(i.clone().multiplyScalar(100)),r.quaternion.copy(a.quaternion))}}}},e}();function ao(t){e.Object3D.call(this),this.controller=t,this.motionController=null,this.envMap=null,this.mesh=null}ao.prototype=Object.assign(Object.create(e.Object3D.prototype),{constructor:ao,updateMatrixWorld:function(t){e.Object3D.prototype.updateMatrixWorld.call(this,t),this.motionController&&this.motionController.updateMesh()}});var io=function(){function e(){this.path=""}return e.prototype={constructor:e,setPath:function(e){return this.path=e,this},createHandModel:function(e,t,r){var a=this,i=new ao(e);return e.addEventListener("connected",(function(n){var o=n.data;o.hand&&!i.motionController&&(i.visible=!0,i.xrInputSource=o,void 0===t||"spheres"===t?i.motionController=new Kn(i,e,a.path,o.handedness,{primitive:"sphere"}):"boxes"===t?i.motionController=new Kn(i,e,a.path,o.handedness,{primitive:"box"}):"oculus"===t&&(i.motionController=new ro(i,e,a.path,o.handedness,r)))})),e.addEventListener("disconnected",(function(){})),i}},e}(),no=function(){function t(t,r,a,i,n){var o=this;this.xrLight=t,this.renderer=r,this.lightProbe=a,this.xrWebGLBinding=null,this.estimationStartCallback=n,this.frameCallback=this.onXRFrame.bind(this);var s=r.xr.getSession();if(i&&"XRWebGLBinding"in window){var l=new e.WebGLCubeRenderTarget(16);t.environment=l.texture;var u=r.getContext();switch(s.preferredReflectionFormat){case"srgba8":u.getExtension("EXT_sRGB");break;case"rgba16f":u.getExtension("OES_texture_half_float")}this.xrWebGLBinding=new XRWebGLBinding(s,u),this.lightProbe.addEventListener("reflectionchange",(function(){o.updateReflection()}))}s.requestAnimationFrame(this.frameCallback)}var r=t.prototype;return r.updateReflection=function(){var e=this.renderer.properties.get(this.xrLight.environment);if(e){var t=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);t&&(e.__webglTexture=t)}},r.onXRFrame=function(e,t){if(this.xrLight){t.session.requestAnimationFrame(this.frameCallback);var r=t.getLightEstimate(this.lightProbe);if(r){this.xrLight.lightProbe.sh.fromArray(r.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;var a=Math.max(1,Math.max(r.primaryLightIntensity.x,Math.max(r.primaryLightIntensity.y,r.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(r.primaryLightIntensity.x/a,r.primaryLightIntensity.y/a,r.primaryLightIntensity.z/a),this.xrLight.directionalLight.intensity=a,this.xrLight.directionalLight.position.copy(r.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}},r.dispose=function(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null},t}(),oo=function(t){function r(r,a){var i;void 0===a&&(a=!0),(i=t.call(this)||this).lightProbe=new e.LightProbe,i.lightProbe.intensity=0,i.add(i.lightProbe),i.directionalLight=new e.DirectionalLight,i.directionalLight.intensity=0,i.add(i.directionalLight),i.environment=null;var n=null,o=!1;return r.xr.addEventListener("sessionstart",(function(){var e=r.xr.getSession();"requestLightProbe"in e&&e.requestLightProbe({reflectionFormat:e.preferredReflectionFormat}).then((function(e){n=new no(x.default(i),r,e,a,(function(){o=!0,i.dispatchEvent({type:"estimationstart"})}))}))})),r.xr.addEventListener("sessionend",(function(){n&&(n.dispose(),n=null),o&&i.dispatchEvent({type:"estimationend"})})),i.dispose=function(){n&&(n.dispose(),n=null),i.remove(i.lightProbe),i.lightProbe=null,i.remove(i.directionalLight),i.directionalLight=null,i.environment=null},i}return g.default(r,t),r}(e.Group),so=function(){function e(){}return e.createButton=function(e,t){t&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.');var r=document.createElement("button");function a(){r.style.display="",r.style.cursor="auto",r.style.left="calc(50% - 75px)",r.style.width="150px",r.onmouseenter=null,r.onmouseleave=null,r.onclick=null,r.textContent="VR NOT SUPPORTED"}function i(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return r.id="VRButton",r.style.display="none",i(r),navigator.xr.isSessionSupported("immersive-vr").then((function(t){t?function(){var t=null;function a(e){return i.apply(this,arguments)}function i(){return(i=w.default(regeneratorRuntime.mark((function a(i){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i.addEventListener("end",n),a.next=3,e.xr.setSession(i);case 3:r.textContent="EXIT VR",t=i;case 5:case"end":return a.stop()}}),a)})))).apply(this,arguments)}function n(){t.removeEventListener("end",n),r.textContent="ENTER VR",t=null}r.style.display="",r.style.cursor="pointer",r.style.left="calc(50% - 50px)",r.style.width="100px",r.textContent="ENTER VR",r.onmouseenter=function(){r.style.opacity="1.0"},r.onmouseleave=function(){r.style.opacity="0.5"},r.onclick=function(){null===t?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking"]}).then(a):t.end()}}():a()})),r;var n=document.createElement("a");return!1===window.isSecureContext?(n.href=document.location.href.replace(/^http:/,"https:"),n.innerHTML="WEBXR NEEDS HTTPS"):(n.href="https://immersiveweb.dev/",n.innerHTML="WEBXR NOT AVAILABLE"),n.style.left="calc(50% - 90px)",n.style.width="180px",n.style.textDecoration="none",i(n),n},e}(),lo=function(){function e(){}return e.createButton=function(e,t){void 0===t&&(t={});var r=document.createElement("button");function a(){r.style.display="",r.style.cursor="auto",r.style.left="calc(50% - 75px)",r.style.width="150px",r.onmouseenter=null,r.onmouseleave=null,r.onclick=null,r.textContent="AR NOT SUPPORTED"}function i(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return r.id="ARButton",r.style.display="none",i(r),navigator.xr.isSessionSupported("immersive-ar").then((function(i){i?function(){if(void 0===t.domOverlay){var a=document.createElement("div");a.style.display="none",document.body.appendChild(a);var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("width",38),i.setAttribute("height",38),i.style.position="absolute",i.style.right="20px",i.style.top="20px",i.addEventListener("click",(function(){o.end()})),a.appendChild(i);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d","M 12,12 L 28,28 M 28,12 12,28"),n.setAttribute("stroke","#fff"),n.setAttribute("stroke-width",2),i.appendChild(n),void 0===t.optionalFeatures&&(t.optionalFeatures=[]),t.optionalFeatures.push("dom-overlay"),t.domOverlay={root:a}}var o=null;function s(e){return l.apply(this,arguments)}function l(){return(l=w.default(regeneratorRuntime.mark((function a(i){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i.addEventListener("end",u),e.xr.setReferenceSpaceType("local"),a.next=4,e.xr.setSession(i);case 4:r.textContent="STOP AR",t.domOverlay.root.style.display="",o=i;case 7:case"end":return a.stop()}}),a)})))).apply(this,arguments)}function u(){o.removeEventListener("end",u),r.textContent="START AR",t.domOverlay.root.style.display="none",o=null}r.style.display="",r.style.cursor="pointer",r.style.left="calc(50% - 50px)",r.style.width="100px",r.textContent="START AR",r.onmouseenter=function(){r.style.opacity="1.0"},r.onmouseleave=function(){r.style.opacity="0.5"},r.onclick=function(){null===o?navigator.xr.requestSession("immersive-ar",t).then(s):o.end()}}():a()})).catch(a),r;var n=document.createElement("a");return!1===window.isSecureContext?(n.href=document.location.href.replace(/^http:/,"https:"),n.innerHTML="WEBXR NEEDS HTTPS"):(n.href="https://immersiveweb.dev/",n.innerHTML="WEBXR NOT AVAILABLE"),n.style.left="calc(50% - 90px)",n.style.width="180px",n.style.textDecoration="none",i(n),n},e}(),uo={klein:function(e,t,r){var a,i,n;t*=Math.PI,e*=2*Math.PI,(t*=2)<Math.PI?(a=3*Math.cos(t)*(1+Math.sin(t))+2*(1-Math.cos(t)/2)*Math.cos(t)*Math.cos(e),n=-8*Math.sin(t)-2*(1-Math.cos(t)/2)*Math.sin(t)*Math.cos(e)):(a=3*Math.cos(t)*(1+Math.sin(t))+2*(1-Math.cos(t)/2)*Math.cos(e+Math.PI),n=-8*Math.sin(t)),i=-2*(1-Math.cos(t)/2)*Math.sin(e),r.set(a,i,n)},plane:function(e,t){return function(r,a,i){var n=r*e,o=a*t;i.set(n,0,o)}},mobius:function(e,t,r){e-=.5;var a,i,n,o=2*Math.PI*t;a=Math.cos(o)*(2+e*Math.cos(o/2)),i=Math.sin(o)*(2+e*Math.cos(o/2)),n=e*Math.sin(o/2),r.set(a,i,n)},mobius3d:function(e,t,r){e*=Math.PI,t*=2*Math.PI;var a,i,n,o=(e*=2)/2;a=.125*Math.cos(t)*Math.cos(o)-.65*Math.sin(t)*Math.sin(o),n=.125*Math.cos(t)*Math.sin(o)+.65*Math.sin(t)*Math.cos(o),i=(2.25+a)*Math.sin(e),a=(2.25+a)*Math.cos(e),r.set(a,i,n)},TubeGeometry:function(t,r,a,i,n){this.path=t,this.segments=r||64,this.radius=a||1,this.segmentsRadius=i||8,this.closed=n||!1;var o=this,s=this.segments+1,l=t.computeFrenetFrames(r,n),u=l.tangents,c=l.normals,h=l.binormals;this.tangents=u,this.normals=c,this.binormals=h;var d=new e.Vector3;e.ParametricGeometry.call(this,(function(e,r,a){r*=2*Math.PI;var i=e*(s-1);i=Math.floor(i),t.getPointAt(e,d);var n=c[i],l=h[i],u=-o.radius*Math.cos(r),f=o.radius*Math.sin(r);d.x+=u*n.x+f*l.x,d.y+=u*n.y+f*l.y,d.z+=u*n.z+f*l.z,a.copy(d)}),r,i)}};uo.TubeGeometry.prototype=Object.create(e.BufferGeometry.prototype),uo.TubeGeometry.prototype.constructor=uo.TubeGeometry,uo.TorusKnotGeometry=function(t,r,a,i,n,o){this.radius=t||200,this.tube=r||40,this.segmentsT=a||64,this.segmentsR=i||8,this.p=n||2,this.q=o||3;var s=a,l=i,u=new(function(r){function a(){return r.call(this)||this}return g.default(a,r),a.prototype.getPoint=function(r,a){var i=a||new e.Vector3;r*=2*Math.PI;var s=(1+.5*Math.cos(o*r))*Math.cos(n*r),l=(1+.5*Math.cos(o*r))*Math.sin(n*r),u=.5*Math.sin(o*r);return i.set(s,l,u).multiplyScalar(t)},a}(e.Curve));uo.TubeGeometry.call(this,u,s,r,l,!0,!1)},uo.TorusKnotGeometry.prototype=Object.create(e.BufferGeometry.prototype),uo.TorusKnotGeometry.prototype.constructor=uo.TorusKnotGeometry,uo.SphereGeometry=function(t,r,a){e.ParametricGeometry.call(this,(function(e,r,a){e*=Math.PI,r*=2*Math.PI;var i=t*Math.sin(e)*Math.cos(r),n=t*Math.sin(e)*Math.sin(r),o=t*Math.cos(e);a.set(i,n,o)}),r,a)},uo.SphereGeometry.prototype=Object.create(e.BufferGeometry.prototype),uo.SphereGeometry.prototype.constructor=uo.SphereGeometry,uo.PlaneGeometry=function(t,r,a,i){e.ParametricGeometry.call(this,(function(e,a,i){var n=e*t,o=a*r;i.set(n,0,o)}),a,i)},uo.PlaneGeometry.prototype=Object.create(e.BufferGeometry.prototype),uo.PlaneGeometry.prototype.constructor=uo.PlaneGeometry;var co=new e.Vector3;function ho(e,t,r,a,i,n){var o=2*Math.PI*i/4,s=Math.max(n-2*i,0),l=Math.PI/4;co.copy(t),co[a]=0,co.normalize();var u=.5*o/(o+s),c=1-co.angleTo(e)/l;return 1===Math.sign(co[r])?c*u:s/(o+s)+u+u*(1-c)}var fo=function(t){function r(r,a,i,n,o){var s;if(void 0===r&&(r=1),void 0===a&&(a=1),void 0===i&&(i=1),void 0===n&&(n=2),void 0===o&&(o=.1),n=2*n+1,o=Math.min(r/2,a/2,i/2,o),s=t.call(this,1,1,1,n,n,n)||this,1===n)return x.default(s);var l=s.toNonIndexed();s.index=null,s.attributes.position=l.attributes.position,s.attributes.normal=l.attributes.normal,s.attributes.uv=l.attributes.uv;for(var u=new e.Vector3,c=new e.Vector3,h=new e.Vector3(r,a,i).divideScalar(2).subScalar(o),d=s.attributes.position.array,f=s.attributes.normal.array,p=s.attributes.uv.array,m=d.length/6,v=new e.Vector3,g=.5/n,y=0,b=0;y<d.length;y+=3,b+=2){switch(u.fromArray(d,y),c.copy(u),c.x-=Math.sign(c.x)*g,c.y-=Math.sign(c.y)*g,c.z-=Math.sign(c.z)*g,c.normalize(),d[y+0]=h.x*Math.sign(u.x)+c.x*o,d[y+1]=h.y*Math.sign(u.y)+c.y*o,d[y+2]=h.z*Math.sign(u.z)+c.z*o,f[y+0]=c.x,f[y+1]=c.y,f[y+2]=c.z,Math.floor(y/m)){case 0:v.set(1,0,0),p[b+0]=ho(v,c,"z","y",o,i),p[b+1]=1-ho(v,c,"y","z",o,a);break;case 1:v.set(-1,0,0),p[b+0]=1-ho(v,c,"z","y",o,i),p[b+1]=1-ho(v,c,"y","z",o,a);break;case 2:v.set(0,1,0),p[b+0]=1-ho(v,c,"x","z",o,r),p[b+1]=ho(v,c,"z","x",o,i);break;case 3:v.set(0,-1,0),p[b+0]=1-ho(v,c,"x","z",o,r),p[b+1]=1-ho(v,c,"z","x",o,i);break;case 4:v.set(0,0,1),p[b+0]=1-ho(v,c,"x","y",o,r),p[b+1]=1-ho(v,c,"y","x",o,a);break;case 5:v.set(0,0,-1),p[b+0]=ho(v,c,"x","y",o,r),p[b+1]=1-ho(v,c,"y","x",o,a)}}return s}return g.default(r,t),r}(e.BoxGeometry),po=function(t){function r(r,a,i,n,o,s){var l;l=t.call(this)||this;for(var u=(r=r||1)/2,c=(a=a||1)/2,h=(i=i||1)/2,d=r/(n=Math.floor(n)||1),f=a/(o=Math.floor(o)||1),p=i/(s=Math.floor(s)||1),m=[],v=-u,g=-c,y=-h,x=0;x<=n;x++)m.push(v,-c,-h,v,c,-h),m.push(v,c,-h,v,c,h),m.push(v,c,h,v,-c,h),m.push(v,-c,h,v,-c,-h),v+=d;for(var b=0;b<=o;b++)m.push(-u,g,-h,u,g,-h),m.push(u,g,-h,u,g,h),m.push(u,g,h,-u,g,h),m.push(-u,g,h,-u,g,-h),g+=f;for(var A=0;A<=s;A++)m.push(-u,-c,y,-u,c,y),m.push(-u,c,y,u,c,y),m.push(u,c,y,u,-c,y),m.push(u,-c,y,-u,-c,y),y+=p;return l.setAttribute("position",new e.Float32BufferAttribute(m,3)),l}return g.default(r,t),r}(e.BufferGeometry),mo=function(t){function r(r,a,i,n){var o;o=t.call(this)||this;var s=[],l=[],u=[],c=new e.Vector3,h=new e.Matrix4;h.makeRotationFromEuler(i),h.setPosition(a);var d=new e.Matrix4;function f(e,t,a){t.applyMatrix4(r.matrixWorld),t.applyMatrix4(d),a.transformDirection(r.matrixWorld),e.push(new vo(t.clone(),a.clone()))}function p(e,t){for(var r=[],a=.5*Math.abs(n.dot(t)),i=0;i<e.length;i+=3){var o,s,l,u=void 0,c=void 0,h=void 0,d=void 0;switch(((o=e[i+0].position.dot(t)-a>0)?1:0)+((s=e[i+1].position.dot(t)-a>0)?1:0)+((l=e[i+2].position.dot(t)-a>0)?1:0)){case 0:r.push(e[i]),r.push(e[i+1]),r.push(e[i+2]);break;case 1:if(o&&(u=e[i+1],c=e[i+2],h=m(e[i],u,t,a),d=m(e[i],c,t,a)),s){u=e[i],c=e[i+2],h=m(e[i+1],u,t,a),d=m(e[i+1],c,t,a),r.push(h),r.push(c.clone()),r.push(u.clone()),r.push(c.clone()),r.push(h.clone()),r.push(d);break}l&&(u=e[i],c=e[i+1],h=m(e[i+2],u,t,a),d=m(e[i+2],c,t,a)),r.push(u.clone()),r.push(c.clone()),r.push(h),r.push(d),r.push(h.clone()),r.push(c.clone());break;case 2:o||(c=m(u=e[i].clone(),e[i+1],t,a),h=m(u,e[i+2],t,a),r.push(u),r.push(c),r.push(h)),s||(c=m(u=e[i+1].clone(),e[i+2],t,a),h=m(u,e[i],t,a),r.push(u),r.push(c),r.push(h)),l||(c=m(u=e[i+2].clone(),e[i],t,a),h=m(u,e[i+1],t,a),r.push(u),r.push(c),r.push(h))}}return r}function m(t,r,a,i){var n=t.position.dot(a)-i,o=n/(n-(r.position.dot(a)-i));return new vo(new e.Vector3(t.position.x+o*(r.position.x-t.position.x),t.position.y+o*(r.position.y-t.position.y),t.position.z+o*(r.position.z-t.position.z)),new e.Vector3(t.normal.x+o*(r.normal.x-t.normal.x),t.normal.y+o*(r.normal.y-t.normal.y),t.normal.z+o*(r.normal.z-t.normal.z)))}return d.copy(h).invert(),function(){var t,a=[],i=new e.Vector3,o=new e.Vector3;if(!0===r.geometry.isGeometry)return void console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");var d=r.geometry,m=d.attributes.position,v=d.attributes.normal;if(null!==d.index){var g=d.index;for(t=0;t<g.count;t++)i.fromBufferAttribute(m,g.getX(t)),o.fromBufferAttribute(v,g.getX(t)),f(a,i,o)}else for(t=0;t<m.count;t++)i.fromBufferAttribute(m,t),o.fromBufferAttribute(v,t),f(a,i,o);for(a=p(a,c.set(1,0,0)),a=p(a,c.set(-1,0,0)),a=p(a,c.set(0,1,0)),a=p(a,c.set(0,-1,0)),a=p(a,c.set(0,0,1)),a=p(a,c.set(0,0,-1)),t=0;t<a.length;t++){var y=a[t];u.push(.5+y.position.x/n.x,.5+y.position.y/n.y),y.position.applyMatrix4(h),s.push(y.position.x,y.position.y,y.position.z),l.push(y.normal.x,y.normal.y,y.normal.z)}}(),o.setAttribute("position",new e.Float32BufferAttribute(s,3)),o.setAttribute("normal",new e.Float32BufferAttribute(l,3)),o.setAttribute("uv",new e.Float32BufferAttribute(u,2)),o}return g.default(r,t),r}(e.BufferGeometry),vo=function(){function e(e,t){this.position=e,this.normal=t}return e.prototype.clone=function(){return new this.constructor(this.position.clone(),this.normal.clone())},e}(),go=function(t){function r(r,a,i,n,o,s,l){var u,c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],h=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];u=t.call(this)||this,r=r||50,a=void 0!==a?Math.max(2,Math.floor(a)||10):10,s=void 0===s||s;var d=3.15*((l=void 0===l||l)?1:1.3)/2,f=r/d,p=(i=void 0===i||i)?(8*a-4)*a:0;p+=(n=void 0===n||n)?(16*a-4)*a:0,p+=(o=void 0===o||o)?40*a*a:0;var m=new Uint32Array(3*p),v=i?4:0;v+=n?8:0,v+=o?20:0,v*=(a+1)*(a+1);var g=new Float32Array(3*v),y=new Float32Array(3*v),x=new Float32Array(2*v),b=new e.Matrix4;b.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);var A,w,M,S,T,C,F,E,B,L,P,D,N,R,_,I,O=[],U=[],k=[],V=[],G=[],j=[],z=[],H=[],W=[],X=new e.Vector3,Q=0,Y=0,J=new e.Vector3,K=new e.Matrix4,q=new e.Matrix4,Z=new e.Vector4,$=new e.Vector4,ee=new e.Vector4,te=new e.Vector4,re=new e.Vector3,ae=new e.Vector3,ie=b.clone();ie.transpose();var ne=function(e,t,r){return!(g[3*e]===g[3*t]&&g[3*e+1]===g[3*t+1]&&g[3*e+2]===g[3*t+2]||g[3*e]===g[3*r]&&g[3*e+1]===g[3*r+1]&&g[3*e+2]===g[3*r+2]||g[3*t]===g[3*r]&&g[3*t+1]===g[3*r+1]&&g[3*t+2]===g[3*r+2])};for(A=0;A<3;A++)j[A]=new e.Matrix4;var oe=i?32:28;F=a+1;for(var se=0,le=0,ue=0,ce=0,he=0,de=o?0:20;de<oe;de++)if(n||de<20||de>=28){for(A=0;A<3;A++){for(w=0;w<4;w++)for(M=0;M<4;M++)O[4*M+w]=h[3*c[16*de+4*w+M]+A],s&&de>=20&&de<28&&2!==A&&(O[4*M+w]*=1.077),l||2!==A||(O[4*M+w]*=1.3);K.set(O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8],O[9],O[10],O[11],O[12],O[13],O[14],O[15]),q.multiplyMatrices(K,b),j[A].multiplyMatrices(ie,q)}for(T=0;T<=a;T++)for(E=T/a,C=0;C<=a;C++){for(B=C/a,D=4,L=P=1;D--;)U[D]=L,k[D]=P,L*=E,P*=B,3===D?(V[D]=G[D]=0,Q=Y=1):(V[D]=Q*(3-D),G[D]=Y*(3-D),Q*=E,Y*=B);for(Z.fromArray(U),$.fromArray(k),ee.fromArray(V),te.fromArray(G),A=0;A<3;A++)(S=Z.clone()).applyMatrix4(j[A]),z[A]=S.dot($),(S=ee.clone()).applyMatrix4(j[A]),H[A]=S.dot($),(S=Z.clone()).applyMatrix4(j[A]),W[A]=S.dot(te);re.fromArray(H),ae.fromArray(W),X.crossVectors(ae,re),X.normalize(),0===z[0]&&0===z[1]?J.set(0,z[2]>d?1:-1,0):J.set(X.x,X.z,-X.y),g[le++]=f*z[0],g[le++]=f*(z[2]-d),g[le++]=-f*z[1],y[ue++]=J.x,y[ue++]=J.y,y[ue++]=J.z,x[ce++]=1-B,x[ce++]=1-E}for(T=0;T<a;T++)for(C=0;C<a;C++)I=(N=se*F*F+T*F+C)+F,ne(N,R=N+1,_=R+F)&&(m[he++]=N,m[he++]=R,m[he++]=_),ne(N,_,I)&&(m[he++]=N,m[he++]=_,m[he++]=I);se++}return u.setIndex(new e.BufferAttribute(m,1)),u.setAttribute("position",new e.BufferAttribute(g,3)),u.setAttribute("normal",new e.BufferAttribute(y,3)),u.setAttribute("uv",new e.BufferAttribute(x,2)),u.computeBoundingSphere(),u}return g.default(r,t),r}(e.BufferGeometry),yo=new e.Matrix4,xo=function(){function t(t){t=t||{},this.vertices={near:[new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3],far:[new e.Vector3,new e.Vector3,new e.Vector3,new e.Vector3]},void 0!==t.projectionMatrix&&this.setFromProjectionMatrix(t.projectionMatrix,t.maxFar||1e4)}var r=t.prototype;return r.setFromProjectionMatrix=function(e,t){var r=0===e.elements[11];return yo.copy(e).invert(),this.vertices.near[0].set(1,1,-1),this.vertices.near[1].set(1,-1,-1),this.vertices.near[2].set(-1,-1,-1),this.vertices.near[3].set(-1,1,-1),this.vertices.near.forEach((function(e){e.applyMatrix4(yo)})),this.vertices.far[0].set(1,1,1),this.vertices.far[1].set(1,-1,1),this.vertices.far[2].set(-1,-1,1),this.vertices.far[3].set(-1,1,1),this.vertices.far.forEach((function(e){e.applyMatrix4(yo);var a=Math.abs(e.z);r?e.z*=Math.min(t/a,1):e.multiplyScalar(Math.min(t/a,1))})),this.vertices},r.split=function(e,r){for(;e.length>r.length;)r.push(new t);r.length=e.length;for(var a=0;a<e.length;a++){var i=r[a];if(0===a)for(var n=0;n<4;n++)i.vertices.near[n].copy(this.vertices.near[n]);else for(var o=0;o<4;o++)i.vertices.near[o].lerpVectors(this.vertices.near[o],this.vertices.far[o],e[a-1]);if(a===e-1)for(var s=0;s<4;s++)i.vertices.far[s].copy(this.vertices.far[s]);else for(var l=0;l<4;l++)i.vertices.far[l].lerpVectors(this.vertices.near[l],this.vertices.far[l],e[a])}},r.toSpace=function(e,t){for(var r=0;r<4;r++)t.vertices.near[r].copy(this.vertices.near[r]).applyMatrix4(e),t.vertices.far[r].copy(this.vertices.far[r]).applyMatrix4(e)},t}(),bo={lights_fragment_begin:"\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0) && defined( RE_Direct ) && defined( USE_CSM ) && defined( CSM_CASCADES )\n\n\tDirectionalLight directionalLight;\n\tfloat linearDepth = (vViewPosition.z) / (shadowFar - cameraNear);\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#if defined( USE_SHADOWMAP ) && defined( CSM_FADE )\n\tvec2 cascade;\n\tfloat cascadeCenter;\n\tfloat closestEdge;\n\tfloat margin;\n\tfloat csmx;\n\tfloat csmy;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t// NOTE: Depth gets larger away from the camera.\n\t\t// cascade.x is closer, cascade.y is further\n\t\tcascade = CSM_cascades[ i ];\n\t\tcascadeCenter = ( cascade.x + cascade.y ) / 2.0;\n\t\tclosestEdge = linearDepth < cascadeCenter ? cascade.x : cascade.y;\n\t\tmargin = 0.25 * pow( closestEdge, 2.0 );\n\t\tcsmx = cascade.x - margin / 2.0;\n\t\tcsmy = cascade.y + margin / 2.0;\n\t\tif( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS && linearDepth >= csmx && ( linearDepth < csmy || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 ) ) {\n\n\t\t\tfloat dist = min( linearDepth - csmx, csmy - linearDepth );\n\t\t\tfloat ratio = clamp( dist / margin, 0.0, 1.0 );\n\t\t\tif( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS ) {\n\n\t\t\t\tvec3 prevColor = directLight.color;\n\t\t\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\t\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t\t\t\tbool shouldFadeLastCascade = UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth > cascadeCenter;\n\t\t\t\tdirectLight.color = mix( prevColor, directLight.color, shouldFadeLastCascade ? ratio : 1.0 );\n\n\t\t\t}\n\n\t\t\tReflectedLight prevLight = reflectedLight;\n\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t\t\tbool shouldBlend = UNROLLED_LOOP_INDEX != CSM_CASCADES - 1 || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth < cascadeCenter;\n\t\t\tfloat blendRatio = shouldBlend ? ratio : 1.0;\n\n\t\t\treflectedLight.directDiffuse = mix( prevLight.directDiffuse, reflectedLight.directDiffuse, blendRatio );\n\t\t\treflectedLight.directSpecular = mix( prevLight.directSpecular, reflectedLight.directSpecular, blendRatio );\n\t\t\treflectedLight.indirectDiffuse = mix( prevLight.indirectDiffuse, reflectedLight.indirectDiffuse, blendRatio );\n\t\t\treflectedLight.indirectSpecular = mix( prevLight.indirectSpecular, reflectedLight.indirectSpecular, blendRatio );\n\n\t\t}\n\n\t}\n\t#pragma unroll_loop_end\n\t#else\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tif(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y) directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t\t#endif\n\n\t\tif(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && (linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1)) RE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct ) && !defined( USE_CSM ) && !defined( CSM_CASCADES )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_pars_begin:"\n#if defined( USE_CSM ) && defined( CSM_CASCADES )\nuniform vec2 CSM_cascades[CSM_CASCADES];\nuniform float cameraNear;\nuniform float shadowFar;\n#endif\n\t"+e.ShaderChunk.lights_pars_begin},Ao=new e.Matrix4,wo=new xo,Mo=new e.Vector3,So=new e.Box3,To=[],Co=[],Fo=function(){function t(t){t=t||{},this.camera=t.camera,this.parent=t.parent,this.cascades=t.cascades||3,this.maxFar=t.maxFar||1e5,this.mode=t.mode||"practical",this.shadowMapSize=t.shadowMapSize||2048,this.shadowBias=t.shadowBias||1e-6,this.lightDirection=t.lightDirection||new e.Vector3(1,-1,1).normalize(),this.lightIntensity=t.lightIntensity||1,this.lightNear=t.lightNear||1,this.lightFar=t.lightFar||2e3,this.lightMargin=t.lightMargin||200,this.customSplitsCallback=t.customSplitsCallback,this.fade=!1,this.mainFrustum=new xo,this.frustums=[],this.breaks=[],this.lights=[],this.shaders=new Map,this.createLights(),this.updateFrustums(),this.injectInclude()}var r=t.prototype;return r.createLights=function(){for(var t=0;t<this.cascades;t++){var r=new e.DirectionalLight(16777215,this.lightIntensity);r.castShadow=!0,r.shadow.mapSize.width=this.shadowMapSize,r.shadow.mapSize.height=this.shadowMapSize,r.shadow.camera.near=this.lightNear,r.shadow.camera.far=this.lightFar,r.shadow.bias=this.shadowBias,this.parent.add(r),this.parent.add(r.target),this.lights.push(r)}},r.initCascades=function(){var e=this.camera;e.updateProjectionMatrix(),this.mainFrustum.setFromProjectionMatrix(e.projectionMatrix,this.maxFar),this.mainFrustum.split(this.breaks,this.frustums)},r.updateShadowBounds=function(){for(var e=this.frustums,t=0;t<e.length;t++){var r=this.lights[t].shadow.camera,a=this.frustums[t],i=a.vertices.near,n=a.vertices.far,o=n[0],s=void 0;s=o.distanceTo(n[2])>o.distanceTo(i[2])?n[2]:i[2];var l=o.distanceTo(s);if(this.fade){var u=this.camera,c=Math.max(u.far,this.maxFar),h=a.vertices.far[0].z/(c-u.near);l+=.25*Math.pow(h,2)*(c-u.near)}r.left=-l/2,r.right=l/2,r.top=l/2,r.bottom=-l/2,r.updateProjectionMatrix()}},r.getBreaks=function(){var t=this.camera,r=Math.min(t.far,this.maxFar);switch(this.breaks.length=0,this.mode){case"uniform":a(this.cascades,t.near,r,this.breaks);break;case"logarithmic":i(this.cascades,t.near,r,this.breaks);break;case"practical":!function(t,r,n,o,s){To.length=0,Co.length=0,i(t,r,n,Co),a(t,r,n,To);for(var l=1;l<t;l++)s.push(e.MathUtils.lerp(To[l-1],Co[l-1],o));s.push(1)}(this.cascades,t.near,r,.5,this.breaks);break;case"custom":void 0===this.customSplitsCallback&&console.error("CSM: Custom split scheme callback not defined."),this.customSplitsCallback(this.cascades,t.near,r,this.breaks)}function a(e,t,r,a){for(var i=1;i<e;i++)a.push((t+(r-t)*i/e)/r);a.push(1)}function i(e,t,r,a){for(var i=1;i<e;i++)a.push(t*Math.pow(r/t,i/e)/r);a.push(1)}},r.update=function(){for(var e=this.camera,t=this.frustums,r=0;r<t.length;r++){var a=this.lights[r],i=a.shadow.camera,n=(i.right-i.left)/this.shadowMapSize,o=(i.top-i.bottom)/this.shadowMapSize;a.shadow.camera.updateMatrixWorld(!0),Ao.multiplyMatrices(a.shadow.camera.matrixWorldInverse,e.matrixWorld),t[r].toSpace(Ao,wo);var s=wo.vertices.near,l=wo.vertices.far;So.makeEmpty();for(var u=0;u<4;u++)So.expandByPoint(s[u]),So.expandByPoint(l[u]);So.getCenter(Mo),Mo.z=So.max.z+this.lightMargin,Mo.x=Math.floor(Mo.x/n)*n,Mo.y=Math.floor(Mo.y/o)*o,Mo.applyMatrix4(a.shadow.camera.matrixWorld),a.position.copy(Mo),a.target.position.copy(Mo),a.target.position.x+=this.lightDirection.x,a.target.position.y+=this.lightDirection.y,a.target.position.z+=this.lightDirection.z}},r.injectInclude=function(){e.ShaderChunk.lights_fragment_begin=bo.lights_fragment_begin,e.ShaderChunk.lights_pars_begin=bo.lights_pars_begin},r.setupMaterial=function(e){e.defines=e.defines||{},e.defines.USE_CSM=1,e.defines.CSM_CASCADES=this.cascades,this.fade&&(e.defines.CSM_FADE="");var t=[],r=this,a=this.shaders;e.onBeforeCompile=function(i){var n=Math.min(r.camera.far,r.maxFar);r.getExtendedBreaks(t),i.uniforms.CSM_cascades={value:t},i.uniforms.cameraNear={value:r.camera.near},i.uniforms.shadowFar={value:n},a.set(e,i)},a.set(e,null)},r.updateUniforms=function(){var e=Math.min(this.camera.far,this.maxFar);this.shaders.forEach((function(t,r){if(null!==t){var a=t.uniforms;this.getExtendedBreaks(a.CSM_cascades.value),a.cameraNear.value=this.camera.near,a.shadowFar.value=e}!this.fade&&"CSM_FADE"in r.defines?(delete r.defines.CSM_FADE,r.needsUpdate=!0):this.fade&&!("CSM_FADE"in r.defines)&&(r.defines.CSM_FADE="",r.needsUpdate=!0)}),this)},r.getExtendedBreaks=function(t){for(;t.length<this.breaks.length;)t.push(new e.Vector2);t.length=this.breaks.length;for(var r=0;r<this.cascades;r++){var a=this.breaks[r],i=this.breaks[r-1]||0;t[r].x=i,t[r].y=a}},r.updateFrustums=function(){this.getBreaks(),this.initCascades(),this.updateShadowBounds(),this.updateUniforms()},r.remove=function(){for(var e=0;e<this.lights.length;e++)this.parent.remove(this.lights[e])},r.dispose=function(){var e=this.shaders;e.forEach((function(e,t){delete t.onBeforeCompile,delete t.defines.USE_CSM,delete t.defines.CSM_CASCADES,delete t.defines.CSM_FADE,null!==e&&(delete e.uniforms.CSM_cascades,delete e.uniforms.cameraNear,delete e.uniforms.shadowFar),t.needsUpdate=!0})),e.clear()},t}(),Eo=function(t){function r(r){var a;(a=t.call(this)||this).csm=r,a.displayFrustum=!0,a.displayPlanes=!0,a.displayShadowBounds=!0;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),o=new e.BufferGeometry;o.setIndex(new e.BufferAttribute(i,1)),o.setAttribute("position",new e.BufferAttribute(n,3,!1));var s=new e.LineSegments(o,new e.LineBasicMaterial);return a.add(s),a.frustumLines=s,a.cascadeLines=[],a.cascadePlanes=[],a.shadowLines=[],a}g.default(r,t);var a=r.prototype;return a.updateVisibility=function(){for(var e=this.displayFrustum,t=this.displayPlanes,r=this.displayShadowBounds,a=this.frustumLines,i=this.cascadeLines,n=this.cascadePlanes,o=this.shadowLines,s=0,l=i.length;s<l;s++){var u=i[s],c=n[s],h=o[s];u.visible=e,c.visible=e&&t,h.visible=r}a.visible=e},a.update=function(){var t=this.csm,r=t.camera,a=t.cascades,i=t.mainFrustum,n=t.frustums,o=t.lights,s=this.frustumLines.geometry.getAttribute("position"),l=this.cascadeLines,u=this.cascadePlanes,c=this.shadowLines;for(this.position.copy(r.position),this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.updateMatrixWorld(!0);l.length>a;)this.remove(l.pop()),this.remove(u.pop()),this.remove(c.pop());for(;l.length<a;){var h=new e.Box3Helper(new e.Box3,16777215),d=new e.MeshBasicMaterial({transparent:!0,opacity:.1,depthWrite:!1,side:e.DoubleSide}),f=new e.Mesh(new e.PlaneGeometry,d),p=new e.Group,m=new e.Box3Helper(new e.Box3,16776960);p.add(m),this.add(h),this.add(f),this.add(p),l.push(h),u.push(f),c.push(p)}for(var v=0;v<a;v++){var g=n[v],y=o[v].shadow.camera,x=g.vertices.far,b=l[v],A=u[v],w=c[v],M=w.children[0];b.box.min.copy(x[2]),b.box.max.copy(x[0]),b.box.max.z+=1e-4,A.position.addVectors(x[0],x[2]),A.position.multiplyScalar(.5),A.scale.subVectors(x[0],x[2]),A.scale.z=1e-4,this.remove(w),w.position.copy(y.position),w.quaternion.copy(y.quaternion),w.scale.copy(y.scale),w.updateMatrixWorld(!0),this.attach(w),M.box.min.set(y.bottom,y.left,-y.far),M.box.max.set(y.top,y.right,-y.near)}var S=i.vertices.near,T=i.vertices.far;s.setXYZ(0,T[0].x,T[0].y,T[0].z),s.setXYZ(1,T[3].x,T[3].y,T[3].z),s.setXYZ(2,T[2].x,T[2].y,T[2].z),s.setXYZ(3,T[1].x,T[1].y,T[1].z),s.setXYZ(4,S[0].x,S[0].y,S[0].z),s.setXYZ(5,S[3].x,S[3].y,S[3].z),s.setXYZ(6,S[2].x,S[2].y,S[2].z),s.setXYZ(7,S[1].x,S[1].y,S[1].z),s.needsUpdate=!0},r}(e.Group),Bo={uniforms:{tInput:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tInput;","void main() {","\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );","}"].join("\n")},Lo={uniforms:{tInput:{value:null},fStepSize:{value:1},vSunPositionScreenSpace:{value:new e.Vector3}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec3 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","\tvec2 delta = vSunPositionScreenSpace.xy - vUv;","\tfloat dist = length( delta );","\tvec2 stepv = fStepSize * delta / dist;","\tfloat iters = dist/fStepSize;","\tvec2 uv = vUv.xy;","\tfloat col = 0.0;","\tfloat f = min( 1.0, max( vSunPositionScreenSpace.z / 1000.0, 0.0 ) );","\tif ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tgl_FragColor = vec4( col/TAPS_PER_PASS );","\tgl_FragColor.a = 1.0;","}"].join("\n")},Po={uniforms:{tColors:{value:null},tGodRays:{value:null},fGodRayIntensity:{value:.69}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform float fGodRayIntensity;","void main() {","\tgl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","\tgl_FragColor.a = 1.0;","}"].join("\n")},Do={uniforms:{vSunPositionScreenSpace:{value:new e.Vector3},fAspect:{value:1},sunColor:{value:new e.Color(16772608)},bgColor:{value:new e.Color(0)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform vec3 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","\tvec2 diff = vUv - vSunPositionScreenSpace.xy;","\tdiff.x *= fAspect;","\tfloat prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","\tprop = 0.35 * pow( 1.0 - prop, 3.0 );","\tgl_FragColor.xyz = ( vSunPositionScreenSpace.z > 0.0 ) ? mix( sunColor, bgColor, 1.0 - prop ) : bgColor;","\tgl_FragColor.w = 1.0;","}"].join("\n")},No={uniforms:{tDiffuse:{value:null},side:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","\tvec2 p = vUv;","\tif (side == 0){","\t\tif (p.x > 0.5) p.x = 1.0 - p.x;","\t}else if (side == 1){","\t\tif (p.x < 0.5) p.x = 1.0 - p.x;","\t}else if (side == 2){","\t\tif (p.y < 0.5) p.y = 1.0 - p.y;","\t}else if (side == 3){","\t\tif (p.y > 0.5) p.y = 1.0 - p.y;","\t} ","\tvec4 color = texture2D(tDiffuse, p);","\tgl_FragColor = color;","}"].join("\n")},Ro={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 base = texture2D( tDiffuse, vUv );","\tvec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","\tfloat lum = dot( lumCoeff, base.rgb );","\tvec3 blend = vec3( lum );","\tfloat L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","\tvec3 result1 = 2.0 * base.rgb * blend;","\tvec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","\tvec3 newColor = mix( result1, result2, L );","\tfloat A2 = opacity * base.a;","\tvec3 mixRGB = A2 * newColor.rgb;","\tmixRGB += ( ( 1.0 - A2 ) * base.rgb );","\tgl_FragColor = vec4( mixRGB, base.a );","}"].join("\n")},_o={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","\tvec4 texel1 = texture2D( tDiffuse1, vUv );","\tvec4 texel2 = texture2D( tDiffuse2, vUv );","\tgl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")},Io={uniforms:{tDiffuse:{value:null},sides:{value:6},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","\tvec2 p = vUv - 0.5;","\tfloat r = length(p);","\tfloat a = atan(p.y, p.x) + angle;","\tfloat tau = 2. * 3.1416 ;","\ta = mod(a, tau/sides);","\ta = abs(a - tau/sides/2.) ;","\tp = r * vec2(cos(a), sin(a));","\tvec4 color = texture2D(tDiffuse, p + 0.5);","\tgl_FragColor = color;","}"].join("\n")},Oo={uniforms:{tDiffuse:{value:null},exposure:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define saturate(a) clamp( a, 0.0, 1.0 )","uniform sampler2D tDiffuse;","uniform float exposure;","varying vec2 vUv;","vec3 RRTAndODTFit( vec3 v ) {","\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;","\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;","\treturn a / b;","}","vec3 ACESFilmicToneMapping( vec3 color ) {","\tconst mat3 ACESInputMat = mat3(","\t\tvec3( 0.59719, 0.07600, 0.02840 ),","\t\tvec3( 0.35458, 0.90834, 0.13383 ),","\t\tvec3( 0.04823, 0.01566, 0.83777 )","\t);","\tconst mat3 ACESOutputMat = mat3(","\t\tvec3(  1.60475, -0.10208, -0.00327 ),","\t\tvec3( -0.53108,  1.10813, -0.07276 ),","\t\tvec3( -0.07367, -0.00605,  1.07602 )","\t);","\tcolor = ACESInputMat * color;","\tcolor = RRTAndODTFit( color );","\tcolor = ACESOutputMat * color;","\treturn saturate( color );","}","void main() {","\tvec4 tex = texture2D( tDiffuse, vUv );","\ttex.rgb *= exposure / 0.6;","\tgl_FragColor = vec4( ACESFilmicToneMapping( tex.rgb ), tex.a );","}"].join("\n")},Uo={modes:{none:"NO_PARALLAX",basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"},uniforms:{bumpMap:{value:null},map:{value:null},parallaxScale:{value:null},parallaxMinLayers:{value:null},parallaxMaxLayers:{value:null}},vertexShader:["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","\tvUv = uv;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvViewPosition = -mvPosition.xyz;","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","\tvec2 parallaxMap( in vec3 V ) {","\t\tfloat initialHeight = texture2D( bumpMap, vUv ).r;","\t\tvec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","\t\treturn vUv - texCoordOffset;","\t}","#else","\tvec2 parallaxMap( in vec3 V ) {","\t\tfloat numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","\t\tfloat layerHeight = 1.0 / numLayers;","\t\tfloat currentLayerHeight = 0.0;","\t\tvec2 dtex = parallaxScale * V.xy / V.z / numLayers;","\t\tvec2 currentTextureCoords = vUv;","\t\tfloat heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\tfor ( int i = 0; i < 30; i += 1 ) {","\t\t\tif ( heightFromTexture <= currentLayerHeight ) {","\t\t\t\tbreak;","\t\t\t}","\t\t\tcurrentLayerHeight += layerHeight;","\t\t\tcurrentTextureCoords -= dtex;","\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\t}","\t\t#ifdef USE_STEEP_PARALLAX","\t\t\treturn currentTextureCoords;","\t\t#elif defined( USE_RELIEF_PARALLAX )","\t\t\tvec2 deltaTexCoord = dtex / 2.0;","\t\t\tfloat deltaHeight = layerHeight / 2.0;","\t\t\tcurrentTextureCoords += deltaTexCoord;","\t\t\tcurrentLayerHeight -= deltaHeight;","\t\t\tconst int numSearches = 5;","\t\t\tfor ( int i = 0; i < numSearches; i += 1 ) {","\t\t\t\tdeltaTexCoord /= 2.0;","\t\t\t\tdeltaHeight /= 2.0;","\t\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\t\t\tif( heightFromTexture > currentLayerHeight ) {","\t\t\t\t\tcurrentTextureCoords -= deltaTexCoord;","\t\t\t\t\tcurrentLayerHeight += deltaHeight;","\t\t\t\t} else {","\t\t\t\t\tcurrentTextureCoords += deltaTexCoord;","\t\t\t\t\tcurrentLayerHeight -= deltaHeight;","\t\t\t\t}","\t\t\t}","\t\t\treturn currentTextureCoords;","\t\t#elif defined( USE_OCLUSION_PARALLAX )","\t\t\tvec2 prevTCoords = currentTextureCoords + dtex;","\t\t\tfloat nextH = heightFromTexture - currentLayerHeight;","\t\t\tfloat prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","\t\t\tfloat weight = nextH / ( nextH - prevH );","\t\t\treturn prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","\t\t#else","\t\t\treturn vUv;","\t\t#endif","\t}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","\tvec2 texDx = dFdx( vUv );","\tvec2 texDy = dFdy( vUv );","\tvec3 vSigmaX = dFdx( surfPosition );","\tvec3 vSigmaY = dFdy( surfPosition );","\tvec3 vR1 = cross( vSigmaY, surfNormal );","\tvec3 vR2 = cross( surfNormal, vSigmaX );","\tfloat fDet = dot( vSigmaX, vR1 );","\tvec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","\tvec3 vProjVtex;","\tvProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","\tvProjVtex.z = dot( surfNormal, viewPosition );","\treturn parallaxMap( vProjVtex );","}","void main() {","\tvec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","\tgl_FragColor = texture2D( map, mapUv );","}"].join("\n")},ko={uniforms:{tDiffuse:{value:null},powRGB:{value:new e.Vector3(2,2,2)},mulRGB:{value:new e.Vector3(1,1,1)},addRGB:{value:new e.Vector3(0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tgl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n")},Vo={uniforms:{tDiffuse:{value:null},resolution:{value:null},pixelSize:{value:1}},vertexShader:["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n")},Go={uniforms:{tDiffuse:{value:null},screenWidth:{value:1024},screenHeight:{value:1024},sampleDistance:{value:.94},waveFactor:{value:.00125}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 color, org, tmp, add;","\tfloat sample_dist, f;","\tvec2 vin;","\tvec2 uv = vUv;","\tadd = color = org = texture2D( tDiffuse, uv );","\tvin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","\tsample_dist = dot( vin, vin ) * 2.0;","\tf = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","\tvec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tcolor = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","\tcolor = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","\tgl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n")},jo={uniforms:{color:{value:null},time:{value:0},tDiffuse:{value:null},tDudv:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")},zo={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","\tvec2 offset = amount * vec2( cos(angle), sin(angle));","\tvec4 cr = texture2D(tDiffuse, vUv + offset);","\tvec4 cga = texture2D(tDiffuse, vUv);","\tvec4 cb = texture2D(tDiffuse, vUv - offset);","\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")},Ho={uniforms:{texture:{value:null},delta:{value:new e.Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","\tvec4 color = vec4( 0.0 );","\tfloat total = 0.0;","\tfloat offset = rand( vUv );","\tfor ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","\t\tfloat percent = ( t + offset - 0.5 ) / ITERATIONS;","\t\tfloat weight = 1.0 - abs( percent );","\t\tcolor += texture2D( texture, vUv + delta * percent ) * weight;","\t\ttotal += weight;","\t}","\tgl_FragColor = color / total;","}"].join("\n")},Wo={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tvec3 c = color.rgb;","\tcolor.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","\tcolor.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","\tcolor.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","\tgl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")},Xo={uniforms:{tDiffuse:{value:null},resolution:{value:new e.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};var Qo,Yo,Jo,Ko,qo,Zo,$o,es,ts,rs,as,is,ns,os,ss,ls,us,cs,hs=e.ShaderChunk.meshphong_frag.slice(0,e.ShaderChunk.meshphong_frag.indexOf("void main() {")),ds=e.ShaderChunk.meshphong_frag.slice(e.ShaderChunk.meshphong_frag.indexOf("void main() {")),fs={uniforms:e.UniformsUtils.merge([e.ShaderLib.phong.uniforms,{thicknessMap:{value:null},thicknessColor:{value:new e.Color(16777215)},thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}}]),vertexShader:["#define USE_UV",e.ShaderChunk.meshphong_vert].join("\n"),fragmentShader:["#define USE_UV","#define SUBSURFACE",hs,"uniform sampler2D thicknessMap;","uniform float thicknessPower;","uniform float thicknessScale;","uniform float thicknessDistortion;","uniform float thicknessAmbient;","uniform float thicknessAttenuation;","uniform vec3 thicknessColor;","void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {","\tvec3 thickness = thicknessColor * texture2D(thicknessMap, uv).r;","\tvec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));","\tfloat scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;","\tvec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;","\treflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;","}",ds.replace("#include <lights_fragment_begin>",(Qo=e.ShaderChunk.lights_fragment_begin,Yo="RE_Direct( directLight, geometry, material, reflectedLight );",Jo=["RE_Direct( directLight, geometry, material, reflectedLight );","#if defined( SUBSURFACE ) && defined( USE_UV )"," RE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","#endif"].join("\n"),Qo.split(Yo).join(Jo)))].join("\n")},ps={uniforms:{uDirLightPos:{value:new e.Vector3},uDirLightColor:{value:new e.Color(15658734)},uAmbientLightColor:{value:new e.Color(328965)},uBaseColor:{value:new e.Color(16777215)}},vertexShader:["varying vec3 vNormal;","varying vec3 vRefract;","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","\tvNormal = normalize( normalMatrix * normal );","\tvec3 I = worldPosition.xyz - cameraPosition;","\tvRefract = refract( normalize( I ), worldNormal, 1.02 );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","varying vec3 vRefract;","void main() {","\tfloat directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","\tfloat intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );","\tintensity += length(lightWeighting) * 0.2;","\tfloat cameraWeighting = dot( normalize( vNormal ), vRefract );","\tintensity += pow( 1.0 - length( cameraWeighting ), 6.0 );","\tintensity = intensity * 0.2 + 0.3;","\tif ( intensity < 0.50 ) {","\t\tgl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );","\t} else {","\t\tgl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );","}","}"].join("\n")},ms={uniforms:{uDirLightPos:{value:new e.Vector3},uDirLightColor:{value:new e.Color(15658734)},uAmbientLightColor:{value:new e.Color(328965)},uBaseColor:{value:new e.Color(15658734)},uLineColor1:{value:new e.Color(8421504)},uLineColor2:{value:new e.Color(0)},uLineColor3:{value:new e.Color(0)},uLineColor4:{value:new e.Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","\tfloat camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);","\tfloat light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","\tgl_FragColor = vec4( uBaseColor, 1.0 );","\tif ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {","\t\tgl_FragColor *= vec4( uLineColor1, 1.0 );","\t}","\tif ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {","\t\tgl_FragColor *= vec4( uLineColor2, 1.0 );","\t}","}"].join("\n")},vs={uniforms:{uDirLightPos:{value:new e.Vector3},uDirLightColor:{value:new e.Color(15658734)},uAmbientLightColor:{value:new e.Color(328965)},uBaseColor:{value:new e.Color(16777215)},uLineColor1:{value:new e.Color(0)},uLineColor2:{value:new e.Color(0)},uLineColor3:{value:new e.Color(0)},uLineColor4:{value:new e.Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","\tfloat directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","\tgl_FragColor = vec4( uBaseColor, 1.0 );","\tif ( length(lightWeighting) < 1.00 ) {","\t\tif ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.75 ) {","\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor2, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.50 ) {","\t\tif (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor3, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.3465 ) {","\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor4, 1.0 );","\t}","\t}","}"].join("\n")},gs={uniforms:{uDirLightPos:{value:new e.Vector3},uDirLightColor:{value:new e.Color(15658734)},uAmbientLightColor:{value:new e.Color(328965)},uBaseColor:{value:new e.Color(16777215)},uLineColor1:{value:new e.Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","\t\tif ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.50 ) {","\t\tif ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","}"].join("\n")},ys={uniforms:{heightMap:{value:null},resolution:{value:new e.Vector2(512,512)},scale:{value:new e.Vector2(1,1)},height:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","\tfloat val = texture2D( heightMap, vUv ).x;","\tfloat valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","\tfloat valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","\tgl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n")},xs={uniforms:{tDiffuse:{value:null},aspect:{value:new e.Vector2(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","\tG[0] = g0,","\tG[1] = g1,","\tG[2] = g2,","\tG[3] = g3,","\tG[4] = g4,","\tG[5] = g5,","\tG[6] = g6,","\tG[7] = g7,","\tG[8] = g8;","\tmat3 I;","\tfloat cnv[9];","\tvec3 sample;","\tfor (float i=0.0; i<3.0; i++) {","\t\tfor (float j=0.0; j<3.0; j++) {","\t\t\tsample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","\t\t\tI[int(i)][int(j)] = length(sample);","\t\t}","\t}","\tfor (int i=0; i<9; i++) {","\t\tfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","\t\tcnv[i] = dp3 * dp3;","\t}","\tfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","\tfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","\tgl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")},bs={uniforms:{u_size:{value:new e.Vector3(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_clim:{value:new e.Vector2(1,1)},u_data:{value:null},u_cmdata:{value:null}},vertexShader:["\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tvarying vec3 v_position;","\t\tvoid main() {","\t\t\t\tmat4 viewtransformf = modelViewMatrix;","\t\t\t\tmat4 viewtransformi = inverse(modelViewMatrix);","\t\t\t\tvec4 position4 = vec4(position, 1.0);","\t\t\t\tvec4 pos_in_cam = viewtransformf * position4;","\t\t\t\tpos_in_cam.z = -pos_in_cam.w;","\t\t\t\tv_nearpos = viewtransformi * pos_in_cam;","\t\t\t\tpos_in_cam.z = pos_in_cam.w;","\t\t\t\tv_farpos = viewtransformi * pos_in_cam;","\t\t\t\tv_position = position;","\t\t\t\tgl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;","\t\t}"].join("\n"),fragmentShader:["\t\tprecision highp float;","\t\tprecision mediump sampler3D;","\t\tuniform vec3 u_size;","\t\tuniform int u_renderstyle;","\t\tuniform float u_renderthreshold;","\t\tuniform vec2 u_clim;","\t\tuniform sampler3D u_data;","\t\tuniform sampler2D u_cmdata;","\t\tvarying vec3 v_position;","\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tconst int MAX_STEPS = 887;\t// 887 for 512^3, 1774 for 1024^3","\t\tconst int REFINEMENT_STEPS = 4;","\t\tconst float relative_step_size = 1.0;","\t\tconst vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);","\t\tconst vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);","\t\tconst vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);","\t\tconst float shininess = 40.0;","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tfloat sample1(vec3 texcoords);","\t\tvec4 apply_colormap(float val);","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);","\t\tvoid main() {","\t\t\t\tvec3 farpos = v_farpos.xyz / v_farpos.w;","\t\t\t\tvec3 nearpos = v_nearpos.xyz / v_nearpos.w;","\t\t\t\tvec3 view_ray = normalize(nearpos.xyz - farpos.xyz);","\t\t\t\tfloat distance = dot(nearpos - v_position, view_ray);","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.x) / view_ray.x,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.x - 0.5 - v_position.x) / view_ray.x));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.y) / view_ray.y,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.y - 0.5 - v_position.y) / view_ray.y));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.z) / view_ray.z,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.z - 0.5 - v_position.z) / view_ray.z));","\t\t\t\tvec3 front = v_position + view_ray * distance;","\t\t\t\tint nsteps = int(-distance / relative_step_size + 0.5);","\t\t\t\tif ( nsteps < 1 )","\t\t\t\t\t\tdiscard;","\t\t\t\tvec3 step = ((v_position - front) / u_size) / float(nsteps);","\t\t\t\tvec3 start_loc = front / u_size;","\t\t\t\tif (u_renderstyle == 0)","\t\t\t\t\t\tcast_mip(start_loc, step, nsteps, view_ray);","\t\t\t\telse if (u_renderstyle == 1)","\t\t\t\t\t\tcast_iso(start_loc, step, nsteps, view_ray);","\t\t\t\tif (gl_FragColor.a < 0.05)","\t\t\t\t\t\tdiscard;","\t\t}","\t\tfloat sample1(vec3 texcoords) {","\t\t\t\t/* Sample float value from a 3D texture. Assumes intensity data. */","\t\t\t\treturn texture(u_data, texcoords.xyz).r;","\t\t}","\t\tvec4 apply_colormap(float val) {","\t\t\t\tval = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);","\t\t\t\treturn texture2D(u_cmdata, vec2(val, 0.5));","\t\t}","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tfloat max_val = -1e6;","\t\t\t\tint max_i = 100;","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > max_val) {","\t\t\t\t\t\t\t\tmax_val = val;","\t\t\t\t\t\t\t\tmax_i = iter;","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t\t\tvec3 iloc = start_loc + step * (float(max_i) - 0.5);","\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\tmax_val = max(max_val, sample1(iloc));","\t\t\t\t\t\tiloc += istep;","\t\t\t\t}","\t\t\t\tgl_FragColor = apply_colormap(max_val);","\t\t}","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tgl_FragColor = vec4(0.0);\t// init transparent","\t\t\t\tvec4 color3 = vec4(0.0);\t// final color","\t\t\t\tvec3 dstep = 1.5 / u_size;\t// step to sample derivative","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfloat low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > low_threshold) {","\t\t\t\t\t\t\t\tvec3 iloc = loc - 0.5 * step;","\t\t\t\t\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\t\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\t\t\t\t\tval = sample1(iloc);","\t\t\t\t\t\t\t\t\t\tif (val > u_renderthreshold) {","\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = add_lighting(val, iloc, dstep, view_ray);","\t\t\t\t\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\t\t\tiloc += istep;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t}","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray)","\t\t{","\t\t\t\tvec3 V = normalize(view_ray);","\t\t\t\tvec3 N;","\t\t\t\tfloat val1, val2;","\t\t\t\tval1 = sample1(loc + vec3(-step[0], 0.0, 0.0));","\t\t\t\tval2 = sample1(loc + vec3(+step[0], 0.0, 0.0));","\t\t\t\tN[0] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, -step[1], 0.0));","\t\t\t\tval2 = sample1(loc + vec3(0.0, +step[1], 0.0));","\t\t\t\tN[1] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, 0.0, -step[2]));","\t\t\t\tval2 = sample1(loc + vec3(0.0, 0.0, +step[2]));","\t\t\t\tN[2] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tfloat gm = length(N); // gradient magnitude","\t\t\t\tN = normalize(N);","\t\t\t\tfloat Nselect = float(dot(N, V) > 0.0);","\t\t\t\tN = (2.0 * Nselect - 1.0) * N;\t// ==\tNselect * N - (1.0-Nselect)*N;","\t\t\t\tvec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tfor (int i=0; i<1; i++)","\t\t\t\t{","\t\t\t\t\t\tvec3 L = normalize(view_ray);\t//lightDirs[i];","\t\t\t\t\t\tfloat lightEnabled = float( length(L) > 0.0 );","\t\t\t\t\t\tL = normalize(L + (1.0 - lightEnabled));","\t\t\t\t\t\tfloat lambertTerm = clamp(dot(N, L), 0.0, 1.0);","\t\t\t\t\t\tvec3 H = normalize(L+V); // Halfway vector","\t\t\t\t\t\tfloat specularTerm = pow(max(dot(H, N), 0.0), shininess);","\t\t\t\t\t\tfloat mask1 = lightEnabled;","\t\t\t\t\t\tambient_color +=\tmask1 * ambient_color;\t// * gl_LightSource[i].ambient;","\t\t\t\t\t\tdiffuse_color +=\tmask1 * lambertTerm;","\t\t\t\t\t\tspecular_color += mask1 * specularTerm * specular_color;","\t\t\t\t}","\t\t\t\tvec4 final_color;","\t\t\t\tvec4 color = apply_colormap(val);","\t\t\t\tfinal_color = color * (ambient_color + diffuse_color) + specular_color;","\t\t\t\tfinal_color.a = color.a;","\t\t\t\treturn final_color;","\t\t}"].join("\n")},As={uniforms:{tDiffuse:{value:null},h:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tfloat hh = h * abs( r - vUv.y );","\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},ws={uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tfloat vv = v * abs( r - vUv.y );","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},Ms={uniforms:{tDiffuse:{value:null},brightness:{value:0},contrast:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tgl_FragColor.rgb += brightness;","\tif (contrast > 0.0) {","\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","\t} else {","\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","\t}","}"].join("\n")},Ss={uniforms:{tDiffuse:{value:null},resolution:{value:new e.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")},Ts={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vUv );","\tgl_FragColor = LinearTosRGB( tex );","}"].join("\n")},Cs={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","\tgl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")},Fs={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","\tvec3 I = worldPosition.xyz - cameraPosition;","\tvReflect = reflect( I, worldNormal );","\tvRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","\tvRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","\tvRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","\tvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","\tvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","\tvec4 refractedColor = vec4( 1.0 );","\trefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","\trefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","\trefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","\tgl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n")},Es={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")},Bs={uniforms:{},vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},Ls={uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},maxblur:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","\tvec4 depth = texture2D( tDepth, vUv );","\tfloat factor = depth.x - focus;","\tvec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","\tgl_FragColor = col;","\tgl_FragColor.a = 1.0;","}"].join("\n")},Ps={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")},Ds={uniforms:{tDiffuse:{value:null},color:{value:new e.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")},Ns=function(){function t(t,r,a){var i=this;this.element=document.createElement("div"),this.element.classList.add(a),this.element.style.pointerEvents="none",this.renderer=r,this.startPoint=new e.Vector2,this.pointTopLeft=new e.Vector2,this.pointBottomRight=new e.Vector2,this.isDown=!1,this.renderer.domElement.addEventListener("pointerdown",(function(e){i.isDown=!0,i.onSelectStart(e)})),this.renderer.domElement.addEventListener("pointermove",(function(e){i.isDown&&i.onSelectMove(e)})),this.renderer.domElement.addEventListener("pointerup",(function(e){i.isDown=!1,i.onSelectOver(e)}))}var r=t.prototype;return r.onSelectStart=function(e){this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY},r.onSelectMove=function(e){this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"},r.onSelectOver=function(){this.element.parentElement.removeChild(this.element)},t}(),Rs=(Ko=new e.Frustum,qo=new e.Vector3,Zo=new e.Vector3,$o=new e.Vector3,es=new e.Vector3,ts=new e.Vector3,rs=new e.Vector3,as=new e.Vector3,is=new e.Vector3,ns=new e.Vector3,os=new e.Vector3,ss=new e.Vector3,ls=new e.Vector3,us=new e.Vector3,cs=new e.Vector3,function(){function t(t,r,a){this.camera=t,this.scene=r,this.startPoint=new e.Vector3,this.endPoint=new e.Vector3,this.collection=[],this.deep=a||Number.MAX_VALUE}var r=t.prototype;return r.select=function(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(Ko,this.scene),this.collection},r.updateFrustum=function(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera)Zo.copy(e),Zo.x=Math.min(e.x,t.x),Zo.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),$o.setFromMatrixPosition(this.camera.matrixWorld),es.copy(Zo),ts.set(t.x,Zo.y,0),rs.copy(t),as.set(Zo.x,t.y,0),es.unproject(this.camera),ts.unproject(this.camera),rs.unproject(this.camera),as.unproject(this.camera),ls.copy(es).sub($o),us.copy(ts).sub($o),cs.copy(rs).sub($o),ls.normalize(),us.normalize(),cs.normalize(),ls.multiplyScalar(this.deep),us.multiplyScalar(this.deep),cs.multiplyScalar(this.deep),ls.add($o),us.add($o),cs.add($o),(r=Ko.planes)[0].setFromCoplanarPoints($o,es,ts),r[1].setFromCoplanarPoints($o,ts,rs),r[2].setFromCoplanarPoints(rs,as,$o),r[3].setFromCoplanarPoints(as,es,$o),r[4].setFromCoplanarPoints(ts,rs,as),r[5].setFromCoplanarPoints(cs,us,ls),r[5].normal.multiplyScalar(-1);else if(this.camera.isOrthographicCamera){var r,a=Math.min(e.x,t.x),i=Math.max(e.y,t.y),n=Math.max(e.x,t.x),o=Math.min(e.y,t.y);es.set(a,i,-1),ts.set(n,i,-1),rs.set(n,o,-1),as.set(a,o,-1),is.set(a,i,1),ns.set(n,i,1),os.set(n,o,1),ss.set(a,o,1),es.unproject(this.camera),ts.unproject(this.camera),rs.unproject(this.camera),as.unproject(this.camera),is.unproject(this.camera),ns.unproject(this.camera),os.unproject(this.camera),ss.unproject(this.camera),(r=Ko.planes)[0].setFromCoplanarPoints(es,is,ns),r[1].setFromCoplanarPoints(ts,ns,os),r[2].setFromCoplanarPoints(os,ss,as),r[3].setFromCoplanarPoints(ss,is,es),r[4].setFromCoplanarPoints(ts,rs,as),r[5].setFromCoplanarPoints(os,ns,is),r[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")},r.searchChildInFrustum=function(e,t){if((t.isMesh||t.isLine||t.isPoints)&&void 0!==t.material&&(null===t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),qo.copy(t.geometry.boundingSphere.center),qo.applyMatrix4(t.matrixWorld),e.containsPoint(qo)&&this.collection.push(t)),t.children.length>0)for(var r=0;r<t.children.length;r++)this.searchChildInFrustum(e,t.children[r])},t}());function _s(){return(_s=w.default(regeneratorRuntime.mark((function e(){var t,r,a,i,n,o,s,l,u,c,h,d,f,p,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=function(){var e=performance.now();if(m>0){var t=(e-m)/1e3;o.stepSimulation(t,10)}m=e;for(var r=0,a=u.length;r<a;r++){var i=u[r];if(i.isInstancedMesh){for(var n=i.instanceMatrix.array,l=c.get(i),h=0;h<l.length;h++){l[h].getMotionState().getWorldTransform(s),Is(s.getOrigin(),s.getRotation(),n,16*h)}i.instanceMatrix.needsUpdate=!0}else if(i.isMesh){c.get(i).getMotionState().getWorldTransform(s);var d=s.getOrigin(),f=s.getRotation();i.position.set(d.x(),d.y(),d.z()),i.quaternion.set(f.x(),f.y(),f.z(),f.w())}}},p=function(e,r,a){if(void 0===a&&(a=0),e.isInstancedMesh){var i=c.get(e)[a];i.setAngularVelocity(new t.btVector3(0,0,0)),i.setLinearVelocity(new t.btVector3(0,0,0)),s.setIdentity(),s.setOrigin(new t.btVector3(r.x,r.y,r.z)),i.setWorldTransform(s)}else if(e.isMesh){var n=c.get(e);n.setAngularVelocity(new t.btVector3(0,0,0)),n.setLinearVelocity(new t.btVector3(0,0,0)),s.setIdentity(),s.setOrigin(new t.btVector3(r.x,r.y,r.z)),n.setWorldTransform(s)}},f=function(e,r,a){for(var i=e.instanceMatrix.array,n=[],s=0;s<e.count;s++){var l=16*s,h=new t.btTransform;h.setFromOpenGLMatrix(i.slice(l,l+16));var d=new t.btDefaultMotionState(h),f=new t.btVector3(0,0,0);a.calculateLocalInertia(r,f);var p=new t.btRigidBodyConstructionInfo(r,d,a,f),m=new t.btRigidBody(p);o.addRigidBody(m),n.push(m)}r>0&&(e.instanceMatrix.setUsage(35048),u.push(e),c.set(e,n))},d=function(e,r,a){var i=e.position,n=e.quaternion,s=new t.btTransform;s.setIdentity(),s.setOrigin(new t.btVector3(i.x,i.y,i.z)),s.setRotation(new t.btQuaternion(n.x,n.y,n.z,n.w));var l=new t.btDefaultMotionState(s),h=new t.btVector3(0,0,0);a.calculateLocalInertia(r,h);var d=new t.btRigidBodyConstructionInfo(r,l,a,h),f=new t.btRigidBody(d);o.addRigidBody(f),r>0&&(u.push(e),c.set(e,f))},h=function(e,t){void 0===t&&(t=0);var r=l(e.geometry);null!==r&&(e.isInstancedMesh?f(e,t,r):e.isMesh&&d(e,t,r))},l=function(e){var r=e.parameters;if("BoxGeometry"===e.type){var a=void 0!==r.width?r.width/2:.5,i=void 0!==r.height?r.height/2:.5,n=void 0!==r.depth?r.depth/2:.5,o=new t.btBoxShape(new t.btVector3(a,i,n));return o.setMargin(.05),o}if("SphereGeometry"===e.type||"IcosahedronGeometry"===e.type){var s=void 0!==r.radius?r.radius:1,l=new t.btSphereShape(s);return l.setMargin(.05),l}return null},"Ammo"in window!=!1){e.next=9;break}return console.error("AmmoPhysics: Couldn't find Ammo.js"),e.abrupt("return");case 9:return e.next=11,Ammo();case 11:return t=e.sent,60,r=new t.btDefaultCollisionConfiguration,a=new t.btCollisionDispatcher(r),i=new t.btDbvtBroadphase,n=new t.btSequentialImpulseConstraintSolver,(o=new t.btDiscreteDynamicsWorld(a,i,n,r)).setGravity(new t.btVector3(0,-9.8,0)),s=new t.btTransform,u=[],c=new WeakMap,m=0,setInterval(v,1e3/60),e.abrupt("return",{addMesh:h,setMeshPosition:p});case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Is(e,t,r,a){var i=t.x(),n=t.y(),o=t.z(),s=t.w(),l=i+i,u=n+n,c=o+o,h=i*l,d=i*u,f=i*c,p=n*u,m=n*c,v=o*c,g=s*l,y=s*u,x=s*c;r[a+0]=1-(p+v),r[a+1]=d+x,r[a+2]=f-y,r[a+3]=0,r[a+4]=d-x,r[a+5]=1-(h+v),r[a+6]=m+g,r[a+7]=0,r[a+8]=f+y,r[a+9]=m-g,r[a+10]=1-(h+p),r[a+11]=0,r[a+12]=e.x(),r[a+13]=e.y(),r[a+14]=e.z(),r[a+15]=1}var Os=function(t){e.Loader.call(this,t)};Os.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Os,load:function(t,r,a,i){var n=this,o=new e.Texture,s=new e.FileLoader(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.setWithCredentials(this.withCredentials),s.load(t,(function(e){o.image=n.parse(e),o.needsUpdate=!0,void 0!==r&&r(o)}),a,i),o},parse:function(e){var t=0,r=1,a=2,i=3,n=9,o=10,s=11,l=48,u=4,c=0,h=1,d=2,f=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var p=new Uint8Array(e),m=0,v={id_length:p[m++],colormap_type:p[m++],image_type:p[m++],colormap_index:p[m++]|p[m++]<<8,colormap_length:p[m++]|p[m++]<<8,colormap_size:p[m++],origin:[p[m++]|p[m++]<<8,p[m++]|p[m++]<<8],width:p[m++]|p[m++]<<8,height:p[m++]|p[m++]<<8,pixel_size:p[m++],flags:p[m++]};!function(e){switch(e.image_type){case r:case n:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case a:case i:case o:case s:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(v),v.id_length+m>e.length&&console.error("THREE.TGALoader: No data."),m+=v.id_length;var g=!1,y=!1,x=!1;switch(v.image_type){case n:g=!0,y=!0;break;case r:y=!0;break;case o:g=!0;break;case a:break;case s:g=!0,x=!0;break;case i:x=!0}var b="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(v.width,v.height):document.createElement("canvas");b.width=v.width,b.height=v.height;var A=b.getContext("2d"),w=A.createImageData(v.width,v.height),M=function(e,t,r,a,i){var n,o,s,l;if(o=r.pixel_size>>3,s=r.width*r.height*o,t&&(l=i.subarray(a,a+=r.colormap_length*(r.colormap_size>>3))),e){var u,c,h;n=new Uint8Array(s);for(var d=0,f=new Uint8Array(o);d<s;)if(c=1+(127&(u=i[a++])),128&u){for(h=0;h<o;++h)f[h]=i[a++];for(h=0;h<c;++h)n.set(f,d+h*o);d+=o*c}else{for(c*=o,h=0;h<c;++h)n[d+h]=i[a++];d+=c}}else n=i.subarray(a,a+=t?r.width*r.height:s);return{pixel_data:n,palettes:l}}(g,y,v,m,p);return function(e,t,r,a,i){var n,o,s,p,m,g;switch((v.flags&l)>>u){default:case d:n=0,s=1,m=t,o=0,p=1,g=r;break;case c:n=0,s=1,m=t,o=r-1,p=-1,g=-1;break;case f:n=t-1,s=-1,m=-1,o=0,p=1,g=r;break;case h:n=t-1,s=-1,m=-1,o=r-1,p=-1,g=-1}if(x)switch(v.pixel_size){case 8:!function(e,t,r,a,i,n,o,s){var l,u,c,h=0,d=v.width;for(c=t;c!==a;c+=r)for(u=i;u!==o;u+=n,h++)l=s[h],e[4*(u+d*c)+0]=l,e[4*(u+d*c)+1]=l,e[4*(u+d*c)+2]=l,e[4*(u+d*c)+3]=255}(e,o,p,g,n,s,m,a);break;case 16:!function(e,t,r,a,i,n,o,s){var l,u,c=0,h=v.width;for(u=t;u!==a;u+=r)for(l=i;l!==o;l+=n,c+=2)e[4*(l+h*u)+0]=s[c+0],e[4*(l+h*u)+1]=s[c+0],e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+3]=s[c+1]}(e,o,p,g,n,s,m,a);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(v.pixel_size){case 8:!function(e,t,r,a,i,n,o,s,l){var u,c,h,d=l,f=0,p=v.width;for(h=t;h!==a;h+=r)for(c=i;c!==o;c+=n,f++)u=s[f],e[4*(c+p*h)+3]=255,e[4*(c+p*h)+2]=d[3*u+0],e[4*(c+p*h)+1]=d[3*u+1],e[4*(c+p*h)+0]=d[3*u+2]}(e,o,p,g,n,s,m,a,i);break;case 16:!function(e,t,r,a,i,n,o,s){var l,u,c,h=0,d=v.width;for(c=t;c!==a;c+=r)for(u=i;u!==o;u+=n,h+=2)l=s[h+0]+(s[h+1]<<8),e[4*(u+d*c)+0]=(31744&l)>>7,e[4*(u+d*c)+1]=(992&l)>>2,e[4*(u+d*c)+2]=(31&l)>>3,e[4*(u+d*c)+3]=32768&l?0:255}(e,o,p,g,n,s,m,a);break;case 24:!function(e,t,r,a,i,n,o,s){var l,u,c=0,h=v.width;for(u=t;u!==a;u+=r)for(l=i;l!==o;l+=n,c+=3)e[4*(l+h*u)+3]=255,e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+1]=s[c+1],e[4*(l+h*u)+0]=s[c+2]}(e,o,p,g,n,s,m,a);break;case 32:!function(e,t,r,a,i,n,o,s){var l,u,c=0,h=v.width;for(u=t;u!==a;u+=r)for(l=i;l!==o;l+=n,c+=4)e[4*(l+h*u)+2]=s[c+0],e[4*(l+h*u)+1]=s[c+1],e[4*(l+h*u)+0]=s[c+2],e[4*(l+h*u)+3]=s[c+3]}(e,o,p,g,n,s,m,a);break;default:console.error("THREE.TGALoader: Format not supported.")}}(w.data,v.width,v.height,M.pixel_data,M.palettes),A.putImageData(w,0,0),b}});var Us=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.load=function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("text"),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},a.parse=function(t){t=t.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim();for(var r=null,a=null,i=new e.Vector3(0,0,0),n=new e.Vector3(1,1,1),o=t.split(/[\n\r]+/g),s=null,l=0,u=0,c=o.length;u<c;u++){var h=o[u].trim(),d=h.split(/\s/g);switch(d[0]){case"TITLE":r=h.substring(7,h.length-1);break;case"LUT_3D_SIZE":var f=d[1];a=parseFloat(f),s=new Uint8Array(a*a*a*3);break;case"DOMAIN_MIN":i.x=parseFloat(d[1]),i.y=parseFloat(d[2]),i.z=parseFloat(d[3]);break;case"DOMAIN_MAX":n.x=parseFloat(d[1]),n.y=parseFloat(d[2]),n.z=parseFloat(d[3]);break;default:var p=parseFloat(d[0]),m=parseFloat(d[1]),v=parseFloat(d[2]);if(p>1||p<0||m>1||m<0||v>1||v<0)throw new Error("LUTCubeLoader : Non normalized values not supported.");s[l+0]=255*p,s[l+1]=255*m,s[l+2]=255*v,l+=3}}var g=new e.DataTexture;g.image.data=s,g.image.width=a,g.image.height=a*a,g.format=e.RGBFormat,g.type=e.UnsignedByteType,g.magFilter=e.LinearFilter,g.minFilter=e.LinearFilter,g.wrapS=e.ClampToEdgeWrapping,g.wrapT=e.ClampToEdgeWrapping,g.generateMipmaps=!1;var y=new e.DataTexture3D;return y.image.data=s,y.image.width=a,y.image.height=a,y.image.depth=a,y.format=e.RGBFormat,y.type=e.UnsignedByteType,y.magFilter=e.LinearFilter,y.minFilter=e.LinearFilter,y.wrapS=e.ClampToEdgeWrapping,y.wrapT=e.ClampToEdgeWrapping,y.wrapR=e.ClampToEdgeWrapping,y.generateMipmaps=!1,{title:r,size:a,domainMin:i,domainMax:n,texture:g,texture3D:y}},r}(e.Loader),ks=function(t){e.Loader.call(this,t)};ks.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:ks,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){var r=t,a=0,i=new Int8Array(new Int16Array([1]).buffer)[0]>0,n={};var o,s=function(e,t){null==t&&(t=1);var n=1,o=Uint8Array;switch(e){case"uchar":break;case"schar":o=Int8Array;break;case"ushort":o=Uint16Array,n=2;break;case"sshort":o=Int16Array,n=2;break;case"uint":o=Uint32Array,n=4;break;case"sint":o=Int32Array,n=4;break;case"float":o=Float32Array,n=4;break;case"complex":case"double":o=Float64Array,n=8}var s=new o(r.slice(a,a+=t*n));return true!=i&&(s=function(e,t){for(var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=0;a<e.byteLength;a+=t)for(var i=a+t-1,n=a;i>n;i--,n++){var o=r[n];r[n]=r[i],r[i]=o}return e}(s,n)),1==t?s[0]:s}("uchar",t.byteLength),u=s.length,c=null,h=0;for(o=1;o<u;o++)if(10==s[o-1]&&10==s[o]){c=this.parseChars(s,0,o-2),h=o+1;break}!function(t){var r,a,i,o,s,l,u,c,h;for(c=0,h=(l=t.split(/\r?\n/)).length;c<h;c++)(s=l[c]).match(/NRRD\d+/)?n.isNrrd=!0:s.match(/^#/)||(u=s.match(/(.*):(.*)/))&&(a=u[1].trim(),r=u[2].trim(),(i=ks.prototype.fieldFunctions[a])?i.call(n,r):n[a]=r);if(!n.isNrrd)throw new Error("Not an NRRD file");if("bz2"===n.encoding||"bzip2"===n.encoding)throw new Error("Bzip is not supported");if(!n.vectors&&(n.vectors=[new e.Vector3(1,0,0),new e.Vector3(0,1,0),new e.Vector3(0,0,1)],n.spacings))for(o=0;o<=2;o++)isNaN(n.spacings[o])||n.vectors[o].multiplyScalar(n.spacings[o])}(c);r=s.subarray(h);if("gz"===n.encoding.substring(0,2))r=l.gunzipSync(new Uint8Array(r));else if("ascii"===n.encoding||"text"===n.encoding||"txt"===n.encoding||"hex"===n.encoding)r=function(e,t,r){var a,i="";t=t||0,r=r||e.length;var o=n.sizes.reduce((function(e,t){return e*t}),1),s=10;"hex"===n.encoding&&(s=16);var l=new n.__array(o),u=0,c=parseInt;n.__array!==Float32Array&&n.__array!==Float64Array||(c=parseFloat);for(var h=t;h<r;h++)((a=e[h])<9||a>13)&&32!==a?i+=String.fromCharCode(a):(""!==i&&(l[u]=c(i,s),u++),i="");return""!==i&&(l[u]=c(i,s),u++),l}(r);else if("raw"===n.encoding){for(var d=new Uint8Array(r.length),f=0;f<r.length;f++)d[f]=r[f];r=d}r=r.buffer;var p=new W;p.header=n,p.data=new n.__array(r);var m=p.computeMinMax(),v=m[0],g=m[1];p.windowLow=v,p.windowHigh=g,p.dimensions=[n.sizes[0],n.sizes[1],n.sizes[2]],p.xLength=p.dimensions[0],p.yLength=p.dimensions[1],p.zLength=p.dimensions[2];var y=new e.Vector3(n.vectors[0][0],n.vectors[0][1],n.vectors[0][2]).length(),x=new e.Vector3(n.vectors[1][0],n.vectors[1][1],n.vectors[1][2]).length(),b=new e.Vector3(n.vectors[2][0],n.vectors[2][1],n.vectors[2][2]).length();p.spacing=[y,x,b],p.matrix=new e.Matrix4;var A=1,w=1;if("left-posterior-superior"==n.space?(A=-1,w=-1):"left-anterior-superior"===n.space&&(A=-1),n.vectors){var M=n.vectors;p.matrix.set(A*M[0][0],A*M[1][0],A*M[2][0],0,w*M[0][1],w*M[1][1],w*M[2][1],0,1*M[0][2],1*M[1][2],1*M[2][2],0,0,0,0,1)}else p.matrix.set(A,0,0,0,0,w,0,0,0,0,1,0,0,0,0,1);return p.inverseMatrix=new e.Matrix4,p.inverseMatrix.copy(p.matrix).invert(),p.RASDimensions=new e.Vector3(p.xLength,p.yLength,p.zLength).applyMatrix4(p.matrix).round().toArray().map(Math.abs),p.lowerThreshold===-1/0&&(p.lowerThreshold=v),p.upperThreshold===1/0&&(p.upperThreshold=g),p},parseChars:function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var a="",i=0;for(i=t;i<r;++i)a+=String.fromCharCode(e[i]);return a},fieldFunctions:{type:function(e){switch(e){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+e)}return this.type=e},endian:function(e){return this.endian=e},encoding:function(e){return this.encoding=e},dimension:function(e){return this.dim=parseInt(e,10)},sizes:function(e){var t;return this.sizes=function(){var r,a,i,n;for(n=[],r=0,a=(i=e.split(/\s+/)).length;r<a;r++)t=i[r],n.push(parseInt(t,10));return n}()},space:function(e){return this.space=e},"space origin":function(e){return this.space_origin=e.split("(")[1].split(")")[0].split(",")},"space directions":function(e){var t,r,a;return r=e.match(/\(.*?\)/g),this.vectors=function(){var e,i,n;for(n=[],e=0,i=r.length;e<i;e++)a=r[e],n.push(function(){var e,r,i,n;for(n=[],e=0,r=(i=a.slice(1,-1).split(/,/)).length;e<r;e++)t=i[e],n.push(parseFloat(t));return n}());return n}()},spacings:function(e){var t,r;return r=e.split(/\s+/),this.spacings=function(){var e,a,i=[];for(e=0,a=r.length;e<a;e++)t=r[e],i.push(parseFloat(t));return i}()}}});var Vs=function(t){e.Loader.call(this,t)};Vs.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Vs,load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){function r(e,t,r){for(var a=0,i=e.length;a<i;a++)if(e[a]!==t.getUint8(r+a,!1))return!1;return!0}var a,i=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(t);return function(e){var t;if(50,84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var a=[115,111,108,105,100],i=0;i<5;i++)if(r(a,t,i))return!1;return!0}(i)?function(t){for(var r,a,i,n,o,s,l,u,c=new DataView(t),h=c.getUint32(80,!0),d=!1,f=0;f<70;f++)1129270351==c.getUint32(f,!1)&&82==c.getUint8(f+4)&&61==c.getUint8(f+5)&&(d=!0,n=new Float32Array(3*h*3),o=c.getUint8(f+6)/255,s=c.getUint8(f+7)/255,l=c.getUint8(f+8)/255,u=c.getUint8(f+9)/255);for(var p=new e.BufferGeometry,m=new Float32Array(3*h*3),v=new Float32Array(3*h*3),g=0;g<h;g++){var y=84+50*g,x=c.getFloat32(y,!0),b=c.getFloat32(y+4,!0),A=c.getFloat32(y+8,!0);if(d){var w=c.getUint16(y+48,!0);0==(32768&w)?(r=(31&w)/31,a=(w>>5&31)/31,i=(w>>10&31)/31):(r=o,a=s,i=l)}for(var M=1;M<=3;M++){var S=y+12*M,T=3*g*3+3*(M-1);m[T]=c.getFloat32(S,!0),m[T+1]=c.getFloat32(S+4,!0),m[T+2]=c.getFloat32(S+8,!0),v[T]=x,v[T+1]=b,v[T+2]=A,d&&(n[T]=r,n[T+1]=a,n[T+2]=i)}}return p.setAttribute("position",new e.BufferAttribute(m,3)),p.setAttribute("normal",new e.BufferAttribute(v,3)),d&&(p.setAttribute("color",new e.BufferAttribute(n,3)),p.hasColors=!0,p.alpha=u),p}(i):function(t){for(var r,a=new e.BufferGeometry,i=/solid([\s\S]*?)endsolid/g,n=/facet([\s\S]*?)endfacet/g,o=0,s=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,l=new RegExp("vertex"+s+s+s,"g"),u=new RegExp("normal"+s+s+s,"g"),c=[],h=[],d=new e.Vector3,f=0,p=0,m=0;null!==(r=i.exec(t));){p=m;for(var v=r[0];null!==(r=n.exec(v));){for(var g=0,y=0,x=r[0];null!==(r=u.exec(x));)d.x=parseFloat(r[1]),d.y=parseFloat(r[2]),d.z=parseFloat(r[3]),y++;for(;null!==(r=l.exec(x));)c.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),h.push(d.x,d.y,d.z),g++,m++;1!==y&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+o),3!==g&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+o),o++}var b=p,A=m-p;a.addGroup(b,A,f),f++}return a.setAttribute("position",new e.Float32BufferAttribute(c,3)),a.setAttribute("normal",new e.Float32BufferAttribute(h,3)),a}("string"!=typeof(a=t)?e.LoaderUtils.decodeText(new Uint8Array(a)):a)}});var Gs=function(t){e.Loader.call(this,t)};Gs.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Gs,load:function(t,r,a,i){var n=this,o=""===this.path?e.LoaderUtils.extractUrlBase(t):this.path,s=new e.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var r=e.split("\n"),a={},i=/\s+/,n={},o=0;o<r.length;o++){var s=r[o];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var l=s.indexOf(" "),u=l>=0?s.substring(0,l):s;u=u.toLowerCase();var c=l>=0?s.substring(l+1):"";if(c=c.trim(),"newmtl"===u)a={name:c},n[c]=a;else if("ka"===u||"kd"===u||"ks"===u||"ke"===u){var h=c.split(i,3);a[u]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else a[u]=c}}var d=new Gs.MaterialCreator(this.resourcePath||t,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(n),d}}),(Gs.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:e.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:e.RepeatWrapping}).prototype={constructor:Gs.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var a=e[r],i={};for(var n in t[r]=i,a){var o=!0,s=a[n],l=n.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(i[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(t){var r=this,a=this.materialsInfo[t],i={name:t,side:this.side};function n(e,t){if(!i[e]){var a,n,o=r.getTextureParams(t,i),s=r.loadTexture((a=r.baseUrl,"string"!=typeof(n=o.url)||""===n?"":/^https?:\/\//i.test(n)?n:a+n));s.repeat.copy(o.scale),s.offset.copy(o.offset),s.wrapS=r.wrap,s.wrapT=r.wrap,i[e]=s}}for(var o in a){var s,l=a[o];if(""!==l)switch(o.toLowerCase()){case"kd":i.color=(new e.Color).fromArray(l);break;case"ks":i.specular=(new e.Color).fromArray(l);break;case"ke":i.emissive=(new e.Color).fromArray(l);break;case"map_kd":n("map",l);break;case"map_ks":n("specularMap",l);break;case"map_ke":n("emissiveMap",l);break;case"norm":n("normalMap",l);break;case"map_bump":case"bump":n("bumpMap",l);break;case"map_d":n("alphaMap",l),i.transparent=!0;break;case"ns":i.shininess=parseFloat(l);break;case"d":(s=parseFloat(l))<1&&(i.opacity=s,i.transparent=!0);break;case"tr":s=parseFloat(l),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(i.opacity=1-s,i.transparent=!0)}}return this.materials[t]=new e.MeshPhongMaterial(i),this.materials[t]},getTextureParams:function(t,r){var a,i={scale:new e.Vector2(1,1),offset:new e.Vector2(0,0)},n=t.split(/\s+/);return(a=n.indexOf("-bm"))>=0&&(r.bumpScale=parseFloat(n[a+1]),n.splice(a,2)),(a=n.indexOf("-s"))>=0&&(i.scale.set(parseFloat(n[a+1]),parseFloat(n[a+2])),n.splice(a,4)),(a=n.indexOf("-o"))>=0&&(i.offset.set(parseFloat(n[a+1]),parseFloat(n[a+2])),n.splice(a,4)),i.url=n.join(" ").trim(),i},loadTexture:function(t,r,a,i,n){var o,s=void 0!==this.manager?this.manager:e.DefaultLoadingManager,l=s.getHandler(t);return null===l&&(l=new e.TextureLoader(s)),l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin),o=l.load(t,a,i,n),void 0!==r&&(o.mapping=r),o}};var js,zs,Hs,Ws,Xs,Qs,Ys=(js=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},zs=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),Hs=function e(){js(this,e),this.boneName="",this.BoneIndex=0,this.Indeces=[],this.Weights=[],this.initMatrix=null,this.OffsetMatrix=null},Ws=function e(){js(this,e),this.animeName="",this.boneName="",this.targetBone=null,this.keyType=4,this.frameStartLv=0,this.keyFrames=[],this.InverseMx=null},Xs=function(){function t(e){js(this,t),this.fps=30,this.name="xanimation",this.length=0,this.hierarchy=[],this.putFlags=e,void 0===this.putFlags.putPos&&(this.putFlags.putPos=!0),void 0===this.putFlags.putRot&&(this.putFlags.putRot=!0),void 0===this.putFlags.putScl&&(this.putFlags.putScl=!0)}return zs(t,[{key:"make",value:function(e){for(var t=0;t<e.length;t++)this.hierarchy.push(this.makeBonekeys(e[t]));this.length=this.hierarchy[0].keys[this.hierarchy[0].keys.length-1].time}},{key:"clone",value:function(){return Object.assign({},this)}},{key:"makeBonekeys",value:function(e){var t={};return t.name=e.boneName,t.parent="",t.keys=this.keyFrameRefactor(e),t.copy=function(){return Object.assign({},this)},t}},{key:"keyFrameRefactor",value:function(t){for(var r=[],a=0;a<t.keyFrames.length;a++){var i={};i.time=t.keyFrames[a].time*this.fps,t.keyFrames[a].pos&&this.putFlags.putPos&&(i.pos=t.keyFrames[a].pos),t.keyFrames[a].rot&&this.putFlags.putRot&&(i.rot=t.keyFrames[a].rot),t.keyFrames[a].scl&&this.putFlags.putScl&&(i.scl=t.keyFrames[a].scl),t.keyFrames[a].matrix&&(i.matrix=t.keyFrames[a].matrix,this.putFlags.putPos&&(i.pos=(new e.Vector3).setFromMatrixPosition(i.matrix)),this.putFlags.putRot&&(i.rot=(new e.Quaternion).setFromRotationMatrix(i.matrix)),this.putFlags.putScl&&(i.scl=(new e.Vector3).setFromMatrixScale(i.matrix))),r.push(i)}return r}}]),t}(),Qs=function e(){js(this,e),this.index=0,this.Frame=0,this.time=0,this.matrix=null},function(){function t(r){e.Loader.call(this,r),js(this,t),this.debug=!1,this.texloader=new e.TextureLoader(this.manager),this.url="",this._putMatLength=0,this._nowMat=null,this._nowFrameName="",this.frameHierarchie=[],this.Hierarchies={},this.HieStack=[],this._currentObject={},this._currentFrame={},this._data=null,this.onLoad=null,this.IsUvYReverse=!0,this.Meshes=[],this.animations=[],this.animTicksPerSecond=30,this._currentGeo=null,this._currentAnime=null,this._currentAnimeFrames=null}return zs(t,[{key:"_setArgOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){for(var r=t;r<e.length;r++)switch(r){case 0:this.url=e[r];break;case 1:this.options=e[r]}void 0===this.options&&(this.options={})}}},{key:"load",value:function(t,r,a,i){var n=this;this._setArgOption(t);var o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(this.url,(function(e){try{n.parse(e,r)}catch(e){i?i(e):console.error(e),n.manager.itemError(n.url)}}),a,i)}},{key:"_readLine",value:function(e){for(var t=0;;){var r=-1;if(-1===(r=e.indexOf("//",t))&&(r=e.indexOf("#",t)),!(r>-1&&r<2))break;var a=-1;t=(a=e.indexOf("\r\n",t))>0?a+2:(a=e.indexOf("\r",t))>0?a+1:e.indexOf("\n",t)+1}return e.substr(t)}},{key:"_readLine",value:function(e){for(var t=0;;){var r=-1;if(-1===(r=e.indexOf("//",t))&&(r=e.indexOf("#",t)),!(r>-1&&r<2))break;var a=-1;t=(a=e.indexOf("\r\n",t))>0?a+2:(a=e.indexOf("\r",t))>0?a+1:e.indexOf("\n",t)+1}return e.substr(t)}},{key:"_isBinary",value:function(e){var t=new DataView(e);if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;for(var r=t.byteLength,a=0;a<r;a++)if(t.getUint8(a,!1)>127)return!0;return!1}},{key:"_ensureBinary",value:function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}},{key:"_ensureString",value:function(t){return"string"!=typeof t?e.LoaderUtils.decodeText(new Uint8Array(t)):t}},{key:"parse",value:function(e,t){var r=this._ensureBinary(e);return this._data=this._ensureString(e),this.onLoad=t,this._isBinary(r)?this._parseBinary(r):this._parseASCII()}},{key:"_parseBinary",value:function(t){return this._parseASCII(e.LoaderUtils.decodeText(new Uint8Array(t)))}},{key:"_parseASCII",value:function(){var t;t=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:e.LoaderUtils.extractUrlBase(this.url),this.texloader.setPath(t).setCrossOrigin(this.crossOrigin),this.Hierarchies.children=[],this._hierarchieParse(this.Hierarchies,16),this._changeRoot(),this._currentObject=this.Hierarchies.children.shift(),this._mainloop()}},{key:"_hierarchieParse",value:function(e,t){for(var r=t;;){var a=this._data.indexOf("{",r)+1,i=this._data.indexOf("}",r),n=this._data.indexOf("{",a)+1;if(!(a>0&&i>a)){r=-1===a?this._data.length:i+1;break}var o={children:[]},s=this._readLine(this._data.substr(r,a-r-1)).trim(),l=s.split(/ /g);if(l.length>0?(o.type=l[0],l.length>=2?o.name=l[1]:o.name=l[0]+this.Hierarchies.children.length):(o.name=s,o.type=""),"Animation"===o.type){o.data=this._data.substr(n,i-n).trim();var u=this._hierarchieParse(o,i+1);r=u.end,o.children=u.parent.children}else{var c=this._data.lastIndexOf(";",n>0?Math.min(n,i):i);if(o.data=this._data.substr(a,c-a).trim(),n<=0||i<n)r=i+1;else{var h=Math.max(c+1,a),d=this._hierarchieParse(o,h);r=d.end,o.children=d.parent.children}}o.parent=e,"template"!=o.type&&e.children.push(o)}return{parent:e,end:r}}},{key:"_mainloop",value:function(){var e=this;this._mainProc(),this._currentObject.parent||this._currentObject.children.length>0||!this._currentObject.worked?setTimeout((function(){e._mainloop()}),1):setTimeout((function(){e.onLoad({models:e.Meshes,animations:e.animations})}),1)}},{key:"_mainProc",value:function(){for(var e=!1;;){if(!this._currentObject.worked){switch(this._currentObject.type){case"template":break;case"AnimTicksPerSecond":this.animTicksPerSecond=parseInt(this._currentObject.data);break;case"Frame":this._setFrame();break;case"FrameTransformMatrix":this._setFrameTransformMatrix();break;case"Mesh":this._changeRoot(),this._currentGeo={},this._currentGeo.name=this._currentObject.name.trim(),this._currentGeo.parentName=this._getParentName(this._currentObject).trim(),this._currentGeo.VertexSetedBoneCount=[],this._currentGeo.GeometryData={vertices:[],normals:[],uvs:[],skinIndices:[],skinWeights:[],indices:[],materialIndices:[]},this._currentGeo.Materials=[],this._currentGeo.normalVectors=[],this._currentGeo.BoneInfs=[],this._currentGeo.baseFrame=this._currentFrame,this._makeBoneFrom_CurrentFrame(),this._readVertexDatas(),e=!0;break;case"MeshNormals":this._readVertexDatas();break;case"MeshTextureCoords":this._setMeshTextureCoords();break;case"VertexDuplicationIndices":break;case"MeshMaterialList":this._setMeshMaterialList();break;case"Material":this._setMaterial();break;case"SkinWeights":this._setSkinWeights();break;case"AnimationSet":this._changeRoot(),this._currentAnime={},this._currentAnime.name=this._currentObject.name.trim(),this._currentAnime.AnimeFrames=[];break;case"Animation":this._currentAnimeFrames&&this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=new Ws,this._currentAnimeFrames.boneName=this._currentObject.data.trim();break;case"AnimationKey":this._readAnimationKey(),e=!0}this._currentObject.worked=!0}if(this._currentObject.children.length>0){if(this._currentObject=this._currentObject.children.shift(),this.debug&&console.log("processing "+this._currentObject.name),e)break}else if(this._currentObject.worked&&this._currentObject.parent&&!this._currentObject.parent.parent&&this._changeRoot(),this._currentObject.parent?this._currentObject=this._currentObject.parent:e=!0,e)break}}},{key:"_changeRoot",value:function(){null!=this._currentGeo&&this._currentGeo.name&&this._makeOutputGeometry(),this._currentGeo={},null!=this._currentAnime&&this._currentAnime.name&&(this._currentAnimeFrames&&(this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=null),this._makeOutputAnimation()),this._currentAnime={}}},{key:"_getParentName",value:function(e){return e.parent?e.parent.name?e.parent.name:this._getParentName(e.parent):""}},{key:"_setFrame",value:function(){this._nowFrameName=this._currentObject.name.trim(),this._currentFrame={},this._currentFrame.name=this._nowFrameName,this._currentFrame.children=[],this._currentObject.parent&&this._currentObject.parent.name&&(this._currentFrame.parentName=this._currentObject.parent.name),this.frameHierarchie.push(this._nowFrameName),this.HieStack[this._nowFrameName]=this._currentFrame}},{key:"_setFrameTransformMatrix",value:function(){this._currentFrame.FrameTransformMatrix=new e.Matrix4;var t=this._currentObject.data.split(",");this._ParseMatrixData(this._currentFrame.FrameTransformMatrix,t),this._makeBoneFrom_CurrentFrame()}},{key:"_makeBoneFrom_CurrentFrame",value:function(){if(this._currentFrame.FrameTransformMatrix){var t=new e.Bone;if(t.name=this._currentFrame.name,t.applyMatrix4(this._currentFrame.FrameTransformMatrix),t.matrixWorld=t.matrix,t.FrameTransformMatrix=this._currentFrame.FrameTransformMatrix,this._currentFrame.putBone=t,this._currentFrame.parentName)for(var r in this.HieStack)this.HieStack[r].name===this._currentFrame.parentName&&this.HieStack[r].putBone.add(this._currentFrame.putBone)}}},{key:"_readVertexDatas",value:function(){for(var e=0,t=0,r=0,a=0;;){var i=!1;if(0===r)e=this._readInt1(e).endRead,r=1,(a=this._currentObject.data.indexOf(";;",e)+1)<=0&&(a=this._currentObject.data.length);else{var n=0;switch(t){case 0:n=this._currentObject.data.indexOf(",",e)+1;break;case 1:n=this._currentObject.data.indexOf(";,",e)+1}switch((0===n||n>a)&&(n=a,r=0,i=!0),this._currentObject.type){case"Mesh":switch(t){case 0:this._readVertex1(this._currentObject.data.substr(e,n-e));break;case 1:this._readFace1(this._currentObject.data.substr(e,n-e))}break;case"MeshNormals":switch(t){case 0:this._readNormalVector1(this._currentObject.data.substr(e,n-e))}}e=n+1,i&&t++}if(e>=this._currentObject.data.length)break}}},{key:"_readInt1",value:function(e){var t=this._currentObject.data.indexOf(";",e);return{refI:parseInt(this._currentObject.data.substr(e,t-e)),endRead:t+1}}},{key:"_readVertex1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.GeometryData.vertices.push(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])),this._currentGeo.GeometryData.skinIndices.push(0,0,0,0),this._currentGeo.GeometryData.skinWeights.push(1,0,0,0),this._currentGeo.VertexSetedBoneCount.push(0)}},{key:"_readFace1",value:function(e){var t=this._readLine(e.trim()).substr(2,e.length-4).split(",");this._currentGeo.GeometryData.indices.push(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))}},{key:"_readNormalVector1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.GeometryData.normals.push(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))}},{key:"_buildGeometry",value:function(){for(var t=new e.BufferGeometry,r=[],a=[],i=[],n=[],o=[],s=this._currentGeo.GeometryData,l=0,u=s.indices.length;l<u;l++){var c=2*s.indices[l],h=3*s.indices[l],d=4*s.indices[l];r.push(s.vertices[h],s.vertices[h+1],s.vertices[h+2]),a.push(s.normals[h],s.normals[h+1],s.normals[h+2]),n.push(s.skinIndices[d],s.skinIndices[d+1],s.skinIndices[d+2],s.skinIndices[d+3]),o.push(s.skinWeights[d],s.skinWeights[d+1],s.skinWeights[d+2],s.skinWeights[d+3]),i.push(s.uvs[c],s.uvs[c+1])}return t.setAttribute("position",new e.Float32BufferAttribute(r,3)),t.setAttribute("normal",new e.Float32BufferAttribute(a,3)),t.setAttribute("uv",new e.Float32BufferAttribute(i,2)),t.setAttribute("skinIndex",new e.Uint16BufferAttribute(n,4)),t.setAttribute("skinWeight",new e.Float32BufferAttribute(o,4)),this._computeGroups(t,s.materialIndices),t}},{key:"_computeGroups",value:function(e,t){for(var r,a=[],n=void 0,o=0;o<t.length;o++){var s=t[o];s!==n&&(n=s,void 0!==r&&(r.count=3*o-r.start,a.push(r)),r={start:3*o,materialIndex:n})}void 0!==r&&(r.count=3*i-r.start,a.push(r)),e.groups=a}},{key:"_setMeshTextureCoords",value:function(){for(var e=0,t=0,r=0;;){switch(t){case 0:if(0===r)e=this._readInt1(0).endRead,r=1;else{var a=this._currentObject.data.indexOf(",",e)+1;0===a&&(a=this._currentObject.data.length,t=2,r=0);var i=this._currentObject.data.substr(e,a-e),n=this._readLine(i.trim()).split(";");this.IsUvYReverse?this._currentGeo.GeometryData.uvs.push(parseFloat(n[0]),1-parseFloat(n[1])):this._currentGeo.GeometryData.uvs.push(parseFloat(n[0]),parseFloat(n[1])),e=a+1}}if(e>=this._currentObject.data.length)break}}},{key:"_setMeshMaterialList",value:function(){for(var e=0,t=0,r=0;;){if(r<2)e=this._readInt1(e).endRead,r++;else{var a=this._currentObject.data.indexOf(";",e);-1===a&&(a=this._currentObject.data.length,t=3,r=0);for(var i=this._currentObject.data.substr(e,a-e),n=this._readLine(i.trim()).split(","),o=0;o<n.length;o++)this._currentGeo.GeometryData.materialIndices[o]=parseInt(n[o]);e=this._currentObject.data.length}if(e>=this._currentObject.data.length||t>=3)break}}},{key:"_setMaterial",value:function(){var t=new e.MeshPhongMaterial({color:16777215*Math.random()});t.side=e.FrontSide,t.name=this._currentObject.name;var r=0,a=this._currentObject.data.indexOf(";;",r),i=this._currentObject.data.substr(r,a-r),n=this._readLine(i.trim()).split(";");t.color.r=parseFloat(n[0]),t.color.g=parseFloat(n[1]),t.color.b=parseFloat(n[2]),r=a+2,a=this._currentObject.data.indexOf(";",r),i=this._currentObject.data.substr(r,a-r),t.shininess=parseFloat(this._readLine(i)),r=a+1,a=this._currentObject.data.indexOf(";;",r),i=this._currentObject.data.substr(r,a-r);var o=this._readLine(i.trim()).split(";");t.specular.r=parseFloat(o[0]),t.specular.g=parseFloat(o[1]),t.specular.b=parseFloat(o[2]),r=a+2,-1===(a=this._currentObject.data.indexOf(";;",r))&&(a=this._currentObject.data.length),i=this._currentObject.data.substr(r,a-r);var s=this._readLine(i.trim()).split(";");t.emissive.r=parseFloat(s[0]),t.emissive.g=parseFloat(s[1]),t.emissive.b=parseFloat(s[2]);for(var l=null;this._currentObject.children.length>0;){l=this._currentObject.children.shift(),this.debug&&console.log("processing "+l.name);var u=l.data.substr(1,l.data.length-2);switch(l.type){case"TextureFilename":t.map=this.texloader.load(u);break;case"BumpMapFilename":t.bumpMap=this.texloader.load(u),t.bumpScale=.05;break;case"NormalMapFilename":t.normalMap=this.texloader.load(u),t.normalScale=new e.Vector2(2,2);break;case"EmissiveMapFilename":t.emissiveMap=this.texloader.load(u);break;case"LightMapFilename":t.lightMap=this.texloader.load(u)}}this._currentGeo.Materials.push(t)}},{key:"_setSkinWeights",value:function(){var t=new Hs,r=0,a=this._currentObject.data.indexOf(";",r),i=this._currentObject.data.substr(r,a-r);r=a+1,t.boneName=i.substr(1,i.length-2),t.BoneIndex=this._currentGeo.BoneInfs.length,r=(a=this._currentObject.data.indexOf(";",r))+1,a=this._currentObject.data.indexOf(";",r),i=this._currentObject.data.substr(r,a-r);for(var n=this._readLine(i.trim()).split(","),o=0;o<n.length;o++)t.Indeces.push(parseInt(n[o]));r=a+1,a=this._currentObject.data.indexOf(";",r),i=this._currentObject.data.substr(r,a-r);for(var s=this._readLine(i.trim()).split(","),l=0;l<s.length;l++)t.Weights.push(parseFloat(s[l]));r=a+1,(a=this._currentObject.data.indexOf(";",r))<=0&&(a=this._currentObject.data.length),i=this._currentObject.data.substr(r,a-r);var u=this._readLine(i.trim()).split(",");t.OffsetMatrix=new e.Matrix4,this._ParseMatrixData(t.OffsetMatrix,u),this._currentGeo.BoneInfs.push(t)}},{key:"_makePutBoneList",value:function(t,r){var a=!1;for(var i in this.HieStack)if(this.HieStack[i].name===t||a){a=!0;var n=new e.Bone;if(n.name=this.HieStack[i].name,n.applyMatrix4(this.HieStack[i].FrameTransformMatrix),n.matrixWorld=n.matrix,n.FrameTransformMatrix=this.HieStack[i].FrameTransformMatrix,n.pos=(new e.Vector3).setFromMatrixPosition(n.FrameTransformMatrix).toArray(),n.rotq=(new e.Quaternion).setFromRotationMatrix(n.FrameTransformMatrix).toArray(),n.scl=(new e.Vector3).setFromMatrixScale(n.FrameTransformMatrix).toArray(),this.HieStack[i].parentName&&this.HieStack[i].parentName.length>0)for(var o=0;o<r.length;o++)if(this.HieStack[i].parentName===r[o].name){r[o].add(n),n.parent=o;break}r.push(n)}}},{key:"_makeOutputGeometry",value:function(){var t=null;if(this._currentGeo.BoneInfs.length>0){var r=[];this._makePutBoneList(this._currentGeo.baseFrame.parentName,r);for(var a=0;a<this._currentGeo.BoneInfs.length;a++){for(var i=0,n=0;n<r.length;n++)if(r[n].name===this._currentGeo.BoneInfs[a].boneName){i=n,r[n].OffsetMatrix=new e.Matrix4,r[n].OffsetMatrix.copy(this._currentGeo.BoneInfs[a].OffsetMatrix);break}for(var o=0;o<this._currentGeo.BoneInfs[a].Indeces.length;o++){var s=this._currentGeo.BoneInfs[a].Indeces[o],l=this._currentGeo.BoneInfs[a].Weights[o],u=4*s;switch(this._currentGeo.VertexSetedBoneCount[s]){case 0:this._currentGeo.GeometryData.skinIndices[u]=i,this._currentGeo.GeometryData.skinWeights[u]=l;break;case 1:this._currentGeo.GeometryData.skinIndices[u+1]=i,this._currentGeo.GeometryData.skinWeights[u+1]=l;break;case 2:this._currentGeo.GeometryData.skinIndices[u+2]=i,this._currentGeo.GeometryData.skinWeights[u+2]=l;break;case 3:this._currentGeo.GeometryData.skinIndices[u+3]=i,this._currentGeo.GeometryData.skinWeights[u+3]=l}this._currentGeo.VertexSetedBoneCount[s]++,this._currentGeo.VertexSetedBoneCount[s]>4&&console.log("warn! over 4 bone weight! :"+s)}}for(var c=0;c<this._currentGeo.Materials.length;c++)this._currentGeo.Materials[c].skinning=!0;for(var h=[],d=0;d<r.length;d++)r[d].OffsetMatrix?h.push(r[d].OffsetMatrix):h.push(new e.Matrix4);var f=this._buildGeometry();t=new e.SkinnedMesh(f,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials),this._initSkeleton(t,r,h)}else{var p=this._buildGeometry();t=new e.Mesh(p,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials)}t.name=this._currentGeo.name;var m=new e.Matrix4,v=this._currentGeo.baseFrame.putBone;if(v&&v.parent){for(;v=v.parent;)m.multiply(v.FrameTransformMatrix);t.applyMatrix4(m)}this.Meshes.push(t)}},{key:"_initSkeleton",value:function(t,r,a){var i,n,o,s,l=[];for(o=0,s=r.length;o<s;o++)n=r[o],i=new e.Bone,l.push(i),i.name=n.name,i.position.fromArray(n.pos),i.quaternion.fromArray(n.rotq),void 0!==n.scl&&i.scale.fromArray(n.scl);for(o=0,s=r.length;o<s;o++)-1!==(n=r[o]).parent&&null!==n.parent&&void 0!==l[n.parent]?l[n.parent].add(l[o]):t.add(l[o]);t.updateMatrixWorld(!0);var u=new e.Skeleton(l,a);t.bind(u,t.matrixWorld)}},{key:"_readAnimationKey",value:function(){var t=0,r=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,r-t);t=r+1;var i=parseInt(this._readLine(a));t=(r=this._currentObject.data.indexOf(";",t))+1,a=this._currentObject.data.substr(t);for(var n=this._readLine(a.trim()).split(";;,"),o=0;o<n.length;o++){var s=n[o].split(";"),l=new Qs;if(l.type=i,l.Frame=parseInt(s[0]),l.index=this._currentAnimeFrames.keyFrames.length,l.time=l.Frame,4!=i){for(var u=!1,c=0;c<this._currentAnimeFrames.keyFrames.length;c++)if(this._currentAnimeFrames.keyFrames[c].Frame===l.Frame){l=this._currentAnimeFrames.keyFrames[c],u=!0;break}var h=s[2].split(",");switch(i){case 0:l.rot=new e.Quaternion(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]),-1*parseFloat(h[0]));break;case 1:l.scl=new e.Vector3(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]));break;case 2:l.pos=new e.Vector3(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]))}u||this._currentAnimeFrames.keyFrames.push(l)}else l.matrix=new e.Matrix4,this._ParseMatrixData(l.matrix,s[2].split(",")),this._currentAnimeFrames.keyFrames.push(l)}}},{key:"_makeOutputAnimation",value:function(){var e=new Xs(this.options);e.fps=this.animTicksPerSecond,e.name=this._currentAnime.name,e.make(this._currentAnime.AnimeFrames),this.animations.push(e)}},{key:"assignAnimation",value:function(t,r){var a=t,i=r;if(a||(a=this.Meshes[0]),i||(i=this.animations[0]),!a||!i)return null;var n={};n.fps=i.fps,n.name=i.name,n.length=i.length,n.hierarchy=[];for(var o=0;o<a.skeleton.bones.length;o++){for(var s=!1,l=0;l<i.hierarchy.length;l++)if(a.skeleton.bones[o].name===i.hierarchy[l].name){s=!0;var u=i.hierarchy[l].copy();if(u.parent=-1,a.skeleton.bones[o].parent&&"Bone"===a.skeleton.bones[o].parent.type)for(var c=0;c<n.hierarchy.length;c++)n.hierarchy[c].name===a.skeleton.bones[o].parent.name&&(u.parent=c,u.parentName=a.skeleton.bones[o].parent.name);n.hierarchy.push(u);break}if(!s){var h=i.hierarchy[0].copy();h.name=a.skeleton.bones[o].name,h.parent=-1;for(var d=0;d<h.keys.length;d++)h.keys[d].pos&&h.keys[d].pos.set(0,0,0),h.keys[d].scl&&h.keys[d].scl.set(1,1,1),h.keys[d].rot&&h.keys[d].rot.set(0,0,0,1);n.hierarchy.push(h)}}return a.geometry.animations||(a.geometry.animations=[]),a.geometry.animations.push(e.AnimationClip.parseAnimation(n,a.skeleton.bones)),a.animationMixer||(a.animationMixer=new e.AnimationMixer(a)),n}},{key:"_ParseMatrixData",value:function(e,t){e.set(parseFloat(t[0]),parseFloat(t[4]),parseFloat(t[8]),parseFloat(t[12]),parseFloat(t[1]),parseFloat(t[5]),parseFloat(t[9]),parseFloat(t[13]),parseFloat(t[2]),parseFloat(t[6]),parseFloat(t[10]),parseFloat(t[14]),parseFloat(t[3]),parseFloat(t[7]),parseFloat(t[11]),parseFloat(t[15]))}}]),t}()),Js=function(t){e.Loader.call(this,t),this.animateBonePositions=!0,this.animateBoneRotations=!0};Js.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Js,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){function r(t,a,i){if("ENDSITE"!==i.type){var n={time:a,position:new e.Vector3,rotation:new e.Quaternion};i.frames.push(n);for(var o=new e.Quaternion,s=new e.Vector3(1,0,0),l=new e.Vector3(0,1,0),u=new e.Vector3(0,0,1),c=0;c<i.channels.length;c++)switch(i.channels[c]){case"Xposition":n.position.x=parseFloat(t.shift().trim());break;case"Yposition":n.position.y=parseFloat(t.shift().trim());break;case"Zposition":n.position.z=parseFloat(t.shift().trim());break;case"Xrotation":o.setFromAxisAngle(s,parseFloat(t.shift().trim())*Math.PI/180),n.rotation.multiply(o);break;case"Yrotation":o.setFromAxisAngle(l,parseFloat(t.shift().trim())*Math.PI/180),n.rotation.multiply(o);break;case"Zrotation":o.setFromAxisAngle(u,parseFloat(t.shift().trim())*Math.PI/180),n.rotation.multiply(o);break;default:console.warn("THREE.BVHLoader: Invalid channel type.")}for(var h=0;h<i.children.length;h++)r(t,a,i.children[h])}}function a(t,r,n){var o={name:"",type:"",frames:[]};n.push(o);var s=r.split(/[\s]+/);"END"===s[0].toUpperCase()&&"SITE"===s[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=s[1],o.type=s[0].toUpperCase()),"{"!==i(t)&&console.error("THREE.BVHLoader: Expected opening { after type & name"),"OFFSET"!==(s=i(t).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected OFFSET but got: "+s[0]),4!==s.length&&console.error("THREE.BVHLoader: Invalid number of values for OFFSET.");var l=new e.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));if((isNaN(l.x)||isNaN(l.y)||isNaN(l.z))&&console.error("THREE.BVHLoader: Invalid values of OFFSET."),o.offset=l,"ENDSITE"!==o.type){"CHANNELS"!==(s=i(t).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected CHANNELS definition.");var u=parseInt(s[1]);o.channels=s.splice(2,u),o.children=[]}for(;;){var c=i(t);if("}"===c)return o;o.children.push(a(t,c,n))}}function i(e){for(var t;0===(t=e.shift().trim()).length;);return t}var n=this,o=function(e){"HIERARCHY"!==i(e)&&console.error("THREE.BVHLoader: HIERARCHY expected.");var t=[],n=a(e,i(e),t);"MOTION"!==i(e)&&console.error("THREE.BVHLoader: MOTION expected.");var o=i(e).split(/[\s]+/),s=parseInt(o[1]);isNaN(s)&&console.error("THREE.BVHLoader: Failed to read number of frames."),o=i(e).split(/[\s]+/);var l=parseFloat(o[2]);isNaN(l)&&console.error("THREE.BVHLoader: Failed to read frame time.");for(var u=0;u<s;u++)r(o=i(e).split(/[\s]+/),u*l,n);return t}(t.split(/[\r\n]+/g)),s=[];!function t(r,a){var i=new e.Bone;if(a.push(i),i.position.add(r.offset),i.name=r.name,"ENDSITE"!==r.type)for(var n=0;n<r.children.length;n++)i.add(t(r.children[n],a));return i}(o[0],s);var l=function(t){for(var r=[],a=0;a<t.length;a++){var i=t[a];if("ENDSITE"!==i.type){for(var o=[],s=[],l=[],u=0;u<i.frames.length;u++){var c=i.frames[u];o.push(c.time),s.push(c.position.x+i.offset.x),s.push(c.position.y+i.offset.y),s.push(c.position.z+i.offset.z),l.push(c.rotation.x),l.push(c.rotation.y),l.push(c.rotation.z),l.push(c.rotation.w)}n.animateBonePositions&&r.push(new e.VectorKeyframeTrack(".bones["+i.name+"].position",o,s)),n.animateBoneRotations&&r.push(new e.QuaternionKeyframeTrack(".bones["+i.name+"].quaternion",o,l))}}return new e.AnimationClip("animation",-1,r)}(o);return{skeleton:new e.Skeleton(s),clip:l}}});var Ks=function(t){e.Loader.call(this,t)};Ks.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Ks,load:function(t,r,a,i){var n=this,o=""===n.path?e.LoaderUtils.extractUrlBase(t):n.path,s=new e.FileLoader(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(t,r){function a(e,t){for(var r=[],a=e.childNodes,i=0,n=a.length;i<n;i++){var o=a[i];o.nodeName===t&&r.push(o)}return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,i=t.length;a<i;a++)r[a]=t[a];return r}function n(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,i=t.length;a<i;a++)r[a]=parseFloat(t[a]);return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,i=t.length;a<i;a++)r[a]=parseInt(t[a]);return r}function s(e){return e.substring(1)}function l(e){return 0===Object.keys(e).length}function u(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function c(e){return void 0!==e?e.textContent:"Y_UP"}function h(e,t,r,i){var n=a(e,t)[0];if(void 0!==n)for(var o=a(n,r),s=0;s<o.length;s++)i(o[s])}function d(e,t){for(var r in e){e[r].build=t(e[r])}}function f(e,t){return void 0!==e.build||(e.build=t(e)),e.build}function p(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var n=s(i.getAttribute("source")),o=i.getAttribute("semantic");t.inputs[o]=n}}return t}function m(e){var t={},r=e.getAttribute("target").split("/"),a=r.shift(),i=r.shift(),n=-1!==i.indexOf("("),o=-1!==i.indexOf(".");if(o)r=i.split("."),i=r.shift(),t.member=r.shift();else if(n){var l=i.split("(");i=l.shift();for(var u=0;u<l.length;u++)l[u]=parseInt(l[u].replace(/\)/,""));t.indices=l}return t.id=a,t.sid=i,t.arraySyntax=n,t.memberSyntax=o,t.sampler=s(e.getAttribute("source")),t}function v(e){var t=[],r=e.channels,a=e.samplers,i=e.sources;for(var n in r)if(r.hasOwnProperty(n)){var o=r[n],s=a[o.sampler],l=s.inputs.INPUT,u=s.inputs.OUTPUT;w(y(o,i[l],i[u]),t)}return t}function g(e){return f(qe.animations[e],v)}function y(e,t,r){var a,i,n,o,s,l,u=qe.nodes[e.id],c=Ie(u.id),h=u.transforms[e.sid],d=u.matrix.clone().transpose(),f={};switch(h){case"matrix":for(n=0,o=t.array.length;n<o;n++)if(a=t.array[n],i=n*r.stride,void 0===f[a]&&(f[a]={}),!0===e.arraySyntax){var p=r.array[i],m=e.indices[0]+4*e.indices[1];f[a][m]=p}else for(s=0,l=r.stride;s<l;s++)f[a][s]=r.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var v=function(e,t){var r=[];for(var a in e)r.push({time:parseFloat(a),value:e[a]});r.sort(n);for(var i=0;i<16;i++)M(r,i,t.elements[i]);return r;function n(e,t){return e.time-t.time}}(f,d);return{name:c.uuid,keyframes:v}}var x=new e.Vector3,b=new e.Vector3,A=new e.Quaternion;function w(t,r){for(var a=t.keyframes,i=t.name,n=[],o=[],s=[],l=[],u=0,c=a.length;u<c;u++){var h=a[u],d=h.time,f=h.value;Te.fromArray(f).transpose(),Te.decompose(x,A,b),n.push(d),o.push(x.x,x.y,x.z),s.push(A.x,A.y,A.z,A.w),l.push(b.x,b.y,b.z)}return o.length>0&&r.push(new e.VectorKeyframeTrack(i+".position",n,o)),s.length>0&&r.push(new e.QuaternionKeyframeTrack(i+".quaternion",n,s)),l.length>0&&r.push(new e.VectorKeyframeTrack(i+".scale",n,l)),r}function M(e,t,r){var a,i,n,o=!0;for(i=0,n=e.length;i<n;i++)void 0===(a=e[i]).value[t]?a.value[t]=null:o=!1;if(!0===o)for(i=0,n=e.length;i<n;i++)(a=e[i]).value[t]=r;else!function(e,t){for(var r,a,i=0,n=e.length;i<n;i++){var o=e[i];if(null===o.value[t]){if(r=S(e,i,t),a=T(e,i,t),null===r){o.value[t]=a.value[t];continue}if(null===a){o.value[t]=r.value[t];continue}C(o,r,a,t)}}}(e,t)}function S(e,t,r){for(;t>=0;){var a=e[t];if(null!==a.value[r])return a;t--}return null}function T(e,t,r){for(;t<e.length;){var a=e[t];if(null!==a.value[r])return a;t++}return null}function C(e,t,r,a){r.time-t.time!=0?e.value[a]=(e.time-t.time)*(r.value[a]-t.value[a])/(r.time-t.time)+t.value[a]:e.value[a]=t.value[a]}function F(t){for(var r=[],a=t.name,i=t.end-t.start||-1,n=t.animations,o=0,s=n.length;o<s;o++)for(var l=g(n[o]),u=0,c=l.length;u<c;u++)r.push(l[u]);return new e.AnimationClip(a,i,r)}function E(e){return f(qe.clips[e],F)}function B(e){for(var t={sources:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=n(i.textContent);break;case"source":var o=i.getAttribute("id");t.sources[o]=ne(i);break;case"joints":t.joints=L(i);break;case"vertex_weights":t.vertexWeights=P(i)}}return t}function L(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var n=i.getAttribute("semantic"),o=s(i.getAttribute("source"));t.inputs[n]=o}}return t}function P(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var n=i.getAttribute("semantic"),l=s(i.getAttribute("source")),u=parseInt(i.getAttribute("offset"));t.inputs[n]={id:l,offset:u};break;case"vcount":t.vcount=o(i.textContent);break;case"v":t.v=o(i.textContent)}}return t}function D(t){var r={id:t.id},a=qe.geometries[r.id];return void 0!==t.skin&&(r.skin=function(t){var r,a,i,n=4,o={joints:[],indices:{array:[],stride:n},weights:{array:[],stride:n}},s=t.sources,l=t.vertexWeights,u=l.vcount,c=l.v,h=l.inputs.JOINT.offset,d=l.inputs.WEIGHT.offset,f=t.sources[t.joints.inputs.JOINT],p=t.sources[t.joints.inputs.INV_BIND_MATRIX],m=s[l.inputs.WEIGHT.id].array,v=0;for(r=0,i=u.length;r<i;r++){var g=u[r],y=[];for(a=0;a<g;a++){var x=c[v+h],b=m[c[v+d]];y.push({index:x,weight:b}),v+=2}for(y.sort(S),a=0;a<n;a++){var A=y[a];void 0!==A?(o.indices.array.push(A.index),o.weights.array.push(A.weight)):(o.indices.array.push(0),o.weights.array.push(0))}}t.bindShapeMatrix?o.bindMatrix=(new e.Matrix4).fromArray(t.bindShapeMatrix).transpose():o.bindMatrix=(new e.Matrix4).identity();for(r=0,i=f.array.length;r<i;r++){var w=f.array[r],M=(new e.Matrix4).fromArray(p.array,r*p.stride).transpose();o.joints.push({name:w,boneInverse:M})}return o;function S(e,t){return t.weight-e.weight}}(t.skin),a.sources.skinIndices=r.skin.indices,a.sources.skinWeights=r.skin.weights),r}function N(e){return void 0!==e.build?e.build:e.init_from}function R(e){var t=qe.images[e];return void 0!==t?f(t,N):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function _(e){for(var t={surfaces:{},samplers:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"newparam":I(i,t);break;case"technique":t.technique=k(i);break;case"extra":t.extra=W(i)}}return t}function I(e,t){for(var r=e.getAttribute("sid"),a=0,i=e.childNodes.length;a<i;a++){var n=e.childNodes[a];if(1===n.nodeType)switch(n.nodeName){case"surface":t.surfaces[r]=O(n);break;case"sampler2D":t.samplers[r]=U(n)}}}function O(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":t.init_from=i.textContent}}return t}function U(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"source":t.source=i.textContent}}return t}function k(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=V(i)}}return t}function V(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[i.nodeName]=G(i);break;case"transparent":t[i.nodeName]={opaque:i.getAttribute("opaque"),data:G(i)}}}return t}function G(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"color":t[i.nodeName]=n(i.textContent);break;case"float":t[i.nodeName]=parseFloat(i.textContent);break;case"texture":t[i.nodeName]={id:i.getAttribute("texture"),extra:j(i)}}}return t}function j(e){for(var t={technique:{}},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"extra":z(i,t)}}return t}function z(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":H(i,t)}}}function H(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent)}}}function W(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":t.technique=X(i)}}return t}function X(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent)}}return t}function Q(e){return e}function Y(t){var r,a,i=(r=t.url,f(qe.effects[r],Q)),n=i.profile.technique,o=i.profile.extra;switch(n.type){case"phong":case"blinn":a=new e.MeshPhongMaterial;break;case"lambert":a=new e.MeshLambertMaterial;break;default:a=new e.MeshBasicMaterial}function s(t){var r=i.profile.samplers[t.id],a=null;void 0!==r?a=R(i.profile.surfaces[r.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),a=R(t.id));if(null!==a){var n=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=We;break;default:t=Qe}return t}(a);if(void 0!==n){var o=n.load(a),s=t.extra;if(void 0!==s&&void 0!==s.technique&&!1===l(s.technique)){var u=s.technique;o.wrapS=u.wrapU?e.RepeatWrapping:e.ClampToEdgeWrapping,o.wrapT=u.wrapV?e.RepeatWrapping:e.ClampToEdgeWrapping,o.offset.set(u.offsetU||0,u.offsetV||0),o.repeat.set(u.repeatU||1,u.repeatV||1)}else o.wrapS=e.RepeatWrapping,o.wrapT=e.RepeatWrapping;return o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",a),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",t.id),null}a.name=t.name||"";var u=n.parameters;for(var c in u){var h=u[c];switch(c){case"diffuse":h.color&&a.color.fromArray(h.color),h.texture&&(a.map=s(h.texture));break;case"specular":h.color&&a.specular&&a.specular.fromArray(h.color),h.texture&&(a.specularMap=s(h.texture));break;case"bump":h.texture&&(a.normalMap=s(h.texture));break;case"ambient":h.texture&&(a.lightMap=s(h.texture));break;case"shininess":h.float&&a.shininess&&(a.shininess=h.float);break;case"emission":h.color&&a.emissive&&a.emissive.fromArray(h.color),h.texture&&(a.emissiveMap=s(h.texture))}}var d=u.transparent,p=u.transparency;if(void 0===p&&d&&(p={float:1}),void 0===d&&p&&(d={opaque:"A_ONE",data:{color:[1,1,1,1]}}),d&&p)if(d.data.texture)a.transparent=!0;else{var m=d.data.color;switch(d.opaque){case"A_ONE":a.opacity=m[3]*p.float;break;case"RGB_ZERO":a.opacity=1-m[0]*p.float;break;case"A_ZERO":a.opacity=1-m[3]*p.float;break;case"RGB_ONE":a.opacity=m[0]*p.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',d.opaque)}a.opacity<1&&(a.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(a.side=e.DoubleSide),a}function J(e){return f(qe.materials[e],Y)}function K(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return q(r)}}return{}}function q(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"perspective":case"orthographic":t.technique=a.nodeName,t.parameters=Z(a)}}return t}function Z(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[a.nodeName]=parseFloat(a.textContent)}}return t}function $(t){var r;switch(t.optics.technique){case"perspective":r=new e.PerspectiveCamera(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":var a=t.optics.parameters.ymag,i=t.optics.parameters.xmag,n=t.optics.parameters.aspect_ratio;i=void 0===i?a*n:i,a=void 0===a?i/n:a,i*=.5,a*=.5,r=new e.OrthographicCamera(-i,i,a,-a,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:r=new e.PerspectiveCamera}return r.name=t.name||"",r}function ee(e){var t=qe.cameras[e];return void 0!==t?f(t,$):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function te(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=re(i)}}return t}function re(t){for(var r={},a=0,i=t.childNodes.length;a<i;a++){var o=t.childNodes[a];if(1===o.nodeType)switch(o.nodeName){case"color":var s=n(o.textContent);r.color=(new e.Color).fromArray(s);break;case"falloff_angle":r.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var l=parseFloat(o.textContent);r.distance=l?Math.sqrt(1/l):0}}return r}function ae(t){var r;switch(t.technique){case"directional":r=new e.DirectionalLight;break;case"point":r=new e.PointLight;break;case"spot":r=new e.SpotLight;break;case"ambient":r=new e.AmbientLight}return t.parameters.color&&r.color.copy(t.parameters.color),t.parameters.distance&&(r.distance=t.parameters.distance),r}function ie(e){var t=qe.lights[e];return void 0!==t?f(t,ae):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function ne(e){for(var t={array:[],stride:3},r=0;r<e.childNodes.length;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"float_array":t.array=n(o.textContent);break;case"Name_array":t.array=i(o.textContent);break;case"technique_common":var s=a(o,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function oe(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];1===a.nodeType&&(t[a.getAttribute("semantic")]=s(a.getAttribute("source")))}return t}function se(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var n=s(i.getAttribute("source")),l=i.getAttribute("semantic"),u=parseInt(i.getAttribute("offset")),c=parseInt(i.getAttribute("set")),h=c>0?l+c:l;t.inputs[h]={id:n,offset:u},t.stride=Math.max(t.stride,u+1),"TEXCOORD"===l&&(t.hasUV=!0);break;case"vcount":t.vcount=o(i.textContent);break;case"p":t.p=o(i.textContent)}}return t}function le(e){for(var t=0,r=0,a=e.length;r<a;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function ue(e){var t={},r=e.sources,a=e.vertices,i=e.primitives;if(0===i.length)return{};var n=function(e){for(var t={},r=0;r<e.length;r++){var a=e[r];void 0===t[a.type]&&(t[a.type]=[]),t[a.type].push(a)}return t}(i);for(var o in n){var s=n[o];le(s),t[o]=ce(s,r,a)}return t}function ce(t,r,a){for(var i={},n={array:[],stride:0},o={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:0},u={array:[],stride:0},c=[],h=4,d=[],f=4,p=new e.BufferGeometry,m=[],v=0,g=0;g<t.length;g++){var y=t[g],x=y.inputs,b=0;switch(y.type){case"lines":case"linestrips":b=2*y.count;break;case"triangles":b=3*y.count;break;case"polylist":for(var A=0;A<y.count;A++){var w=y.vcount[A];switch(w){case 3:b+=3;break;case 4:b+=6;break;default:b+=3*(w-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",y.type)}for(var M in p.addGroup(v,b,g),v+=b,y.material&&m.push(y.material),x){var S=x[M];switch(M){case"VERTEX":for(var T in a){var C=a[T];switch(T){case"POSITION":var F=n.array.length;if(he(y,r[C],S.offset,n.array),n.stride=r[C].stride,r.skinWeights&&r.skinIndices&&(he(y,r.skinIndices,S.offset,c),he(y,r.skinWeights,S.offset,d)),!1===y.hasUV&&!0===t.uvsNeedsFix){b=(n.array.length-F)/n.stride;for(var E=0;E<b;E++)s.array.push(0,0)}break;case"NORMAL":he(y,r[C],S.offset,o.array),o.stride=r[C].stride;break;case"COLOR":he(y,r[C],S.offset,u.array),u.stride=r[C].stride;break;case"TEXCOORD":he(y,r[C],S.offset,s.array),s.stride=r[C].stride;break;case"TEXCOORD1":he(y,r[C],S.offset,l.array),s.stride=r[C].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',T)}}break;case"NORMAL":he(y,r[S.id],S.offset,o.array),o.stride=r[S.id].stride;break;case"COLOR":he(y,r[S.id],S.offset,u.array),u.stride=r[S.id].stride;break;case"TEXCOORD":he(y,r[S.id],S.offset,s.array),s.stride=r[S.id].stride;break;case"TEXCOORD1":he(y,r[S.id],S.offset,l.array),l.stride=r[S.id].stride}}}return n.array.length>0&&p.setAttribute("position",new e.Float32BufferAttribute(n.array,n.stride)),o.array.length>0&&p.setAttribute("normal",new e.Float32BufferAttribute(o.array,o.stride)),u.array.length>0&&p.setAttribute("color",new e.Float32BufferAttribute(u.array,u.stride)),s.array.length>0&&p.setAttribute("uv",new e.Float32BufferAttribute(s.array,s.stride)),l.array.length>0&&p.setAttribute("uv2",new e.Float32BufferAttribute(l.array,l.stride)),c.length>0&&p.setAttribute("skinIndex",new e.Float32BufferAttribute(c,h)),d.length>0&&p.setAttribute("skinWeight",new e.Float32BufferAttribute(d,f)),i.data=p,i.type=t[0].type,i.materialKeys=m,i}function he(e,t,r,a){var i=e.p,n=e.stride,o=e.vcount;function s(e){for(var t=i[e+r]*u,n=t+u;t<n;t++)a.push(l[t])}var l=t.array,u=t.stride;if(void 0!==e.vcount)for(var c=0,h=0,d=o.length;h<d;h++){var f=o[h];if(4===f){var p=c+1*n,m=c+2*n,v=c+3*n;s(c+0*n),s(p),s(v),s(p),s(m),s(v)}else if(3===f){p=c+1*n,m=c+2*n;s(c+0*n),s(p),s(m)}else if(f>4)for(var g=1,y=f-2;g<=y;g++){p=c+n*g,m=c+n*(g+1);s(c+0*n),s(p),s(m)}c+=n*f}else for(var x=0,b=i.length;x<b;x+=n)s(x)}function de(e){return f(qe.geometries[e],ue)}function fe(e){return void 0!==e.build?e.build:e}function pe(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"joint":t.joints[a.getAttribute("sid")]=me(a);break;case"link":t.links.push(ge(a))}}}function me(e){for(var t,r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"prismatic":case"revolute":t=ve(a)}}return t}function ve(t,r){r={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new e.Vector3,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var a=0;a<t.childNodes.length;a++){var i=t.childNodes[a];if(1===i.nodeType)switch(i.nodeName){case"axis":var o=n(i.textContent);r.axis.fromArray(o);break;case"limits":var s=i.getElementsByTagName("max")[0],l=i.getElementsByTagName("min")[0];r.limits.max=parseFloat(s.textContent),r.limits.min=parseFloat(l.textContent)}}return r.limits.min>=r.limits.max&&(r.static=!0),r.middlePosition=(r.limits.min+r.limits.max)/2,r}function ge(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"attachment_full":t.attachments.push(ye(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(a))}}return t}function ye(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"link":t.links.push(ge(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(a))}}return t}function xe(t){var r={type:t.nodeName},a=n(t.textContent);switch(r.type){case"matrix":r.obj=new e.Matrix4,r.obj.fromArray(a).transpose();break;case"translate":r.obj=new e.Vector3,r.obj.fromArray(a);break;case"rotate":r.obj=new e.Vector3,r.obj.fromArray(a),r.angle=e.MathUtils.degToRad(a[3])}return r}function be(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"technique_common":Ae(a,t)}}}function Ae(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"inertia":t.inertia=n(a.textContent);break;case"mass":t.mass=n(a.textContent)[0]}}}function we(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"axis":var i=a.getElementsByTagName("param")[0];t.axis=i.textContent;var n=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=n.substr(0,n.length-1)}}return t}function Me(e){return void 0!==e.build?e.build:e}function Se(t){for(var r=[],a=Ve.querySelector('[id="'+t.id+'"]'),i=0;i<a.childNodes.length;i++){var o=a.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"matrix":var s=n(o.textContent),l=(new e.Matrix4).fromArray(s).transpose();r.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l});break;case"translate":case"scale":s=n(o.textContent);var u=(new e.Vector3).fromArray(s);r.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:u});break;case"rotate":s=n(o.textContent),u=(new e.Vector3).fromArray(s);var c=e.MathUtils.degToRad(s[3]);r.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:u,angle:c})}}return r}var Te=new e.Matrix4,Ce=new e.Vector3;function Fe(t){for(var r={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new e.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},a=0;a<t.childNodes.length;a++){var i=t.childNodes[a];if(1===i.nodeType)switch(i.nodeName){case"node":r.nodes.push(i.getAttribute("id")),Fe(i);break;case"instance_camera":r.instanceCameras.push(s(i.getAttribute("url")));break;case"instance_controller":r.instanceControllers.push(Ee(i));break;case"instance_light":r.instanceLights.push(s(i.getAttribute("url")));break;case"instance_geometry":r.instanceGeometries.push(Ee(i));break;case"instance_node":r.instanceNodes.push(s(i.getAttribute("url")));break;case"matrix":var o=n(i.textContent);r.matrix.multiply(Te.fromArray(o).transpose()),r.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":o=n(i.textContent);Ce.fromArray(o),r.matrix.multiply(Te.makeTranslation(Ce.x,Ce.y,Ce.z)),r.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":o=n(i.textContent);var l=e.MathUtils.degToRad(o[3]);r.matrix.multiply(Te.makeRotationAxis(Ce.fromArray(o),l)),r.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":o=n(i.textContent);r.matrix.scale(Ce.fromArray(o)),r.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}return _e(r.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",r.id):qe.nodes[r.id]=r,r}function Ee(e){for(var t={id:s(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"bind_material":for(var i=a.getElementsByTagName("instance_material"),n=0;n<i.length;n++){var o=i[n],l=o.getAttribute("symbol"),u=o.getAttribute("target");t.materials[l]=s(u)}break;case"skeleton":t.skeletons.push(s(a.textContent))}}return t}function Be(t,r){var a,i,n,o,s=[],l=[];for(a=0;a<t.length;a++){var u=t[a];if(_e(u))Le(Ie(u),r,s);else if(o=u,void 0!==qe.visualScenes[o])for(var c=qe.visualScenes[u].children,h=0;h<c.length;h++){var d=c[h];if("JOINT"===d.type)Le(Ie(d.id),r,s)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",u)}for(a=0;a<r.length;a++)for(i=0;i<s.length;i++)if((n=s[i]).bone.name===r[a].name){l[a]=n,n.processed=!0;break}for(a=0;a<s.length;a++)!1===(n=s[a]).processed&&(l.push(n),n.processed=!0);var f=[],p=[];for(a=0;a<l.length;a++)n=l[a],f.push(n.bone),p.push(n.boneInverse);return new e.Skeleton(f,p)}function Le(t,r,a){t.traverse((function(t){if(!0===t.isBone){for(var i,n=0;n<r.length;n++){var o=r[n];if(o.name===t.name){i=o.boneInverse;break}}void 0===i&&(i=new e.Matrix4),a.push({bone:t,boneInverse:i,processed:!1})}}))}function Pe(t){for(var r,a=[],i=t.matrix,n=t.nodes,o=t.type,s=t.instanceCameras,l=t.instanceControllers,u=t.instanceLights,c=t.instanceGeometries,h=t.instanceNodes,d=0,p=n.length;d<p;d++)a.push(Ie(n[d]));for(var m=0,v=s.length;m<v;m++){var g=ee(s[m]);null!==g&&a.push(g.clone())}for(var y=0,x=l.length;y<x;y++)for(var b=l[y],A=(r=b.id,f(qe.controllers[r],D)),w=Re(de(A.id),b.materials),M=Be(b.skeletons,A.skin.joints),S=0,T=w.length;S<T;S++){var C;(C=w[S]).isSkinnedMesh&&(C.bind(M,A.skin.bindMatrix),C.normalizeSkinWeights()),a.push(C)}for(var F=0,E=u.length;F<E;F++){var B=ie(u[F]);null!==B&&a.push(B.clone())}for(var L=0,P=c.length;L<P;L++)for(var N=0,R=(w=Re(de((b=c[L]).id),b.materials)).length;N<R;N++)a.push(w[N]);for(var _=0,I=h.length;_<I;_++)a.push(Ie(h[_]).clone());if(0===n.length&&1===a.length)C=a[0];else{C="JOINT"===o?new e.Bone:new e.Group;for(var O=0;O<a.length;O++)C.add(a[O])}return C.name="JOINT"===o?t.sid:t.name,C.matrix.copy(i),C.matrix.decompose(C.position,C.quaternion,C.scale),C}var De=new e.MeshBasicMaterial({color:16711935});function Ne(e,t){for(var r=[],a=0,i=e.length;a<i;a++){var n=t[e[a]];void 0===n?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[a]),r.push(De)):r.push(J(n))}return r}function Re(t,r){var a=[];for(var i in t){var n=t[i],o=Ne(n.materialKeys,r);0===o.length&&("lines"===i||"linestrips"===i?o.push(new e.LineBasicMaterial):o.push(new e.MeshPhongMaterial));var s=void 0!==n.data.attributes.skinIndex;if(s)for(var l=0,u=o.length;l<u;l++)o[l].skinning=!0;var c,h=1===o.length?o[0]:o;switch(i){case"lines":c=new e.LineSegments(n.data,h);break;case"linestrips":c=new e.Line(n.data,h);break;case"triangles":case"polylist":c=s?new e.SkinnedMesh(n.data,h):new e.Mesh(n.data,h)}a.push(c)}return a}function _e(e){return void 0!==qe.nodes[e]}function Ie(e){return f(qe.nodes[e],Pe)}function Oe(t){var r=new e.Group;r.name=t.name;for(var a=t.children,i=0;i<a.length;i++){var n=a[i];r.add(Ie(n.id))}return r}function Ue(e){return f(qe.visualScenes[e],Oe)}if(0===t.length)return{scene:new e.Scene};var ke=(new DOMParser).parseFromString(t,"application/xml"),Ve=a(ke,"COLLADA")[0],Ge=ke.getElementsByTagName("parsererror")[0];if(void 0!==Ge){var je,ze=a(Ge,"div")[0];return je=ze?ze.textContent:function(e){for(var t="",r=[e];r.length;){var a=r.shift();a.nodeType===Node.TEXT_NODE?t+=a.textContent:(t+="\n",r.push.apply(r,a.childNodes))}return t.trim()}(Ge),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",je),null}var He=Ve.getAttribute("version");console.log("THREE.ColladaLoader: File version",He);var We,Xe=function(e){return{unit:u(a(e,"unit")[0]),upAxis:c(a(e,"up_axis")[0])}}(a(Ve,"asset")[0]),Qe=new e.TextureLoader(this.manager);Qe.setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin),Os&&(We=new Os(this.manager)).setPath(this.resourcePath||r);var Ye=[],Je={},Ke=0,qe={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};h(Ve,"library_animations","animation",(function t(r){for(var a={sources:{},samplers:{},channels:{}},i=!1,n=0,o=r.childNodes.length;n<o;n++){var s,l=r.childNodes[n];if(1===l.nodeType)switch(l.nodeName){case"source":s=l.getAttribute("id"),a.sources[s]=ne(l);break;case"sampler":s=l.getAttribute("id"),a.samplers[s]=p(l);break;case"channel":s=l.getAttribute("target"),a.channels[s]=m(l);break;case"animation":t(l),i=!0;break;default:console.log(l)}}!1===i&&(qe.animations[r.getAttribute("id")||e.MathUtils.generateUUID()]=a)})),h(Ve,"library_animation_clips","animation_clip",(function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":t.animations.push(s(i.getAttribute("url")))}}qe.clips[e.getAttribute("id")]=t})),h(Ve,"library_controllers","controller",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=s(i.getAttribute("source")),t.skin=B(i);break;case"morph":t.id=s(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}qe.controllers[e.getAttribute("id")]=t})),h(Ve,"library_images","image",(function(e){var t={init_from:a(e,"init_from")[0].textContent};qe.images[e.getAttribute("id")]=t})),h(Ve,"library_effects","effect",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":t.profile=_(i)}}qe.effects[e.getAttribute("id")]=t})),h(Ve,"library_materials","material",(function(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":t.url=s(i.getAttribute("url"))}}qe.materials[e.getAttribute("id")]=t})),h(Ve,"library_cameras","camera",(function(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"optics":t.optics=K(i)}}qe.cameras[e.getAttribute("id")]=t})),h(Ve,"library_lights","light",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":t=te(i)}}qe.lights[e.getAttribute("id")]=t})),h(Ve,"library_geometries","geometry",(function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=a(e,"mesh")[0];if(void 0!==r){for(var i=0;i<r.childNodes.length;i++){var n=r.childNodes[i];if(1===n.nodeType){var o=n.getAttribute("id");switch(n.nodeName){case"source":t.sources[o]=ne(n);break;case"vertices":t.vertices=oe(n);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",n.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(se(n));break;default:console.log(n)}}}qe.geometries[e.getAttribute("id")]=t}})),h(Ve,"library_nodes","node",Fe),h(Ve,"library_visual_scenes","visual_scene",(function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var a=t[r];!1===a.hasAttribute("id")&&a.setAttribute("id","three_default_"+Ke++)}}(e);for(var r=a(e,"node"),i=0;i<r.length;i++)t.children.push(Fe(r[i]));qe.visualScenes[e.getAttribute("id")]=t})),h(Ve,"library_kinematics_models","kinematics_model",(function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"technique_common":pe(a,t)}}qe.kinematicsModels[e.getAttribute("id")]=t})),h(Ve,"library_physics_models","physics_model",(function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"rigid_body":t.rigidBodies[a.getAttribute("name")]={},be(a,t.rigidBodies[a.getAttribute("name")])}}qe.physicsModels[e.getAttribute("id")]=t})),h(Ve,"scene","instance_kinematics_scene",(function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"bind_joint_axis":t.bindJointAxis.push(we(a))}}qe.kinematicsScenes[s(e.getAttribute("url"))]=t})),d(qe.animations,v),d(qe.clips,F),d(qe.controllers,D),d(qe.images,N),d(qe.effects,Q),d(qe.materials,Y),d(qe.cameras,$),d(qe.lights,ae),d(qe.geometries,ue),d(qe.visualScenes,Oe),function(){var t=qe.clips;if(!0===l(t)){if(!1===l(qe.animations)){var r=[];for(var a in qe.animations)for(var i=g(a),n=0,o=i.length;n<o;n++)r.push(i[n]);Ye.push(new e.AnimationClip("default",-1,r))}}else for(var s in t)Ye.push(E(s))}(),function(){var t=Object.keys(qe.kinematicsModels)[0],r=Object.keys(qe.kinematicsScenes)[0],a=Object.keys(qe.visualScenes)[0];if(void 0!==t&&void 0!==r){for(var i,n=(i=t,f(qe.kinematicsModels[i],fe)),o=function(e){return f(qe.kinematicsScenes[e],Me)}(r),s=Ue(a),l=o.bindJointAxis,u={},c=0,h=l.length;c<h;c++){var d=l[c],p=Ve.querySelector('[sid="'+d.target+'"]');if(p){var m=p.parentElement;g(d.jointIndex,m)}}var v=new e.Matrix4;Je={joints:n&&n.joints,getJointValue:function(e){var t=u[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(t,r){var a=u[t];if(a){var i=a.joint;if(r>i.limits.max||r<i.limits.min)console.warn("THREE.ColladaLoader: Joint "+t+" value "+r+" outside of limits (min: "+i.limits.min+", max: "+i.limits.max+").");else if(i.static)console.warn("THREE.ColladaLoader: Joint "+t+" is static.");else{var n=a.object,o=i.axis,s=a.transforms;Te.identity();for(var l=0;l<s.length;l++){var c=s[l];if(c.sid&&-1!==c.sid.indexOf(t))switch(i.type){case"revolute":Te.multiply(v.makeRotationAxis(o,e.MathUtils.degToRad(r)));break;case"prismatic":Te.multiply(v.makeTranslation(o.x*r,o.y*r,o.z*r));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+i.type)}else switch(c.type){case"matrix":Te.multiply(c.obj);break;case"translate":Te.multiply(v.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"scale":Te.scale(c.obj);break;case"rotate":Te.multiply(v.makeRotationAxis(c.obj,c.angle))}}n.matrix.copy(Te),n.matrix.decompose(n.position,n.quaternion,n.scale),u[t].position=r}}else console.log("THREE.ColladaLoader: "+t+" does not exist.")}}}function g(e,t){var r=t.getAttribute("name"),a=n.joints[e];s.traverse((function(i){i.name===r&&(u[e]={object:i,transforms:Se(t),joint:a,position:a.zeroPosition})}))}}();var Ze=function(e){return Ue(s(a(e,"instance_visual_scene")[0].getAttribute("url")))}(a(Ve,"scene")[0]);return Ze.animations=Ye,"Z_UP"===Xe.upAxis&&Ze.quaternion.setFromEuler(new e.Euler(-Math.PI/2,0,0)),Ze.scale.multiplyScalar(Xe.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Ye},kinematics:Je,library:qe,scene:Ze}}});var qs=function(t){e.Loader.call(this,t)};qs.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:qs,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){var r=new e.LoadingManager;r.setURLModifier((function(e){var t=function(e){for(var t in a)if(t.substr(-e.length)===e)return a[t]}(e);if(t){console.log("Loading",e);var r=new Blob([t.buffer],{type:"application/octet-stream"});return URL.createObjectURL(r)}return e}));var a=l.unzipSync(new Uint8Array(t));if(a["doc.kml"]){var i=(new DOMParser).parseFromString(fflate.strFromU8(a["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(i)return new Ks(r).parse(fflate.strFromU8(a[i.textContent]))}else for(var n in console.warn("KMZLoader: Missing doc.kml file."),a){if("dae"===n.split(".").pop().toLowerCase())return new Ks(r).parse(fflate.strFromU8(a[n]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new e.Group}}});var Zs=function(){function t(t){e.Loader.call(this,t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new o(e)})),this.register((function(e){return new l(e)})),this.register((function(e){return new u(e)})),this.register((function(e){return new s(e)})),this.register((function(e){return new i(e)})),this.register((function(e){return new c(e)}))}function r(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,load:function(t,r,a,i){var n,o=this;n=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:e.LoaderUtils.extractUrlBase(t),this.manager.itemStart(t);var s=function(e){i?i(e):console.error(e),o.manager.itemError(t),o.manager.itemEnd(t)},l=new e.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,(function(e){try{o.parse(e,n,(function(e){r(e),o.manager.itemEnd(t)}),s)}catch(e){s(e)}}),a,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(t,r,i,o){var s,l={},u={};if("string"==typeof t)s=t;else if(e.LoaderUtils.decodeText(new Uint8Array(t,0,4))===h){try{l[a.KHR_BINARY_GLTF]=new p(t)}catch(e){return void(o&&o(e))}s=l[a.KHR_BINARY_GLTF].content}else s=e.LoaderUtils.decodeText(new Uint8Array(t));var c=JSON.parse(s);if(void 0===c.asset||c.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var d=new z(c,{path:r||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var g=this.pluginCallbacks[f](d);u[g.name]=g,l[g.name]=!0}if(c.extensionsUsed)for(var b=0;b<c.extensionsUsed.length;++b){var A=c.extensionsUsed[b],w=c.extensionsRequired||[];switch(A){case a.KHR_MATERIALS_UNLIT:l[A]=new n;break;case a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:l[A]=new y;break;case a.KHR_DRACO_MESH_COMPRESSION:l[A]=new m(c,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:l[A]=new v;break;case a.KHR_MESH_QUANTIZATION:l[A]=new x;break;default:w.indexOf(A)>=0&&void 0===u[A]&&console.warn('THREE.GLTFLoader: Unknown extension "'+A+'".')}}d.setExtensions(l),d.setPlugins(u),d.parse(i,o)}}});var a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function i(e){this.parser=e,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function n(){this.name=a.KHR_MATERIALS_UNLIT}function o(e){this.parser=e,this.name=a.KHR_MATERIALS_CLEARCOAT}function s(e){this.parser=e,this.name=a.KHR_MATERIALS_TRANSMISSION}function l(e){this.parser=e,this.name=a.KHR_TEXTURE_BASISU}function u(e){this.parser=e,this.name=a.EXT_TEXTURE_WEBP,this.isSupported=null}function c(e){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=e}i.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,a=t.length;r<a;r++){var i=t[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}},i.prototype._loadLight=function(t){var r=this.parser,a="light:"+t,i=r.cache.get(a);if(i)return i;var n,o=r.json,s=((o.extensions&&o.extensions[this.name]||{}).lights||[])[t],l=new e.Color(16777215);void 0!==s.color&&l.fromArray(s.color);var u=void 0!==s.range?s.range:0;switch(s.type){case"directional":(n=new e.DirectionalLight(l)).target.position.set(0,0,-1),n.add(n.target);break;case"point":(n=new e.PointLight(l)).distance=u;break;case"spot":(n=new e.SpotLight(l)).distance=u,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,n.angle=s.spot.outerConeAngle,n.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,n.target.position.set(0,0,-1),n.add(n.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return n.position.set(0,0,0),n.decay=2,void 0!==s.intensity&&(n.intensity=s.intensity),n.name=r.createUniqueName(s.name||"light_"+t),i=Promise.resolve(n),r.cache.add(a,i),i},i.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,a=r.json.nodes[e],i=(a.extensions&&a.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return r._getNodeRef(t.cache,i,e)}))},n.prototype.getMaterialType=function(){return e.MeshBasicMaterial},n.prototype.extendParams=function(t,r,a){var i=[];t.color=new e.Color(1,1,1),t.opacity=1;var n=r.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){var o=n.baseColorFactor;t.color.fromArray(o),t.opacity=o[3]}void 0!==n.baseColorTexture&&i.push(a.assignTexture(t,"map",n.baseColorTexture))}return Promise.all(i)},o.prototype.getMaterialType=function(t){var r=this.parser.json.materials[t];return r.extensions&&r.extensions[this.name]?e.MeshPhysicalMaterial:null},o.prototype.extendMaterialParams=function(t,r){var a=this.parser,i=a.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var n=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(r.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&n.push(a.assignTexture(r,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(r.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&n.push(a.assignTexture(r,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(n.push(a.assignTexture(r,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var s=o.clearcoatNormalTexture.scale;r.clearcoatNormalScale=new e.Vector2(s,-s)}return Promise.all(n)},s.prototype.getMaterialType=function(t){var r=this.parser.json.materials[t];return r.extensions&&r.extensions[this.name]?e.MeshPhysicalMaterial:null},s.prototype.extendMaterialParams=function(e,t){var r=this.parser,a=r.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();var i=[],n=a.extensions[this.name];return void 0!==n.transmissionFactor&&(t.transmission=n.transmissionFactor),void 0!==n.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",n.transmissionTexture)),Promise.all(i)},l.prototype.loadTexture=function(e){var t=this.parser,r=t.json,a=r.textures[e];if(!a.extensions||!a.extensions[this.name])return null;var i=a.extensions[this.name],n=r.images[i.source],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,n,o)},u.prototype.loadTexture=function(e){var t=this.name,r=this.parser,a=r.json,i=a.textures[e];if(!i.extensions||!i.extensions[t])return null;var n=i.extensions[t],o=a.images[n.source],s=r.textureLoader;if(o.uri){var l=r.options.manager.getHandler(o.uri);null!==l&&(s=l)}return this.detectSupport().then((function(i){if(i)return r.loadTextureImage(e,o,s);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))},u.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},c.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var a=r.extensions[this.name],i=this.parser.getDependency("buffer",a.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,n.ready]).then((function(e){var t=a.byteOffset||0,r=a.byteLength||0,i=a.count,o=a.byteStride,s=new ArrayBuffer(i*o),l=new Uint8Array(e[0],t,r);return n.decodeGltfBuffer(new Uint8Array(s),i,o,l,a.mode,a.filter),s}))}return null};var h="glTF",d=1313821514,f=5130562;function p(t){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;var r=new DataView(t,0,12);if(this.header={magic:e.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==h)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,n=new DataView(t,12),o=0;o<i;){var s=n.getUint32(o,!0);o+=4;var l=n.getUint32(o,!0);if(o+=4,l===d){var u=new Uint8Array(t,12+o,s);this.content=e.LoaderUtils.decodeText(u)}else if(l===f){var c=12+o;this.body=t.slice(c,c+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function m(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function v(){this.name=a.KHR_TEXTURE_TRANSFORM}function g(t){e.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var r=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),n=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new e.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var t in s)e.uniforms[t]=s[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",r).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",n).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){s.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function y(){return{name:a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return g},extendParams:function(t,r,a){var i=r.extensions[this.name];t.color=new e.Color(1,1,1),t.opacity=1;var n=[];if(Array.isArray(i.diffuseFactor)){var o=i.diffuseFactor;t.color.fromArray(o),t.opacity=o[3]}if(void 0!==i.diffuseTexture&&n.push(a.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new e.Color(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new e.Color(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var s=i.specularGlossinessTexture;n.push(a.assignTexture(t,"glossinessMap",s)),n.push(a.assignTexture(t,"specularMap",s))}return Promise.all(n)},createMaterial:function(t){var r=new g(t);return r.fog=!0,r.color=t.color,r.map=void 0===t.map?null:t.map,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=void 0===t.aoMap?null:t.aoMap,r.aoMapIntensity=1,r.emissive=t.emissive,r.emissiveIntensity=1,r.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,r.bumpMap=void 0===t.bumpMap?null:t.bumpMap,r.bumpScale=1,r.normalMap=void 0===t.normalMap?null:t.normalMap,r.normalMapType=e.TangentSpaceNormalMap,t.normalScale&&(r.normalScale=t.normalScale),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=void 0===t.specularMap?null:t.specularMap,r.specular=t.specular,r.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,r.glossiness=t.glossiness,r.alphaMap=null,r.envMap=void 0===t.envMap?null:t.envMap,r.envMapIntensity=1,r.refractionRatio=.98,r}}}function x(){this.name=a.KHR_MESH_QUANTIZATION}function b(t,r,a,i){e.Interpolant.call(this,t,r,a,i)}m.prototype.decodePrimitive=function(e,t){var r=this.json,a=this.dracoLoader,i=e.extensions[this.name].bufferView,n=e.extensions[this.name].attributes,o={},s={},l={};for(var u in n){var c=D[u]||u.toLowerCase();o[c]=n[u]}for(var h in e.attributes){c=D[h]||h.toLowerCase();if(void 0!==n[h]){var d=r.accessors[e.attributes[h]],f=E[d.componentType];l[c]=f,s[c]=!0===d.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){a.decodeDracoFile(e,(function(e){for(var r in e.attributes){var a=e.attributes[r],i=s[r];void 0!==i&&(a.normalized=i)}t(e)}),o,l)}))}))},v.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},g.prototype=Object.create(e.MeshStandardMaterial.prototype),g.prototype.constructor=g,g.prototype.copy=function(t){return e.MeshStandardMaterial.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},b.prototype=Object.create(e.Interpolant.prototype),b.prototype.constructor=b,b.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,a=this.valueSize,i=e*a*3+a,n=0;n!==a;n++)t[n]=r[i+n];return t},b.prototype.beforeStart_=b.prototype.copySampleValue_,b.prototype.afterEnd_=b.prototype.copySampleValue_,b.prototype.interpolate_=function(e,t,r,a){for(var i=this.resultBuffer,n=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=a-t,c=(r-t)/u,h=c*c,d=h*c,f=e*l,p=f-l,m=-2*d+3*h,v=d-h,g=1-m,y=v-h+c,x=0;x!==o;x++){var b=n[p+x+o],A=n[p+x+s]*u,w=n[f+x+o],M=n[f+x]*u;i[x]=g*b+y*A+m*w+v*M}return i};var A=0,w=1,M=2,S=3,T=4,C=5,F=6,E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},B={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipmapNearestFilter,9985:e.LinearMipmapNearestFilter,9986:e.NearestMipmapLinearFilter,9987:e.LinearMipmapLinearFilter},L={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},P={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},D={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},N={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},R={CUBICSPLINE:void 0,LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},_="OPAQUE",I="MASK",O="BLEND";function U(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function k(e,t,r){for(var a in r.extensions)void 0===e[a]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[a]=r.extensions[a])}function V(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function G(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,a=t.weights.length;r<a;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var n=0,o=i.length;n<o;n++)e.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function j(e){for(var t="",r=Object.keys(e).sort(),a=0,i=r.length;a<i;a++)t+=r[a]+":"+e[r[a]]+";";return t}function z(t,a){this.json=t||{},this.extensions={},this.plugins={},this.options=a||{},this.cache=new r,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new e.ImageBitmapLoader(this.options.manager):this.textureLoader=new e.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new e.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function H(t,r,a){var i=r.attributes,n=[];function o(e,r){return a.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(var s in i){var l=D[s]||s.toLowerCase();l in t.attributes||n.push(o(i[s],l))}if(void 0!==r.indices&&!t.index){var u=a.getDependency("accessor",r.indices).then((function(e){t.setIndex(e)}));n.push(u)}return V(t,r),function(t,r,a){var i=r.attributes,n=new e.Box3;if(void 0!==i.POSITION){var o=(f=a.json.accessors[i.POSITION]).min,s=f.max;if(void 0!==o&&void 0!==s){n.set(new e.Vector3(o[0],o[1],o[2]),new e.Vector3(s[0],s[1],s[2]));var l=r.targets;if(void 0!==l){for(var u=new e.Vector3,c=new e.Vector3,h=0,d=l.length;h<d;h++){var f,p=l[h];if(void 0!==p.POSITION)o=(f=a.json.accessors[p.POSITION]).min,s=f.max,void 0!==o&&void 0!==s?(c.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),c.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),c.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),u.max(c)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}n.expandByVector(u)}t.boundingBox=n;var m=new e.Sphere;n.getCenter(m.center),m.radius=n.min.distanceTo(n.max)/2,t.boundingSphere=m}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,r,a),Promise.all(n).then((function(){return void 0!==r.targets?function(e,t,r){for(var a=!1,i=!1,n=0,o=t.length;n<o&&(void 0!==(h=t[n]).POSITION&&(a=!0),void 0!==h.NORMAL&&(i=!0),!a||!i);n++);if(!a&&!i)return Promise.resolve(e);for(var s=[],l=[],u=0,c=t.length;u<c;u++){var h=t[u];if(a){var d=void 0!==h.POSITION?r.getDependency("accessor",h.POSITION):e.attributes.position;s.push(d)}i&&(d=void 0!==h.NORMAL?r.getDependency("accessor",h.NORMAL):e.attributes.normal,l.push(d))}return Promise.all([Promise.all(s),Promise.all(l)]).then((function(t){var r=t[0],n=t[1];return a&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=n),e.morphTargetsRelative=!0,e}))}(t,r.targets,a):t}))}function W(t,r){var a=t.getIndex();if(null===a){var i=[],n=t.getAttribute("position");if(void 0===n)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<n.count;o++)i.push(o);t.setIndex(i),a=t.getIndex()}var s=a.count-2,l=[];if(r===e.TriangleFanDrawMode)for(var u=1;u<=s;u++)l.push(a.getX(0)),l.push(a.getX(u)),l.push(a.getX(u+1));else for(var c=0;c<s;c++)c%2==0?(l.push(a.getX(c)),l.push(a.getX(c+1)),l.push(a.getX(c+2))):(l.push(a.getX(c+2)),l.push(a.getX(c+1)),l.push(a.getX(c)));l.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var h=t.clone();return h.setIndex(l),h}return z.prototype.setExtensions=function(e){this.extensions=e},z.prototype.setPlugins=function(e){this.plugins=e},z.prototype.parse=function(e,t){var r=this,a=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var n={scene:t[0][a.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:a.asset,parser:r,userData:{}};k(i,n,a),V(n,a),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(n)}))).then((function(){e(n)}))})).catch(t)},z.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],a=0,i=t.length;a<i;a++)for(var n=t[a].joints,o=0,s=n.length;o<s;o++)e[n[o]].isBone=!0;for(var l=0,u=e.length;l<u;l++){var c=e[l];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(r[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}},z.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},z.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var a=r.clone();return a.name+="_instance_"+e.uses[t]++,a},z.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var a=e(t[r]);if(a)return a}},z.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],a=0;a<t.length;a++){var i=e(t[a]);i&&r.push(i)}return r},z.prototype.getDependency=function(e,t){var r=e+":"+t,a=this.cache.get(r);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this.loadNode(t);break;case"mesh":a=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":a=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":a=this.loadSkin(t);break;case"animation":a=this.loadAnimation(t);break;case"camera":a=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,a)}return a},z.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,a=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(a.map((function(t,a){return r.getDependency(e,a)}))),this.cache.add(e,t)}return t},z.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,a){r.load(U(t.uri,i.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},z.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,a=t.byteOffset||0;return e.slice(a,a+r)}))},z.prototype.loadAccessor=function(t){var r=this,a=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var n=[];return void 0!==i.bufferView?n.push(this.getDependency("bufferView",i.bufferView)):n.push(null),void 0!==i.sparse&&(n.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(n).then((function(t){var n,o,s=t[0],l=P[i.type],u=E[i.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,d=i.byteOffset||0,f=void 0!==i.bufferView?a.bufferViews[i.bufferView].byteStride:void 0,p=!0===i.normalized;if(f&&f!==h){var m=Math.floor(d/f),v="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+m+":"+i.count,g=r.cache.get(v);g||(n=new u(s,m*f,i.count*f/c),g=new e.InterleavedBuffer(n,f/c),r.cache.add(v,g)),o=new e.InterleavedBufferAttribute(g,l,d%f/c,p)}else n=null===s?new u(i.count*l):new u(s,d,i.count*l),o=new e.BufferAttribute(n,l,p);if(void 0!==i.sparse){var y=P.SCALAR,x=E[i.sparse.indices.componentType],b=i.sparse.indices.byteOffset||0,A=i.sparse.values.byteOffset||0,w=new x(t[1],b,i.sparse.count*y),M=new u(t[2],A,i.sparse.count*l);null!==s&&(o=new e.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var S=0,T=w.length;S<T;S++){var C=w[S];if(o.setX(C,M[S*l]),l>=2&&o.setY(C,M[S*l+1]),l>=3&&o.setZ(C,M[S*l+2]),l>=4&&o.setW(C,M[S*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},z.prototype.loadTexture=function(e){var t=this.json,r=this.options,a=t.textures[e],i=t.images[a.source],n=this.textureLoader;if(i.uri){var o=r.manager.getHandler(i.uri);null!==o&&(n=o)}return this.loadTextureImage(e,i,n)},z.prototype.loadTextureImage=function(t,r,a){var i=this,n=this.json,o=this.options,s=n.textures[t],l=self.URL||self.webkitURL,u=r.uri,c=!1,h=!0;if("image/jpeg"===r.mimeType&&(h=!1),void 0!==r.bufferView)u=i.getDependency("bufferView",r.bufferView).then((function(e){if("image/png"===r.mimeType){var t=new DataView(e,25,1).getUint8(0,!1);h=6===t||4===t||3===t}c=!0;var a=new Blob([e],{type:r.mimeType});return u=l.createObjectURL(a)}));else if(void 0===r.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");return Promise.resolve(u).then((function(t){return new Promise((function(r,i){var n=r;!0===a.isImageBitmapLoader&&(n=function(t){r(new e.CanvasTexture(t))}),a.load(U(t,o.path),n,void 0,i)}))})).then((function(r){!0===c&&l.revokeObjectURL(u),r.flipY=!1,s.name&&(r.name=s.name),h||(r.format=e.RGBFormat);var a=(n.samplers||{})[s.sampler]||{};return r.magFilter=B[a.magFilter]||e.LinearFilter,r.minFilter=B[a.minFilter]||e.LinearMipmapLinearFilter,r.wrapS=L[a.wrapS]||e.RepeatWrapping,r.wrapT=L[a.wrapT]||e.RepeatWrapping,i.associations.set(r,{type:"textures",index:t}),r}))},z.prototype.assignTexture=function(e,t,r){var i=this;return this.getDependency("texture",r.index).then((function(n){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),i.extensions[a.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var s=i.associations.get(n);n=i.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(n,o),i.associations.set(n,s)}}e[t]=n}))},z.prototype.assignFinalMaterial=function(t){var r=t.geometry,a=t.material,i=void 0!==r.attributes.tangent,n=void 0!==r.attributes.color,o=void 0===r.attributes.normal,s=!0===t.isSkinnedMesh,l=Object.keys(r.morphAttributes).length>0,u=l&&void 0!==r.morphAttributes.normal;if(t.isPoints){var c="PointsMaterial:"+a.uuid,h=this.cache.get(c);h||(h=new e.PointsMaterial,e.Material.prototype.copy.call(h,a),h.color.copy(a.color),h.map=a.map,h.sizeAttenuation=!1,this.cache.add(c,h)),a=h}else if(t.isLine){c="LineBasicMaterial:"+a.uuid;var d=this.cache.get(c);d||(d=new e.LineBasicMaterial,e.Material.prototype.copy.call(d,a),d.color.copy(a.color),this.cache.add(c,d)),a=d}if(i||n||o||s||l){c="ClonedMaterial:"+a.uuid+":";a.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),s&&(c+="skinning:"),i&&(c+="vertex-tangents:"),n&&(c+="vertex-colors:"),o&&(c+="flat-shading:"),l&&(c+="morph-targets:"),u&&(c+="morph-normals:");var f=this.cache.get(c);f||(f=a.clone(),s&&(f.skinning=!0),n&&(f.vertexColors=!0),o&&(f.flatShading=!0),l&&(f.morphTargets=!0),u&&(f.morphNormals=!0),i&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(c,f),this.associations.set(f,this.associations.get(a))),a=f}a.aoMap&&void 0===r.attributes.uv2&&void 0!==r.attributes.uv&&r.setAttribute("uv2",r.attributes.uv),t.material=a},z.prototype.getMaterialType=function(){return e.MeshStandardMaterial},z.prototype.loadMaterial=function(t){var r,i=this,n=this.json,o=this.extensions,s=n.materials[t],l={},u=s.extensions||{},c=[];if(u[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=o[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=h.getMaterialType(),c.push(h.extendParams(l,s,i))}else if(u[a.KHR_MATERIALS_UNLIT]){var d=o[a.KHR_MATERIALS_UNLIT];r=d.getMaterialType(),c.push(d.extendParams(l,s,i))}else{var f=s.pbrMetallicRoughness||{};if(l.color=new e.Color(1,1,1),l.opacity=1,Array.isArray(f.baseColorFactor)){var p=f.baseColorFactor;l.color.fromArray(p),l.opacity=p[3]}void 0!==f.baseColorTexture&&c.push(i.assignTexture(l,"map",f.baseColorTexture)),l.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,l.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(c.push(i.assignTexture(l,"metalnessMap",f.metallicRoughnessTexture)),c.push(i.assignTexture(l,"roughnessMap",f.metallicRoughnessTexture))),r=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),c.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,l)}))))}!0===s.doubleSided&&(l.side=e.DoubleSide);var m=s.alphaMode||_;return m===O?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,m===I&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&r!==e.MeshBasicMaterial&&(c.push(i.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new e.Vector2(1,-1),void 0!==s.normalTexture.scale&&l.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&r!==e.MeshBasicMaterial&&(c.push(i.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&r!==e.MeshBasicMaterial&&(l.emissive=(new e.Color).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&r!==e.MeshBasicMaterial&&c.push(i.assignTexture(l,"emissiveMap",s.emissiveTexture)),Promise.all(c).then((function(){var n;return n=r===g?o[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):new r(l),s.name&&(n.name=s.name),n.map&&(n.map.encoding=e.sRGBEncoding),n.emissiveMap&&(n.emissiveMap.encoding=e.sRGBEncoding),V(n,s),i.associations.set(n,{type:"materials",index:t}),s.extensions&&k(o,n,s),n}))},z.prototype.createUniqueName=function(t){for(var r=e.PropertyBinding.sanitizeNodeName(t||""),a=r,i=1;this.nodeNamesUsed[a];++i)a=r+"_"+i;return this.nodeNamesUsed[a]=!0,a},z.prototype.loadGeometries=function(t){var r=this,i=this.extensions,n=this.primitiveCache;function o(e){return i[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then((function(t){return H(t,e,r)}))}for(var s,l,u=[],c=0,h=t.length;c<h;c++){var d,f=t[c],p=(l=void 0,(l=(s=f).extensions&&s.extensions[a.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+j(l.attributes):s.indices+":"+j(s.attributes)+":"+s.mode),m=n[p];if(m)u.push(m.promise);else d=f.extensions&&f.extensions[a.KHR_DRACO_MESH_COMPRESSION]?o(f):H(new e.BufferGeometry,f,r),n[p]={primitive:f,promise:d},u.push(d)}return Promise.all(u)},z.prototype.loadMesh=function(t){for(var r,a=this,i=this.json,n=this.extensions,o=i.meshes[t],s=o.primitives,l=[],u=0,c=s.length;u<c;u++){var h=void 0===s[u].material?(void 0===(r=this.cache).DefaultMaterial&&(r.DefaultMaterial=new e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:e.FrontSide})),r.DefaultMaterial):this.getDependency("material",s[u].material);l.push(h)}return l.push(a.loadGeometries(s)),Promise.all(l).then((function(r){for(var i=r.slice(0,r.length-1),l=r[r.length-1],u=[],c=0,h=l.length;c<h;c++){var d,f=l[c],p=s[c],m=i[c];if(p.mode===T||p.mode===C||p.mode===F||void 0===p.mode)!0!==(d=!0===o.isSkinnedMesh?new e.SkinnedMesh(f,m):new e.Mesh(f,m)).isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),p.mode===C?d.geometry=W(d.geometry,e.TriangleStripDrawMode):p.mode===F&&(d.geometry=W(d.geometry,e.TriangleFanDrawMode));else if(p.mode===w)d=new e.LineSegments(f,m);else if(p.mode===S)d=new e.Line(f,m);else if(p.mode===M)d=new e.LineLoop(f,m);else{if(p.mode!==A)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);d=new e.Points(f,m)}Object.keys(d.geometry.morphAttributes).length>0&&G(d,o),d.name=a.createUniqueName(o.name||"mesh_"+t),V(d,o),p.extensions&&k(n,d,p),a.assignFinalMaterial(d),u.push(d)}if(1===u.length)return u[0];for(var v=new e.Group,g=0,y=u.length;g<y;g++)v.add(u[g]);return v}))},z.prototype.loadCamera=function(t){var r,a=this.json.cameras[t],i=a[a.type];if(i)return"perspective"===a.type?r=new e.PerspectiveCamera(e.MathUtils.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===a.type&&(r=new e.OrthographicCamera(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),a.name&&(r.name=this.createUniqueName(a.name)),V(r,a),Promise.resolve(r);console.warn("THREE.GLTFLoader: Missing camera parameters.")},z.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},z.prototype.loadAnimation=function(t){for(var r=this.json.animations[t],a=[],i=[],n=[],o=[],s=[],l=0,u=r.channels.length;l<u;l++){var c=r.channels[l],h=r.samplers[c.sampler],d=c.target,f=void 0!==d.node?d.node:d.id,p=void 0!==r.parameters?r.parameters[h.input]:h.input,m=void 0!==r.parameters?r.parameters[h.output]:h.output;a.push(this.getDependency("node",f)),i.push(this.getDependency("accessor",p)),n.push(this.getDependency("accessor",m)),o.push(h),s.push(d)}return Promise.all([Promise.all(a),Promise.all(i),Promise.all(n),Promise.all(o),Promise.all(s)]).then((function(a){for(var i=a[0],n=a[1],o=a[2],s=a[3],l=a[4],u=[],c=0,h=i.length;c<h;c++){var d=i[c],f=n[c],p=o[c],m=s[c],v=l[c];if(void 0!==d){var g;switch(d.updateMatrix(),d.matrixAutoUpdate=!0,N[v.path]){case N.weights:g=e.NumberKeyframeTrack;break;case N.rotation:g=e.QuaternionKeyframeTrack;break;case N.position:case N.scale:default:g=e.VectorKeyframeTrack}var y=d.name?d.name:d.uuid,x=void 0!==m.interpolation?R[m.interpolation]:e.InterpolateLinear,A=[];N[v.path]===N.weights?d.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&A.push(e.name?e.name:e.uuid)})):A.push(y);var w=p.array;if(p.normalized){var M;if(w.constructor===Int8Array)M=1/127;else if(w.constructor===Uint8Array)M=1/255;else if(w.constructor==Int16Array)M=1/32767;else{if(w.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");M=1/65535}for(var S=new Float32Array(w.length),T=0,C=w.length;T<C;T++)S[T]=w[T]*M;w=S}for(var F=0,E=A.length;F<E;F++){var B=new g(A[F]+"."+N[v.path],f.array,w,x);"CUBICSPLINE"===m.interpolation&&(B.createInterpolant=function(e){return new b(this.times,this.values,this.getValueSize()/3,e)},B.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(B)}}}var L=r.name?r.name:"animation_"+t;return new e.AnimationClip(L,void 0,u)}))},z.prototype.loadNode=function(t){var r,a=this.json,i=this.extensions,n=this,o=a.nodes[t],s=o.name?n.createUniqueName(o.name):"";return(r=[],void 0!==o.mesh&&r.push(n.getDependency("mesh",o.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,o.mesh,e);return void 0!==o.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=o.weights.length;t<r;t++)e.morphTargetInfluences[t]=o.weights[t]})),t}))),void 0!==o.camera&&r.push(n.getDependency("camera",o.camera).then((function(e){return n._getNodeRef(n.cameraCache,o.camera,e)}))),n._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(e){r.push(e)})),Promise.all(r)).then((function(r){var a;if((a=!0===o.isBone?new e.Bone:r.length>1?new e.Group:1===r.length?r[0]:new e.Object3D)!==r[0])for(var l=0,u=r.length;l<u;l++)a.add(r[l]);if(o.name&&(a.userData.name=o.name,a.name=s),V(a,o),o.extensions&&k(i,a,o),void 0!==o.matrix){var c=new e.Matrix4;c.fromArray(o.matrix),a.applyMatrix4(c)}else void 0!==o.translation&&a.position.fromArray(o.translation),void 0!==o.rotation&&a.quaternion.fromArray(o.rotation),void 0!==o.scale&&a.scale.fromArray(o.scale);return n.associations.set(a,{type:"nodes",index:t}),a}))},z.prototype.loadScene=function(){function t(r,a,i,n){var o=i.nodes[r];return n.getDependency("node",r).then((function(t){return void 0===o.skin?t:n.getDependency("skin",o.skin).then((function(e){for(var t=[],a=0,i=(r=e).joints.length;a<i;a++)t.push(n.getDependency("node",r.joints[a]));return Promise.all(t)})).then((function(a){return t.traverse((function(t){if(t.isMesh){for(var i=[],n=[],o=0,s=a.length;o<s;o++){var l=a[o];if(l){i.push(l);var u=new e.Matrix4;void 0!==r.inverseBindMatrices&&u.fromArray(r.inverseBindMatrices.array,16*o),n.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',r.joints[o])}t.bind(new e.Skeleton(i,n),t.matrixWorld)}})),t}));var r})).then((function(e){a.add(e);var r=[];if(o.children)for(var s=o.children,l=0,u=s.length;l<u;l++){var c=s[l];r.push(t(c,e,i,n))}return Promise.all(r)}))}return function(r){var a=this.json,i=this.extensions,n=this.json.scenes[r],o=new e.Group;n.name&&(o.name=this.createUniqueName(n.name)),V(o,n),n.extensions&&k(i,o,n);for(var s=n.nodes||[],l=[],u=0,c=s.length;u<c;u++)l.push(t(s[u],o,a,this));return Promise.all(l).then((function(){return o}))}}(),t}(),$s=function(){function t(t){if(void 0===Zs)throw new Error("THREE.VRMLoader: Import GLTFLoader.");e.Loader.call(this,t),this.gltfLoader=new Zs(this.manager)}return t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,load:function(e,t,r,a){var i=this;this.gltfLoader.load(e,(function(r){try{i.parse(r,t)}catch(t){a?a(t):console.error(t),i.manager.itemError(e)}}),r,a)},setDRACOLoader:function(e){return this.gltfLoader.setDRACOLoader(e),this},parse:function(e,t){t(e)}}),t}(),el=function(){function t(t){e.Loader.call(this,t)}function r(e){this.lexer=new c.Lexer(e)}function a(e){c.Parser.call(this,e);var t=this,r=e.Version,a=e.LCurly,i=e.RCurly,n=e.LSquare,o=e.RSquare,s=e.Identifier,l=e.RouteIdentifier,u=e.StringLiteral,h=e.HexLiteral,d=e.NumberLiteral,f=e.TrueLiteral,p=e.FalseLiteral,m=e.NullLiteral,v=e.DEF,g=e.USE,y=e.ROUTE,x=e.TO,b=e.NodeName;t.RULE("vrml",(function(){t.SUBRULE(t.version),t.AT_LEAST_ONE((function(){t.SUBRULE(t.node)})),t.MANY((function(){t.SUBRULE(t.route)}))})),t.RULE("version",(function(){t.CONSUME(r)})),t.RULE("node",(function(){t.OPTION((function(){t.SUBRULE(t.def)})),t.CONSUME(b),t.CONSUME(a),t.MANY((function(){t.SUBRULE(t.field)})),t.CONSUME(i)})),t.RULE("field",(function(){t.CONSUME(s),t.OR2([{ALT:function(){t.SUBRULE(t.singleFieldValue)}},{ALT:function(){t.SUBRULE(t.multiFieldValue)}}])})),t.RULE("def",(function(){t.CONSUME(v),t.OR([{ALT:function(){t.CONSUME(s)}},{ALT:function(){t.CONSUME(b)}}])})),t.RULE("use",(function(){t.CONSUME(g),t.OR([{ALT:function(){t.CONSUME(s)}},{ALT:function(){t.CONSUME(b)}}])})),t.RULE("singleFieldValue",(function(){t.AT_LEAST_ONE((function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(u)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(d)}},{ALT:function(){t.CONSUME(f)}},{ALT:function(){t.CONSUME(p)}},{ALT:function(){t.CONSUME(m)}}])}))})),t.RULE("multiFieldValue",(function(){t.CONSUME(n),t.MANY((function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(u)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(d)}},{ALT:function(){t.CONSUME(m)}}])})),t.CONSUME(o)})),t.RULE("route",(function(){t.CONSUME(y),t.CONSUME(l),t.CONSUME(x),t.CONSUME2(l)})),this.performSelfAnalysis()}function i(t,r,a){this.a=t,this.b=r,this.c=a,this.normal=new e.Vector3}t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,load:function(t,r,a,i){var n=this,o=""===n.path?e.LoaderUtils.extractUrlBase(t):n.path,s=new e.FileLoader(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t,o){var s={};function l(e){e.DEF&&(s[e.DEF]=e);for(var t=e.fields,r=0,a=t.length;r<a;r++){var i=t[r];if("node"===i.type)for(var n=i.values,o=0,u=n.length;o<u;o++)l(n[o])}}function u(t){return t.USE?(r=t.USE,(a=u(s[r])).isObject3D||a.isMaterial?a.clone():a):(void 0!==t.build||(t.build=function(t){var r,a=t.name;switch(a){case"Group":case"Transform":case"Collision":r=function(t){for(var r=new e.Group,a=t.fields,i=0,n=a.length;i<n;i++){var o=a[i],s=o.name,l=o.values;switch(s){case"bboxCenter":case"bboxSize":case"center":break;case"children":f(l,r);break;case"collide":break;case"rotation":var u=new e.Vector3(l[0],l[1],l[2]),c=l[3];r.quaternion.setFromAxisAngle(u,c);break;case"scale":r.scale.set(l[0],l[1],l[2]);break;case"scaleOrientation":break;case"translation":r.position.set(l[0],l[1],l[2]);break;case"proxy":break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return r}(t);break;case"Background":r=function(t){for(var r,a,i,n,o=new e.Group,s=t.fields,l=0,u=s.length;l<u;l++){var c=s[l],h=c.name,d=c.values;switch(h){case"groundAngle":r=d;break;case"groundColor":a=d;break;case"backUrl":case"bottomUrl":case"frontUrl":case"leftUrl":case"rightUrl":case"topUrl":break;case"skyAngle":i=d;break;case"skyColor":n=d;break;default:console.warn("THREE.VRMLLoader: Unknown field:",h)}}var f=1e4;if(n){var p=new e.SphereGeometry(f,32,16),m=new e.MeshBasicMaterial({fog:!1,side:e.BackSide,depthWrite:!1,depthTest:!1});n.length>3?(R(p,f,i,N(n),!0),m.vertexColors=!0):m.color.setRGB(n[0],n[1],n[2]);var v=new e.Mesh(p,m);o.add(v)}if(a&&a.length>0){var g=new e.SphereGeometry(f,32,16,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),y=new e.MeshBasicMaterial({fog:!1,side:e.BackSide,vertexColors:!0,depthWrite:!1,depthTest:!1});R(g,f,r,N(a),!1);var x=new e.Mesh(g,y);o.add(x)}return o.renderOrder=-1/0,o}(t);break;case"Shape":r=function(t){for(var r,a,i=t.fields,n=new e.MeshBasicMaterial({color:0}),o=0,s=i.length;o<s;o++){var l=i[o],c=l.name,h=l.values;switch(c){case"appearance":null!==h[0]&&(n=u(h[0]));break;case"geometry":null!==h[0]&&(r=u(h[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}if(r&&r.attributes.position){var d=r._type;if("points"===d){var f=new e.PointsMaterial({color:16777215});void 0!==r.attributes.color?f.vertexColors=!0:n.isMeshPhongMaterial&&f.color.copy(n.emissive),a=new e.Points(r,f)}else if("line"===d){var p=new e.LineBasicMaterial({color:16777215});void 0!==r.attributes.color?p.vertexColors=!0:n.isMeshPhongMaterial&&p.color.copy(n.emissive),a=new e.LineSegments(r,p)}else void 0!==r._solid&&(n.side=r._solid?e.FrontSide:e.DoubleSide),void 0!==r.attributes.color&&(n.vertexColors=!0),a=new e.Mesh(r,n)}else(a=new e.Object3D).visible=!1;return a}(t);break;case"Appearance":r=function(t){for(var r,a=new e.MeshPhongMaterial,i=t.fields,o=0,s=i.length;o<s;o++){var l=i[o],c=l.name,h=l.values;switch(c){case"material":if(null!==h[0]){var d=u(h[0]);d.diffuseColor&&a.color.copy(d.diffuseColor),d.emissiveColor&&a.emissive.copy(d.emissiveColor),d.shininess&&(a.shininess=d.shininess),d.specularColor&&a.specular.copy(d.specularColor),d.transparency&&(a.opacity=1-d.transparency),d.transparency>0&&(a.transparent=!0)}else a=new e.MeshBasicMaterial({color:0});break;case"texture":var f=h[0];null!==f&&("ImageTexture"!==f.name&&"PixelTexture"!==f.name||(a.map=u(f)));break;case"textureTransform":null!==h[0]&&(r=u(h[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}if(a.map){if(a.map.__type){switch(a.map.__type){case n.INTENSITY_ALPHA:a.opacity=1;break;case n.RGB:a.color.set(16777215);break;case n.RGBA:a.color.set(16777215),a.opacity=1}delete a.map.__type}r&&(a.map.center.copy(r.center),a.map.rotation=r.rotation,a.map.repeat.copy(r.scale),a.map.offset.copy(r.translation))}return a}(t);break;case"Material":r=function(t){for(var r={},a=t.fields,i=0,n=a.length;i<n;i++){var o=a[i],s=o.name,l=o.values;switch(s){case"ambientIntensity":break;case"diffuseColor":r.diffuseColor=new e.Color(l[0],l[1],l[2]);break;case"emissiveColor":r.emissiveColor=new e.Color(l[0],l[1],l[2]);break;case"shininess":r.shininess=l[0];break;case"specularColor":r.emissiveColor=new e.Color(l[0],l[1],l[2]);break;case"transparency":r.transparency=l[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return r}(t);break;case"ImageTexture":r=function(t){for(var r,a=e.RepeatWrapping,i=e.RepeatWrapping,n=t.fields,o=0,s=n.length;o<s;o++){var l=n[o],u=l.name,c=l.values;switch(u){case"url":var h=c[0];h&&(r=_.load(h));break;case"repeatS":!1===c[0]&&(a=e.ClampToEdgeWrapping);break;case"repeatT":!1===c[0]&&(i=e.ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}r&&(r.wrapS=a,r.wrapT=i);return r}(t);break;case"PixelTexture":r=function(t){for(var r,a=e.RepeatWrapping,i=e.RepeatWrapping,n=t.fields,o=0,s=n.length;o<s;o++){var l=n[o],u=l.name,c=l.values;switch(u){case"image":for(var f=c[0],p=c[1],m=c[2],v=2===m||4===m,g=d(m),y=new Uint8Array(f*p*(!0===v?4:3)),x={r:0,g:0,b:0,a:0},b=3,A=0,w=c.length;b<w;b++,A++){var M;if(h(c[b],g,x),!0===v)y[(M=4*A)+0]=x.r,y[M+1]=x.g,y[M+2]=x.b,y[M+3]=x.a;else y[(M=3*A)+0]=x.r,y[M+1]=x.g,y[M+2]=x.b}(r=new e.DataTexture(y,f,p,!0===v?e.RGBAFormat:e.RGBFormat)).__type=g;break;case"repeatS":!1===c[0]&&(a=e.ClampToEdgeWrapping);break;case"repeatT":!1===c[0]&&(i=e.ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}r&&(r.wrapS=a,r.wrapT=i);return r}(t);break;case"TextureTransform":r=function(t){for(var r={center:new e.Vector2,rotation:new e.Vector2,scale:new e.Vector2,translation:new e.Vector2},a=t.fields,i=0,n=a.length;i<n;i++){var o=a[i],s=o.name,l=o.values;switch(s){case"center":r.center.set(l[0],l[1]);break;case"rotation":r.rotation=l[0];break;case"scale":r.scale.set(l[0],l[1]);break;case"translation":r.translation.set(l[0],l[1]);break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return r}(t);break;case"IndexedFaceSet":r=function(t){for(var r,a,i,n,o,s,l,c,h=!0,d=!0,f=0,g=!0,y=!0,x=t.fields,b=0,A=x.length;b<A;b++){var w=x[b],M=w.name,S=w.values;switch(M){case"color":var F=S[0];null!==F&&(r=u(F));break;case"coord":var B=S[0];null!==B&&(a=u(B));break;case"normal":var L=S[0];null!==L&&(i=u(L));break;case"texCoord":var D=S[0];null!==D&&(n=u(D));break;case"ccw":h=S[0];break;case"colorIndex":o=S;break;case"colorPerVertex":g=S[0];break;case"convex":break;case"coordIndex":s=S;break;case"creaseAngle":f=S[0];break;case"normalIndex":l=S;break;case"normalPerVertex":y=S[0];break;case"solid":d=S[0];break;case"texCoordIndex":c=S;break;default:console.warn("THREE.VRMLLoader: Unknown field:",M)}}if(void 0===s)return console.warn("THREE.VRMLLoader: Missing coordIndex."),new e.BufferGeometry;var N,R,_,I,O=p(s,h);if(r){if(!0===g)if(o&&o.length>0)R=T(O,p(o,h),r,3);else R=E(O,new e.Float32BufferAttribute(r,3));else if(o&&o.length>0)R=C(O,m(v(r,o),s));else R=C(O,m(r,s))}if(i){if(!0===y)if(l&&l.length>0)_=T(O,p(l,h),i,3);else _=E(O,new e.Float32BufferAttribute(i,3));else if(l&&l.length>0)_=C(O,m(v(i,l),s));else _=C(O,m(i,s))}else _=P(O,a,f);if(n){if(c&&c.length>0)I=T(O,p(c,h),n,2);else I=E(O,new e.Float32BufferAttribute(n,2))}var U=new e.BufferGeometry;N=E(O,new e.Float32BufferAttribute(a,3)),U.setAttribute("position",N),U.setAttribute("normal",_),R&&U.setAttribute("color",R);I&&U.setAttribute("uv",I);return U._solid=d,U._type="mesh",U}(t);break;case"IndexedLineSet":r=function(t){for(var r,a,i,n,o,s=!0,l=t.fields,c=0,h=l.length;c<h;c++){var d=l[c],f=d.name,p=d.values;switch(f){case"color":var m=p[0];null!==m&&(r=u(m));break;case"coord":var x=p[0];null!==x&&(a=u(x));break;case"colorIndex":i=p;break;case"colorPerVertex":s=p[0];break;case"coordIndex":n=p;break;default:console.warn("THREE.VRMLLoader: Unknown field:",f)}}var b=g(n);if(r){if(!0===s)if(i.length>0)o=T(b,g(i),r,3);else o=E(b,new e.Float32BufferAttribute(r,3));else if(i.length>0)o=F(b,y(v(r,i),n));else o=F(b,y(r,n))}var A=new e.BufferGeometry,w=E(b,new e.Float32BufferAttribute(a,3));A.setAttribute("position",w),o&&A.setAttribute("color",o);return A._type="line",A}(t);break;case"PointSet":r=function(t){for(var r,a,i=t.fields,n=0,o=i.length;n<o;n++){var s=i[n],l=s.name,c=s.values;switch(l){case"color":var h=c[0];null!==h&&(r=u(h));break;case"coord":var d=c[0];null!==d&&(a=u(d));break;default:console.warn("THREE.VRMLLoader: Unknown field:",l)}}var f;(f=new e.BufferGeometry).setAttribute("position",new e.Float32BufferAttribute(a,3)),r&&f.setAttribute("color",new e.Float32BufferAttribute(r,3));return f._type="points",f}(t);break;case"Box":r=function(t){for(var r=new e.Vector3(2,2,2),a=t.fields,i=0,n=a.length;i<n;i++){var o=a[i],s=o.name,l=o.values;switch(s){case"size":r.x=l[0],r.y=l[1],r.z=l[2];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return new e.BoxGeometry(r.x,r.y,r.z)}(t);break;case"Cone":r=function(t){for(var r=1,a=2,i=!1,n=t.fields,o=0,s=n.length;o<s;o++){var l=n[o],u=l.name,c=l.values;switch(u){case"bottom":i=!c[0];break;case"bottomRadius":r=c[0];break;case"height":a=c[0];break;case"side":break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}return new e.ConeGeometry(r,a,16,1,i)}(t);break;case"Cylinder":r=function(t){for(var r=1,a=2,i=t.fields,n=0,o=i.length;n<o;n++){var s=i[n],l=s.name,u=s.values;switch(l){case"bottom":break;case"radius":r=u[0];break;case"height":a=u[0];break;case"side":case"top":break;default:console.warn("THREE.VRMLLoader: Unknown field:",l)}}return new e.CylinderGeometry(r,r,a,16,1)}(t);break;case"Sphere":r=function(t){for(var r=1,a=t.fields,i=0,n=a.length;i<n;i++){var o=a[i],s=o.name,l=o.values;switch(s){case"radius":r=l[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return new e.SphereGeometry(r,16,16)}(t);break;case"ElevationGrid":r=function(t){for(var r,a,i,n,o=!0,s=!0,l=!0,c=!0,h=0,d=2,f=2,p=1,m=1,v=t.fields,g=0,y=v.length;g<y;g++){var x=v[g],b=x.name,A=x.values;switch(b){case"color":var w=A[0];null!==w&&(r=u(w));break;case"normal":var M=A[0];null!==M&&(a=u(M));break;case"texCoord":var S=A[0];null!==S&&(i=u(S));break;case"height":n=A;break;case"ccw":c=A[0];break;case"colorPerVertex":o=A[0];break;case"creaseAngle":h=A[0];break;case"normalPerVertex":s=A[0];break;case"solid":l=A[0];break;case"xDimension":d=A[0];break;case"xSpacing":p=A[0];break;case"zDimension":f=A[0];break;case"zSpacing":m=A[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",b)}}for(var T=[],C=[],F=[],B=[],L=0;L<f;L++)for(var D=0;D<d;D++){var N=p*L,R=n[ie=L*d+D],_=m*D;if(T.push(N,R,_),r&&!0===o){var I=r[3*ie+0],O=r[3*ie+1],U=r[3*ie+2];F.push(I,O,U)}if(a&&!0===s){var k=a[3*ie+0],V=a[3*ie+1],G=a[3*ie+2];C.push(k,V,G)}if(i){var j=i[2*ie+0],z=i[2*ie+1];B.push(j,z)}else B.push(L/(d-1),D/(f-1))}for(var H=[],W=0;W<d-1;W++)for(var X=0;X<f-1;X++){var Q=W+X*d,Y=(U=W+(X+1)*d,W+1+(X+1)*d),J=W+1+X*d;!0===c?(H.push(Q,Y,U),H.push(Y,Q,J)):(H.push(Q,U,Y),H.push(Y,J,Q))}var K,q,Z=E(H,new e.Float32BufferAttribute(T,3)),$=E(H,new e.Float32BufferAttribute(B,2));if(r)if(!1===o){for(var ee=0;ee<d-1;ee++)for(var te=0;te<f-1;te++){I=r[3*(ie=ee+te*(d-1))+0],O=r[3*ie+1],U=r[3*ie+2];F.push(I,O,U),F.push(I,O,U),F.push(I,O,U),F.push(I,O,U),F.push(I,O,U),F.push(I,O,U)}K=new e.Float32BufferAttribute(F,3)}else K=E(H,new e.Float32BufferAttribute(F,3));if(a)if(!1===s){for(var re=0;re<d-1;re++)for(var ae=0;ae<f-1;ae++){var ie;k=a[3*(ie=re+ae*(d-1))+0],V=a[3*ie+1],G=a[3*ie+2];C.push(k,V,G),C.push(k,V,G),C.push(k,V,G),C.push(k,V,G),C.push(k,V,G),C.push(k,V,G)}q=new e.Float32BufferAttribute(C,3)}else q=E(H,new e.Float32BufferAttribute(C,3));else q=P(H,T,h);var ne=new e.BufferGeometry;ne.setAttribute("position",Z),ne.setAttribute("normal",q),ne.setAttribute("uv",$),K&&ne.setAttribute("color",K);return ne._solid=l,ne._type="mesh",ne}(t);break;case"Extrusion":r=function(t){for(var r,a,i=[1,1,1,-1,-1,-1,-1,1,1,1],n=[0,0,0,0,1,0],o=!0,s=!0,l=0,u=!0,c=!0,h=t.fields,d=0,f=h.length;d<f;d++){var p=h[d],m=p.name,v=p.values;switch(m){case"beginCap":o=v[0];break;case"ccw":s=v[0];break;case"convex":break;case"creaseAngle":l=v[0];break;case"crossSection":i=v;break;case"endCap":u=v[0];break;case"orientation":a=v;break;case"scale":r=v;break;case"solid":c=v[0];break;case"spine":n=v;break;default:console.warn("THREE.VRMLLoader: Unknown field:",m)}}for(var g=i[0]===i[i.length-2]&&i[1]===i[i.length-1],y=[],x=new e.Vector3,b=new e.Vector3,A=new e.Vector3,w=new e.Vector3,M=new e.Quaternion,S=0,T=0,C=0,F=n.length;S<F;S+=3,T+=2,C+=4){x.fromArray(n,S),b.x=r?r[T+0]:1,b.y=1,b.z=r?r[T+1]:1,A.x=a?a[C+0]:0,A.y=a?a[C+1]:0,A.z=a?a[C+2]:1;for(var B=a?a[C+3]:0,L=0,D=i.length;L<D;L+=2)w.x=i[L+0],w.y=0,w.z=i[L+1],w.multiply(b),M.setFromAxisAngle(A,B),w.applyQuaternion(M),w.add(x),y.push(w.x,w.y,w.z)}for(var N=[],R=n.length/3,_=i.length/2,I=0;I<R-1;I++)for(var O=0;O<_-1;O++){var U=O+I*_,k=O+1+I*_,V=O+(I+1)*_,G=O+1+(I+1)*_;O===_-2&&!0===g&&(k=I*_,G=(I+1)*_),!0===s?(N.push(U,k,V),N.push(V,k,G)):(N.push(U,V,k),N.push(V,G,k))}if(!0===o||!0===u){for(var j=[],z=0,H=i.length;z<H;z+=2)j.push(new e.Vector2(i[z],i[z+1]));for(var W=e.ShapeUtils.triangulateShape(j,[]),X=[],Q=0,Y=W.length;Q<Y;Q++){var J=W[Q];X.push(J[0],J[1],J[2])}if(!0===o)for(var K=0,q=X.length;K<q;K+=3)!0===s?N.push(X[K+0],X[K+1],X[K+2]):N.push(X[K+0],X[K+2],X[K+1]);if(!0===u)for(var Z=_*(R-1),$=0,ee=X.length;$<ee;$+=3)!0===s?N.push(Z+X[$+0],Z+X[$+2],Z+X[$+1]):N.push(Z+X[$+0],Z+X[$+1],Z+X[$+2])}var te=E(N,new e.Float32BufferAttribute(y,3)),re=P(N,y,l),ae=new e.BufferGeometry;return ae.setAttribute("position",te),ae.setAttribute("normal",re),ae._solid=c,ae._type="mesh",ae}(t);break;case"Color":case"Coordinate":case"Normal":case"TextureCoordinate":r=function(e){return e.fields[0].values}(t);break;case"WorldInfo":r=function(e){for(var t={},r=e.fields,a=0,i=r.length;a<i;a++){var n=r[a],o=n.name,s=n.values;switch(o){case"title":t.title=s[0];break;case"info":t.info=s;break;default:console.warn("THREE.VRMLLoader: Unknown field:",o)}}return t}(t);break;case"Anchor":case"Billboard":case"Inline":case"LOD":case"Switch":case"AudioClip":case"DirectionalLight":case"PointLight":case"Script":case"Sound":case"SpotLight":case"CylinderSensor":case"PlaneSensor":case"ProximitySensor":case"SphereSensor":case"TimeSensor":case"TouchSensor":case"VisibilitySensor":case"Text":case"FontStyle":case"MovieTexture":case"ColorInterpolator":case"CoordinateInterpolator":case"NormalInterpolator":case"OrientationInterpolator":case"PositionInterpolator":case"ScalarInterpolator":case"Fog":case"NavigationInfo":case"Viewpoint":break;default:console.warn("THREE.VRMLLoader: Unknown node:",a)}void 0!==r&&void 0!==t.DEF&&!0===r.hasOwnProperty("name")&&(r.name=t.DEF);return r}(t)),t.build);var r,a}function h(e,t,r){switch(t){case n.INTENSITY:var a=parseInt(e);r.r=a,r.g=a,r.b=a;break;case n.INTENSITY_ALPHA:a=parseInt("0x"+e.substring(2,4));r.r=a,r.g=a,r.b=a,r.a=parseInt("0x"+e.substring(4,6));break;case n.RGB:r.r=parseInt("0x"+e.substring(2,4)),r.g=parseInt("0x"+e.substring(4,6)),r.b=parseInt("0x"+e.substring(6,8));break;case n.RGBA:r.r=parseInt("0x"+e.substring(2,4)),r.g=parseInt("0x"+e.substring(4,6)),r.b=parseInt("0x"+e.substring(6,8)),r.a=parseInt("0x"+e.substring(8,10))}}function d(e){var t;switch(e){case 1:t=n.INTENSITY;break;case 2:t=n.INTENSITY_ALPHA;break;case 3:t=n.RGB;break;case 4:t=n.RGBA}return t}function f(t,r){for(var a=0,i=t.length;a<i;a++){var n=u(t[a]);n instanceof e.Object3D&&r.add(n)}}function p(e,t){for(var r=[],a=0,i=0,n=e.length;i<n;i++){var o=e[a],s=e[i+(t?1:2)],l=e[i+(t?2:1)];r.push(o,s,l),(-1===e[i+3]||i+3>=n)&&(a=(i+=3)+1)}return r}function m(e,t){for(var r=[],a=0,i=0,n=t.length;i<n;i++){var o=3*a,s=e[o],l=e[o+1],u=e[o+2];r.push(s,l,u),(-1===t[i+3]||i+3>=n)&&(i+=3,a++)}return r}function v(e,t){for(var r=[],a=0,i=t.length;a<i;a++){var n=3*t[a],o=e[n],s=e[n+1],l=e[n+2];r.push(o,s,l)}return r}function g(e){for(var t=[],r=0,a=e.length;r<a;r++){var i=e[r],n=e[r+1];t.push(i,n),(-1===e[r+2]||r+2>=a)&&(r+=2)}return t}function y(e,t){for(var r=[],a=0,i=0,n=t.length;i<n;i++){var o=3*a,s=e[o],l=e[o+1],u=e[o+2];r.push(s,l,u),(-1===t[i+2]||i+2>=n)&&(i+=2,a++)}return r}var x=new e.Vector3,b=new e.Vector3,A=new e.Vector3,w=new e.Vector2,M=new e.Vector2,S=new e.Vector2;function T(t,r,a,i){for(var n=[],o=0,s=t.length;o<s;o+=3){var l=r[o],u=r[o+1],c=r[o+2];2===i?(w.fromArray(a,l*i),M.fromArray(a,u*i),S.fromArray(a,c*i),n.push(w.x,w.y),n.push(M.x,M.y),n.push(S.x,S.y)):(x.fromArray(a,l*i),b.fromArray(a,u*i),A.fromArray(a,c*i),n.push(x.x,x.y,x.z),n.push(b.x,b.y,b.z),n.push(A.x,A.y,A.z))}return new e.Float32BufferAttribute(n,i)}function C(t,r){for(var a=[],i=0,n=0,o=t.length;i<o;i+=3,n++)x.fromArray(r,3*n),a.push(x.x,x.y,x.z),a.push(x.x,x.y,x.z),a.push(x.x,x.y,x.z);return new e.Float32BufferAttribute(a,3)}function F(t,r){for(var a=[],i=0,n=0,o=t.length;i<o;i+=2,n++)x.fromArray(r,3*n),a.push(x.x,x.y,x.z),a.push(x.x,x.y,x.z);return new e.Float32BufferAttribute(a,3)}function E(t,r){for(var a=r.array,i=r.itemSize,n=new a.constructor(t.length*i),o=0,s=0,l=0,u=t.length;l<u;l++){o=t[l]*i;for(var c=0;c<i;c++)n[s++]=a[o++]}return new e.Float32BufferAttribute(n,i)}var B=new e.Vector3,L=new e.Vector3;function P(t,r,a){for(var n=[],o={},s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2],d=new i(u,c,h);x.fromArray(r,3*u),b.fromArray(r,3*c),A.fromArray(r,3*h),L.subVectors(A,b),B.subVectors(x,b),L.cross(B),L.normalize(),d.normal.copy(L),void 0===o[u]&&(o[u]=[]),void 0===o[c]&&(o[c]=[]),void 0===o[h]&&(o[h]=[]),o[u].push(d.normal),o[c].push(d.normal),o[h].push(d.normal),n.push(d)}for(var f=[],p=0,m=n.length;p<m;p++){var v=D(o[(d=n[p]).a],d.normal,a),g=D(o[d.b],d.normal,a),y=D(o[d.c],d.normal,a);x.fromArray(r,3*d.a),b.fromArray(r,3*d.b),A.fromArray(r,3*d.c),f.push(v.x,v.y,v.z),f.push(g.x,g.y,g.z),f.push(y.x,y.y,y.z)}return new e.Float32BufferAttribute(f,3)}function D(t,r,a){var i=new e.Vector3;if(0===a)i.copy(r);else for(var n=0,o=t.length;n<o;n++)t[n].angleTo(r)<a&&i.add(t[n]);return i.normalize()}function N(t){for(var r=[],a=0,i=t.length;a<i;a+=3)r.push(new e.Color(t[a],t[a+1],t[a+2]));return r}function R(t,r,a,i,n){for(var o=[],s=!0===n?0:Math.PI,l=0,u=i.length;l<u;l++){var c=0===l?0:a[l-1];c=!0===n?c:s-c;var h=new e.Vector3;h.setFromSphericalCoords(r,c,0),o.push(h)}for(var d=t.index,f=t.attributes.position,p=new e.BufferAttribute(new Float32Array(3*t.attributes.position.count),3),m=new e.Vector3,v=new e.Color,g=0;g<d.count;g++){var y,x,b=d.getX(g);m.fromBufferAttribute(f,b);for(var A=1,w=1;w<o.length;w++){x=w;var M=o[y=w-1],S=o[x];if(!0===n){if(m.y<=M.y&&m.y>S.y){A=Math.abs(M.y-m.y)/Math.abs(M.y-S.y);break}}else if(m.y>=M.y&&m.y<S.y){A=Math.abs(M.y-m.y)/Math.abs(M.y-S.y);break}}var T=i[y],C=i[x];v.copy(T).lerp(C,A),p.setXYZ(b,v.r,v.g,v.b)}t.setAttribute("color",p)}var _=new e.TextureLoader(this.manager);if(_.setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin),-1===t.indexOf("#VRML V2.0"))throw Error("THREE.VRMLLexer: Version of VRML asset not supported.");return function(t){for(var r=t.nodes,a=new e.Scene,i=0,n=r.length;i<n;i++){l(c=r[i])}for(var o=0,s=r.length;o<s;o++){var c,h=u(c=r[o]);h instanceof e.Object3D&&a.add(h),"WorldInfo"===c.name&&(a.userData.worldInfo=h)}return a}(function(e){var t=function(){for(var e=c.createToken({name:"RouteIdentifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*[\.][^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/}),t=c.createToken({name:"Identifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/,longer_alt:e}),r=["Anchor","Billboard","Collision","Group","Transform","Inline","LOD","Switch","AudioClip","DirectionalLight","PointLight","Script","Shape","Sound","SpotLight","WorldInfo","CylinderSensor","PlaneSensor","ProximitySensor","SphereSensor","TimeSensor","TouchSensor","VisibilitySensor","Box","Cone","Cylinder","ElevationGrid","Extrusion","IndexedFaceSet","IndexedLineSet","PointSet","Sphere","Color","Coordinate","Normal","TextureCoordinate","Appearance","FontStyle","ImageTexture","Material","MovieTexture","PixelTexture","TextureTransform","ColorInterpolator","CoordinateInterpolator","NormalInterpolator","OrientationInterpolator","PositionInterpolator","ScalarInterpolator","Background","Fog","NavigationInfo","Viewpoint","Text"],a=c.createToken({name:"Version",pattern:/#VRML.*/,longer_alt:t}),i=c.createToken({name:"NodeName",pattern:new RegExp(r.join("|")),longer_alt:t}),n=c.createToken({name:"DEF",pattern:/DEF/,longer_alt:t}),o=c.createToken({name:"USE",pattern:/USE/,longer_alt:t}),s=c.createToken({name:"ROUTE",pattern:/ROUTE/,longer_alt:t}),l=c.createToken({name:"TO",pattern:/TO/,longer_alt:t}),u=c.createToken({name:"StringLiteral",pattern:/"(:?[^\\"\n\r]+|\\(:?[bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/}),h=c.createToken({name:"HexLiteral",pattern:/0[xX][0-9a-fA-F]+/}),d=c.createToken({name:"NumberLiteral",pattern:/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/}),f=c.createToken({name:"TrueLiteral",pattern:/TRUE/}),p=c.createToken({name:"FalseLiteral",pattern:/FALSE/}),m=c.createToken({name:"NullLiteral",pattern:/NULL/}),v=c.createToken({name:"LSquare",pattern:/\[/}),g=c.createToken({name:"RSquare",pattern:/]/}),y=c.createToken({name:"LCurly",pattern:/{/}),x=c.createToken({name:"RCurly",pattern:/}/}),b=c.createToken({name:"Comment",pattern:/#.*/,group:c.Lexer.SKIPPED}),A=[c.createToken({name:"WhiteSpace",pattern:/[ ,\s]/,group:c.Lexer.SKIPPED}),i,n,o,s,l,f,p,m,a,t,e,u,h,d,v,g,y,x,b],w={},M=0,S=A.length;M<S;M++){var T=A[M];w[T.name]=T}return{tokens:A,tokenVocabulary:w}}(),i=new r(t.tokens),n=new a(t.tokenVocabulary),o=function(e){function t(){e.call(this),this.validateVisitor()}function r(e,t){var r={type:null,values:[]};if(t.node){r.type="node";for(var a=0,i=t.node.length;a<i;a++){var n=t.node[a];r.values.push(e.visit(n))}}if(t.use){r.type="use";for(var o=0,s=t.use.length;o<s;o++){var l=t.use[o];r.values.push(e.visit(l))}}if(t.StringLiteral){r.type="string";for(var u=0,c=t.StringLiteral.length;u<c;u++){var h=t.StringLiteral[u];r.values.push(h.image.replace(/'|"/g,""))}}if(t.NumberLiteral){r.type="number";for(var d=0,f=t.NumberLiteral.length;d<f;d++){var p=t.NumberLiteral[d];r.values.push(parseFloat(p.image))}}if(t.HexLiteral){r.type="hex";for(var m=0,v=t.HexLiteral.length;m<v;m++){var g=t.HexLiteral[m];r.values.push(g.image)}}if(t.TrueLiteral){r.type="boolean";for(var y=0,x=t.TrueLiteral.length;y<x;y++){"TRUE"===t.TrueLiteral[y].image&&r.values.push(!0)}}if(t.FalseLiteral){r.type="boolean";for(var b=0,A=t.FalseLiteral.length;b<A;b++){"FALSE"===t.FalseLiteral[b].image&&r.values.push(!1)}}return t.NullLiteral&&(r.type="null",t.NullLiteral.forEach((function(){r.values.push(null)}))),r}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,vrml:function(e){for(var t={version:this.visit(e.version),nodes:[],routes:[]},r=0,a=e.node.length;r<a;r++){var i=e.node[r];t.nodes.push(this.visit(i))}if(e.route)for(var n=0,o=e.route.length;n<o;n++){var s=e.route[n];t.routes.push(this.visit(s))}return t},version:function(e){return e.Version[0].image},node:function(e){var t={name:e.NodeName[0].image,fields:[]};if(e.field)for(var r=0,a=e.field.length;r<a;r++){var i=e.field[r];t.fields.push(this.visit(i))}return e.def&&(t.DEF=this.visit(e.def[0])),t},field:function(e){var t,r={name:e.Identifier[0].image,type:null,values:null};return e.singleFieldValue&&(t=this.visit(e.singleFieldValue[0])),e.multiFieldValue&&(t=this.visit(e.multiFieldValue[0])),r.type=t.type,r.values=t.values,r},def:function(e){return(e.Identifier||e.NodeName)[0].image},use:function(e){return{USE:(e.Identifier||e.NodeName)[0].image}},singleFieldValue:function(e){return r(this,e)},multiFieldValue:function(e){return r(this,e)},route:function(e){return{FROM:e.RouteIdentifier[0].image,TO:e.RouteIdentifier[1].image}}}),new t}(n.getBaseCstVisitorConstructor()),s=i.lex(e);n.input=s.tokens;var l=n.vrml();if(n.errors.length>0)throw console.error(n.errors),Error("THREE.VRMLLoader: Parsing errors detected.");return o.visit(l)}(t))}}),r.prototype={constructor:r,lex:function(e){var t=this.lexer.tokenize(e);if(t.errors.length>0)throw console.error(t.errors),Error("THREE.VRMLLexer: Lexing errors detected.");return t}},a.prototype=Object.create(c.Parser.prototype),a.prototype.constructor=a;var n={INTENSITY:1,INTENSITY_ALPHA:2,RGB:3,RGBA:4};return t}(),tl=function(t){e.Loader.call(this,t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig=null};tl.taskCache=new WeakMap,tl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:tl,setTranscoderPath:function(e){return this.transcoderPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},detectSupport:function(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this},load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials);var s=new e.CompressedTexture;return o.load(t,(function(e){if(tl.taskCache.has(e))return tl.taskCache.get(e).promise.then(r).catch(i);n._createTexture([e]).then((function(e){s.copy(e),s.needsUpdate=!0,r&&r(s)})).catch(i)}),a,i),s},parseInternalAsync:function(e){for(var t=e.levels,r=new Set,a=0;a<t.length;a++)r.add(t[a].data.buffer);return this._createTexture(Array.from(r),M.default({},e,{lowLevel:!0}))},_createTexture:function(t,r){for(var a,i,n=this,o=r||{},s=0,l=0;l<t.length;l++)s+=t[l].byteLength;var u=this._allocateWorker(s).then((function(e){return a=e,i=n.workerNextTaskID++,new Promise((function(e,r){a._callbacks[i]={resolve:e,reject:r},a.postMessage({type:"transcode",id:i,buffers:t,taskConfig:o},t)}))})).then((function(t){var r=t.mipmaps,a=t.width,i=t.height,n=t.format,o=new e.CompressedTexture(r,a,i,n,e.UnsignedByteType);return o.minFilter=1===r.length?e.LinearFilter:e.LinearMipmapLinearFilter,o.magFilter=e.LinearFilter,o.generateMipmaps=!1,o.needsUpdate=!0,o}));return u.catch((function(){return!0})).then((function(){a&&i&&(a._taskLoad-=s,delete a._callbacks[i])})),tl.taskCache.set(t[0],{promise:u}),u},_initTranscoder:function(){var t=this;if(!this.transcoderPending){var r=new e.FileLoader(this.manager);r.setPath(this.transcoderPath),r.setWithCredentials(this.withCredentials);var a=new Promise((function(e,t){r.load("basis_transcoder.js",e,void 0,t)})),i=new e.FileLoader(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);var n=new Promise((function(e,t){i.load("basis_transcoder.wasm",e,void 0,t)}));this.transcoderPending=Promise.all([a,n]).then((function(e){var r=e[0],a=e[1],i=tl.BasisWorker.toString(),n=["/* constants */","var _EngineFormat = "+JSON.stringify(tl.EngineFormat),"var _TranscoderFormat = "+JSON.stringify(tl.TranscoderFormat),"var _BasisFormat = "+JSON.stringify(tl.BasisFormat),"/* basis_transcoder.js */",r,"/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([n])),t.transcoderBinary=a}))}return this.transcoderPending},_allocateWorker:function(e){var t=this;return this._initTranscoder().then((function(){var r;t.workerPool.length<t.workerLimit?((r=new Worker(t.workerSourceURL))._callbacks={},r._taskLoad=0,r.postMessage({type:"init",config:t.workerConfig,transcoderBinary:t.transcoderBinary}),r.onmessage=function(e){var t=e.data;switch(t.type){case"transcode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+t.type+'"')}},t.workerPool.push(r)):t.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(r=t.workerPool[t.workerPool.length-1])._taskLoad+=e,r}))},dispose:function(){for(var e=0;e<this.workerPool.length;e++)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),tl.BasisFormat={ETC1S:0,UASTC_4x4:1},tl.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},tl.EngineFormat={RGBAFormat:e.RGBAFormat,RGBA_ASTC_4x4_Format:e.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:e.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:e.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:e.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:e.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:e.RGB_ETC1_Format,RGB_ETC2_Format:e.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:e.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:e.RGB_S3TC_DXT1_Format},tl.BasisWorker=function(){var e,t,r,a=_EngineFormat,i=_TranscoderFormat,n=_BasisFormat;onmessage=function(a){var i,o=a.data;switch(o.type){case"init":e=o.config,i=o.transcoderBinary,t=new Promise((function(e){r={wasmBinary:i,onRuntimeInitialized:e},BASIS(r)})).then((function(){r.initializeBasis()}));break;case"transcode":t.then((function(){try{for(var e=o.taskConfig.lowLevel?function(e){var t=e.basisFormat,a=e.width,i=e.height,o=e.hasAlpha,s=u(t,a,i,o),l=s.transcoderFormat,p=s.engineFormat,m=r.getBytesPerBlockOrPixel(l);c(r.isFormatSupported(l),"THREE.BasisTextureLoader: Unsupported format.");var v=[];if(t===n.ETC1S){var g=new r.LowLevelETC1SImageTranscoder,y=e.globalData,x=y.endpointCount,b=y.endpointsData,A=y.selectorCount,w=y.selectorsData,M=y.tablesData;try{c(g.decodePalettes(x,b,A,w),"THREE.BasisTextureLoader: decodePalettes() failed."),c(g.decodeTables(M),"THREE.BasisTextureLoader: decodeTables() failed.");for(var S=0;S<e.levels.length;S++){var T=e.levels[S],C=e.globalData.imageDescs[S],F=f(l,T.width,T.height),E=new Uint8Array(F);c(g.transcodeImage(l,E,F/m,T.data,h(l,T.width),d(l,T.height),T.width,T.height,T.index,C.rgbSliceByteOffset,C.rgbSliceByteLength,C.alphaSliceByteOffset,C.alphaSliceByteLength,C.imageFlags,o,!1,0,0),"THREE.BasisTextureLoader: transcodeImage() failed for level "+T.index+"."),v.push({data:E,width:T.width,height:T.height})}}finally{g.delete()}}else for(var B=0;B<e.levels.length;B++){F=f(l,(T=e.levels[B]).width,T.height),E=new Uint8Array(F);c(r.transcodeUASTCImage(l,E,F/m,T.data,h(l,T.width),d(l,T.height),T.width,T.height,T.index,0,T.data.byteLength,0,o,!1,0,0,-1,-1),"THREE.BasisTextureLoader: transcodeUASTCImage() failed for level "+T.index+"."),v.push({data:E,width:T.width,height:T.height})}return{width:a,height:i,hasAlpha:o,mipmaps:v,format:p}}(o.taskConfig):function(e){var t=new r.BasisFile(new Uint8Array(e)),a=t.isUASTC()?n.UASTC_4x4:n.ETC1S,i=t.getImageWidth(0,0),o=t.getImageHeight(0,0),s=t.getNumLevels(0),l=t.getHasAlpha();function c(){t.close(),t.delete()}var h=u(a,i,o,l),d=h.transcoderFormat,f=h.engineFormat;if(!i||!o||!s)throw c(),new Error("THREE.BasisTextureLoader:\tInvalid texture");if(!t.startTranscoding())throw c(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");for(var p=[],m=0;m<s;m++){var v=t.getImageWidth(0,m),g=t.getImageHeight(0,m),y=new Uint8Array(t.getImageTranscodedSizeInBytes(0,m,d));if(!t.transcodeImage(y,0,m,d,0,l))throw c(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");p.push({data:y,width:v,height:g})}return c(),{width:i,height:o,hasAlpha:l,mipmaps:p,format:f}}(o.buffers[0]),t=e.width,a=e.height,i=e.hasAlpha,s=e.mipmaps,l=e.format,p=[],m=0;m<s.length;++m)p.push(s[m].data.buffer);self.postMessage({type:"transcode",id:o.id,width:t,height:a,hasAlpha:i,mipmaps:s,format:l},p)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}}))}};var o=[{if:"astcSupported",basisFormat:[n.UASTC_4x4],transcoderFormat:[i.ASTC_4x4,i.ASTC_4x4],engineFormat:[a.RGBA_ASTC_4x4_Format,a.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[n.ETC1S,n.UASTC_4x4],transcoderFormat:[i.BC7_M5,i.BC7_M5],engineFormat:[a.RGBA_BPTC_Format,a.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[n.ETC1S,n.UASTC_4x4],transcoderFormat:[i.BC1,i.BC3],engineFormat:[a.RGB_S3TC_DXT1_Format,a.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[n.ETC1S,n.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC2],engineFormat:[a.RGB_ETC2_Format,a.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[n.ETC1S,n.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC1],engineFormat:[a.RGB_ETC1_Format,a.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[n.ETC1S,n.UASTC_4x4],transcoderFormat:[i.PVRTC1_4_RGB,i.PVRTC1_4_RGBA],engineFormat:[a.RGB_PVRTC_4BPPV1_Format,a.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],s=o.sort((function(e,t){return e.priorityETC1S-t.priorityETC1S})),l=o.sort((function(e,t){return e.priorityUASTC-t.priorityUASTC}));function u(t,r,o,u){for(var c=t===n.ETC1S?s:l,h=0;h<c.length;h++){var d=c[h];if(e[d.if]&&(d.basisFormat.includes(t)&&(!d.needsPowerOfTwo||p(r)&&p(o))))return{transcoderFormat:d.transcoderFormat[u?1:0],engineFormat:d.engineFormat[u?1:0]}}return console.warn("THREE.BasisTextureLoader: No suitable compressed texture format found. Decoding to RGBA32."),{transcoderFormat:i.RGBA32,engineFormat:a.RGBAFormat}}function c(e,t){if(!e)throw new Error(t)}function h(e,t){return Math.ceil(t/r.getFormatBlockWidth(e))}function d(e,t){return Math.ceil(t/r.getFormatBlockHeight(e))}function f(e,t,a){var n=r.getBytesPerBlockOrPixel(e);if(r.formatIsUncompressed(e))return t*a*n;if(e===i.PVRTC1_4_RGB||e===i.PVRTC1_4_RGBA){var o=t+3&-4,s=a+3&-4;return(Math.max(8,o)*Math.max(8,s)*4+7)/8}return h(e,t)*d(e,a)*n}function p(e){return e<=2||0==(e&e-1)&&0!==e}};var rl,al=166,il={RGB:0,RRR:3,GGG:4,AAA:15},nl={RGB:0,RGBA:3,RRR:4,RRRG:5},ol=2,sl=2,ll=function(t){function r(e){var r;return(r=t.call(this,e)||this).basisLoader=new tl(e),r.zstd=new d.ZSTDDecoder,r.zstd.init(),"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.'),r}g.default(r,t);var a=r.prototype;return a.setTranscoderPath=function(e){return this.basisLoader.setTranscoderPath(e),this},a.setWorkerLimit=function(e){return this.basisLoader.setWorkerLimit(e),this},a.detectSupport=function(e){return this.basisLoader.detectSupport(e),this},a.dispose=function(){return this.basisLoader.dispose(),this},a.load=function(t,r,a,i){var n=this,o=new e.CompressedTexture;return new Promise((function(r,i){new e.FileLoader(n.manager).setPath(n.path).setResponseType("arraybuffer").load(t,r,a,i)})).then((function(e){n.parse(e,(function(e){o.copy(e),o.needsUpdate=!0,r&&r(o)}),i)})).catch(i),o},a.parse=function(t,r,a){var i=this,n=f.read(new Uint8Array(t));if(n.pixelDepth>0)throw new Error("THREE.KTX2Loader: Only 2D textures are currently supported.");if(n.layerCount>1)throw new Error("THREE.KTX2Loader: Array textures are not currently supported.");if(n.faceCount>1)throw new Error("THREE.KTX2Loader: Cube textures are not currently supported.");var o=ul.getBasicDFD(n);return ul.createLevels(n,this.zstd).then((function(e){var t=o.colorModel===al?tl.BasisFormat.UASTC_4x4:tl.BasisFormat.ETC1S,r={levels:e,width:n.pixelWidth,height:n.pixelHeight,basisFormat:t,hasAlpha:ul.getAlpha(n)};return t===tl.BasisFormat.ETC1S&&(r.globalData=n.globalData),i.basisLoader.parseInternalAsync(r)})).then((function(t){t.encoding=o.transferFunction===sl?e.sRGBEncoding:e.LinearEncoding,t.premultiplyAlpha=ul.getPremultiplyAlpha(n),r(t)})).catch(a),this},r}(e.CompressedTextureLoader),ul={createLevels:(rl=w.default(regeneratorRuntime.mark((function e(t,r){var a,i,n,o,s,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.supercompressionScheme!==ol){e.next=3;break}return e.next=3,r.init();case 3:for(a=[],i=t.pixelWidth,n=t.pixelHeight,o=0;o<t.levels.length;o++)s=Math.max(1,Math.floor(i/Math.pow(2,o))),l=Math.max(1,Math.floor(n/Math.pow(2,o))),u=t.levels[o].levelData,t.supercompressionScheme===ol&&(u=r.decode(u,t.levels[o].uncompressedByteLength)),a.push({index:o,width:s,height:l,data:u});return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return rl.apply(this,arguments)}),getBasicDFD:function(e){return e.dataFormatDescriptor[0]},getAlpha:function(e){var t=this.getBasicDFD(e);return t.colorModel===al?(15&t.samples[0].channelID)===nl.RGBA:2===t.samples.length&&(15&t.samples[1].channelID)===il.AAA},getPremultiplyAlpha:function(e){return!!(1&this.getBasicDFD(e).flags)}},cl=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.setQuality=function(e){this._quality=e},a.load=function(t,r,a,i){var n=this._quality||1,o=new e.CanvasTexture;o.minFilter=e.NearestFilter;var s=new e.FileLoader(this.manager);return s.setPath(this.path),s.setWithCredentials(this.withCredentials),s.load(t,(function(e){var t=JSON.parse(e),a=document.createElement("div");a.style.width=t.w+"px",a.style.height=t.h+"px",document.body.appendChild(a);var i=bodymovin.loadAnimation({container:a,animType:"canvas",loop:!0,autoplay:!0,animationData:t,rendererSettings:{dpr:n}});o.animation=i,o.image=i.container,i.addEventListener("enterFrame",(function(){o.needsUpdate=!0})),a.style.display="none",void 0!==r&&r(o)}),a,i),o},r}(e.Loader),hl=function(t){e.Loader.call(this,t),this.reversed=!1};hl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:hl,load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(e){function t(e){var t,r=[];e.forEach((function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)}));var a=[];return r.forEach((function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};a.push(t);for(var r=e.length-1;r>0;r--){var i=e[r];t={type:i.type};void 0!==i.x2&&void 0!==i.y2?(t.x1=i.x2,t.y1=i.y2,t.x2=i.x1,t.y2=i.y1):void 0!==i.x1&&void 0!==i.y1&&(t.x1=i.x1,t.y1=i.y1),t.x=e[r-1].x,t.y=e[r-1].y,a.push(t)}})),a}return function(e,r){for(var a=Math.round,i={},n=1e5/(72*(e.unitsPerEm||2048)),o=e.encoding.cmap.glyphIndexMap,s=Object.keys(o),l=0;l<s.length;l++){var u=s[l],c=e.glyphs.glyphs[o[u]];if(void 0!==u){var h={ha:a(c.advanceWidth*n),x_min:a(c.xMin*n),x_max:a(c.xMax*n),o:""};r&&(c.path.commands=t(c.path.commands)),c.path.commands.forEach((function(e){"c"===e.type.toLowerCase()&&(e.type="b"),h.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(h.o+=a(e.x*n)+" "+a(e.y*n)+" "),void 0!==e.x1&&void 0!==e.y1&&(h.o+=a(e.x1*n)+" "+a(e.y1*n)+" "),void 0!==e.x2&&void 0!==e.y2&&(h.o+=a(e.x2*n)+" "+a(e.y2*n)+" ")})),i[String.fromCodePoint(c.unicode)]=h}}return{glyphs:i,familyName:e.getEnglishName("fullName"),ascender:a(e.ascender*n),descender:a(e.descender*n),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(p.parse(e),this.reversed)}});var dl=function(t){e.DataTextureLoader.call(this,t),this.type=e.UnsignedByteType};dl.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:dl,parse:function(t){var r=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},a=function(e,t,r){t=t||1024;for(var a=e.pos,i=-1,n=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));0>(i=s.indexOf("\n"))&&n<t&&a<e.byteLength;)o+=s,n+=s.length,a+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));return-1<i&&(!1!==r&&(e.pos+=n+i+1),o+s.slice(0,i))},i=function(e,t,r,a){var i=e[t+3],n=Math.pow(2,i-128)/255;r[a+0]=e[t+0]*n,r[a+1]=e[t+1]*n,r[a+2]=e[t+2]*n},n=function(t,r,a,i){var n=t[r+3],o=Math.pow(2,n-128)/255;a[i+0]=e.DataUtils.toHalfFloat(t[r+0]*o),a[i+1]=e.DataUtils.toHalfFloat(t[r+1]*o),a[i+2]=e.DataUtils.toHalfFloat(t[r+2]*o)},o=new Uint8Array(t);o.pos=0;var s=function(e){var t,i,n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(t=a(e)))return r(1,"no header found");if(!(i=t.match(/^#\?(\S+)/)))return r(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=t+"\n";!1!==(t=a(e));)if(u.string+=t+"\n","#"!==t.charAt(0)){if((i=t.match(n))&&(u.gamma=parseFloat(i[1],10)),(i=t.match(o))&&(u.exposure=parseFloat(i[1],10)),(i=t.match(s))&&(u.valid|=2,u.format=i[1]),(i=t.match(l))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=t+"\n";return 2&u.valid?4&u.valid?u:r(3,"missing image size specifier"):r(3,"missing format specifier")}(o);if(-1!==s){var l=s.width,u=s.height,c=function(e,t,a){var i,n,o,s,l,u,c,h,d,f,p,m,v,g=t,y=a;if(g<8||g>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return r(3,"wrong scanline width");if(!(i=new Uint8Array(4*t*a)).length)return r(4,"unable to allocate buffer space");for(n=0,o=0,h=4*g,v=new Uint8Array(4),u=new Uint8Array(h);y>0&&o<e.byteLength;){if(o+4>e.byteLength)return r(1);if(v[0]=e[o++],v[1]=e[o++],v[2]=e[o++],v[3]=e[o++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return r(3,"bad rgbe scanline format");for(c=0;c<h&&o<e.byteLength;){if((m=(s=e[o++])>128)&&(s-=128),0===s||c+s>h)return r(3,"bad scanline data");if(m)for(l=e[o++],d=0;d<s;d++)u[c++]=l;else u.set(e.subarray(o,o+s),c),c+=s,o+=s}for(f=g,d=0;d<f;d++)p=0,i[n]=u[d+p],p+=g,i[n+1]=u[d+p],p+=g,i[n+2]=u[d+p],p+=g,i[n+3]=u[d+p],n+=4;y--}return i}(o.subarray(o.pos),l,u);if(-1!==c){switch(this.type){case e.UnsignedByteType:var h=c,d=e.RGBEFormat,f=e.UnsignedByteType;break;case e.FloatType:for(var p=c.length/4*3,m=new Float32Array(p),v=0;v<p;v++)i(c,4*v,m,3*v);h=m,d=e.RGBFormat,f=e.FloatType;break;case e.HalfFloatType:p=c.length/4*3;for(var g=new Uint16Array(p),y=0;y<p;y++)n(c,4*y,g,3*y);h=g,d=e.RGBFormat,f=e.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:l,height:u,data:h,header:s.string,gamma:s.gamma,exposure:s.exposure,format:d,type:f}}}return null},setDataType:function(e){return this.type=e,this},load:function(t,r,a,i){return e.DataTextureLoader.prototype.load.call(this,t,(function(t,a){switch(t.type){case e.UnsignedByteType:t.encoding=e.RGBEEncoding,t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case e.FloatType:case e.HalfFloatType:t.encoding=e.LinearEncoding,t.minFilter=e.LinearFilter,t.magFilter=e.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}r&&r(t,a)}),a,i)}});var fl=function(t){e.Loader.call(this,t)};fl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:fl,load:function(t,r,a,i){var n=this,o=""===n.path?e.LoaderUtils.extractUrlBase(t):n.path,s=new e.FileLoader(n.manager);s.setPath(n.path),s.setResponseType("arraybuffer"),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t,r){var a=new e.TextureLoader(this.manager);a.setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin);var i={KeyFrame:function(t,r){this.time=t,this.matrix=r.clone(),this.position=new e.Vector3,this.quaternion=new e.Quaternion,this.scale=new e.Vector3(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new i.KeyFrame(this.time,this.matrix)},this.lerp=function(e,t){var r=(t-=this.time)/(e.time-this.time),a=1-r,n=this.position,o=this.quaternion,s=e.position,l=e.quaternion;return i.KeyFrame.tempAniPos.x=n.x*a+s.x*r,i.KeyFrame.tempAniPos.y=n.y*a+s.y*r,i.KeyFrame.tempAniPos.z=n.z*a+s.z*r,i.KeyFrame.tempAniQuat.set(o.x,o.y,o.z,o.w),i.KeyFrame.tempAniQuat.slerp(l,r),i.KeyFrame.tempAniMatrix.compose(i.KeyFrame.tempAniPos,i.KeyFrame.tempAniQuat,i.KeyFrame.tempAniScale)}}};i.KeyFrame.tempAniPos=new e.Vector3,i.KeyFrame.tempAniQuat=new e.Quaternion,i.KeyFrame.tempAniScale=new e.Vector3(1,1,1),i.KeyFrame.tempAniMatrix=new e.Matrix4,i.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(e){this.keys.push(e)},this.init=function(){if(this.sortKeys(),this.keys.length>0?this.length=this.keys[this.keys.length-1].time:this.length=0,this.fps)for(var e=0;e<this.length*this.fps;e++)for(var t=0;t<this.keys.length;t++){if(this.keys[t].time==e){this._accelTable[e]=t;break}if(this.keys[t].time<e/this.fps&&this.keys[t+1]&&this.keys[t+1].time>=e/this.fps){this._accelTable[e]=t;break}}},this.parseFromThree=function(e){var t=e.fps;this.target=e.node;for(var r=e.hierarchy[0].keys,a=0;a<r.length;a++)this.addKey(new i.KeyFrame(a/t||r[a].time,r[a].targets[0].data));this.init()},this.parseFromCollada=function(e){for(var t=e.keys,r=this.fps,a=0;a<t.length;a++)this.addKey(new i.KeyFrame(a/r||t[a].time,t[a].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(e,t){return e.time-t.time},this.clone=function(){var e=new i.KeyFrameTrack;e.target=this.target,e.time=this.time,e.length=this.length;for(var t=0;t<this.keys.length;t++)e.addKey(this.keys[t].clone());return e.init(),e},this.reTarget=function(e,t){t||(t=i.TrackTargetNodeNameCompare),this.target=t(e,this.target)},this.keySearchAccel=function(e){return e*=this.fps,e=Math.floor(e),this._accelTable[e]||0},this.setTime=function(e){e=Math.abs(e),this.length&&(e=e%this.length+.05);for(var t=null,r=null,a=this.keySearchAccel(e);a<this.keys.length;a++){if(this.keys[a].time==e){t=this.keys[a],r=this.keys[a];break}if(this.keys[a].time<e&&this.keys[a+1]&&this.keys[a+1].time>e){t=this.keys[a],r=this.keys[a+1];break}if(this.keys[a].time<e&&a==this.keys.length-1){t=this.keys[a],(r=this.keys[0].clone()).time+=this.length+.05;break}}return t&&r&&t!==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.lerp(r,e)),void(this.target.matrixWorldNeedsUpdate=!0)):t&&r&&t==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},i.TrackTargetNodeNameCompare=function(e,t){return function e(t,r){if(t.name==r)return t;for(var a=0;a<t.children.length;a++){var i=e(t.children[a],r);if(i)return i}return null}(e,t.name)},i.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(e){this.tracks.push(e),this.length=Math.max(e.length,this.length)},this.setTime=function(e){this.time=e;for(var t=0;t<this.tracks.length;t++)this.tracks[t].setTime(e)},this.clone=function(e,t){t||(t=i.TrackTargetNodeNameCompare);var r=new i.Animation;r.target=e;for(var a=0;a<this.tracks.length;a++){var n=this.tracks[a].clone();n.reTarget(e,t),r.addTrack(n)}return r}};function n(e){return 256<<e}function o(e){return 65536<<e}function s(t,r){var a=new e.Bone;for(var i in a.matrix.copy(t.matrix),a.matrixWorld.copy(t.matrixWorld),a.position.copy(t.position),a.quaternion.copy(t.quaternion),a.scale.copy(t.scale),r.nodeCount++,a.name="bone_"+t.name+r.nodeCount.toString(),r.nodeToBoneMap[t.name]||(r.nodeToBoneMap[t.name]=[]),r.nodeToBoneMap[t.name].push(a),t.children){var n=s(t.children[i],r);a.add(n)}return a}function l(e,t){for(var r=[],a=0;a<e.length;a++)r.push({i:e[a],w:t[a]});for(r.sort((function(e,t){return t.w-e.w}));r.length<4;)r.push({i:0,w:0});r.length>4&&(r.length=4);for(var i=0,n=0;n<4;n++)i+=r[n].w*r[n].w;i=Math.sqrt(i);for(var o=0;o<4;o++)r[o].w=r[o].w/i,e[o]=r[o].i,t[o]=r[o].w}function u(e,t){if(0==e.name.indexOf("bone_"+t))return e;for(var r in e.children){var a=u(e.children[r],t);if(a)return a}}function c(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(t){if(0!=this.mBones.length){for(var r=[],a=[],i=t.findNode(this.mBones[0].mName);i.mParent&&i.mParent.isBone;)i=i.mParent;var n=s(i.toTHREE(t),t);this.threeNode.add(n);for(var o=0;o<this.mBones.length;o++){if(c=u(n,this.mBones[o].mName)){var l=c;r.push(l),a.push(this.mBones[o].mOffsetMatrix.toTHREE())}else{if(!(i=t.findNode(this.mBones[o].mName)))return;n=s(i.toTHREE(t),t);this.threeNode.add(n);var c;l=c=u(n,this.mBones[o].mName);r.push(l),a.push(this.mBones[o].mOffsetMatrix.toTHREE())}}var h=new e.Skeleton(r,a);this.threeNode.bind(h,new e.Matrix4),this.threeNode.material.skinning=!0}},this.toTHREE=function(t){if(this.threeNode)return this.threeNode;var r,a,i=new e.BufferGeometry;if(r=t.mMaterials[this.mMaterialIndex]?t.mMaterials[this.mMaterialIndex].toTHREE(t):new e.MeshLambertMaterial,i.setIndex(new e.BufferAttribute(new Uint32Array(this.mIndexArray),1)),i.setAttribute("position",new e.BufferAttribute(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&i.setAttribute("normal",new e.BufferAttribute(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&i.setAttribute("color",new e.BufferAttribute(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&i.setAttribute("uv",new e.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&i.setAttribute("uv1",new e.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&i.setAttribute("tangents",new e.BufferAttribute(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&i.setAttribute("bitangents",new e.BufferAttribute(this.mBitangentBuffer,3)),this.mBones.length>0){for(var n=[],o=[],s=0;s<this.mBones.length;s++)for(var u=0;u<this.mBones[s].mWeights.length;u++){var c=this.mBones[s].mWeights[u];c&&(n[c.mVertexId]||(n[c.mVertexId]=[]),o[c.mVertexId]||(o[c.mVertexId]=[]),n[c.mVertexId].push(c.mWeight),o[c.mVertexId].push(parseInt(s)))}for(var h in o)l(o[h],n[h]);for(var d=[],f=[],p=0;p<n.length;p++)for(var m=0;m<4;m++)n[p]&&o[p]?(d.push(n[p][m]),f.push(o[p][m])):(d.push(0),f.push(0));i.setAttribute("skinWeight",new e.BufferAttribute(new Float32Array(d),4)),i.setAttribute("skinIndex",new e.BufferAttribute(new Float32Array(f),4))}return 0==this.mBones.length&&(a=new e.Mesh(i,r)),this.mBones.length>0&&(a=new e.SkinnedMesh(i,r)).normalizeSkinWeights(),this.threeNode=a,a}}function h(){this.mNumIndices=0,this.mIndices=[]}function d(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new e.Vector3(this.x,this.y,this.z)}}function f(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new e.Color(this.r,this.g,this.b)}}function p(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new e.Quaternion(this.x,this.y,this.z,this.w)}}function m(){this.mVertexId=0,this.mWeight=0}function v(){this.data=[],this.toString=function(){var e="";return this.data.forEach((function(t){e+=String.fromCharCode(t)})),e.replace(/[^\x20-\x7E]+/g,"")}}function g(){this.mTime=0,this.mValue=null}function y(){this.mTime=0,this.mValue=null}function x(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(t){if(this.threeNode)return this.threeNode;var r=new e.Object3D;r.name=this.mName,r.matrix=this.mTransformation.toTHREE();for(var a=0;a<this.mChildren.length;a++)r.add(this.mChildren[a].toTHREE(t));for(var i=0;i<this.mMeshes.length;i++)r.add(t.mMeshes[this.mMeshes[i]].toTHREE(t));return this.threeNode=r,r.matrix.decompose(r.position,r.quaternion,r.scale),r}}function b(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function A(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var t=new Uint8Array(this.mData).buffer,r=new DataView(t),a=r.getFloat32(0,!0),i=r.getFloat32(4,!0),n=r.getFloat32(8,!0);return new e.Color(a,i,n)},this.dataAsFloat=function(){var e=new Uint8Array(this.mData).buffer;return new DataView(e).getFloat32(0,!0)},this.dataAsBool=function(){var e=new Uint8Array(this.mData).buffer;return!!new DataView(e).getFloat32(0,!0)},this.dataAsString=function(){var e=new v;return e.data=this.mData,e.toString()},this.dataAsMap=function(){var e=new v;e.data=this.mData;var t=e.toString();return-1!=(t=t.replace(/\\/g,"/")).indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),a.load(t)}}var w={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},M={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"};function S(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(){for(var t=new e.MeshPhongMaterial,r=0;r<this.mProperties.length;r++)if("float"==M[this.mProperties[r].mKey]&&(t[w[this.mProperties[r].mKey]]=this.mProperties[r].dataAsFloat()),"color"==M[this.mProperties[r].mKey]&&(t[w[this.mProperties[r].mKey]]=this.mProperties[r].dataAsColor()),"bool"==M[this.mProperties[r].mKey]&&(t[w[this.mProperties[r].mKey]]=this.mProperties[r].dataAsBool()),"string"==M[this.mProperties[r].mKey]&&(t[w[this.mProperties[r].mKey]]=this.mProperties[r].dataAsString()),"map"==M[this.mProperties[r].mKey]){var a=this.mProperties[r];1==a.mSemantic&&(t.map=this.mProperties[r].dataAsMap()),6==a.mSemantic&&(t.normalMap=this.mProperties[r].dataAsMap()),10==a.mSemantic&&(t.lightMap=this.mProperties[r].dataAsMap()),8==a.mSemantic&&(t.alphaMap=this.mProperties[r].dataAsMap())}return t.ambient.r=.53,t.ambient.g=.53,t.ambient.b=.53,t.color.r=1,t.color.g=1,t.color.b=1,t}}function T(t,r,a){var i=new e.Vector3,n=1-a;return i.x=t.x*a+r.x*n,i.y=t.y*a+r.y*n,i.z=t.z*a+r.z*n,i}function C(e,t,r){return e.clone().slerp(t,1-r)}function F(e,t,r,a){if(1==e.length)return e[0].mValue.toTHREE();for(var i=1/0,n=null,o=null,s=0;s<e.length;s++){var l=Math.abs(e[s].mTime-t);l<i&&e[s].mTime<=t&&(i=l,n=e[s],o=e[s+1])}if(n){if(o){var u=o.mTime-n.mTime,c=(n.mTime-t)/u;return a(n.mValue.toTHREE(),o.mValue.toTHREE(),c)}(o=e[0].clone()).mTime+=r;u=o.mTime-n.mTime,c=(n.mTime-t)/u;return a(n.mValue.toTHREE(),o.mValue.toTHREE(),c)}return null}function E(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(e){function t(t){t.mTime/=e}e||(e=1),this.mPositionKeys.forEach(t),this.mRotationKeys.forEach(t),this.mScalingKeys.forEach(t)},this.sortKeys=function(){function e(e,t){return e.mTime-t.mTime}this.mPositionKeys.sort(e),this.mRotationKeys.sort(e),this.mScalingKeys.sort(e)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map((function(e){return e.mTime}))),Math.max.apply(null,this.mRotationKeys.map((function(e){return e.mTime}))),Math.max.apply(null,this.mScalingKeys.map((function(e){return e.mTime}))))},this.toTHREE=function(t){this.sortKeys();for(var r=this.getLength(),a=new i.KeyFrameTrack,n=0;n<r;n+=.05){var o=new e.Matrix4,s=n,l=F(this.mPositionKeys,s,r,T),u=F(this.mScalingKeys,s,r,T),c=F(this.mRotationKeys,s,r,C);o.compose(l,c,u);var h=new i.KeyFrame(s,o);a.addKey(h)}a.target=t.findNode(this.mNodeName).toTHREE();var d=[a];if(t.nodeToBoneMap[this.mNodeName])for(var f=0;f<t.nodeToBoneMap[this.mNodeName].length;f++){var p=a.clone();p.target=t.nodeToBoneMap[this.mNodeName][f],d.push(p)}return d}}function B(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(e){var t=new i.Animation;for(var r in this.mChannels){this.mChannels[r].init(this.mTicksPerSecond);var a=this.mChannels[r].toTHREE(e);for(var n in a)a[n].init(),t.addTrack(a[n])}return t.length=Math.max.apply(null,t.tracks.map((function(e){return e.length}))),t}}function L(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function P(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function D(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function N(){this.versionMajor=0,this.versionMinor=0,this.versionRevision=0,this.compileFlags=0,this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(e,t){if(t||(t=this.mRootNode),t.mName==e)return t;for(var r=0;r<t.mChildren.length;r++){var a=this.findNode(e,t.mChildren[r]);if(a)return a}return null},this.toTHREE=function(){this.nodeCount=0,function(e){for(var t in e.mMeshes){var r=e.mMeshes[t];for(var a in r.mBones){var i=e.findNode(r.mBones[a].mName);i&&(i.isBone=!0)}}}(this);var e=this.mRootNode.toTHREE(this);for(var t in this.mMeshes)this.mMeshes[t].hookupSkeletons(this);if(this.mAnimations.length>0)var r=this.mAnimations[0].toTHREE(this);return{object:e,animation:r}}}function R(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var t=new e.Matrix4,r=0;r<4;++r)for(var a=0;a<4;++a)t.elements[4*r+a]=this.elements[a][r];return t}}var _=!0;function I(e){var t=e.getFloat32(e.readOffset,_);return e.readOffset+=4,t}function O(e){var t=e.getFloat64(e.readOffset,_);return e.readOffset+=8,t}function U(e){var t=e.getUint16(e.readOffset,_);return e.readOffset+=2,t}function k(e){var t=e.getUint32(e.readOffset,_);return e.readOffset+=4,t}function V(e){var t=e.getUint32(e.readOffset,_);return e.readOffset+=4,t}function G(e){var t=new d;return t.x=I(e),t.y=I(e),t.z=I(e),t}function j(e){var t=new f;return t.r=I(e),t.g=I(e),t.b=I(e),t}function z(e){var t=new v,r=k(e);return e.ReadBytes(t.data,1,r),t.toString()}function H(e){var t=new m;return t.mVertexId=k(e),t.mWeight=I(e),t}function W(e){for(var t=new R,r=0;r<4;++r)for(var a=0;a<4;++a)t.elements[r][a]=I(e);return t}function X(e){var t=new g;return t.mTime=O(e),t.mValue=G(e),t}function Q(e){var t=new y;return t.mTime=O(e),t.mValue=function(e){var t=new p;return t.w=I(e),t.x=I(e),t.y=I(e),t.z=I(e),t}(e),t}function Y(e,t,r){for(var a=0;a<r;a++)t[a]=X(e)}function J(e,t,r){return e.Seek(sizeof(t)*r,ce)}function K(e){if(!e)throw"asset failed"}function q(e,t,r){K(4668==V(e)),V(e);var a=new x;if(a.mParent=t,a.mDepth=r,a.mName=z(e),a.mTransformation=W(e),a.mNumChildren=k(e),a.mNumMeshes=k(e),a.mNumMeshes){a.mMeshes=[];for(var i=0;i<a.mNumMeshes;++i)a.mMeshes[i]=k(e)}if(a.mNumChildren){a.mChildren=[];for(var n=0;n<a.mNumChildren;++n){var o=q(e,a,r++);a.mChildren[n]=o}}return a}function Z(e,t){return K(4666==V(e)),V(e),t.mName=z(e),t.mNumWeights=k(e),t.mOffsetMatrix=W(e),le?J(e,t.mWeights,t.mNumWeights):(t.mWeights=[],function(e,t,r){for(var a=0;a<r;a++)t[a]=H(e)}(e,t.mWeights,t.mNumWeights)),t}function $(e,t){K(4663==V(e)),V(e),t.mPrimitiveTypes=k(e),t.mNumVertices=k(e),t.mNumFaces=k(e),t.mNumBones=k(e),t.mMaterialIndex=k(e),t.mNumUVComponents=[];var r=k(e);1&r&&(le?J(e,t.mVertices,t.mNumVertices):(t.mVertices=[],t.mVertexBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,ce))),2&r&&(le?J(e,t.mNormals,t.mNumVertices):(t.mNormals=[],t.mNormalBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,ce))),4&r&&(le?(J(e,t.mTangents,t.mNumVertices),J(e,t.mBitangents,t.mNumVertices)):(t.mTangents=[],t.mTangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,ce),t.mBitangents=[],t.mBitangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,ce)));for(var a=0;a<1&&r&o(a);++a)le?J(e,t.mColors[a],t.mNumVertices):(t.mColors[a]=[],t.mColorBuffer=e.subArray32(e.readOffset,e.readOffset+4*t.mNumVertices*4),e.Seek(4*t.mNumVertices*4,ce));t.mTexCoordsBuffers=[];for(var i=0;i<4&&r&n(i);++i)if(t.mNumUVComponents[i]=k(e),le)J(e,t.mTextureCoords[i],t.mNumVertices);else{t.mTextureCoords[i]=[],t.mTexCoordsBuffers[i]=[];for(var s=0;s<t.mNumVertices;s++)t.mTexCoordsBuffers[i].push(I(e)),t.mTexCoordsBuffers[i].push(I(e)),I(e)}if(le)k(e);else{t.mFaces=[],t.mIndexArray=[];for(var l=0;l<t.mNumFaces;++l){var u=t.mFaces[l]=new h;u.mNumIndices=U(e),u.mIndices=[];for(var c=0;c<u.mNumIndices;++c)t.mNumVertices<65536?u.mIndices[c]=U(e):u.mIndices[c]=k(e);if(3===u.mNumIndices)t.mIndexArray.push(u.mIndices[0]),t.mIndexArray.push(u.mIndices[1]),t.mIndexArray.push(u.mIndices[2]);else{if(4!==u.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");t.mIndexArray.push(u.mIndices[0]),t.mIndexArray.push(u.mIndices[1]),t.mIndexArray.push(u.mIndices[2]),t.mIndexArray.push(u.mIndices[2]),t.mIndexArray.push(u.mIndices[3]),t.mIndexArray.push(u.mIndices[0])}}}if(t.mNumBones){t.mBones=[];for(var d=0;d<t.mNumBones;++d)t.mBones[d]=new b,Z(e,t.mBones[d])}}function ee(e,t){K(4670==V(e)),V(e),t.mKey=z(e),t.mSemantic=k(e),t.mIndex=k(e),t.mDataLength=k(e),t.mType=k(e),t.mData=[],e.ReadBytes(t.mData,1,t.mDataLength)}function te(e,t){if(K(4669==V(e)),V(e),t.mNumAllocated=t.mNumProperties=k(e),t.mNumProperties){t.mProperties&&delete t.mProperties,t.mProperties=[];for(var r=0;r<t.mNumProperties;++r)t.mProperties[r]=new A,ee(e,t.mProperties[r])}}function re(e,t){K(4664==V(e)),V(e),t.mNodeName=z(e),t.mNumPositionKeys=k(e),t.mNumRotationKeys=k(e),t.mNumScalingKeys=k(e),t.mPreState=k(e),t.mPostState=k(e),t.mNumPositionKeys&&(le?J(e,t.mPositionKeys,t.mNumPositionKeys):(t.mPositionKeys=[],Y(e,t.mPositionKeys,t.mNumPositionKeys))),t.mNumRotationKeys&&(le?J(e,t.mRotationKeys,t.mNumRotationKeys):(t.mRotationKeys=[],function(e,t,r){for(var a=0;a<r;a++)t[a]=Q(e)}(e,t.mRotationKeys,t.mNumRotationKeys))),t.mNumScalingKeys&&(le?J(e,t.mScalingKeys,t.mNumScalingKeys):(t.mScalingKeys=[],Y(e,t.mScalingKeys,t.mNumScalingKeys)))}function ae(e,t){if(K(4667==V(e)),V(e),t.mName=z(e),t.mDuration=O(e),t.mTicksPerSecond=O(e),t.mNumChannels=k(e),t.mNumChannels){t.mChannels=[];for(var r=0;r<t.mNumChannels;++r)t.mChannels[r]=new E,re(e,t.mChannels[r])}}function ie(e,t){K(4662==V(e)),V(e),t.mWidth=k(e),t.mHeight=k(e),e.ReadBytes(t.achFormatHint,1,4),le||(t.mHeight?(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth*t.mHeight*4)):(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth)))}function ne(e,t){K(4661==V(e)),V(e),t.mName=z(e),t.mType=k(e),1!=t.mType&&(t.mAttenuationConstant=I(e),t.mAttenuationLinear=I(e),t.mAttenuationQuadratic=I(e)),t.mColorDiffuse=j(e),t.mColorSpecular=j(e),t.mColorAmbient=j(e),3==t.mType&&(t.mAngleInnerCone=I(e),t.mAngleOuterCone=I(e))}function oe(e,t){K(4660==V(e)),V(e),t.mName=z(e),t.mPosition=G(e),t.mLookAt=G(e),t.mUp=G(e),t.mHorizontalFOV=I(e),t.mClipPlaneNear=I(e),t.mClipPlaneFar=I(e),t.mAspect=I(e)}function se(e,t){if(K(4665==V(e)),V(e),t.mFlags=k(e),t.mNumMeshes=k(e),t.mNumMaterials=k(e),t.mNumAnimations=k(e),t.mNumTextures=k(e),t.mNumLights=k(e),t.mNumCameras=k(e),t.mRootNode=new x,t.mRootNode=q(e,null,0),t.mNumMeshes){t.mMeshes=[];for(var r=0;r<t.mNumMeshes;++r)t.mMeshes[r]=new c,$(e,t.mMeshes[r])}if(t.mNumMaterials){t.mMaterials=[];for(var a=0;a<t.mNumMaterials;++a)t.mMaterials[a]=new S,te(e,t.mMaterials[a])}if(t.mNumAnimations){t.mAnimations=[];for(var i=0;i<t.mNumAnimations;++i)t.mAnimations[i]=new B,ae(e,t.mAnimations[i])}if(t.mNumTextures){t.mTextures=[];for(var n=0;n<t.mNumTextures;++n)t.mTextures[n]=new L,ie(e,t.mTextures[n])}if(t.mNumLights){t.mLights=[];for(var o=0;o<t.mNumLights;++o)t.mLights[o]=new P,ne(e,t.mLights[o])}if(t.mNumCameras){t.mCameras=[];for(var s=0;s<t.mNumCameras;++s)t.mCameras[s]=new D,oe(e,t.mCameras[s])}}var le,ue,ce=0;return function(e){var t=new N,r=new DataView(e);if(function(e){e.readOffset=0,e.Seek=function(t,r){r==ce&&(e.readOffset+=t),1==r&&(e.readOffset=t)},e.ReadBytes=function(e,t,r){for(var a,i,n=t*r,o=0;o<n;o++)e[o]=(i=void 0,i=(a=this).getUint8(a.readOffset),a.readOffset+=1,i)},e.subArray32=function(e,t){var r=this.buffer.slice(e,t);return new Float32Array(r)},e.subArrayUint16=function(e,t){var r=this.buffer.slice(e,t);return new Uint16Array(r)},e.subArrayUint8=function(e,t){var r=this.buffer.slice(e,t);return new Uint8Array(r)},e.subArrayUint32=function(e,t){var r=this.buffer.slice(e,t);return new Uint32Array(r)}}(r),r.Seek(44,ce),t.versionMajor=k(r),t.versionMinor=k(r),t.versionRevision=k(r),t.compileFlags=k(r),le=U(r)>0,ue=U(r)>0,le)throw"Shortened binaries are not supported!";if(r.Seek(256,ce),r.Seek(128,ce),r.Seek(64,ce),ue){var a=V(r),i=r.FileSize()-r.Tell(),n=[];r.Read(n,1,i);var o=[];uncompress(o,a,n,i),se(new ArrayBuffer(o),t)}else se(r,t);return t.toTHREE()}(t)}});var pl=function(t){e.Loader.call(this,t)};pl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:pl,load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(t,(function(e){r(n.parse(e))}),a,i)},parse:function(t){for(var r=new DataView(t),a=r.getUint32(0),i=r.getUint32(4),n=8,o=new Float32Array(a),s=new Float32Array(a*a).fill(0),l=0;l<a;l++)o[l]=r.getFloat32(n),n+=4,s[a*l+l]=1;for(var u=new e.NumberKeyframeTrack(".morphTargetInfluences",o,s),c=new e.AnimationClip("default",o[o.length-1],[u]),h=[],d=0;d<a;d++){for(var f=new Float32Array(3*i),p=0;p<i;p++){var m=3*p;f[m+0]=r.getFloat32(n),n+=4,f[m+1]=r.getFloat32(n),n+=4,f[m+2]=r.getFloat32(n),n+=4}var v=new e.BufferAttribute(f,3);v.name="morph_"+d,h.push(v)}return{morphTargets:h,clip:c}}});var ml=function(t){e.DataTextureLoader.call(this,t),this.type=e.FloatType};ml.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:ml,parse:function(t){var r=65536,a=14,i=65537,n=16384,o=Math.pow(2.7182818,2.2),s=new DataView(new ArrayBuffer(8));function u(e){if(0===e)return[e,0];s.setFloat64(0,e);var t=s.getUint32(0)>>>20&2047;0===t&&(s.setFloat64(0,e*Math.pow(2,64)),t=(s.getUint32(0)>>>20&2047)-64);var r=t-1022;return[function(e,t){for(var r=Math.min(3,Math.ceil(Math.abs(t)/1023)),a=e,i=0;i<r;i++)a*=Math.pow(2,Math.floor((t+i)/r));return a}(e,-r),r]}var c={l:0,c:0,lc:0};function h(e,t,r,a,i){for(;r<e;)t=t<<8|j(a,i),r+=8;r-=e,c.l=t>>r&(1<<e)-1,c.c=t,c.lc=r}var d=new Array(59);function f(e,t,r,a,n,o,s){for(var l=r,u=0,f=0;n<=o;n++){if(l.value-r.value>a)return!1;h(6,u,f,e,l);var p=c.l;if(u=c.c,f=c.lc,s[n]=p,63==p){if(l.value-r.value>a)throw"Something wrong with hufUnpackEncTable";h(8,u,f,e,l);var m=c.l+6;if(u=c.c,f=c.lc,n+m>o+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)s[n++]=0;n--}else if(p>=59){if(n+(m=p-59+2)>o+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)s[n++]=0;n--}}!function(e){for(var t=0;t<=58;++t)d[t]=0;for(var r=0;r<i;++r)d[e[r]]+=1;for(var a=0,n=58;n>0;--n){var o=a+d[n]>>1;d[n]=a,a=o}for(var s=0;s<i;++s){var l=e[s];l>0&&(e[s]=l|d[l]++<<6)}}(s)}function p(e){return 63&e}function m(e){return e>>6}var v={c:0,lc:0};function g(e,t,r,a){e=e<<8|j(r,a),t+=8,v.c=e,v.lc=t}var y={c:0,lc:0};function x(e,t,r,a,i,n,o,s,l,u){if(e==t){a<8&&(g(r,a,i,o),r=v.c,a=v.lc);var c=r>>(a-=8);c=new Uint8Array([c])[0];if(l.value+c>u)return!1;for(var h=s[l.value-1];c-- >0;)s[l.value++]=h}else{if(!(l.value<u))return!1;s[l.value++]=e}y.c=r,y.lc=a}function b(e){return 65535&e}function A(e){var t=b(e);return t>32767?t-65536:t}var w={a:0,b:0};function M(e,t){var r=A(e),a=A(t),i=r+(1&a)+(a>>1),n=i,o=i-a;w.a=n,w.b=o}function S(e,t){var r=b(e),a=b(t),i=r-(a>>1)&65535,n=a+i-32768&65535;w.a=n,w.b=i}function T(e,t,r,a,i,n,o){for(var s,l=o<16384,u=r>i?i:r,c=1;c<=u;)c<<=1;for(s=c>>=1,c>>=1;c>=1;){for(var h,d,f,p,m=0,v=m+n*(i-s),g=n*c,y=n*s,x=a*c,b=a*s;m<=v;m+=y){for(var A=m,T=m+a*(r-s);A<=T;A+=b){var C=A+x,F=(E=A+g)+x;l?(M(e[A+t],e[E+t]),h=w.a,f=w.b,M(e[C+t],e[F+t]),d=w.a,p=w.b,M(h,d),e[A+t]=w.a,e[C+t]=w.b,M(f,p),e[E+t]=w.a,e[F+t]=w.b):(S(e[A+t],e[E+t]),h=w.a,f=w.b,S(e[C+t],e[F+t]),d=w.a,p=w.b,S(h,d),e[A+t]=w.a,e[C+t]=w.b,S(f,p),e[E+t]=w.a,e[F+t]=w.b)}if(r&c){var E=A+g;l?M(e[A+t],e[E+t]):S(e[A+t],e[E+t]),h=w.a,e[E+t]=w.b,e[A+t]=h}}if(i&c)for(A=m,T=m+a*(r-s);A<=T;A+=b){C=A+x;l?M(e[A+t],e[C+t]):S(e[A+t],e[C+t]),h=w.a,e[C+t]=w.b,e[A+t]=h}s=c,c>>=1}return m}function C(e,t,r,o,s,l){var u=r.value,c=G(t,r),h=G(t,r);r.value+=4;var d=G(t,r);if(r.value+=4,c<0||c>=i||h<0||h>=i)throw"Something wrong with HUF_ENCSIZE";var b=new Array(i),A=new Array(n);if(function(e){for(var t=0;t<n;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(A),f(e,0,r,o-(r.value-u),c,h,b),d>8*(o-(r.value-u)))throw"Something wrong with hufUncompress";!function(e,t,r,i){for(;t<=r;t++){var n=m(e[t]),o=p(e[t]);if(n>>o)throw"Invalid table entry";if(o>a){if((h=i[n>>o-a]).len)throw"Invalid table entry";if(h.lit++,h.p){var s=h.p;h.p=new Array(h.lit);for(var l=0;l<h.lit-1;++l)h.p[l]=s[l]}else h.p=new Array(1);h.p[h.lit-1]=t}else if(o)for(var u=0,c=1<<a-o;c>0;c--){var h;if((h=i[(n<<a-o)+u]).len||h.p)throw"Invalid table entry";h.len=o,h.lit=t,u++}}}(b,c,h,A),function(e,t,r,i,n,o,s,l,u,c){for(var h=0,d=0,f=l,b=Math.trunc(n.value+(o+7)/8);n.value<b;)for(g(h,d,r,n),h=v.c,d=v.lc;d>=a;)if((S=t[h>>d-a&16383]).len)d-=S.len,x(S.lit,s,h,d,r,0,n,u,c,f),h=y.c,d=y.lc;else{if(!S.p)throw"hufDecode issues";var A;for(A=0;A<S.lit;A++){for(var w=p(e[S.p[A]]);d<w&&n.value<b;)g(h,d,r,n),h=v.c,d=v.lc;if(d>=w&&m(e[S.p[A]])==(h>>d-w&(1<<w)-1)){d-=w,x(S.p[A],s,h,d,r,0,n,u,c,f),h=y.c,d=y.lc;break}}if(A==S.lit)throw"hufDecode issues"}var M=8-o&7;for(h>>=M,d-=M;d>0;){var S;if(!(S=t[h<<a-d&16383]).len)throw"hufDecode issues";d-=S.len,x(S.lit,s,h,d,r,0,n,u,c,f),h=y.c,d=y.lc}}(b,A,e,0,r,d,h,l,s,{value:0})}function F(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function E(e,t){for(var r=0,a=Math.floor((e.length+1)/2),i=0,n=e.length-1;!(i>n||(t[i++]=e[r++],i>n));)t[i++]=e[a++]}function B(e){for(var t=e.byteLength,r=new Array,a=0,i=new DataView(e);t>0;){var n=i.getInt8(a++);if(n<0){t-=(s=-n)+1;for(var o=0;o<s;o++)r.push(i.getUint8(a++))}else{var s=n;t-=2;for(var l=i.getUint8(a++),u=0;u<s+1;u++)r.push(l)}}return r}function L(e,t,r){for(var a,i=1;i<64;)65280==(a=t[e.value])?i=64:a>>8==255?i+=255&a:(r[i]=a,i++),e.value++}function P(e,t){t[0]=X(e[0]),t[1]=X(e[1]),t[2]=X(e[5]),t[3]=X(e[6]),t[4]=X(e[14]),t[5]=X(e[15]),t[6]=X(e[27]),t[7]=X(e[28]),t[8]=X(e[2]),t[9]=X(e[4]),t[10]=X(e[7]),t[11]=X(e[13]),t[12]=X(e[16]),t[13]=X(e[26]),t[14]=X(e[29]),t[15]=X(e[42]),t[16]=X(e[3]),t[17]=X(e[8]),t[18]=X(e[12]),t[19]=X(e[17]),t[20]=X(e[25]),t[21]=X(e[30]),t[22]=X(e[41]),t[23]=X(e[43]),t[24]=X(e[9]),t[25]=X(e[11]),t[26]=X(e[18]),t[27]=X(e[24]),t[28]=X(e[31]),t[29]=X(e[40]),t[30]=X(e[44]),t[31]=X(e[53]),t[32]=X(e[10]),t[33]=X(e[19]),t[34]=X(e[23]),t[35]=X(e[32]),t[36]=X(e[39]),t[37]=X(e[45]),t[38]=X(e[52]),t[39]=X(e[54]),t[40]=X(e[20]),t[41]=X(e[22]),t[42]=X(e[33]),t[43]=X(e[38]),t[44]=X(e[46]),t[45]=X(e[51]),t[46]=X(e[55]),t[47]=X(e[60]),t[48]=X(e[21]),t[49]=X(e[34]),t[50]=X(e[37]),t[51]=X(e[47]),t[52]=X(e[50]),t[53]=X(e[56]),t[54]=X(e[59]),t[55]=X(e[61]),t[56]=X(e[35]),t[57]=X(e[36]),t[58]=X(e[48]),t[59]=X(e[49]),t[60]=X(e[57]),t[61]=X(e[58]),t[62]=X(e[62]),t[63]=X(e[63])}function D(e){for(var t=.5*Math.cos(.7853975),r=.5*Math.cos(3.14159/16),a=.5*Math.cos(3.14159/8),i=.5*Math.cos(3*3.14159/16),n=.5*Math.cos(.981746875),o=.5*Math.cos(3*3.14159/8),s=.5*Math.cos(1.374445625),l=new Array(4),u=new Array(4),c=new Array(4),h=new Array(4),d=0;d<8;++d){var f=8*d;l[0]=a*e[f+2],l[1]=o*e[f+2],l[2]=a*e[f+6],l[3]=o*e[f+6],u[0]=r*e[f+1]+i*e[f+3]+n*e[f+5]+s*e[f+7],u[1]=i*e[f+1]-s*e[f+3]-r*e[f+5]-n*e[f+7],u[2]=n*e[f+1]-r*e[f+3]+s*e[f+5]+i*e[f+7],u[3]=s*e[f+1]-n*e[f+3]+i*e[f+5]-r*e[f+7],c[0]=t*(e[f+0]+e[f+4]),c[3]=t*(e[f+0]-e[f+4]),c[1]=l[0]+l[3],c[2]=l[1]-l[2],h[0]=c[0]+c[1],h[1]=c[3]+c[2],h[2]=c[3]-c[2],h[3]=c[0]-c[1],e[f+0]=h[0]+u[0],e[f+1]=h[1]+u[1],e[f+2]=h[2]+u[2],e[f+3]=h[3]+u[3],e[f+4]=h[3]-u[3],e[f+5]=h[2]-u[2],e[f+6]=h[1]-u[1],e[f+7]=h[0]-u[0]}for(var p=0;p<8;++p)l[0]=a*e[16+p],l[1]=o*e[16+p],l[2]=a*e[48+p],l[3]=o*e[48+p],u[0]=r*e[8+p]+i*e[24+p]+n*e[40+p]+s*e[56+p],u[1]=i*e[8+p]-s*e[24+p]-r*e[40+p]-n*e[56+p],u[2]=n*e[8+p]-r*e[24+p]+s*e[40+p]+i*e[56+p],u[3]=s*e[8+p]-n*e[24+p]+i*e[40+p]-r*e[56+p],c[0]=t*(e[p]+e[32+p]),c[3]=t*(e[p]-e[32+p]),c[1]=l[0]+l[3],c[2]=l[1]-l[2],h[0]=c[0]+c[1],h[1]=c[3]+c[2],h[2]=c[3]-c[2],h[3]=c[0]-c[1],e[0+p]=h[0]+u[0],e[8+p]=h[1]+u[1],e[16+p]=h[2]+u[2],e[24+p]=h[3]+u[3],e[32+p]=h[3]-u[3],e[40+p]=h[2]-u[2],e[48+p]=h[1]-u[1],e[56+p]=h[0]-u[0]}function N(e){for(var t=0;t<64;++t){var r=e[0][t],a=e[1][t],i=e[2][t];e[0][t]=r+1.5747*i,e[1][t]=r-.1873*a-.4682*i,e[2][t]=r+1.8556*a}}function R(t,r,a){for(var i=0;i<64;++i)r[a+i]=e.DataUtils.toHalfFloat(_(t[i]))}function _(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(o,Math.abs(e)-1)}function I(e){var t=e.array.slice(e.offset.value,e.offset.value+e.size),r=l.unzlibSync(t),a=new Uint8Array(r.length);return F(r),E(r,a),new DataView(a.buffer)}function O(e){var t=e.viewer,r={value:e.offset.value},a=new Uint8Array(e.width*e.lines*(q.channels.length*e.type*2)),i={version:H(t,r),unknownUncompressedSize:H(t,r),unknownCompressedSize:H(t,r),acCompressedSize:H(t,r),dcCompressedSize:H(t,r),rleCompressedSize:H(t,r),rleUncompressedSize:H(t,r),rleRawSize:H(t,r),totalAcUncompressedCount:H(t,r),totalDcUncompressedCount:H(t,r),acCompression:H(t,r)};if(i.version<2)throw"EXRLoader.parse: "+q.compression+" version "+i.version+" is unsupported";for(var n=new Array,o=Q(t,r)-2;o>0;){var s=U(t.buffer,r),l=z(t,r),u=l>>2&3,c=new Int8Array([(l>>4)-1])[0],h=z(t,r);n.push({name:s,index:c,type:h,compression:u}),o-=s.length+3}for(var d=q.channels,f=new Array(e.channels),p=0;p<e.channels;++p){var m=f[p]={},v=d[p];m.name=v.name,m.compression=0,m.decoded=!1,m.type=v.pixelType,m.pLinear=v.pLinear,m.width=e.width,m.height=e.lines}for(var g={idx:new Array(3)},y=0;y<e.channels;++y){m=f[y];for(var x=0;x<n.length;++x){var b=n[x];m.name==b.name&&(m.compression=b.compression,b.index>=0&&(g.idx[b.index]=y),m.offset=y)}}if(i.acCompressedSize>0)switch(i.acCompression){case 0:var A=new Uint16Array(i.totalAcUncompressedCount);C(e.array,t,r,i.acCompressedSize,A,i.totalAcUncompressedCount);break;case 1:var w=e.array.slice(r.value,r.value+i.totalAcUncompressedCount),M=fflate.unzlibSync(w);A=new Uint16Array(M.buffer);r.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var S={array:e.array,offset:r,size:i.dcCompressedSize},T=new Uint16Array(I(S).buffer);r.value+=i.dcCompressedSize}if(i.rleRawSize>0){w=e.array.slice(r.value,r.value+i.rleCompressedSize);var F=B((M=fflate.unzlibSync(w)).buffer);r.value+=i.rleCompressedSize}for(var E=0,_=new Array(f.length),O=0;O<_.length;++O)_[O]=new Array;for(var k=0;k<e.lines;++k)for(var V=0;V<f.length;++V)_[V].push(E),E+=f[V].width*e.type*2;!function(e,t,r,a,i,n){for(var o=new DataView(n.buffer),s=r[e.idx[0]].width,l=r[e.idx[0]].height,u=Math.floor(s/8),c=Math.ceil(s/8),h=Math.ceil(l/8),d=s-8*(c-1),f=l-8*(h-1),p={value:0},m=new Array(3),v=new Array(3),g=new Array(3),y=new Array(3),x=new Array(3),b=0;b<3;++b)x[b]=t[e.idx[b]],m[b]=b<1?0:m[b-1]+c*h,v[b]=new Float32Array(64),g[b]=new Uint16Array(64),y[b]=new Uint16Array(64*c);for(var A=0;A<h;++A){var w=8;A==h-1&&(w=f);for(var M=8,S=0;S<c;++S){S==c-1&&(M=d);for(var T=0;T<3;++T)g[T].fill(0),g[T][0]=i[m[T]++],L(p,a,g[T]),P(g[T],v[T]),D(v[T]);N(v);for(var C=0;C<3;++C)R(v[C],y[C],64*S)}for(var F=0,E=0;E<3;++E){for(var B=r[e.idx[E]].type,_=8*A;_<8*A+w;++_){F=x[E][_];for(var I=0;I<u;++I){var O=64*I+8*(7&_);o.setUint16(F+0*B,y[E][O+0],!0),o.setUint16(F+2*B,y[E][O+1],!0),o.setUint16(F+4*B,y[E][O+2],!0),o.setUint16(F+6*B,y[E][O+3],!0),o.setUint16(F+8*B,y[E][O+4],!0),o.setUint16(F+10*B,y[E][O+5],!0),o.setUint16(F+12*B,y[E][O+6],!0),o.setUint16(F+14*B,y[E][O+7],!0),F+=16*B}}if(u!=c)for(var U=8*A;U<8*A+w;++U)for(var k=x[E][U]+8*u*2*B,V=64*u+8*(7&U),G=0;G<M;++G)o.setUint16(k+2*G*B,y[E][V+G],!0)}}for(var j=new Uint16Array(s),z=(o=new DataView(n.buffer),0);z<3;++z){r[e.idx[z]].decoded=!0;var H=r[e.idx[z]].type;if(2==r[z].type)for(var W=0;W<l;++W){for(var Q=x[z][W],Y=0;Y<s;++Y)j[Y]=o.getUint16(Q+2*Y*H,!0);for(var J=0;J<s;++J)o.setFloat32(Q+2*J*H,X(j[J]),!0)}}}(g,_,f,A,T,a);for(var G=0;G<f.length;++G){if(!(m=f[G]).decoded)switch(m.compression){case 2:for(var j=0,W=0,Y=0;Y<e.lines;++Y){for(var J=_[G][j],K=0;K<m.width;++K){for(var Z=0;Z<2*m.type;++Z)a[J++]=F[W+Z*m.width*m.height];W++}j++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(a.buffer)}function U(e,t){for(var r=new Uint8Array(e),a=0;0!=r[t.value+a];)a+=1;var i=(new TextDecoder).decode(r.slice(t.value,t.value+a));return t.value=t.value+a+1,i}function k(e,t){var r=e.getUint32(0,!0);return t.value=t.value+8,r}function V(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function G(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function j(e,t){var r=e[t.value];return t.value=t.value+1,r}function z(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}function H(e,t){var r=Number(e.getBigInt64(t.value,!0));return t.value+=8,r}function W(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function X(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function Q(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function Y(e,t,r,a,i){return"string"===a||"stringvector"===a||"iccProfile"===a?function(e,t,r){var a=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,a}(t,r,i):"chlist"===a?function(e,t,r,a){for(var i=r.value,n=[];r.value<i+a-1;){var o=U(t,r),s=V(e,r),l=z(e,r);r.value+=3;var u=V(e,r),c=V(e,r);n.push({name:o,pixelType:s,pLinear:l,xSampling:u,ySampling:c})}return r.value+=1,n}(e,t,r,i):"chromaticities"===a?function(e,t){return{redX:W(e,t),redY:W(e,t),greenX:W(e,t),greenY:W(e,t),blueX:W(e,t),blueY:W(e,t),whiteX:W(e,t),whiteY:W(e,t)}}(e,r):"compression"===a?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][z(e,t)]}(e,r):"box2i"===a?function(e,t){return{xMin:G(e,t),yMin:G(e,t),xMax:G(e,t),yMax:G(e,t)}}(e,r):"lineOrder"===a?function(e,t){return["INCREASING_Y"][z(e,t)]}(e,r):"float"===a?W(e,r):"v2f"===a?function(e,t){return[W(e,t),W(e,t)]}(e,r):"v3f"===a?function(e,t){return[W(e,t),W(e,t),W(e,t)]}(e,r):"int"===a?V(e,r):"rational"===a?function(e,t){return[V(e,t),G(e,t)]}(e,r):"timecode"===a?function(e,t){return[G(e,t),G(e,t)]}(e,r):"preview"===a?(r.value+=i,"skipped"):void(r.value+=i)}var J=new DataView(t),K=new Uint8Array(t),q={};J.getUint32(0,!0),J.getUint8(4,!0),J.getUint8(5,!0);for(var Z={value:8},$=!0;$;){var ee=U(t,Z);if(0==ee)$=!1;else{var te=U(t,Z),re=Y(J,t,Z,te,G(J,Z));void 0===re?console.warn("EXRLoader.parse: skipped unknown header attribute type '"+te+"'."):q[ee]=re}}var ae,ie,ne,oe,se=q.dataWindow.yMax+1;switch(q.compression){case"NO_COMPRESSION":ie=1,ae=function(e){return new DataView(e.array.buffer,e.offset.value,e.size)};break;case"RLE_COMPRESSION":ie=1,ae=function(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),r=new Uint8Array(B(t)),a=new Uint8Array(r.length);return F(r),E(r,a),new DataView(a.buffer)};break;case"ZIPS_COMPRESSION":ie=1,ae=I;break;case"ZIP_COMPRESSION":ie=16,ae=I;break;case"PIZ_COMPRESSION":ie=32,ae=function(e){for(var t=e.viewer,a={value:e.offset.value},i=e.width*ie*(q.channels.length*e.type),n=new Uint16Array(i),o=new Uint8Array(8192),s=0,l=new Array(e.channels),u=0;u<e.channels;u++)l[u]={},l[u].start=s,l[u].end=l[u].start,l[u].nx=e.width,l[u].ny=e.lines,l[u].size=e.type,s+=l[u].nx*l[u].ny*l[u].size;var c=Q(t,a),h=Q(t,a);if(h>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=h)for(var d=0;d<h-c+1;d++)o[d+c]=z(t,a);var f=new Uint16Array(r),p=function(e,t){for(var a=0,i=0;i<r;++i)(0==i||e[i>>3]&1<<(7&i))&&(t[a++]=i);for(var n=a-1;a<r;)t[a++]=0;return n}(o,f),m=G(t,a);C(e.array,t,a,m,n,s);for(var v=0;v<e.channels;++v)for(var g=l[v],y=0;y<l[v].size;++y)T(n,g.start+y,g.nx,g.size,g.ny,g.nx*g.size,p);!function(e,t,r){for(var a=0;a<r;++a)t[a]=e[t[a]]}(f,n,s);for(var x=0,b=new Uint8Array(n.buffer.byteLength),A=0;A<e.lines;A++)for(var w=0;w<e.channels;w++){var M=(g=l[w]).nx*g.size,S=new Uint8Array(n.buffer,2*g.end,2*M);b.set(S,x),x+=2*M,g.end+=M}return new DataView(b.buffer)};break;case"PXR24_COMPRESSION":ie=16,ae=function(e){var t=e.array.slice(e.offset.value,e.offset.value+e.size);"undefined"==typeof fflate&&console.error("THREE.EXRLoader: External library fflate.min.js required.");for(var r=fflate.unzlibSync(t),a=e.lines*e.channels*e.width,i=1==e.type?new Uint16Array(a):new Uint32Array(a),n=0,o=0,s=new Array(4),l=0;l<e.lines;l++)for(var u=0;u<e.channels;u++){var c=0;switch(e.type){case 1:s[0]=n,s[1]=s[0]+e.width,n=s[1]+e.width;for(var h=0;h<e.width;++h)c+=r[s[0]++]<<8|r[s[1]++],i[o]=c,o++;break;case 2:s[0]=n,s[1]=s[0]+e.width,s[2]=s[1]+e.width,n=s[2]+e.width;for(var d=0;d<e.width;++d)c+=r[s[0]++]<<24|r[s[1]++]<<16|r[s[2]++]<<8,i[o]=c,o++}}return new DataView(i.buffer)};break;case"DWAA_COMPRESSION":ie=32,ae=O;break;case"DWAB_COMPRESSION":ie=256,ae=O;break;default:throw"EXRLoader.parse: "+q.compression+" is unsupported"}var le=q.channels[0].pixelType;if(1===le)switch(this.type){case e.UnsignedByteType:case e.FloatType:oe=function(e,t){return X(Q(e,t))},ne=2;break;case e.HalfFloatType:oe=Q,ne=2}else{if(2!==le)throw"EXRLoader.parse: unsupported pixelType "+le+" for "+q.compression+".";switch(this.type){case e.UnsignedByteType:case e.FloatType:oe=W,ne=4;break;case e.HalfFloatType:oe=function(t,r){return e.DataUtils.toHalfFloat(W(t,r))},ne=4}}for(var ue=se/ie,ce=0;ce<ue;ce++)k(J,Z);var he=q.dataWindow.xMax-q.dataWindow.xMin+1,de=q.dataWindow.yMax-q.dataWindow.yMin+1,fe=he*de*4;switch(this.type){case e.UnsignedByteType:case e.FloatType:var pe=new Float32Array(fe);q.channels.length<4&&pe.fill(1,0,fe);break;case e.HalfFloatType:pe=new Uint16Array(fe);q.channels.length<4&&pe.fill(15360,0,fe);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}for(var me,ve,ge={R:0,G:1,B:2,A:3},ye={size:0,width:he,lines:ie,offset:Z,array:K,viewer:J,type:le,channels:q.channels.length},xe={value:0},be=0;be<de/ie;be++){me=G(J,Z),fe=G(J,Z),ye.lines=me+ie>de?de-me:ie,ye.offset=Z,ye.size=fe,ve=ae(ye),Z.value+=fe;for(var Ae=0;Ae<ie;Ae++){var we=Ae+be*ie;if(we>=de)break;for(var Me=0;Me<q.channels.length;Me++)for(var Se=ge[q.channels[Me].name],Te=0;Te<he;Te++){var Ce=Ae*(q.channels.length*he)+Me*he+Te;xe.value=Ce*ne;var Fe=oe(ve,xe);pe[4*he*(de-1-we)+4*Te+Se]=Fe}}}if(this.type===e.UnsignedByteType){for(var Ee,Be,Le=pe.length,Pe=new Uint8Array(Le),De=0;De<de;++De)for(var Ne=0;Ne<he;++Ne){var Re=pe[Be=De*he*4+4*Ne],_e=pe[Be+1],Ie=pe[Be+2];if((Ee=Ie>(Ee=Re>_e?Re:_e)?Ie:Ee)<1e-32)Pe[Be]=Pe[Be+1]=Pe[Be+2]=Pe[Be+3]=0;else{var Oe=u(Ee);Ee=256*Oe[0]/Ee,Pe[Be]=Re*Ee,Pe[Be+1]=_e*Ee,Pe[Be+2]=Ie*Ee,Pe[Be+3]=Oe[1]+128}}pe=Pe}var Ue=this.type===e.UnsignedByteType?e.RGBEFormat:e.RGBAFormat;return{header:q,width:he,height:de,data:pe,format:Ue,type:this.type}},setDataType:function(e){return this.type=e,this},load:function(t,r,a,i){return e.DataTextureLoader.prototype.load.call(this,t,(function(t,a){switch(t.type){case e.UnsignedByteType:t.encoding=e.RGBEEncoding,t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.generateMipmaps=!1,t.flipY=!1;break;case e.FloatType:case e.HalfFloatType:t.encoding=e.LinearEncoding,t.minFilter=e.LinearFilter,t.magFilter=e.LinearFilter,t.generateMipmaps=!1,t.flipY=!1}r&&r(t,a)}),a,i)}});var vl=function(t){e.Loader.call(this,t),this.availableExtensions=[]};function gl(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return yl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yl(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function yl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}vl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:vl,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){var r=this,a=new e.TextureLoader(this.manager);function i(e){for(var t=[],r=(new DOMParser).parseFromString(e,"application/xml").querySelectorAll("Relationship"),a=0;a<r.length;a++){var i=r[a],n={target:i.getAttribute("Target"),id:i.getAttribute("Id"),type:i.getAttribute("Type")};t.push(n)}return t}function n(e){for(var t={id:e.getAttribute("id"),basematerials:[]},r=e.querySelectorAll("base"),a=0;a<r.length;a++){var i=c(r[a]);i.index=a,t.basematerials.push(i)}return t}function o(e){for(var t={id:e.getAttribute("id"),texid:e.getAttribute("texid"),displaypropertiesid:e.getAttribute("displaypropertiesid")},r=e.querySelectorAll("tex2coord"),a=[],i=0;i<r.length;i++){var n=r[i],o=n.getAttribute("u"),s=n.getAttribute("v");a.push(parseFloat(o),parseFloat(s))}return t.uvs=new Float32Array(a),t}function s(t){for(var r={id:t.getAttribute("id"),displaypropertiesid:t.getAttribute("displaypropertiesid")},a=t.querySelectorAll("color"),i=[],n=new e.Color,o=0;o<a.length;o++){var s=a[o].getAttribute("color");n.setStyle(s.substring(0,7)),n.convertSRGBToLinear(),i.push(n.r,n.g,n.b)}return r.colors=new Float32Array(i),r}function u(e){for(var t={id:e.getAttribute("id")},r=e.querySelectorAll("pbmetallic"),a=[],i=0;i<r.length;i++){var n=r[i];a.push({name:n.getAttribute("name"),metallicness:parseFloat(n.getAttribute("metallicness")),roughness:parseFloat(n.getAttribute("roughness"))})}return t.data=a,t}function c(e){var t={};return t.name=e.getAttribute("name"),t.displaycolor=e.getAttribute("displaycolor"),t.displaypropertiesid=e.getAttribute("displaypropertiesid"),t}function h(e){var t={};t.objectId=e.getAttribute("objectid");var r=e.getAttribute("transform");return r&&(t.transform=d(r)),t}function d(t){var r=[];t.split(" ").forEach((function(e){r.push(parseFloat(e))}));var a=new e.Matrix4;return a.set(r[0],r[3],r[6],r[9],r[1],r[4],r[7],r[10],r[2],r[5],r[8],r[11],0,0,0,1),a}function f(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var a=e.getAttribute("pid");a&&(t.pid=a);var i=e.getAttribute("pindex");i&&(t.pindex=i);var n=e.getAttribute("thumbnail");n&&(t.thumbnail=n);var o=e.getAttribute("partnumber");o&&(t.partnumber=o);var s=e.getAttribute("name");s&&(t.name=s);var l=e.querySelector("mesh");l&&(t.mesh=function(e){for(var t={},r=[],a=e.querySelectorAll("vertices vertex"),i=0;i<a.length;i++){var n=a[i],o=n.getAttribute("x"),s=n.getAttribute("y"),l=n.getAttribute("z");r.push(parseFloat(o),parseFloat(s),parseFloat(l))}t.vertices=new Float32Array(r);for(var u=[],c=[],h=e.querySelectorAll("triangles triangle"),d=0;d<h.length;d++){var f=h[d],p=f.getAttribute("v1"),m=f.getAttribute("v2"),v=f.getAttribute("v3"),g=f.getAttribute("p1"),y=f.getAttribute("p2"),x=f.getAttribute("p3"),b=f.getAttribute("pid"),A={};A.v1=parseInt(p,10),A.v2=parseInt(m,10),A.v3=parseInt(v,10),c.push(A.v1,A.v2,A.v3),g&&(A.p1=parseInt(g,10)),y&&(A.p2=parseInt(y,10)),x&&(A.p3=parseInt(x,10)),b&&(A.pid=b),0<Object.keys(A).length&&u.push(A)}return t.triangleProperties=u,t.triangles=new Uint32Array(c),t}(l));var u=e.querySelector("components");return u&&(t.components=function(e){for(var t=[],r=e.querySelectorAll("component"),a=0;a<r.length;a++){var i=h(r[a]);t.push(i)}return t}(u)),t}function p(e){var t={unit:e.getAttribute("unit")||"millimeter"},r=e.querySelectorAll("metadata");r&&(t.metadata=function(e){for(var t={},r=0;r<e.length;r++){var a=e[r],i=a.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(i)&&(t[i]=a.textContent)}return t}(r));var a=e.querySelector("resources");a&&(t.resources=function(e){for(var t={basematerials:{}},r=e.querySelectorAll("basematerials"),a=0;a<r.length;a++){var i=n(r[a]);t.basematerials[i.id]=i}t.texture2d={};for(var l,c=e.querySelectorAll("texture2d"),h=0;h<c.length;h++){var d={id:(l=c[h]).getAttribute("id"),path:l.getAttribute("path"),contenttype:l.getAttribute("contenttype"),tilestyleu:l.getAttribute("tilestyleu"),tilestylev:l.getAttribute("tilestylev"),filter:l.getAttribute("filter")};t.texture2d[d.id]=d}t.colorgroup={};for(var p=e.querySelectorAll("colorgroup"),m=0;m<p.length;m++){var v=s(p[m]);t.colorgroup[v.id]=v}t.pbmetallicdisplayproperties={};for(var g=e.querySelectorAll("pbmetallicdisplayproperties"),y=0;y<g.length;y++){var x=u(g[y]);t.pbmetallicdisplayproperties[x.id]=x}t.texture2dgroup={};for(var b=e.querySelectorAll("texture2dgroup"),A=0;A<b.length;A++){var w=o(b[A]);t.texture2dgroup[w.id]=w}t.object={};for(var M=e.querySelectorAll("object"),S=0;S<M.length;S++){var T=f(M[S]);t.object[T.id]=T}return t}(a));var i=e.querySelector("build");return i&&(t.build=function(e){for(var t=[],r=e.querySelectorAll("item"),a=0;a<r.length;a++){var i=r[a],n={objectId:i.getAttribute("objectid")},o=i.getAttribute("transform");o&&(n.transform=d(o)),t.push(n)}return t}(i)),t}function m(t,r,i,n){var o=t.texid,s=i.resources.texture2d[o];if(s){var l=n[s.path],u=s.contenttype,c=new Blob([l],{type:u}),h=URL.createObjectURL(c),d=a.load(h,(function(){URL.revokeObjectURL(h)}));switch(d.encoding=e.sRGBEncoding,s.tilestyleu){case"wrap":d.wrapS=e.RepeatWrapping;break;case"mirror":d.wrapS=e.MirroredRepeatWrapping;break;case"none":case"clamp":d.wrapS=e.ClampToEdgeWrapping;break;default:d.wrapS=e.RepeatWrapping}switch(s.tilestylev){case"wrap":d.wrapT=e.RepeatWrapping;break;case"mirror":d.wrapT=e.MirroredRepeatWrapping;break;case"none":case"clamp":d.wrapT=e.ClampToEdgeWrapping;break;default:d.wrapT=e.RepeatWrapping}switch(s.filter){case"auto":d.magFilter=e.LinearFilter,d.minFilter=e.LinearMipmapLinearFilter;break;case"linear":d.magFilter=e.LinearFilter,d.minFilter=e.LinearFilter;break;case"nearest":d.magFilter=e.NearestFilter,d.minFilter=e.NearestFilter;break;default:d.magFilter=e.LinearFilter,d.minFilter=e.LinearMipmapLinearFilter}return d}return null}function v(t,r,a,i,n,o){for(var s=o.pindex,l={},u=0,c=r.length;u<c;u++){var h=void 0!==(C=r[u]).p1?C.p1:s;void 0===l[h]&&(l[h]=[]),l[h].push(C)}for(var d=Object.keys(l),f=[],p=0,m=d.length;p<m;p++){for(var v=d[p],g=l[v],y=w(t.basematerials[v],F,a,n,o,M),x=new e.BufferGeometry,b=[],A=i.vertices,S=0,T=g.length;S<T;S++){var C=g[S];b.push(A[3*C.v1+0]),b.push(A[3*C.v1+1]),b.push(A[3*C.v1+2]),b.push(A[3*C.v2+0]),b.push(A[3*C.v2+1]),b.push(A[3*C.v2+2]),b.push(A[3*C.v3+0]),b.push(A[3*C.v3+1]),b.push(A[3*C.v3+2])}x.setAttribute("position",new e.Float32BufferAttribute(b,3));var E=new e.Mesh(x,y);f.push(E)}return f}function g(t,r,a,i,n,o){for(var s=new e.BufferGeometry,l=[],u=[],c=i.vertices,h=t.uvs,d=0,f=r.length;d<f;d++){var p=r[d];l.push(c[3*p.v1+0]),l.push(c[3*p.v1+1]),l.push(c[3*p.v1+2]),l.push(c[3*p.v2+0]),l.push(c[3*p.v2+1]),l.push(c[3*p.v2+2]),l.push(c[3*p.v3+0]),l.push(c[3*p.v3+1]),l.push(c[3*p.v3+2]),u.push(h[2*p.p1+0]),u.push(h[2*p.p1+1]),u.push(h[2*p.p2+0]),u.push(h[2*p.p2+1]),u.push(h[2*p.p3+0]),u.push(h[2*p.p3+1])}s.setAttribute("position",new e.Float32BufferAttribute(l,3)),s.setAttribute("uv",new e.Float32BufferAttribute(u,2));var v=w(t,F,a,n,o,m),g=new e.MeshPhongMaterial({map:v,flatShading:!0});return new e.Mesh(s,g)}function y(t,r,a,i,n){for(var o=new e.BufferGeometry,s=[],l=[],u=i.vertices,c=t.colors,h=0,d=r.length;h<d;h++){var f=r[h],p=f.v1,m=f.v2,v=f.v3;s.push(u[3*p+0]),s.push(u[3*p+1]),s.push(u[3*p+2]),s.push(u[3*m+0]),s.push(u[3*m+1]),s.push(u[3*m+2]),s.push(u[3*v+0]),s.push(u[3*v+1]),s.push(u[3*v+2]);var g=void 0!==f.p1?f.p1:n.pindex,y=void 0!==f.p2?f.p2:g,x=void 0!==f.p3?f.p3:g;l.push(c[3*g+0]),l.push(c[3*g+1]),l.push(c[3*g+2]),l.push(c[3*y+0]),l.push(c[3*y+1]),l.push(c[3*y+2]),l.push(c[3*x+0]),l.push(c[3*x+1]),l.push(c[3*x+2])}o.setAttribute("position",new e.Float32BufferAttribute(s,3)),o.setAttribute("color",new e.Float32BufferAttribute(l,3));var b=new e.MeshPhongMaterial({vertexColors:!0,flatShading:!0});return new e.Mesh(o,b)}function x(t){var r=new e.BufferGeometry;r.setIndex(new e.BufferAttribute(t.triangles,1)),r.setAttribute("position",new e.BufferAttribute(t.vertices,3));var a=new e.MeshPhongMaterial({color:11184895,flatShading:!0});return new e.Mesh(r,a)}function b(e,t){return void 0!==t.resources.texture2dgroup[e]?"texture":void 0!==t.resources.basematerials[e]?"material":void 0!==t.resources.colorgroup[e]?"vertexColors":"default"===e?"default":void 0}function A(t,r,a,i,n){for(var o=new e.Group,s=function(e,t,r,a,i){for(var n=Object.keys(e),o=[],s=0,l=n.length;s<l;s++){var u=n[s],c=e[u];switch(b(u,t)){case"material":for(var h=v(t.resources.basematerials[u],c,t,r,a,i),d=0,f=h.length;d<f;d++)o.push(h[d]);break;case"texture":var p=t.resources.texture2dgroup[u];o.push(g(p,c,t,r,a,i));break;case"vertexColors":var m=t.resources.colorgroup[u];o.push(y(m,c,0,r,i));break;case"default":o.push(x(r));break;default:console.error("THREE.3MFLoader: Unsupported resource type.")}}return o}(function(e,t,r){for(var a={},i=t.triangleProperties,n=r.pid,o=0,s=i.length;o<s;o++){var l=i[o],u=void 0!==l.pid?l.pid:n;void 0===u&&(u="default"),void 0===a[u]&&(a[u]=[]),a[u].push(l)}return a}(0,t,n),a,t,i,n),l=0,u=s.length;l<u;l++)o.add(s[l]);return o}function w(e,t,r,a,i,n){return void 0!==e.build||(e.build=n(e,t,r,a,i)),e.build}function M(t,r,a){var i,n=t.displaypropertiesid,o=a.resources.pbmetallicdisplayproperties;if(null!==n&&void 0!==o[n]){var s=o[n].data[t.index];i=new e.MeshStandardMaterial({flatShading:!0,roughness:s.roughness,metalness:s.metallicness})}else i=new e.MeshPhongMaterial({flatShading:!0});i.name=t.name;var l=t.displaycolor,u=l.substring(0,7);return i.color.setStyle(u),i.color.convertSRGBToLinear(),9===l.length&&(i.opacity=parseInt(l.charAt(7)+l.charAt(8),16)/255),i}function S(t,r,a,i){for(var n=new e.Group,o=0;o<t.length;o++){var s=t[o],l=r[s.objectId];void 0===l&&(T(s.objectId,r,a,i),l=r[s.objectId]);var u=l.clone(),c=s.transform;c&&u.applyMatrix4(c),n.add(u)}return n}function T(e,t,a,i){var n=a.resources.object[e];if(n.mesh){var o=n.mesh;!function(e,t,a){if(e){for(var i=[],n=Object.keys(e),o=0;o<n.length;o++)for(var s=n[o],l=0;l<r.availableExtensions.length;l++)(c=r.availableExtensions[l]).ns===s&&i.push(c);for(var u=0;u<i.length;u++){var c;(c=i[u]).apply(a,e[c.ns],t)}}}(a.extensions,o,a.xml),t[n.id]=w(o,t,a,i,n,A)}else{var s=n.components;t[n.id]=w(s,t,a,i,n,S)}}var C=function(t){var r,a,n,o,s=null,u=null,c=[],h=[],d={},f={};try{s=l.unzipSync(new Uint8Array(t))}catch(e){if(e instanceof ReferenceError)return console.error("THREE.3MFLoader: fflate missing and file is compressed."),null}for(u in s)u.match(/\_rels\/.rels$/)?r=u:u.match(/3D\/_rels\/.*\.model\.rels$/)?a=u:u.match(/^3D\/.*\.model$/)?c.push(u):u.match(/^3D\/Metadata\/.*\.xml$/)||(u.match(/^3D\/Textures?\/.*/)?h.push(u):u.match(/^3D\/Other\/.*/));var m=s[r];if(n=i(e.LoaderUtils.decodeText(m)),a){m=s[a];o=i(e.LoaderUtils.decodeText(m))}for(var v=0;v<c.length;v++){var g=c[v],y=s[g],x=e.LoaderUtils.decodeText(y),b=(new DOMParser).parseFromString(x,"application/xml");"model"!==b.documentElement.nodeName.toLowerCase()&&console.error("THREE.3MFLoader: Error loading 3MF - no 3MF document found: ",g);for(var A=b.querySelector("model"),w={},M=0;M<A.attributes.length;M++){var S=A.attributes[M];S.name.match(/^xmlns:(.+)$/)&&(w[S.value]=RegExp.$1)}var T=p(A);T.xml=A,0<Object.keys(w).length&&(T.extensions=w),d[g]=T}for(var C=0;C<h.length;C++){var F=h[C];f[F]=s[F].buffer}return{rels:n,modelRels:o,model:d,printTicket:{},texture:f,other:{}}}(t),F=function(e){var t=e.model,r=e.modelRels,a={},i=Object.keys(t),n={};if(r)for(var o=0,s=r.length;o<s;o++){var l=r[o],u=l.target.substring(1);e.texture[u]&&(n[l.target]=e.texture[u])}for(var c=0;c<i.length;c++)for(var h=t[i[c]],d=Object.keys(h.resources.object),f=0;f<d.length;f++){T(d[f],a,h,n)}return a}(C);return function(t,r){for(var a=new e.Group,i=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("model"===r.target.split(".").pop().toLowerCase())return r}}(r.rels),n=r.model[i.target.substring(1)].build,o=0;o<n.length;o++){var s=n[o],l=t[s.objectId],u=s.transform;u&&l.applyMatrix4(u),a.add(l)}return a}(F,C)},addExtension:function(e){this.availableExtensions.push(e)}});var xl=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.load=function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},a.parse=function(t){for(var r,a=[],i=[],n=gl(t.split("\n"));!(r=n()).done;){var o=r.value;if("#"!==(o=o.trim()).charAt(0)){var s=o.split(/\s+/);3===s.length&&(a.push(parseFloat(s[0])),a.push(parseFloat(s[1])),a.push(parseFloat(s[2]))),6===s.length&&(a.push(parseFloat(s[0])),a.push(parseFloat(s[1])),a.push(parseFloat(s[2])),i.push(parseFloat(s[3])/255),i.push(parseFloat(s[4])/255),i.push(parseFloat(s[5])/255))}}var l=new e.BufferGeometry;return l.setAttribute("position",new e.Float32BufferAttribute(a,3)),i.length>0&&l.setAttribute("color",new e.Float32BufferAttribute(i,3)),l},r}(e.Loader),bl=function(t){e.Loader.call(this,t)};bl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:bl,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){function r(e,t){var r=e.length,a=new Int32Array(r+t.length);return a.set(e),a.set(t,r),a}var a=e.LoaderUtils.decodeText(new Uint8Array(t,0,250)).split("\n");return-1!==a[0].indexOf("xml")?function(t){function a(e){var t,r,a,i,n,o,s="undefined"!=typeof Uint8Array?Uint8Array:Array,l=[],u=[],c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=c.length;for(t=0;t<h;t++)l[t]=c[t];for(t=0;t<h;++t)u[c.charCodeAt(t)]=t;if(u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63,(h=e.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=new s(3*h/4-(n="="===e[h-2]?2:"="===e[h-1]?1:0)),a=n>0?h-4:h;var d=0;for(t=0,r=0;t<a;t+=4,r+=3)i=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],o[d++]=(16711680&i)>>16,o[d++]=(65280&i)>>8,o[d++]=255&i;return 2===n?(i=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,o[d++]=255&i):1===n&&(i=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,o[d++]=i>>8&255,o[d++]=255&i),o}function i(e,t){var i,n,s,u,c=0;if("UInt64"===o.attributes.header_type?c=8:"UInt32"===o.attributes.header_type&&(c=4),"binary"===e.attributes.format&&t){var h,d,f,p,m,v;if("Float32"===e.attributes.type)var g=new Float32Array;else"Int64"===e.attributes.type&&(g=new Int32Array);d=(h=a(e["#text"]))[0];for(var y=1;y<c-1;y++)d|=h[y]<<y*c;p=(d+3)*c,v=p+=p%3>0?3-p%3:0,(m=[]).push(v),f=3*c;for(var x=0;x<d;x++){for(var b=h[x*c+f],A=1;A<c-1;A++)b|=h[x*c+f+A]<<8*A;v+=b,m.push(v)}for(var w=0;w<m.length-1;w++)M=l.unzlibSync(h.slice(m[w],m[w+1])).buffer,"Float32"===e.attributes.type?(n=M=new Float32Array(M),s=void 0,u=void 0,s=(i=g).length,(u=new Float32Array(s+n.length)).set(i),u.set(n,s),g=u):"Int64"===e.attributes.type&&(g=r(g,M=new Int32Array(M)));delete e["#text"],"Int64"===e.attributes.type&&"binary"===e.attributes.format&&(g=g.filter((function(e,t){if(t%2!=1)return!0})))}else{if("binary"!==e.attributes.format||t)if(e["#text"])var M=e["#text"].split(/\s+/).filter((function(e){if(""!==e)return e}));else M=new Int32Array(0).buffer;else M=(M=a(e["#text"])).slice(c).buffer;delete e["#text"],"Float32"===e.attributes.type?g=new Float32Array(M):"Int32"===e.attributes.type?g=new Int32Array(M):"Int64"===e.attributes.type&&(g=new Int32Array(M),"binary"===e.attributes.format&&(g=g.filter((function(e,t){if(t%2!=1)return!0}))))}return g}var n=null;if(window.DOMParser)try{n=(new DOMParser).parseFromString(t,"text/xml")}catch(e){n=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((n=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!n.loadXML())throw new Error(n.parseError.reason+n.parseError.srcText)}catch(e){n=null}}var o=function e(t){var r={};if(1===t.nodeType){if(t.attributes&&t.attributes.length>0){r.attributes={};for(var a=0;a<t.attributes.length;a++){var i=t.attributes.item(a);r.attributes[i.nodeName]=i.nodeValue.trim()}}}else 3===t.nodeType&&(r=t.nodeValue.trim());if(t.hasChildNodes())for(var n=0;n<t.childNodes.length;n++){var o=t.childNodes.item(n),s=o.nodeName;if(void 0===r[s])""!==(u=e(o))&&(r[s]=u);else{if(void 0===r[s].push){var l=r[s];r[s]=[l]}var u;""!==(u=e(o))&&r[s].push(u)}}return r}(n.documentElement),s=[],u=[],c=[];if(o.PolyData){for(var h=o.PolyData.Piece,d=o.attributes.hasOwnProperty("compressor"),f=["PointData","Points","Strips","Polys"],p=0,m=f.length;p<m;){var v=h[f[p]];if(v&&v.DataArray){if("[object Array]"===Object.prototype.toString.call(v.DataArray))var g=v.DataArray;else g=[v.DataArray];for(var y=0,x=g.length;y<x;)"#text"in g[y]&&g[y]["#text"].length>0&&(g[y].text=i(g[y],d)),y++;switch(f[p]){case"PointData":var b=parseInt(h.attributes.NumberOfPoints),A=v.attributes.Normals;if(b>0)for(var w=0,M=g.length;w<M;w++)if(A===g[w].attributes.Name){var S=g[w].attributes.NumberOfComponents;(u=new Float32Array(b*S)).set(g[w].text,0)}break;case"Points":(b=parseInt(h.attributes.NumberOfPoints))>0&&(S=v.DataArray.attributes.NumberOfComponents,(s=new Float32Array(b*S)).set(v.DataArray.text,0));break;case"Strips":var T=parseInt(h.attributes.NumberOfStrips);if(T>0){var C=new Int32Array(v.DataArray[0].text.length),F=new Int32Array(v.DataArray[1].text.length);C.set(v.DataArray[0].text,0),F.set(v.DataArray[1].text,0);var E=T+C.length;c=new Uint32Array(3*E-9*T);for(var B=0,L=0,P=T;L<P;L++){for(var D=[],N=0,R=F[L],_=0;N<R-_;N++)D.push(C[N]),L>0&&(_=F[L-1]);for(var I=0,O=F[L],U=0;I<O-U-2;I++)I%2?(c[B++]=D[I],c[B++]=D[I+2],c[B++]=D[I+1]):(c[B++]=D[I],c[B++]=D[I+1],c[B++]=D[I+2]),L>0&&(U=F[L-1])}}break;case"Polys":var k=parseInt(h.attributes.NumberOfPolys);if(k>0){C=new Int32Array(v.DataArray[0].text.length),F=new Int32Array(v.DataArray[1].text.length),C.set(v.DataArray[0].text,0),F.set(v.DataArray[1].text,0),E=k+C.length,c=new Uint32Array(3*E-9*k),B=0;for(var V=0,G=0,j=k,z=0;G<j;){for(var H=[],W=0,X=F[G];W<X-z;)H.push(C[V++]),W++;for(var Q=1;Q<X-z-1;)c[B++]=H[0],c[B++]=H[Q],c[B++]=H[Q+1],Q++;z=F[++G-1]}}}}p++}var Y=new e.BufferGeometry;return Y.setIndex(new e.BufferAttribute(c,1)),Y.setAttribute("position",new e.BufferAttribute(s,3)),u.length===s.length&&Y.setAttribute("normal",new e.BufferAttribute(u,3)),Y}throw new Error("Unsupported DATASET type")}(e.LoaderUtils.decodeText(t)):a[2].includes("ASCII")?function(t){var r,a=[],i=[],n=[],o=[],s=/^[^\d.\s-]+/,l=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,u=/^(\d+)\s+([\s\d]*)/,c=/^POINTS /,h=/^POLYGONS /,d=/^TRIANGLE_STRIPS /,f=/^POINT_DATA[ ]+(\d+)/,p=/^CELL_DATA[ ]+(\d+)/,m=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,v=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,g=!1,y=!1,x=!1,b=!1,A=!1,w=!1,M=!1,S=t.split("\n");for(var T in S){var C=S[T].trim();if(0===C.indexOf("DATASET")){var F=C.split(" ")[1];if("POLYDATA"!==F)throw new Error("Unsupported DATASET type: "+F)}else if(g)for(;null!==(r=l.exec(C))&&null===s.exec(C);){var E=parseFloat(r[1]),B=parseFloat(r[2]),L=parseFloat(r[3]);i.push(E,B,L)}else if(y){if(null!==(r=u.exec(C))){var P=parseInt(r[1]),D=r[2].split(/\s+/);if(P>=3)for(var N=parseInt(D[0]),R=1,_=0;_<P-2;++_)I=parseInt(D[R]),O=parseInt(D[R+1]),a.push(N,I,O),R++}}else if(x){if(null!==(r=u.exec(C))&&(P=parseInt(r[1]),D=r[2].split(/\s+/),P>=3))for(var I,O,U=0;U<P-2;U++)U%2==1?(N=parseInt(D[U]),I=parseInt(D[U+2]),O=parseInt(D[U+1]),a.push(N,I,O)):(N=parseInt(D[U]),I=parseInt(D[U+1]),O=parseInt(D[U+2]),a.push(N,I,O))}else if(b||A)if(w)for(;null!==(r=l.exec(C))&&null===s.exec(C);){var k=parseFloat(r[1]),V=parseFloat(r[2]),G=parseFloat(r[3]);n.push(k,V,G)}else if(M)for(;null!==(r=l.exec(C))&&null===s.exec(C);){var j=parseFloat(r[1]),z=parseFloat(r[2]),H=parseFloat(r[3]);o.push(j,z,H)}null!==h.exec(C)?(y=!0,g=!1,x=!1):null!==c.exec(C)?(y=!1,g=!0,x=!1):null!==d.exec(C)?(y=!1,g=!1,x=!0):null!==f.exec(C)?(b=!0,g=!1,y=!1,x=!1):null!==p.exec(C)?(A=!0,g=!1,y=!1,x=!1):null!==m.exec(C)?(w=!0,M=!1,g=!1,y=!1,x=!1):null!==v.exec(C)&&(M=!0,w=!1,g=!1,y=!1,x=!1)}var W=new e.BufferGeometry;if(W.setIndex(a),W.setAttribute("position",new e.Float32BufferAttribute(i,3)),o.length===i.length&&W.setAttribute("normal",new e.Float32BufferAttribute(o,3)),n.length!==a.length)n.length===i.length&&W.setAttribute("color",new e.Float32BufferAttribute(n,3));else{var X=(W=W.toNonIndexed()).attributes.position.count/3;if(n.length===3*X){for(var Q=[],Y=0;Y<X;Y++)k=n[3*Y+0],V=n[3*Y+1],G=n[3*Y+2],Q.push(k,V,G),Q.push(k,V,G),Q.push(k,V,G);W.setAttribute("color",new e.Float32BufferAttribute(Q,3))}}return W}(e.LoaderUtils.decodeText(t)):function(t){var r,a,i,n,o,s,l,u=new Uint8Array(t),c=new DataView(t),h=[],d=[],f=[],p=0;function m(e,t){for(var r=t,a=e[r],i=[];10!==a;)i.push(String.fromCharCode(a)),a=e[++r];return{start:t,end:r,next:r+1,parsedString:i.join("")}}for(;;){if(0===(l=(s=m(u,p)).parsedString).indexOf("DATASET")){var v=l.split(" ")[1];if("POLYDATA"!==v)throw new Error("Unsupported DATASET type: "+v)}else if(0===l.indexOf("POINTS")){for(r=4*(n=parseInt(l.split(" ")[1],10))*3,h=new Float32Array(3*n),a=s.next,i=0;i<n;i++)h[3*i]=c.getFloat32(a,!1),h[3*i+1]=c.getFloat32(a+4,!1),h[3*i+2]=c.getFloat32(a+8,!1),a+=12;s.next=s.next+r+1}else if(0===l.indexOf("TRIANGLE_STRIPS")){var g=parseInt(l.split(" ")[1],10);r=4*(w=parseInt(l.split(" ")[2],10)),f=new Uint32Array(3*w-9*g);var y=0;for(a=s.next,i=0;i<g;i++){var x=c.getInt32(a,!1),b=[];for(a+=4,o=0;o<x;o++)b.push(c.getInt32(a,!1)),a+=4;for(var A=0;A<x-2;A++)A%2?(f[y++]=b[A],f[y++]=b[A+2],f[y++]=b[A+1]):(f[y++]=b[A],f[y++]=b[A+1],f[y++]=b[A+2])}s.next=s.next+r+1}else if(0===l.indexOf("POLYGONS")){var w;for(g=parseInt(l.split(" ")[1],10),r=4*(w=parseInt(l.split(" ")[2],10)),f=new Uint32Array(3*w-9*g),y=0,a=s.next,i=0;i<g;i++){for(x=c.getInt32(a,!1),b=[],a+=4,o=0;o<x;o++)b.push(c.getInt32(a,!1)),a+=4;for(var M=1;M<x-1;M++)f[y++]=b[0],f[y++]=b[M],f[y++]=b[M+1]}s.next=s.next+r+1}else if(0===l.indexOf("POINT_DATA")){for(n=parseInt(l.split(" ")[1],10),s=m(u,s.next),r=4*n*3,d=new Float32Array(3*n),a=s.next,i=0;i<n;i++)d[3*i]=c.getFloat32(a,!1),d[3*i+1]=c.getFloat32(a+4,!1),d[3*i+2]=c.getFloat32(a+8,!1),a+=12;s.next=s.next+r}if((p=s.next)>=u.byteLength)break}var S=new e.BufferGeometry;return S.setIndex(new e.BufferAttribute(f,1)),S.setAttribute("position",new e.BufferAttribute(h,3)),d.length===h.length&&S.setAttribute("normal",new e.BufferAttribute(d,3)),S}(t)}});var Al=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.load=function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("text"),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},a.parse=function(t){for(var r=(t=t.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim()).split(/[\n\r]+/g),a=r[0].trim().split(/\s+/g).map((function(e){return parseFloat(e)})),i=a[1]-a[0],n=a.length,o=1,s=a.length;o<s;o++)if(i!==a[o]-a[o-1])throw new Error("LUT3dlLoader: Inconsistent grid size not supported.");for(var l=new Array(n*n*n*3),u=0,c=0,h=1,d=r.length;h<d;h++){var f=r[h].trim().split(/\s/g),p=parseFloat(f[0]),m=parseFloat(f[1]),v=parseFloat(f[2]);c=Math.max(c,p,m,v);var g=u%n*n*n+Math.floor(u/n)%n*n+Math.floor(u/(n*n))%n;l[3*g+0]=p,l[3*g+1]=m,l[3*g+2]=v,u+=1}for(var y=Math.ceil(Math.log2(c)),x=Math.pow(2,y),b=0,A=l.length;b<A;b++){var w=l[b];l[b]=255*w/x}var M=new Uint8Array(l),S=new e.DataTexture;S.image.data=M,S.image.width=n,S.image.height=n*n,S.format=e.RGBFormat,S.type=e.UnsignedByteType,S.magFilter=e.LinearFilter,S.minFilter=e.LinearFilter,S.wrapS=e.ClampToEdgeWrapping,S.wrapT=e.ClampToEdgeWrapping,S.generateMipmaps=!1;var T=new e.DataTexture3D;return T.image.data=M,T.image.width=n,T.image.height=n,T.image.depth=n,T.format=e.RGBFormat,T.type=e.UnsignedByteType,T.magFilter=e.LinearFilter,T.minFilter=e.LinearFilter,T.wrapS=e.ClampToEdgeWrapping,T.wrapT=e.ClampToEdgeWrapping,T.wrapR=e.ClampToEdgeWrapping,T.generateMipmaps=!1,{size:n,texture:S,texture3D:T}},r}(e.Loader),wl=function(t){e.CompressedTextureLoader.call(this,t)};wl.prototype=Object.assign(Object.create(e.CompressedTextureLoader.prototype),{constructor:wl,parse:function(t,r){var a={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function n(e,t,r,a){for(var i=r*a*4,n=new Uint8Array(e,t,i),o=new Uint8Array(i),s=0,l=0,u=0;u<a;u++)for(var c=0;c<r;c++){var h=n[l],d=n[++l],f=n[++l],p=n[++l];l++,o[s]=f,o[++s]=d,o[++s]=h,o[++s]=p,s++}return o}var o,s=i("DXT1"),l=i("DXT3"),u=i("DXT5"),c=i("ETC1"),h=new Int32Array(t,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),a;if(4&!h[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),a;var d,f=h[21],p=!1;switch(f){case s:o=8,a.format=e.RGB_S3TC_DXT1_Format;break;case l:o=16,a.format=e.RGBA_S3TC_DXT3_Format;break;case u:o=16,a.format=e.RGBA_S3TC_DXT5_Format;break;case c:o=8,a.format=e.RGB_ETC1_Format;break;default:if(!(32===h[22]&&16711680&h[23]&&65280&h[24]&&255&h[25]&&4278190080&h[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(d=f,String.fromCharCode(255&d,d>>8&255,d>>16&255,d>>24&255))),a;p=!0,o=64,a.format=e.RGBAFormat}a.mipmapCount=1,131072&h[2]&&!1!==r&&(a.mipmapCount=Math.max(1,h[7]));var m=h[28];if(a.isCubemap=!!(512&m),a.isCubemap&&(!(1024&m)||!(2048&m)||!(4096&m)||!(8192&m)||!(16384&m)||!(32768&m)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),a;a.width=h[4],a.height=h[3];for(var v=h[1]+4,g=a.isCubemap?6:1,y=0;y<g;y++)for(var x=a.width,b=a.height,A=0;A<a.mipmapCount;A++){if(p)var w=(M=n(t,v,x,b)).length;else{w=Math.max(4,x)/4*Math.max(4,b)/4*o;var M=new Uint8Array(t,v,w)}var S={data:M,width:x,height:b};a.mipmaps.push(S),v+=w,x=Math.max(x>>1,1),b=Math.max(b>>1,1)}return a}});var Ml=function(t){e.CompressedTextureLoader.call(this,t)};Ml.prototype=Object.assign(Object.create(e.CompressedTextureLoader.prototype),{constructor:Ml,parse:function(e,t){var r=new Uint32Array(e,0,13),a={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?Ml._parseV3(a):559044176===r[11]?Ml._parseV2(a):void console.error("THREE.PVRLoader: Unknown PVR format.")}}),Ml._parseV3=function(t){var r,a,i=t.header,n=i[12],o=i[2],s=i[6],l=i[7],u=i[10],c=i[11];switch(o){case 0:r=2,a=e.RGB_PVRTC_2BPPV1_Format;break;case 1:r=2,a=e.RGBA_PVRTC_2BPPV1_Format;break;case 2:r=4,a=e.RGB_PVRTC_4BPPV1_Format;break;case 3:r=4,a=e.RGBA_PVRTC_4BPPV1_Format;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",o)}return t.dataPtr=52+n,t.bpp=r,t.format=a,t.width=l,t.height=s,t.numSurfaces=u,t.numMipmaps=c,t.isCubemap=6===u,Ml._extract(t)},Ml._parseV2=function(t){var r,a,i=t.header,n=i[0],o=i[1],s=i[2],l=i[3],u=i[4],c=i[10],h=i[12],d=255&u,f=c>0;return 25===d?(a=f?e.RGBA_PVRTC_4BPPV1_Format:e.RGB_PVRTC_4BPPV1_Format,r=4):24===d?(a=f?e.RGBA_PVRTC_2BPPV1_Format:e.RGB_PVRTC_2BPPV1_Format,r=2):console.error("THREE.PVRLoader: Unknown PVR format:",d),t.dataPtr=n,t.bpp=r,t.format=a,t.width=s,t.height=o,t.numSurfaces=h,t.numMipmaps=l+1,t.isCubemap=6===h,Ml._extract(t)},Ml._extract=function(e){var t,r={mipmaps:[],width:e.width,height:e.height,format:e.format,mipmapCount:e.numMipmaps,isCubemap:e.isCubemap},a=e.buffer,i=e.dataPtr,n=e.bpp,o=e.numSurfaces,s=0,l=0,u=0,c=0,h=0;2===n?(l=8,u=4):(l=4,u=4),t=l*u*n/8,r.mipmaps.length=e.numMipmaps*o;for(var d=0;d<e.numMipmaps;){var f=e.width>>d,p=e.height>>d;(c=f/l)<2&&(c=2),(h=p/u)<2&&(h=2),s=c*h*t;for(var m=0;m<o;m++){var v={data:new Uint8Array(a,i,s),width:f,height:p};r.mipmaps[m*e.numMipmaps+d]=v,i+=s}d++}return r};var Sl=function(t){e.Loader.call(this,t),this.splitLayer=!1};Sl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Sl,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){var r={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},a=[],n=void 0,o=new e.LineBasicMaterial({color:16711680});o.name="path";var s=new e.LineBasicMaterial({color:65280});function l(e){n={vertex:[],pathVertex:[],z:e.z},a.push(n)}function u(e,t){return r.relative?t:t-e}function c(e,t){return r.relative?e+t:t}s.name="extruded";for(var h,d,f=t.replace(/;.+/g,"").split("\n"),p=0;p<f.length;p++){var m=f[p].split(" "),v=m[0].toUpperCase(),g={};if(m.splice(1).forEach((function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));g[t]=r}})),"G0"===v||"G1"===v){var y={x:void 0!==g.x?c(r.x,g.x):r.x,y:void 0!==g.y?c(r.y,g.y):r.y,z:void 0!==g.z?c(r.z,g.z):r.z,e:void 0!==g.e?c(r.e,g.e):r.e,f:void 0!==g.f?c(r.f,g.f):r.f};u(r.e,y.e)>0&&(y.extruding=u(r.e,y.e)>0,null!=n&&y.z==n.z||l(y)),h=r,d=y,void 0===n&&l(h),y.extruding?(n.vertex.push(h.x,h.y,h.z),n.vertex.push(d.x,d.y,d.z)):(n.pathVertex.push(h.x,h.y,h.z),n.pathVertex.push(d.x,d.y,d.z)),r=y}else if("G2"===v||"G3"===v);else if("G90"===v)r.relative=!1;else if("G91"===v)r.relative=!0;else if("G92"===v){(y=r).x=void 0!==g.x?g.x:y.x,y.y=void 0!==g.y?g.y:y.y,y.z=void 0!==g.z?g.z:y.z,y.e=void 0!==g.e?g.e:y.e,r=y}}function x(t,r){var a=new e.BufferGeometry;a.setAttribute("position",new e.Float32BufferAttribute(t,3));var n=new e.LineSegments(a,r?s:o);n.name="layer"+i,b.add(n)}var b=new e.Group;if(b.name="gcode",this.splitLayer)for(var A=0;A<a.length;A++){x((T=a[A]).vertex,!0),x(T.pathVertex,!1)}else{for(var w=[],M=[],S=0;S<a.length;S++){for(var T,C=(T=a[S]).vertex,F=T.pathVertex,E=0;E<C.length;E++)w.push(C[E]);for(var B=0;B<F.length;B++)M.push(F[B])}x(w,!0),x(M,!1)}return b.quaternion.setFromEuler(new e.Euler(-Math.PI/2,0,0)),b}});var Tl=function(t){e.Loader.call(this,t),this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};Tl.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Tl,load:function(t,r,a,i){var n=this,o=""===this.path?e.LoaderUtils.extractUrlBase(t):this.path,s=new e.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(e){try{r(n.parse(e,o))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t,r){this.group=new e.Group,this.position=0,this.materials=[],this.meshes=[],this.readFile(t,r);for(var a=0;a<this.meshes.length;a++)this.group.add(this.meshes[a]);return this.group},readFile:function(e,t){var r=new DataView(e),a=this.readChunk(r);if(a.id===Fl||a.id===El||a.id===Cl)for(var i=this.nextChunk(r,a);0!==i;){if(i===Bl){var n=this.readDWord(r);this.debugMessage("3DS file version: "+n)}else i===Il?(this.resetPosition(r),this.readMeshData(r,t)):this.debugMessage("Unknown main chunk: "+i.toString(16));i=this.nextChunk(r,a)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,t){for(var r=this.readChunk(e),a=this.nextChunk(e,r);0!==a;){if(a===Ol){var i=+this.readDWord(e);this.debugMessage("Mesh Version: "+i)}else if(a===Ul){var n=this.readFloat(e);this.debugMessage("Master scale: "+n),this.group.scale.set(n,n,n)}else a===ou?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):a===kl?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,t)):this.debugMessage("Unknown MDATA chunk: "+a.toString(16));a=this.nextChunk(e,r)}},readNamedObject:function(e){var t=this.readChunk(e),r=this.readString(e,64);t.cur=this.position;for(var a=this.nextChunk(e,t);0!==a;){if(a===su){this.resetPosition(e);var i=this.readMesh(e);i.name=r,this.meshes.push(i)}else this.debugMessage("Unknown named object chunk: "+a.toString(16));a=this.nextChunk(e,t)}this.endChunk(t)},readMaterialEntry:function(t,r){for(var a=this.readChunk(t),i=this.nextChunk(t,a),n=new e.MeshPhongMaterial;0!==i;){if(i===Vl)n.name=this.readString(t,64),this.debugMessage("   Name: "+n.name);else if(i===Jl)this.debugMessage("   Wireframe"),n.wireframe=!0;else if(i===Kl){var o=this.readByte(t);n.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(i===Ql)n.side=e.DoubleSide,this.debugMessage("   DoubleSided");else if(i===Yl)this.debugMessage("   Additive Blending"),n.blending=e.AdditiveBlending;else if(i===zl)this.debugMessage("   Diffuse Color"),n.color=this.readColor(t);else if(i===Hl)this.debugMessage("   Specular Color"),n.specular=this.readColor(t);else if(i===Gl)this.debugMessage("   Ambient color"),n.color=this.readColor(t);else if(i===Wl){var s=this.readPercentage(t);n.shininess=100*s,this.debugMessage("   Shininess : "+s)}else if(i===Xl){var l=this.readPercentage(t);n.opacity=1-l,this.debugMessage("  Transparency : "+l),n.transparent=n.opacity<1}else i===ql?(this.debugMessage("   ColorMap"),this.resetPosition(t),n.map=this.readMap(t,r)):i===$l?(this.debugMessage("   BumpMap"),this.resetPosition(t),n.bumpMap=this.readMap(t,r)):i===Zl?(this.debugMessage("   OpacityMap"),this.resetPosition(t),n.alphaMap=this.readMap(t,r)):i===eu?(this.debugMessage("   SpecularMap"),this.resetPosition(t),n.specularMap=this.readMap(t,r)):this.debugMessage("   Unknown material chunk: "+i.toString(16));i=this.nextChunk(t,a)}this.endChunk(a),this.materials[n.name]=n},readMesh:function(t){var r=this.readChunk(t),a=this.nextChunk(t,r),i=new e.BufferGeometry,n=[],o=new e.MeshPhongMaterial,s=new e.Mesh(i,o);for(s.name="mesh";0!==a;){if(a===lu){var l=this.readWord(t);this.debugMessage("   Vertex: "+l);for(var u=[],c=0;c<l;c++)u.push(this.readFloat(t)),u.push(this.readFloat(t)),u.push(this.readFloat(t));i.setAttribute("position",new e.Float32BufferAttribute(u,3))}else if(a===uu)this.resetPosition(t),this.readFaceArray(t,s);else if(a===hu){var h=this.readWord(t);this.debugMessage("   UV: "+h);n=[];for(var d=0;d<h;d++)n.push(this.readFloat(t)),n.push(this.readFloat(t));i.setAttribute("uv",new e.Float32BufferAttribute(n,2))}else if(a===du){this.debugMessage("   Tranformation Matrix (TODO)");for(var f=[],p=0;p<12;p++)f[p]=this.readFloat(t);var m=new e.Matrix4;m.elements[0]=f[0],m.elements[1]=f[6],m.elements[2]=f[3],m.elements[3]=f[9],m.elements[4]=f[2],m.elements[5]=f[8],m.elements[6]=f[5],m.elements[7]=f[11],m.elements[8]=f[1],m.elements[9]=f[7],m.elements[10]=f[4],m.elements[11]=f[10],m.elements[12]=0,m.elements[13]=0,m.elements[14]=0,m.elements[15]=1,m.transpose();var v=new e.Matrix4;v.copy(m).invert(),i.applyMatrix4(v),m.decompose(s.position,s.quaternion,s.scale)}else this.debugMessage("   Unknown mesh chunk: "+a.toString(16));a=this.nextChunk(t,r)}return this.endChunk(r),i.computeVertexNormals(),s},readFaceArray:function(e,t){var r=this.readChunk(e),a=this.readWord(e);this.debugMessage("   Faces: "+a);for(var i=[],n=0;n<a;++n)i.push(this.readWord(e),this.readWord(e),this.readWord(e)),this.readWord(e);t.geometry.setIndex(i);for(var o=0,s=0;this.position<r.end;){var l=this.readChunk(e);if(l.id===cu){this.debugMessage("      Material Group"),this.resetPosition(e);var u=this.readMaterialGroup(e),c=3*u.index.length;t.geometry.addGroup(s,c,o),s+=c,o++;var h=this.materials[u.name];!1===Array.isArray(t.material)&&(t.material=[]),void 0!==h&&t.material.push(h)}else this.debugMessage("      Unknown face array chunk: "+l.toString(16));this.endChunk(l)}1===t.material.length&&(t.material=t.material[0]),this.endChunk(r)},readMap:function(t,r){var a=this.readChunk(t),i=this.nextChunk(t,a),n={},o=new e.TextureLoader(this.manager);for(o.setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin);0!==i;){if(i===tu){var s=this.readString(t,128);n=o.load(s),this.debugMessage("      File: "+r+s)}else i===iu?(n.offset.x=this.readFloat(t),this.debugMessage("      OffsetX: "+n.offset.x)):i===nu?(n.offset.y=this.readFloat(t),this.debugMessage("      OffsetY: "+n.offset.y)):i===ru?(n.repeat.x=this.readFloat(t),this.debugMessage("      RepeatX: "+n.repeat.x)):i===au?(n.repeat.y=this.readFloat(t),this.debugMessage("      RepeatY: "+n.repeat.y)):this.debugMessage("      Unknown map chunk: "+i.toString(16));i=this.nextChunk(t,a)}return this.endChunk(a),n},readMaterialGroup:function(e){this.readChunk(e);var t=this.readString(e,64),r=this.readWord(e);this.debugMessage("         Name: "+t),this.debugMessage("         Faces: "+r);for(var a=[],i=0;i<r;++i)a.push(this.readWord(e));return{name:t,index:a}},readColor:function(t){var r=this.readChunk(t),a=new e.Color;if(r.id===Pl||r.id===Dl){var i=this.readByte(t),n=this.readByte(t),o=this.readByte(t);a.setRGB(i/255,n/255,o/255),this.debugMessage("      Color: "+a.r+", "+a.g+", "+a.b)}else if(r.id===Ll||r.id===Nl){i=this.readFloat(t),n=this.readFloat(t),o=this.readFloat(t);a.setRGB(i,n,o),this.debugMessage("      Color: "+a.r+", "+a.g+", "+a.b)}else this.debugMessage("      Unknown color chunk: "+r.toString(16));return this.endChunk(r),a},readChunk:function(e){var t={};return t.cur=this.position,t.id=this.readWord(e),t.size=this.readDWord(e),t.end=t.cur+t.size,t.cur+=6,t},endChunk:function(e){this.position=e.end},nextChunk:function(e,t){if(t.cur>=t.end)return 0;this.position=t.cur;try{var r=this.readChunk(e);return t.cur+=r.size,r.id}catch(e){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var t=e.getUint8(this.position,!0);return this.position+=1,t},readFloat:function(e){try{var t=e.getFloat32(this.position,!0);return this.position+=4,t}catch(t){this.debugMessage(t+" "+this.position+" "+e.byteLength)}},readInt:function(e){var t=e.getInt32(this.position,!0);return this.position+=4,t},readShort:function(e){var t=e.getInt16(this.position,!0);return this.position+=2,t},readDWord:function(e){var t=e.getUint32(this.position,!0);return this.position+=4,t},readWord:function(e){var t=e.getUint16(this.position,!0);return this.position+=2,t},readString:function(e,t){for(var r="",a=0;a<t;a++){var i=this.readByte(e);if(!i)break;r+=String.fromCharCode(i)}return r},readPercentage:function(e){var t,r=this.readChunk(e);switch(r.id){case Rl:t=this.readShort(e)/100;break;case _l:t=this.readFloat(e);break;default:this.debugMessage("      Unknown percentage chunk: "+r.toString(16))}return this.endChunk(r),t},debugMessage:function(e){this.debug&&console.log(e)}});var Cl=19789,Fl=15786,El=49725,Bl=2,Ll=16,Pl=17,Dl=18,Nl=19,Rl=48,_l=49,Il=15677,Ol=15678,Ul=256,kl=45055,Vl=40960,Gl=40976,zl=40992,Hl=41008,Wl=41024,Xl=41040,Ql=41089,Yl=41091,Jl=41093,Kl=41095,ql=41472,Zl=41488,$l=41520,eu=41476,tu=41728,ru=41812,au=41814,iu=41816,nu=41818,ou=16384,su=16640,lu=16656,uu=16672,cu=16688,hu=16704,du=16736,fu=function(){var t=new e.Vector3,r=new e.Vector3;function a(e){return/primitive/i.test(e)||"Subpart"===e}function i(e,t){this.line=e,this.lineLength=e.length,this.currentCharIndex=0,this.currentChar=" ",this.lineNumber=t}function n(e,t){return e.colourCode===t.colourCode?0:e.colourCode<t.colourCode?-1:1}function o(t,r,a){t.sort(n);for(var i=[],o=[],s=[],l=new e.BufferGeometry,u=null,c=0,h=0,d=0,f=t.length;d<f;d++){var p=t[d],m=p.v0,v=p.v1;if(i.push(m.x,m.y,m.z,v.x,v.y,v.z),3===r){i.push(p.v2.x,p.v2.y,p.v2.z);var g=p.n0||p.faceNormal,y=p.n1||p.faceNormal,x=p.n2||p.faceNormal;o.push(g.x,g.y,g.z),o.push(y.x,y.y,y.z),o.push(x.x,x.y,x.z)}u!==p.material?(null!==u&&l.addGroup(c,h,s.length-1),s.push(p.material),u=p.material,c=d*r,h=r):h+=r}h>0&&l.addGroup(c,1/0,s.length-1),l.setAttribute("position",new e.Float32BufferAttribute(i,3)),3===r&&l.setAttribute("normal",new e.Float32BufferAttribute(o,3));var b=null;if(2===r?b=new e.LineSegments(l,s):3===r&&(b=new e.Mesh(l,s)),a){b.isConditionalLine=!0;for(var A=new Float32Array(3*t.length*2),w=new Float32Array(3*t.length*2),M=new Float32Array(3*t.length*2),S=0,T=t.length;S<T;S++){var C=t[S],F=C.c0,E=C.c1,B=(m=C.v0,v=C.v1,3*S*2);A[B+0]=F.x,A[B+1]=F.y,A[B+2]=F.z,A[B+3]=F.x,A[B+4]=F.y,A[B+5]=F.z,w[B+0]=E.x,w[B+1]=E.y,w[B+2]=E.z,w[B+3]=E.x,w[B+4]=E.y,w[B+5]=E.z,M[B+0]=v.x-m.x,M[B+1]=v.y-m.y,M[B+2]=v.z-m.z,M[B+3]=v.x-m.x,M[B+4]=v.y-m.y,M[B+5]=v.z-m.z}l.setAttribute("control0",new e.BufferAttribute(A,3,!1)),l.setAttribute("control1",new e.BufferAttribute(w,3,!1)),l.setAttribute("direction",new e.BufferAttribute(M,3,!1))}return b}function s(t){e.Loader.call(this,t),this.parseScopesStack=null,this.materials=[],this.subobjectCache={},this.fileMap=null,this.setMaterials([this.parseColourMetaDirective(new i("Main_Colour CODE 16 VALUE #FF8080 EDGE #333333")),this.parseColourMetaDirective(new i("Edge_Colour CODE 24 VALUE #A0A0A0 EDGE #333333"))]),this.separateObjects=!1,this.smoothNormals=!0}return i.prototype={constructor:i,seekNonSpace:function(){for(;this.currentCharIndex<this.lineLength;){if(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar)return;this.currentCharIndex++}},getToken:function(){for(var e=this.currentCharIndex++;this.currentCharIndex<this.lineLength&&(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar);)this.currentCharIndex++;var t=this.currentCharIndex;return this.seekNonSpace(),this.line.substring(e,t)},getRemainingString:function(){return this.line.substring(this.currentCharIndex,this.lineLength)},isAtTheEnd:function(){return this.currentCharIndex>=this.lineLength},setToEnd:function(){this.currentCharIndex=this.lineLength},getLineNumberString:function(){return this.lineNumber>=0?" at line "+this.lineNumber:""}},s.FINISH_TYPE_DEFAULT=0,s.FINISH_TYPE_CHROME=1,s.FINISH_TYPE_PEARLESCENT=2,s.FINISH_TYPE_RUBBER=3,s.FINISH_TYPE_MATTE_METALLIC=4,s.FINISH_TYPE_METAL=5,s.FILE_LOCATION_AS_IS=0,s.FILE_LOCATION_TRY_PARTS=1,s.FILE_LOCATION_TRY_P=2,s.FILE_LOCATION_TRY_MODELS=3,s.FILE_LOCATION_TRY_RELATIVE=4,s.FILE_LOCATION_TRY_ABSOLUTE=5,s.FILE_LOCATION_NOT_FOUND=6,s.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:s,load:function(t,r,a,i){this.fileMap||(this.fileMap={});var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){n.processObject(e,r,null,t)}),a,i)},parse:function(e,t,r){this.processObject(e,r,null,t)},setMaterials:function(e){return this.parseScopesStack=[],this.newParseScopeLevel(e),this.getCurrentParseScope().isFromParse=!1,this.materials=e,this},setFileMap:function(e){return this.fileMap=e,this},newParseScopeLevel:function(t){var r={};if(t)for(var a=0,i=t.length;a<i;a++){var n=t[a];r[n.userData.code]=n}var o=this.getCurrentParseScope(),s={lib:r,url:null,subobjects:null,numSubobjects:0,subobjectIndex:0,inverted:!1,category:null,keywords:null,currentFileName:null,mainColourCode:o?o.mainColourCode:"16",mainEdgeColourCode:o?o.mainEdgeColourCode:"24",currentMatrix:new e.Matrix4,matrix:new e.Matrix4,isFromParse:!0,triangles:null,lineSegments:null,conditionalSegments:null,startingConstructionStep:!1};return this.parseScopesStack.push(s),s},removeScopeLevel:function(){return this.parseScopesStack.pop(),this},addMaterial:function(e){var t=this.getCurrentParseScope().lib;return t[e.userData.code]||this.materials.push(e),t[e.userData.code]=e,this},getMaterial:function(e){if(e.startsWith("0x2")){var t=e.substring(3);return this.parseColourMetaDirective(new i("Direct_Color_"+t+" CODE -1 VALUE #"+t+" EDGE #"+t))}for(var r=this.parseScopesStack.length-1;r>=0;r--){var a=this.parseScopesStack[r].lib[e];if(a)return a}return null},getParentParseScope:function(){return this.parseScopesStack.length>1?this.parseScopesStack[this.parseScopesStack.length-2]:null},getCurrentParseScope:function(){return this.parseScopesStack.length>0?this.parseScopesStack[this.parseScopesStack.length-1]:null},parseColourMetaDirective:function(t){var r=null,a=16711935,n=16711935,o=1,l=!1,u=0,c=s.FINISH_TYPE_DEFAULT,h=!0,d=null,f=t.getToken();if(!f)throw'LDrawLoader: Material name was expected after "!COLOUR tag'+t.getLineNumberString()+".";for(var p=null;p=t.getToken();)switch(p.toUpperCase()){case"CODE":r=t.getToken();break;case"VALUE":if((a=t.getToken()).startsWith("0x"))a="#"+a.substring(2);else if(!a.startsWith("#"))throw"LDrawLoader: Invalid colour while parsing material"+t.getLineNumberString()+".";break;case"EDGE":if((n=t.getToken()).startsWith("0x"))n="#"+n.substring(2);else if(!n.startsWith("#")){if(!(d=this.getMaterial(n)))throw"LDrawLoader: Invalid edge colour while parsing material"+t.getLineNumberString()+".";d=d.userData.edgeMaterial}break;case"ALPHA":if(o=parseInt(t.getToken()),isNaN(o))throw"LDrawLoader: Invalid alpha value in material definition"+t.getLineNumberString()+".";(o=Math.max(0,Math.min(1,o/255)))<1&&(l=!0);break;case"LUMINANCE":if(u=parseInt(t.getToken()),isNaN(u))throw"LDrawLoader: Invalid luminance value in material definition"+i.getLineNumberString()+".";u=Math.max(0,Math.min(1,u/255));break;case"CHROME":c=s.FINISH_TYPE_CHROME;break;case"PEARLESCENT":c=s.FINISH_TYPE_PEARLESCENT;break;case"RUBBER":c=s.FINISH_TYPE_RUBBER;break;case"MATTE_METALLIC":c=s.FINISH_TYPE_MATTE_METALLIC;break;case"METAL":c=s.FINISH_TYPE_METAL;break;case"MATERIAL":t.setToEnd();break;default:throw'LDrawLoader: Unknown token "'+p+'" while parsing material'+t.getLineNumberString()+"."}var m=null;switch(c){case s.FINISH_TYPE_DEFAULT:m=new e.MeshStandardMaterial({color:a,roughness:.3,envMapIntensity:.3,metalness:0});break;case s.FINISH_TYPE_PEARLESCENT:var v=new e.Color(a),g=v.getHSL({h:0,s:0,l:0});g.h=(g.h+.5)%1,g.l=Math.min(1,g.l+.7*(1-g.l)),v.setHSL(g.h,g.s,g.l),m=new e.MeshPhongMaterial({color:a,specular:v,shininess:10,reflectivity:.3});break;case s.FINISH_TYPE_CHROME:m=new e.MeshStandardMaterial({color:a,roughness:0,metalness:1});break;case s.FINISH_TYPE_RUBBER:m=new e.MeshStandardMaterial({color:a,roughness:.9,metalness:0}),h=!1;break;case s.FINISH_TYPE_MATTE_METALLIC:m=new e.MeshStandardMaterial({color:a,roughness:.8,metalness:.4});break;case s.FINISH_TYPE_METAL:m=new e.MeshStandardMaterial({color:a,roughness:.2,metalness:.85})}return m.transparent=l,m.premultipliedAlpha=!0,m.opacity=o,m.depthWrite=!l,m.polygonOffset=!0,m.polygonOffsetFactor=1,m.userData.canHaveEnvMap=h,0!==u&&m.emissive.set(m.color).multiplyScalar(u),d||((d=new e.LineBasicMaterial({color:n,transparent:l,opacity:o,depthWrite:!l})).userData.code=r,d.name=f+" - Edge",d.userData.canHaveEnvMap=!1,d.userData.conditionalEdgeMaterial=new e.ShaderMaterial({vertexShader:"\n\tattribute vec3 control0;\n\tattribute vec3 control1;\n\tattribute vec3 direction;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_vertex>\n\t#include <fog_pars_vertex>\n\t#include <logdepthbuf_pars_vertex>\n\t#include <clipping_planes_pars_vertex>\n\tvoid main() {\n\t\t#include <color_vertex>\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t// Transform the line segment ends and control points into camera clip space\n\t\tvec4 c0 = projectionMatrix * modelViewMatrix * vec4( control0, 1.0 );\n\t\tvec4 c1 = projectionMatrix * modelViewMatrix * vec4( control1, 1.0 );\n\t\tvec4 p0 = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\tvec4 p1 = projectionMatrix * modelViewMatrix * vec4( position + direction, 1.0 );\n\n\t\tc0.xy /= c0.w;\n\t\tc1.xy /= c1.w;\n\t\tp0.xy /= p0.w;\n\t\tp1.xy /= p1.w;\n\n\t\t// Get the direction of the segment and an orthogonal vector\n\t\tvec2 dir = p1.xy - p0.xy;\n\t\tvec2 norm = vec2( -dir.y, dir.x );\n\n\t\t// Get control point directions from the line\n\t\tvec2 c0dir = c0.xy - p1.xy;\n\t\tvec2 c1dir = c1.xy - p1.xy;\n\n\t\t// If the vectors to the controls points are pointed in different directions away\n\t\t// from the line segment then the line should not be drawn.\n\t\tfloat d0 = dot( normalize( norm ), normalize( c0dir ) );\n\t\tfloat d1 = dot( normalize( norm ), normalize( c1dir ) );\n\t\tdiscardFlag = float( sign( d0 ) != sign( d1 ) );\n\n\t\t#include <logdepthbuf_vertex>\n\t\t#include <clipping_planes_vertex>\n\t\t#include <fog_vertex>\n\t}\n\t",fragmentShader:"\n\tuniform vec3 diffuse;\n\tuniform float opacity;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_fragment>\n\t#include <fog_pars_fragment>\n\t#include <logdepthbuf_pars_fragment>\n\t#include <clipping_planes_pars_fragment>\n\tvoid main() {\n\n\t\tif ( discardFlag > 0.5 ) discard;\n\n\t\t#include <clipping_planes_fragment>\n\t\tvec3 outgoingLight = vec3( 0.0 );\n\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\t#include <logdepthbuf_fragment>\n\t\t#include <color_fragment>\n\t\toutgoingLight = diffuseColor.rgb; // simple shader\n\t\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t\t#include <tonemapping_fragment>\n\t\t#include <encodings_fragment>\n\t\t#include <fog_fragment>\n\t\t#include <premultiplied_alpha_fragment>\n\t}\n\t",uniforms:e.UniformsUtils.merge([e.UniformsLib.fog,{diffuse:{value:new e.Color(n)},opacity:{value:o}}]),fog:!0,transparent:l,depthWrite:!l}),d.userData.conditionalEdgeMaterial.userData.canHaveEnvMap=!1),m.userData.code=r,m.name=f,m.userData.edgeMaterial=d,m},objectParse:function(n){var o,l,u,c=this.getParentParseScope(),h=c.mainColourCode,d=c.mainEdgeColourCode,f=this.getCurrentParseScope(),p=[],m=null,v=null;-1!==n.indexOf("\r\n")&&(n=n.replace(/\r\n/g,"\n"));var g=n.split("\n"),y=g.length,x=0,b=!1,A=null,w=null,M=!1,S=!0,T=!1,C=!0,F="",E=!1,B=this;function L(e,t){var r=e.getToken();t||"16"!==r||(r=h),t&&"24"===r&&(r=d);var a=B.getMaterial(r);if(!a)throw'LDrawLoader: Unknown colour code "'+r+'" is used'+e.getLineNumberString()+" but it was not defined previously.";return a}function P(t){var r=new e.Vector3(parseFloat(t.getToken()),parseFloat(t.getToken()),parseFloat(t.getToken()));return B.separateObjects||r.applyMatrix4(f.currentMatrix),r}for(x=0;x<y;x++){var D=g[x];if(0!==D.length)if(b)D.startsWith("0 FILE ")?(this.subobjectCache[A.toLowerCase()]=w,A=D.substring(7),w=""):w+=D+"\n";else{var N=new i(D,x+1);if(N.seekNonSpace(),!N.isAtTheEnd()){var R=N.getToken();switch(R){case"0":var _=N.getToken();if(_)switch(_){case"!LDRAW_ORG":F=N.getToken(),f.triangles=[],f.lineSegments=[],f.conditionalSegments=[],f.type=F,(!c.isFromParse||B.separateObjects&&!a(F))&&(f.groupObject=new e.Group,f.groupObject.userData.startingConstructionStep=f.startingConstructionStep),(q=f.matrix).determinant()<0&&(B.separateObjects&&a(F)||!B.separateObjects)&&(f.inverted=!f.inverted),o=f.triangles,l=f.lineSegments,u=f.conditionalSegments;break;case"!COLOUR":(U=this.parseColourMetaDirective(N))?this.addMaterial(U):console.warn("LDrawLoader: Error parsing material"+N.getLineNumberString());break;case"!CATEGORY":m=N.getToken();break;case"!KEYWORDS":var I=N.getRemainingString().split(",");I.length>0&&(v||(v=[]),I.forEach((function(e){v.push(e.trim())})));break;case"FILE":x>0&&(b=!0,A=N.getRemainingString(),w="",M=!1,S=!0);break;case"BFC":for(;!N.isAtTheEnd();){var O=N.getToken();switch(O){case"CERTIFY":case"NOCERTIFY":M="CERTIFY"===O,S=!0;break;case"CW":case"CCW":S="CCW"===O;break;case"INVERTNEXT":T=!0;break;case"CLIP":case"NOCLIP":C="CLIP"===O;break;default:console.warn('THREE.LDrawLoader: BFC directive "'+O+'" is unknown.')}}break;case"STEP":E=!0}break;case"1":var U=L(N),k=parseFloat(N.getToken()),V=parseFloat(N.getToken()),G=parseFloat(N.getToken()),j=parseFloat(N.getToken()),z=parseFloat(N.getToken()),H=parseFloat(N.getToken()),W=parseFloat(N.getToken()),X=parseFloat(N.getToken()),Q=parseFloat(N.getToken()),Y=parseFloat(N.getToken()),J=parseFloat(N.getToken()),K=parseFloat(N.getToken()),q=(new e.Matrix4).set(j,z,H,k,W,X,Q,V,Y,J,K,G,0,0,0,1),Z=N.getRemainingString().trim().replace(/\\/g,"/");B.fileMap[Z]?Z=B.fileMap[Z]:Z.startsWith("s/")?Z="parts/"+Z:Z.startsWith("48/")&&(Z="p/"+Z),p.push({material:U,matrix:q,fileName:Z,originalFileName:Z,locationState:s.FILE_LOCATION_AS_IS,url:null,triedLowerCase:!1,inverted:T!==f.inverted,startingConstructionStep:E}),T=!1;break;case"2":var $={material:(U=L(N,!0)).userData.edgeMaterial,colourCode:U.userData.code,v0:P(N),v1:P(N)};l.push($);break;case"5":$={material:(U=L(N,!0)).userData.edgeMaterial.userData.conditionalEdgeMaterial,colourCode:U.userData.code,v0:P(N),v1:P(N),c0:P(N),c1:P(N)};u.push($);break;case"3":U=L(N);var ee=!M||!C;!0===(S!==f.inverted)?(te=P(N),re=P(N),ae=P(N)):(ae=P(N),re=P(N),te=P(N)),t.subVectors(re,te),r.subVectors(ae,re),ne=(new e.Vector3).crossVectors(t,r).normalize(),o.push({material:U,colourCode:U.userData.code,v0:te,v1:re,v2:ae,faceNormal:ne,n0:null,n1:null,n2:null}),!0===ee&&o.push({material:U,colourCode:U.userData.code,v0:te,v1:ae,v2:re,faceNormal:ne,n0:null,n1:null,n2:null});break;case"4":var te,re,ae,ie,ne;U=L(N),ee=!M||!C;!0===(S!==f.inverted)?(te=P(N),re=P(N),ae=P(N),ie=P(N)):(ie=P(N),ae=P(N),re=P(N),te=P(N)),t.subVectors(re,te),r.subVectors(ae,re),ne=(new e.Vector3).crossVectors(t,r).normalize(),o.push({material:U,colourCode:U.userData.code,v0:te,v1:re,v2:ae,faceNormal:ne,n0:null,n1:null,n2:null}),o.push({material:U,colourCode:U.userData.code,v0:te,v1:ae,v2:ie,faceNormal:ne,n0:null,n1:null,n2:null}),!0===ee&&(o.push({material:U,colourCode:U.userData.code,v0:te,v1:ae,v2:re,faceNormal:ne,n0:null,n1:null,n2:null}),o.push({material:U,colourCode:U.userData.code,v0:te,v1:ie,v2:ae,faceNormal:ne,n0:null,n1:null,n2:null}));break;default:throw'LDrawLoader: Unknown line type "'+R+'"'+N.getLineNumberString()+"."}}}}b&&(this.subobjectCache[A.toLowerCase()]=w),f.category=m,f.keywords=v,f.subobjects=p,f.numSubobjects=p.length,f.subobjectIndex=0},computeConstructionSteps:function(e){var t=0;e.traverse((function(e){e.isGroup&&(e.userData.startingConstructionStep&&t++,e.userData.constructionStep=t)})),e.userData.numConstructionSteps=t+1},processObject:function(i,n,l,u){var c=this,h=c.newParseScopeLevel();h.url=u;var d=c.getParentParseScope();l&&(h.currentMatrix.multiplyMatrices(d.currentMatrix,l.matrix),h.matrix.copy(l.matrix),h.inverted=l.inverted,h.startingConstructionStep=l.startingConstructionStep);var f=d.currentFileName;null!==f&&(f=d.currentFileName.toLowerCase()),void 0===c.subobjectCache[f]&&(c.subobjectCache[f]=i),c.objectParse(i);var p=0;function m(){if(++p===h.subobjects.length+1)!function(){c.smoothNormals&&"Part"===h.type&&function(e,t){function r(e){return~~(100*e.x)+","+~~(100*e.y)+","+~~(100*e.z)}function a(e,t){return r(e)+"_"+r(t)}for(var i=new Set,n={},o={},s=[],l=0,u=t.length;l<u;l++){var c=t[l],h=c.v0,d=c.v1;i.add(a(h,d)),i.add(a(d,h))}for(var f=0,p=e.length;f<p;f++)for(var m=e[f],v=0;v<3;v++){var g=(v+1)%3,y=a(h=m["v"+(S=v)],d=m["v"+g]);i.has(y)||(n[y]=m,o[y]=m)}for(;;){var x=Object.keys(n);if(0===x.length)break;for(var b=0,A=[o[x[0]]];b<A.length;){m=A[b],b++;var w=m.faceNormal;null===m.n0&&(m.n0=w.clone(),s.push(m.n0)),null===m.n1&&(m.n1=w.clone(),s.push(m.n1)),null===m.n2&&(m.n2=w.clone(),s.push(m.n2));for(var M=0;M<3;M++){var S;g=(M+1)%3,delete n[y=a(h=m["v"+(S=M)],d=m["v"+g])];var T=a(d,h),C=o[T];if(C){if(Math.abs(C.faceNormal.dot(m.faceNormal))<.25)continue;T in n&&(A.push(C),delete n[T]);for(var F=0;F<3;F++){var E=F,B=(F+1)%3;if(a(C["v"+E],C["v"+B])===T){if(null===C["n"+E]){var L=m["n"+g];C["n"+E]=L,L.add(C.faceNormal)}null===C["n"+B]&&(L=m["n"+S],C["n"+B]=L,L.add(C.faceNormal));break}}}}}}for(var P=0,D=s.length;P<D;P++)s[P].normalize()}(h.triangles,h.lineSegments);var e=!d.isFromParse;if(c.separateObjects&&!a(h.type)||e){var i=h.groupObject;h.triangles.length>0&&i.add(o(h.triangles,3)),h.lineSegments.length>0&&i.add(o(h.lineSegments,2)),h.conditionalSegments.length>0&&i.add(o(h.conditionalSegments,2,!0)),d.groupObject&&(i.name=h.fileName,i.userData.category=h.category,i.userData.keywords=h.keywords,h.matrix.decompose(i.position,i.quaternion,i.scale),d.groupObject.add(i))}else{for(var s=c.separateObjects,l=d.lineSegments,u=d.conditionalSegments,f=d.triangles,p=h.lineSegments,m=h.conditionalSegments,v=h.triangles,g=0,y=p.length;g<y;g++){var x=p[g];s&&(x.v0.applyMatrix4(h.matrix),x.v1.applyMatrix4(h.matrix)),l.push(x)}for(var b=0,A=m.length;b<A;b++){var w=m[b];s&&(w.v0.applyMatrix4(h.matrix),w.v1.applyMatrix4(h.matrix),w.c0.applyMatrix4(h.matrix),w.c1.applyMatrix4(h.matrix)),u.push(w)}for(var M=0,S=v.length;M<S;M++){var T=v[M];s&&(T.v0=T.v0.clone().applyMatrix4(h.matrix),T.v1=T.v1.clone().applyMatrix4(h.matrix),T.v2=T.v2.clone().applyMatrix4(h.matrix),t.subVectors(T.v1,T.v0),r.subVectors(T.v2,T.v1),T.faceNormal.crossVectors(t,r).normalize()),f.push(T)}}c.removeScopeLevel(),d.isFromParse||c.computeConstructionSteps(h.groupObject);n&&n(h.groupObject)}();else{var e=h.subobjects[h.subobjectIndex];Promise.resolve().then((function(){v(e)})),h.subobjectIndex++}}function v(t){h.mainColourCode=t.material.userData.code,h.mainEdgeColourCode=t.material.userData.edgeMaterial.userData.code,h.currentFileName=t.originalFileName;var r=c.subobjectCache[t.originalFileName.toLowerCase()];if(r)c.processObject(r,(function(e){g(e,t),m()}),t,u);else{var a=t.fileName,i=s.FILE_LOCATION_NOT_FOUND;switch(t.locationState){case s.FILE_LOCATION_AS_IS:i=t.locationState+1;break;case s.FILE_LOCATION_TRY_PARTS:a="parts/"+a,i=t.locationState+1;break;case s.FILE_LOCATION_TRY_P:a="p/"+a,i=t.locationState+1;break;case s.FILE_LOCATION_TRY_MODELS:a="models/"+a,i=t.locationState+1;break;case s.FILE_LOCATION_TRY_RELATIVE:a=u.substring(0,u.lastIndexOf("/")+1)+a,i=t.locationState+1;break;case s.FILE_LOCATION_TRY_ABSOLUTE:t.triedLowerCase?i=s.FILE_LOCATION_NOT_FOUND:(t.fileName=t.fileName.toLowerCase(),a=t.fileName,t.triedLowerCase=!0,i=s.FILE_LOCATION_AS_IS);break;case s.FILE_LOCATION_NOT_FOUND:return void console.warn('LDrawLoader: Subobject "'+t.originalFileName+'" could not be found.')}t.locationState=i,t.url=a;var n=new e.FileLoader(c.manager);n.setPath(c.path),n.setRequestHeader(c.requestHeader),n.setWithCredentials(c.withCredentials),n.load(a,(function(e){c.processObject(e,(function(e){g(e,t),m()}),t,u)}),void 0,(function(e){!function(e,t){v(t)}(0,t)}),t)}}function g(e,t){null!==e?c.fileMap[t.originalFileName]=t.url:v(t)}m()}}),s}();function pu(e){this.IFF=e}function mu(e){this.IFF=e}function vu(){this.debugger=new yu}function gu(e){this.dv=new DataView(e),this.offset=0}function yu(){this.active=!1,this.depth=0,this.formList=[]}function xu(e){return e%2}function bu(e){return e.length+1+(xu(e.length+1)?1:0)}pu.prototype={constructor:pu,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"STCK":case"VALU":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NCRD":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"VERS":case"ENUM":case"TAG ":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"GLOW":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var a=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(a<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.currentSurface.attributes.imageMapIndex=this.IFF.reader.getUint32();break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},mu.prototype={constructor:mu,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(t>this.IFF.reader.dv.byteLength-this.IFF.reader.offset&&(this.IFF.reader.offset-=4,t=this.IFF.reader.getUint16()),this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"AUVO":case"STCK":case"PROC":case"VALU":case"FUNC":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NVSK":case"NCRD":case"WRPW":case"WRPH":case"NMOD":case"NPRW":case"NPLA":case"NODS":case"VERS":case"ENUM":case"TAG ":case"OPAC":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"GLOW":case"GVAL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"SURF":this.IFF.parseSurfaceLwo2(t);break;case"CLIP":this.IFF.parseClipLwo2(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"AUVU":case"AUVN":this.IFF.reader.skip(t-1),this.IFF.reader.getVariableLengthIndex();break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var a=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(a<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.reader.skip(2);break;case"TMAP":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;case"BLOK":break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},vu.prototype={constructor:vu,parse:function(e){if(this.reader=new gu(e),this.tree={materials:{},layers:[],tags:[],textures:[]},this.currentLayer=this.tree,this.currentForm=this.tree,this.parseTopForm(),void 0!==this.tree.format){if("LWO2"===this.tree.format)for(this.parser=new mu(this);!this.reader.endOfFile();)this.parser.parseBlock();else if("LWO3"===this.tree.format)for(this.parser=new pu(this);!this.reader.endOfFile();)this.parser.parseBlock();return this.debugger.offset=this.reader.offset,this.debugger.closeForms(),this.tree}},parseTopForm:function(){if(this.debugger.offset=this.reader.offset,"FORM"===this.reader.getIDTag()){var e=this.reader.getUint32();this.debugger.dataOffset=this.reader.offset,this.debugger.length=e;var t=this.reader.getIDTag();("LWO2"===t||"LWO3"===t)&&(this.tree.format=t),this.debugger.node=0,this.debugger.nodeID=t,this.debugger.log()}else console.warn("LWOLoader: Top-level FORM missing.")},parseForm:function(e){var t=this.reader.getIDTag();switch(t){case"ISEQ":case"ANIM":case"STCC":case"VPVL":case"VPRM":case"NROT":case"WRPW":case"WRPH":case"FUNC":case"FALL":case"OPAC":case"GRAD":case"ENVS":case"VMOP":case"VMBG":case"OMAX":case"STEX":case"CKBG":case"CKEY":case"VMLA":case"VMLB":this.debugger.skipped=!0,this.skipForm(e);break;case"META":case"NNDS":case"NODS":case"NDTA":case"ADAT":case"AOVS":case"BLOK":case"IBGC":case"IOPC":case"IIMG":case"TXTR":this.debugger.length=4,this.debugger.skipped=!0;break;case"IFAL":case"ISCL":case"IPOS":case"IROT":case"IBMP":case"IUTD":case"IVTD":this.parseTextureNodeAttribute(t);break;case"ENVL":this.parseEnvelope(e);break;case"CLIP":"LWO2"===this.tree.format?this.parseForm(e):this.parseClip(e);break;case"STIL":this.parseImage();break;case"XREF":this.reader.skip(8),this.currentForm.referenceTexture={index:this.reader.getUint32(),refName:this.reader.getString()};break;case"IMST":this.parseImageStateForm(e);break;case"SURF":this.parseSurfaceForm(e);break;case"VALU":this.parseValueForm(e);break;case"NTAG":this.parseSubNode(e);break;case"ATTR":case"SATR":this.setupForm("attributes",e);break;case"NCON":this.parseConnections(e);break;case"SSHA":this.parentForm=this.currentForm,this.currentForm=this.currentSurface,this.setupForm("surfaceShader",e);break;case"SSHD":this.setupForm("surfaceShaderData",e);break;case"ENTR":this.parseEntryForm(e);break;case"IMAP":this.parseImageMap(e);break;case"TAMP":this.parseXVAL("amplitude",e);break;case"TMAP":this.setupForm("textureMap",e);break;case"CNTR":this.parseXVAL3("center",e);break;case"SIZE":this.parseXVAL3("scale",e);break;case"ROTA":this.parseXVAL3("rotation",e);break;default:this.parseUnknownForm(t,e)}this.debugger.node=0,this.debugger.nodeID=t,this.debugger.log()},setupForm:function(e,t){this.currentForm||(this.currentForm=this.currentNode),this.currentFormEnd=this.reader.offset+t,this.parentForm=this.currentForm,this.currentForm[e]?(console.warn("LWOLoader: form already exists on parent: ",e,this.currentForm),this.currentForm=this.currentForm[e]):(this.currentForm[e]={},this.currentForm=this.currentForm[e])},skipForm:function(e){this.reader.skip(e-4)},parseUnknownForm:function(t,r){var a,i,n;console.warn("LWOLoader: unknown FORM encountered: "+t,r),a=this.reader.dv.buffer,i=this.reader.offset,n=r-4,console.log(e.LoaderUtils.decodeText(new Uint8Array(a,i,n))),this.reader.skip(r-4)},parseSurfaceForm:function(e){this.reader.skip(8);var t=this.reader.getString(),r={attributes:{},connections:{},name:t,inputName:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSurfaceLwo2:function(e){var t=this.reader.getString(),r={attributes:{},connections:{},name:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSubNode:function(e){this.reader.skip(8);var t={name:this.reader.getString()};this.currentForm=t,this.currentNode=t,this.currentFormEnd=this.reader.offset+e},parseConnections:function(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm=this.currentSurface.connections},parseEntryForm:function(e){this.reader.skip(8);var t=this.reader.getString();this.currentForm=this.currentNode.attributes,this.setupForm(t,e)},parseValueForm:function(){this.reader.skip(8);var e=this.reader.getString();"double"===e?this.currentForm.value=this.reader.getUint64():"int"===e?this.currentForm.value=this.reader.getUint32():"vparam"===e?(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64()):"vparam3"===e&&(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64Array(3))},parseImageStateForm:function(){this.reader.skip(8),this.currentForm.mipMapLevel=this.reader.getFloat32()},parseImageMap:function(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm.maps||(this.currentForm.maps=[]);var t={};this.currentForm.maps.push(t),this.currentForm=t,this.reader.skip(10)},parseTextureNodeAttribute:function(e){switch(this.reader.skip(28),this.reader.skip(20),e){case"ISCL":this.currentNode.scale=this.reader.getFloat32Array(3);break;case"IPOS":this.currentNode.position=this.reader.getFloat32Array(3);break;case"IROT":this.currentNode.rotation=this.reader.getFloat32Array(3);break;case"IFAL":this.currentNode.falloff=this.reader.getFloat32Array(3);break;case"IBMP":this.currentNode.amplitude=this.reader.getFloat32();break;case"IUTD":this.currentNode.uTiles=this.reader.getFloat32();break;case"IVTD":this.currentNode.vTiles=this.reader.getFloat32()}this.reader.skip(2)},parseEnvelope:function(e){this.reader.skip(e-4)},parseClip:function(e){if("FORM"===this.reader.getIDTag())return this.reader.skip(16),void(this.currentNode.fileName=this.reader.getString());this.reader.setOffset(this.reader.offset-4),this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.reader.skip(8);var t={index:this.reader.getUint32()};this.tree.textures.push(t),this.currentForm=t},parseClipLwo2:function(e){for(var t={index:this.reader.getUint32(),fileName:""};;){var r=this.reader.getIDTag(),a=this.reader.getUint16();if("STIL"===r){t.fileName=this.reader.getString();break}if(a>=e)break}this.tree.textures.push(t),this.currentForm=t},parseImage:function(){this.reader.skip(8),this.currentForm.fileName=this.reader.getString()},parseXVAL:function(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]=this.reader.getFloat32(),this.reader.setOffset(r)},parseXVAL3:function(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]={x:this.reader.getFloat32(),y:this.reader.getFloat32(),z:this.reader.getFloat32()},this.reader.setOffset(r)},parseObjectTag:function(){this.tree.objectTags||(this.tree.objectTags={}),this.tree.objectTags[this.reader.getIDTag()]={tagString:this.reader.getString()}},parseLayer:function(e){var t={number:this.reader.getUint16(),flags:this.reader.getUint16(),pivot:this.reader.getFloat32Array(3),name:this.reader.getString()};this.tree.layers.push(t),this.currentLayer=t;var r=16+bu(this.currentLayer.name);this.currentLayer.parent=r<e?this.reader.getUint16():-1},parsePoints:function(e){this.currentPoints=[];for(var t=0;t<e/4;t+=3)this.currentPoints.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32())},parseVertexMapping:function(e,t){var r=this.reader.offset+e,a=this.reader.getString();if(this.reader.offset!==r){this.reader.setOffset(this.reader.offset-bu(a));var i=this.reader.getIDTag();this.reader.getUint16();var n=this.reader.getString(),o=e-6-bu(n);switch(i){case"TXUV":this.parseUVMapping(n,r,t);break;case"MORF":case"SPOT":this.parseMorphTargets(n,r,i);break;case"APSL":case"NORM":case"WGHT":case"MNVW":case"PICK":case"RGB ":case"RGBA":this.reader.skip(o);break;default:console.warn("LWOLoader: unknown vertex map type: "+i),this.reader.skip(o)}}else this.currentForm.UVChannel=a},parseUVMapping:function(e,t,r){for(var a=[],i=[],n=[];this.reader.offset<t;)a.push(this.reader.getVariableLengthIndex()),r&&i.push(this.reader.getVariableLengthIndex()),n.push(this.reader.getFloat32(),this.reader.getFloat32());r?(this.currentLayer.discontinuousUVs||(this.currentLayer.discontinuousUVs={}),this.currentLayer.discontinuousUVs[e]={uvIndices:a,polyIndices:i,uvs:n}):(this.currentLayer.uvs||(this.currentLayer.uvs={}),this.currentLayer.uvs[e]={uvIndices:a,uvs:n})},parseMorphTargets:function(e,t,r){var a=[],i=[];for(r="MORF"===r?"relative":"absolute";this.reader.offset<t;)a.push(this.reader.getVariableLengthIndex()),i.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32());this.currentLayer.morphTargets||(this.currentLayer.morphTargets={}),this.currentLayer.morphTargets[e]={indices:a,points:i,type:r}},parsePolygonList:function(e){for(var t=this.reader.offset+e,r=this.reader.getIDTag(),a=[],i=[];this.reader.offset<t;){var n=this.reader.getUint16();n&=1023,i.push(n);for(var o=0;o<n;o++)a.push(this.reader.getVariableLengthIndex())}var s={type:r,vertexIndices:a,polygonDimensions:i,points:this.currentPoints};1===i[0]?s.type="points":2===i[0]&&(s.type="lines"),this.currentLayer.geometry=s},parseTagStrings:function(e){this.tree.tags=this.reader.getStringArray(e)},parsePolygonTagMapping:function(e){var t=this.reader.offset+e;"SURF"===this.reader.getIDTag()?this.parseMaterialIndices(t):this.reader.skip(e-4)},parseMaterialIndices:function(e){for(this.currentLayer.geometry.materialIndices=[];this.reader.offset<e;){var t=this.reader.getVariableLengthIndex(),r=this.reader.getUint16();this.currentLayer.geometry.materialIndices.push(t,r)}},parseUnknownCHUNK:function(e,t){console.warn("LWOLoader: unknown chunk type: "+e+" length: "+t);var r=this.reader.getString(t);this.currentForm[e]=r}},gu.prototype={constructor:gu,size:function(){return this.dv.buffer.byteLength},setOffset:function(e){e>0&&e<this.dv.buffer.byteLength?this.offset=e:console.error("LWOLoader: invalid buffer offset")},endOfFile:function(){return this.offset>=this.size()},skip:function(e){this.offset+=e},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint16:function(){var e=this.dv.getUint16(this.offset);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,!1);return this.offset+=4,e},getUint32:function(){var e=this.dv.getUint32(this.offset,!1);return this.offset+=4,e},getUint64:function(){return 4294967296*this.getUint32()+this.getUint32()},getFloat32:function(){var e=this.dv.getFloat32(this.offset,!1);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getVariableLengthIndex:function(){var e=this.getUint8();return 255===e?65536*this.getUint8()+256*this.getUint8()+this.getUint8():256*e+this.getUint8()},getIDTag:function(){return this.getString(4)},getString:function(t){if(0!==t){var r=[];if(t)for(var a=0;a<t;a++)r[a]=this.getUint8();else{for(var i,n=0;0!==i;)0!==(i=this.getUint8())&&r.push(i),n++;xu(n+1)||this.getUint8()}return e.LoaderUtils.decodeText(new Uint8Array(r))}},getStringArray:function(e){var t=this.getString(e);return(t=t.split("\0")).filter(Boolean)}},yu.prototype={constructor:yu,enable:function(){this.active=!0},log:function(){if(this.active){var e;switch(this.node){case 0:e="FORM";break;case 1:e="CHK";break;case 2:e="S-CHK"}console.log("| ".repeat(this.depth)+e,this.nodeID,"( "+this.offset+" ) -> ( "+(this.dataOffset+this.length)+" )",0==this.node?" {":"",this.skipped?"SKIPPED":"",0==this.node&&this.skipped?"}":""),0!=this.node||this.skipped||(this.depth+=1,this.formList.push(this.dataOffset+this.length)),this.skipped=!1}},closeForms:function(){if(this.active)for(var e=this.formList.length-1;e>=0;e--)this.offset>=this.formList[e]&&(this.depth-=1,console.log("| ".repeat(this.depth)+"}"),this.formList.splice(-1,1))}};var Au,wu,Mu,Su,Tu,Cu,Fu,Eu,Bu,Lu,Pu,Du,Nu,Ru,_u,Iu,Ou,Uu=function(t){e.Loader.call(this,t),this.defaultDPI=90,this.defaultUnit="px"};Uu.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Uu,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){var r=this;function a(e,t,r,a,n,o,s,l){if(0!=t&&0!=r){a=a*Math.PI/180,t=Math.abs(t),r=Math.abs(r);var u=(s.x-l.x)/2,c=(s.y-l.y)/2,h=Math.cos(a)*u+Math.sin(a)*c,d=-Math.sin(a)*u+Math.cos(a)*c,f=t*t,p=r*r,m=h*h,v=d*d,g=m/f+v/p;if(g>1){var y=Math.sqrt(g);f=(t*=y)*t,p=(r*=y)*r}var x=f*v+p*m,b=(f*p-x)/x,A=Math.sqrt(Math.max(0,b));n===o&&(A=-A);var w=A*t*d/r,M=-A*r*h/t,S=Math.cos(a)*w-Math.sin(a)*M+(s.x+l.x)/2,T=Math.sin(a)*w+Math.cos(a)*M+(s.y+l.y)/2,C=i(1,0,(h-w)/t,(d-M)/r),F=i((h-w)/t,(d-M)/r,(-h-w)/t,(-d-M)/r)%(2*Math.PI);e.currentPath.absellipse(S,T,t,r,C,C+F,0===o,a)}else e.lineTo(l.x,l.y)}function i(e,t,r,a){var i=e*r+t*a,n=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+a*a),o=Math.acos(Math.max(-1,Math.min(1,i/n)));return e*a-t*r<0&&(o=-o),o}function n(e,t){t=Object.assign({},t);var r={};if(e.hasAttribute("class"))for(var a=e.getAttribute("class").split(/\s/).filter(Boolean).map((function(e){return e.trim()})),i=0;i<a.length;i++)r=Object.assign(r,p["."+a[i]]);function n(a,i,n){void 0===n&&(n=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(a)&&(t[i]=n(e.getAttribute(a))),r[a]&&(t[i]=n(r[a])),e.style&&""!==e.style[a]&&(t[i]=n(e.style[a]))}function o(e){return Math.max(0,Math.min(1,c(e)))}function s(e){return Math.max(0,c(e))}return e.hasAttribute("id")&&(r=Object.assign(r,p["#"+e.getAttribute("id")])),n("fill","fill"),n("fill-opacity","fillOpacity",o),n("opacity","opacity",o),n("stroke","stroke"),n("stroke-opacity","strokeOpacity",o),n("stroke-width","strokeWidth",s),n("stroke-linejoin","strokeLineJoin"),n("stroke-linecap","strokeLineCap"),n("stroke-miterlimit","strokeMiterLimit",s),n("visibility","visibility"),t}function o(e,t){return e-(t-e)}function s(e){if("string"!=typeof e)throw new TypeError("Invalid input: "+typeof e);var t={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i},r=0,a=!0,i=[],n="",o="";function s(e,t,r){var a=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw a.partial=r,a}function l(){""!==n&&(""===o?i.push(Number(n)):i.push(Number(n)*Math.pow(10,Number(o)))),n="",o=""}var u,c=0,h=e.length;for(c=0;c<h;c++){if(u=e[c],0===r){if(t.WHITESPACE.test(u))continue;if(t.DIGIT.test(u)||t.SIGN.test(u)){r=1,n=u;continue}if(t.POINT.test(u)){r=2,n=u;continue}t.COMMA.test(u)&&(a&&s(u,c,i),a=!0)}if(1===r){if(t.DIGIT.test(u)){n+=u;continue}if(t.POINT.test(u)){n+=u,r=2;continue}if(t.EXP.test(u)){r=3;continue}t.SIGN.test(u)&&1===n.length&&t.SIGN.test(n[0])&&s(u,c,i)}if(2===r){if(t.DIGIT.test(u)){n+=u;continue}if(t.EXP.test(u)){r=3;continue}t.POINT.test(u)&&"."===n[n.length-1]&&s(u,c,i)}if(3==r){if(t.DIGIT.test(u)){o+=u;continue}if(t.SIGN.test(u)){if(""===o){o+=u;continue}1===o.length&&t.SIGN.test(o)&&s(u,c,i)}}t.WHITESPACE.test(u)?(l(),r=0,a=!1):t.COMMA.test(u)?(l(),r=0,a=!0):t.SIGN.test(u)?(l(),r=1,n=u):t.POINT.test(u)?(l(),r=2,n=u):s(u,c,i)}return l(),i}var l=["mm","cm","in","pt","pc","px"],u={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(e){var t="px";if("string"==typeof e||e instanceof String)for(var a=0,i=l.length;a<i;a++){var n=l[a];if(e.endsWith(n)){t=n,e=e.substring(0,e.length-n.length);break}}var o=void 0;return"px"===t&&"px"!==r.defaultUnit?o=u.in[r.defaultUnit]/r.defaultDPI:(o=u[t][r.defaultUnit])<0&&(o=u[t].in*r.defaultDPI),o*parseFloat(e)}function h(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function d(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}var f=[],p={},m=[],v=new e.Matrix3,g=new e.Matrix3,y=new e.Matrix3,x=new e.Matrix3,b=new e.Vector2,A=new e.Vector3,w=new e.Matrix3,M=(new DOMParser).parseFromString(t,"image/svg+xml");return function t(r,i){if(1===r.nodeType){var l=function(t){if(!(t.hasAttribute("transform")||"use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))))return null;var r=function(t){var r=new e.Matrix3,a=v;if("use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))){var i=c(t.getAttribute("x")),n=c(t.getAttribute("y"));r.translate(i,n)}if(t.hasAttribute("transform"))for(var o=t.getAttribute("transform").split(")"),l=o.length-1;l>=0;l--){var u=o[l].trim();if(""!==u){var h=u.indexOf("("),d=u.length;if(h>0&&h<d){var f=u.substr(0,h),p=s(u.substr(h+1,d-h-1));switch(a.identity(),f){case"translate":if(p.length>=1){n=i=p[0];p.length>=2&&(n=p[1]),a.translate(i,n)}break;case"rotate":if(p.length>=1){var m=0,b=0,A=0;m=-p[0]*Math.PI/180,p.length>=3&&(b=p[1],A=p[2]),g.identity().translate(-b,-A),y.identity().rotate(m),x.multiplyMatrices(y,g),g.identity().translate(b,A),a.multiplyMatrices(g,x)}break;case"scale":if(p.length>=1){var w=p[0],M=w;p.length>=2&&(M=p[1]),a.scale(w,M)}break;case"skewX":1===p.length&&a.set(1,Math.tan(p[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===p.length&&a.set(1,0,0,Math.tan(p[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===p.length&&a.set(p[0],p[2],p[4],p[1],p[3],p[5],0,0,1)}}r.premultiply(a)}}return r}(t);m.length>0&&r.premultiply(m[m.length-1]);return w.copy(r),m.push(r),r}(r),u=!0,M=null;switch(r.nodeName){case"svg":break;case"style":!function(e){if(!e.sheet||!e.sheet.cssRules||!e.sheet.cssRules.length)return;for(var t=0;t<e.sheet.cssRules.length;t++){var r=e.sheet.cssRules[t];if(1===r.type)for(var a=r.selectorText.split(/,/gm).filter(Boolean).map((function(e){return e.trim()})),i=0;i<a.length;i++)p[a[i]]=Object.assign(p[a[i]]||{},r.style)}}(r);break;case"g":i=n(r,i);break;case"path":i=n(r,i),r.hasAttribute("d")&&(M=function(t){for(var r=new e.ShapePath,i=new e.Vector2,n=new e.Vector2,l=new e.Vector2,u=!0,c=!1,h=t.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),d=0,f=h.length;d<f;d++){var p=h[d],m=p.charAt(0),v=p.substr(1).trim();switch(!0===u&&(c=!0,u=!1),m){case"M":for(var g=0,y=(ee=s(v)).length;g<y;g+=2)i.x=ee[g+0],i.y=ee[g+1],n.x=i.x,n.y=i.y,0===g?r.moveTo(i.x,i.y):r.lineTo(i.x,i.y),0===g&&!0===c&&l.copy(i);break;case"H":for(var x=0,b=(ee=s(v)).length;x<b;x++)i.x=ee[x],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===x&&!0===c&&l.copy(i);break;case"V":for(var A=0,w=(ee=s(v)).length;A<w;A++)i.y=ee[A],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===A&&!0===c&&l.copy(i);break;case"L":for(var M=0,S=(ee=s(v)).length;M<S;M+=2)i.x=ee[M+0],i.y=ee[M+1],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===M&&!0===c&&l.copy(i);break;case"C":for(var T=0,C=(ee=s(v)).length;T<C;T+=6)r.bezierCurveTo(ee[T+0],ee[T+1],ee[T+2],ee[T+3],ee[T+4],ee[T+5]),n.x=ee[T+2],n.y=ee[T+3],i.x=ee[T+4],i.y=ee[T+5],0===T&&!0===c&&l.copy(i);break;case"S":for(var F=0,E=(ee=s(v)).length;F<E;F+=4)r.bezierCurveTo(o(i.x,n.x),o(i.y,n.y),ee[F+0],ee[F+1],ee[F+2],ee[F+3]),n.x=ee[F+0],n.y=ee[F+1],i.x=ee[F+2],i.y=ee[F+3],0===F&&!0===c&&l.copy(i);break;case"Q":for(var B=0,L=(ee=s(v)).length;B<L;B+=4)r.quadraticCurveTo(ee[B+0],ee[B+1],ee[B+2],ee[B+3]),n.x=ee[B+0],n.y=ee[B+1],i.x=ee[B+2],i.y=ee[B+3],0===B&&!0===c&&l.copy(i);break;case"T":for(var P=0,D=(ee=s(v)).length;P<D;P+=2){var N=o(i.x,n.x),R=o(i.y,n.y);r.quadraticCurveTo(N,R,ee[P+0],ee[P+1]),n.x=N,n.y=R,i.x=ee[P+0],i.y=ee[P+1],0===P&&!0===c&&l.copy(i)}break;case"A":for(var _=0,I=(ee=s(v)).length;_<I;_+=7)if(ee[_+5]!=i.x||ee[_+6]!=i.y){var O=i.clone();i.x=ee[_+5],i.y=ee[_+6],n.x=i.x,n.y=i.y,a(r,ee[_],ee[_+1],ee[_+2],ee[_+3],ee[_+4],O,i),0===_&&!0===c&&l.copy(i)}break;case"m":for(var U=0,k=(ee=s(v)).length;U<k;U+=2)i.x+=ee[U+0],i.y+=ee[U+1],n.x=i.x,n.y=i.y,0===U?r.moveTo(i.x,i.y):r.lineTo(i.x,i.y),0===U&&!0===c&&l.copy(i);break;case"h":for(var V=0,G=(ee=s(v)).length;V<G;V++)i.x+=ee[V],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===V&&!0===c&&l.copy(i);break;case"v":for(var j=0,z=(ee=s(v)).length;j<z;j++)i.y+=ee[j],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===j&&!0===c&&l.copy(i);break;case"l":for(var H=0,W=(ee=s(v)).length;H<W;H+=2)i.x+=ee[H+0],i.y+=ee[H+1],n.x=i.x,n.y=i.y,r.lineTo(i.x,i.y),0===H&&!0===c&&l.copy(i);break;case"c":for(var X=0,Q=(ee=s(v)).length;X<Q;X+=6)r.bezierCurveTo(i.x+ee[X+0],i.y+ee[X+1],i.x+ee[X+2],i.y+ee[X+3],i.x+ee[X+4],i.y+ee[X+5]),n.x=i.x+ee[X+2],n.y=i.y+ee[X+3],i.x+=ee[X+4],i.y+=ee[X+5],0===X&&!0===c&&l.copy(i);break;case"s":for(var Y=0,J=(ee=s(v)).length;Y<J;Y+=4)r.bezierCurveTo(o(i.x,n.x),o(i.y,n.y),i.x+ee[Y+0],i.y+ee[Y+1],i.x+ee[Y+2],i.y+ee[Y+3]),n.x=i.x+ee[Y+0],n.y=i.y+ee[Y+1],i.x+=ee[Y+2],i.y+=ee[Y+3],0===Y&&!0===c&&l.copy(i);break;case"q":for(var K=0,q=(ee=s(v)).length;K<q;K+=4)r.quadraticCurveTo(i.x+ee[K+0],i.y+ee[K+1],i.x+ee[K+2],i.y+ee[K+3]),n.x=i.x+ee[K+0],n.y=i.y+ee[K+1],i.x+=ee[K+2],i.y+=ee[K+3],0===K&&!0===c&&l.copy(i);break;case"t":for(var Z=0,$=(ee=s(v)).length;Z<$;Z+=2){N=o(i.x,n.x),R=o(i.y,n.y);r.quadraticCurveTo(N,R,i.x+ee[Z+0],i.y+ee[Z+1]),n.x=N,n.y=R,i.x=i.x+ee[Z+0],i.y=i.y+ee[Z+1],0===Z&&!0===c&&l.copy(i)}break;case"a":for(var ee,te=0,re=(ee=s(v)).length;te<re;te+=7)if(0!=ee[te+5]||0!=ee[te+6]){O=i.clone();i.x+=ee[te+5],i.y+=ee[te+6],n.x=i.x,n.y=i.y,a(r,ee[te],ee[te+1],ee[te+2],ee[te+3],ee[te+4],O,i),0===te&&!0===c&&l.copy(i)}break;case"Z":case"z":r.currentPath.autoClose=!0,r.currentPath.curves.length>0&&(i.copy(l),r.currentPath.currentPoint.copy(i),u=!0);break;default:console.warn(p)}c=!1}return r}(r));break;case"rect":i=n(r,i),M=function(t){var r=c(t.getAttribute("x")||0),a=c(t.getAttribute("y")||0),i=c(t.getAttribute("rx")||0),n=c(t.getAttribute("ry")||0),o=c(t.getAttribute("width")),s=c(t.getAttribute("height")),l=new e.ShapePath;l.moveTo(r+2*i,a),l.lineTo(r+o-2*i,a),(0!==i||0!==n)&&l.bezierCurveTo(r+o,a,r+o,a,r+o,a+2*n);l.lineTo(r+o,a+s-2*n),(0!==i||0!==n)&&l.bezierCurveTo(r+o,a+s,r+o,a+s,r+o-2*i,a+s);l.lineTo(r+2*i,a+s),(0!==i||0!==n)&&l.bezierCurveTo(r,a+s,r,a+s,r,a+s-2*n);l.lineTo(r,a+2*n),(0!==i||0!==n)&&l.bezierCurveTo(r,a,r,a,r+2*i,a);return l}(r);break;case"polygon":i=n(r,i),M=function(t){function r(e,t,r){var a=c(t),o=c(r);0===n?i.moveTo(a,o):i.lineTo(a,o),n++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new e.ShapePath,n=0;return t.getAttribute("points").replace(a,r),i.currentPath.autoClose=!0,i}(r);break;case"polyline":i=n(r,i),M=function(t){function r(e,t,r){var a=c(t),o=c(r);0===n?i.moveTo(a,o):i.lineTo(a,o),n++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new e.ShapePath,n=0;return t.getAttribute("points").replace(a,r),i.currentPath.autoClose=!1,i}(r);break;case"circle":i=n(r,i),M=function(t){var r=c(t.getAttribute("cx")),a=c(t.getAttribute("cy")),i=c(t.getAttribute("r")),n=new e.Path;n.absarc(r,a,i,0,2*Math.PI);var o=new e.ShapePath;return o.subPaths.push(n),o}(r);break;case"ellipse":i=n(r,i),M=function(t){var r=c(t.getAttribute("cx")),a=c(t.getAttribute("cy")),i=c(t.getAttribute("rx")),n=c(t.getAttribute("ry")),o=new e.Path;o.absellipse(r,a,i,n,0,2*Math.PI);var s=new e.ShapePath;return s.subPaths.push(o),s}(r);break;case"line":i=n(r,i),M=function(t){var r=c(t.getAttribute("x1")),a=c(t.getAttribute("y1")),i=c(t.getAttribute("x2")),n=c(t.getAttribute("y2")),o=new e.ShapePath;return o.moveTo(r,a),o.lineTo(i,n),o.currentPath.autoClose=!1,o}(r);break;case"defs":u=!1;break;case"use":i=n(r,i);var S=r.href.baseVal.substring(1),T=r.viewportElement.getElementById(S);T?t(T,i):console.warn("SVGLoader: 'use node' references non-existent node id: "+S)}if(M&&(void 0!==i.fill&&"none"!==i.fill&&M.color.setStyle(i.fill),function(e,t){function r(e){A.set(e.x,e.y,1).applyMatrix3(t),e.set(A.x,A.y)}for(var a=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=e.subPaths,n=0,o=i.length;n<o;n++)for(var s=i[n].curves,l=0;l<s.length;l++){var u=s[l];u.isLineCurve?(r(u.v1),r(u.v2)):u.isCubicBezierCurve?(r(u.v0),r(u.v1),r(u.v2),r(u.v3)):u.isQuadraticBezierCurve?(r(u.v0),r(u.v1),r(u.v2)):u.isEllipseCurve&&(a&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),b.set(u.aX,u.aY),r(b),u.aX=b.x,u.aY=b.y,u.xRadius*=h(t),u.yRadius*=d(t))}}(M,w),f.push(M),M.userData={node:r,style:i}),u)for(var C=r.childNodes,F=0;F<C.length;F++)t(C[F],i);l&&(m.pop(),m.length>0?w.copy(m[m.length-1]):w.identity())}}(M.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:f,xml:M.documentElement}}}),Uu.getStrokeStyle=function(e,t,r,a,i){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:a=void 0!==a?a:"butt",strokeMiterLimit:i=void 0!==i?i:4}},Uu.pointsToStroke=function(t,r,a,i){var n=[],o=[],s=[];if(0===Uu.pointsToStrokeWithBuffers(t,r,a,i,n,o,s))return null;var l=new e.BufferGeometry;return l.setAttribute("position",new e.Float32BufferAttribute(n,3)),l.setAttribute("normal",new e.Float32BufferAttribute(o,3)),l.setAttribute("uv",new e.Float32BufferAttribute(s,2)),l},Uu.pointsToStrokeWithBuffers=(Au=new e.Vector2,wu=new e.Vector2,Mu=new e.Vector2,Su=new e.Vector2,Tu=new e.Vector2,Cu=new e.Vector2,Fu=new e.Vector2,Eu=new e.Vector2,Bu=new e.Vector2,Lu=new e.Vector2,Pu=new e.Vector2,Du=new e.Vector2,Nu=new e.Vector2,Ru=new e.Vector2,_u=new e.Vector2,Iu=new e.Vector2,Ou=new e.Vector2,function(e,t,r,a,i,n,o,s){r=void 0!==r?r:12,a=void 0!==a?a:.001,s=void 0!==s?s:0;var l=(e=function(e){for(var t=!1,r=1,i=e.length-1;r<i;r++)if(e[r].distanceTo(e[r+1])<a){t=!0;break}if(!t)return e;var n=[];n.push(e[0]);for(var o=1,s=e.length-1;o<s;o++)e[o].distanceTo(e[o+1])>=a&&n.push(e[o]);return n.push(e[e.length-1]),n}(e)).length;if(l<2)return 0;var u,c,h,d,f,p=e[0].equals(e[l-1]),m=e[0],v=t.strokeWidth/2,g=1/(l-1),y=0,x=!1,b=0,A=3*s,w=2*s;R(e[0],e[1],Au).multiplyScalar(v),Eu.copy(e[0]).sub(Au),Bu.copy(e[0]).add(Au),Lu.copy(Eu),Pu.copy(Bu);for(var M=1;M<l;M++){u=e[M],c=M===l-1?p?e[1]:void 0:e[M+1];var S=Au;R(m,u,S),Mu.copy(S).multiplyScalar(v),Du.copy(u).sub(Mu),Nu.copy(u).add(Mu);var T=y+g;if(h=!1,void 0!==c){R(u,c,wu),Mu.copy(wu).multiplyScalar(v),Ru.copy(u).sub(Mu),_u.copy(u).add(Mu),d=!0,Mu.subVectors(c,m),S.dot(Mu)<0&&(d=!1),1===M&&(x=d),Mu.subVectors(c,u),Mu.normalize();var C=Math.abs(S.dot(Mu));if(0!==C){var F=v/C;Mu.multiplyScalar(-F),Su.subVectors(u,m),Tu.copy(Su).setLength(F).add(Mu),Iu.copy(Tu).negate();var E=Tu.length(),B=Su.length();Su.divideScalar(B),Cu.subVectors(c,u);var L=Cu.length();switch(Cu.divideScalar(L),Su.dot(Iu)<B&&Cu.dot(Iu)<L&&(h=!0),Ou.copy(Tu).add(u),Iu.add(u),f=!1,h?d?(_u.copy(Iu),Nu.copy(Iu)):(Ru.copy(Iu),Du.copy(Iu)):O(),t.strokeLineJoin){case"bevel":U(d,h,T);break;case"round":k(d,h),d?I(u,Du,Ru,T,0):I(u,_u,Nu,T,1);break;case"miter":case"miter-clip":default:var P=v*t.strokeMiterLimit/E;if(P<1){if("miter-clip"!==t.strokeLineJoin){U(d,h,T);break}k(d,h),d?(Cu.subVectors(Ou,Du).multiplyScalar(P).add(Du),Fu.subVectors(Ou,Ru).multiplyScalar(P).add(Ru),_(Du,T,0),_(Cu,T,0),_(u,T,.5),_(u,T,.5),_(Cu,T,0),_(Fu,T,0),_(u,T,.5),_(Fu,T,0),_(Ru,T,0)):(Cu.subVectors(Ou,Nu).multiplyScalar(P).add(Nu),Fu.subVectors(Ou,_u).multiplyScalar(P).add(_u),_(Nu,T,1),_(Cu,T,1),_(u,T,.5),_(u,T,.5),_(Cu,T,1),_(Fu,T,1),_(u,T,.5),_(Fu,T,1),_(_u,T,1))}else h?(d?(_(Bu,y,1),_(Eu,y,0),_(Ou,T,0),_(Bu,y,1),_(Ou,T,0),_(Iu,T,1)):(_(Bu,y,1),_(Eu,y,0),_(Ou,T,1),_(Eu,y,0),_(Iu,T,0),_(Ou,T,1)),d?Ru.copy(Ou):_u.copy(Ou)):d?(_(Du,T,0),_(Ou,T,0),_(u,T,.5),_(u,T,.5),_(Ou,T,0),_(Ru,T,0)):(_(Nu,T,1),_(Ou,T,1),_(u,T,.5),_(u,T,.5),_(Ou,T,1),_(_u,T,1)),f=!0}}else O()}else O();p||M!==l-1||V(e[0],Lu,Pu,d,!0,y),y=T,m=u,Eu.copy(Ru),Bu.copy(_u)}if(p){if(h&&i){var D=Ou,N=Iu;x!==d&&(D=Iu,N=Ou),d?(f||x)&&(N.toArray(i,0),N.toArray(i,9),f&&D.toArray(i,3)):!f&&x||(N.toArray(i,3),N.toArray(i,9),f&&D.toArray(i,0))}}else V(u,Du,Nu,d,!1,T);return b;function R(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function _(e,t,r){i&&(i[A]=e.x,i[A+1]=e.y,i[A+2]=0,n&&(n[A]=0,n[A+1]=0,n[A+2]=1),A+=3,o&&(o[w]=t,o[w+1]=r,w+=2)),b+=3}function I(e,t,a,i,n){Au.copy(t).sub(e).normalize(),wu.copy(a).sub(e).normalize();var o=Math.PI,s=Au.dot(wu);Math.abs(s)<1&&(o=Math.abs(Math.acos(s))),o/=r,Mu.copy(t);for(var l=0,u=r-1;l<u;l++)Su.copy(Mu).rotateAround(e,o),_(Mu,i,n),_(Su,i,n),_(e,i,.5),Mu.copy(Su);_(Su,i,n),_(a,i,n),_(e,i,.5)}function O(){_(Bu,y,1),_(Eu,y,0),_(Du,T,0),_(Bu,y,1),_(Du,T,1),_(Nu,T,0)}function U(e,t,r){t?e?(_(Bu,y,1),_(Eu,y,0),_(Du,T,0),_(Bu,y,1),_(Du,T,0),_(Iu,T,1),_(Du,r,0),_(Ru,r,0),_(Iu,r,.5)):(_(Bu,y,1),_(Eu,y,0),_(Nu,T,1),_(Eu,y,0),_(Iu,T,0),_(Nu,T,1),_(Nu,r,1),_(_u,r,0),_(Iu,r,.5)):e?(_(Du,r,0),_(Ru,r,0),_(u,r,.5)):(_(Nu,r,1),_(_u,r,0),_(u,r,.5))}function k(e,t){t&&(e?(_(Bu,y,1),_(Eu,y,0),_(Du,T,0),_(Bu,y,1),_(Du,T,0),_(Iu,T,1),_(Du,y,0),_(u,T,.5),_(Iu,T,1),_(u,T,.5),_(Ru,y,0),_(Iu,T,1)):(_(Bu,y,1),_(Eu,y,0),_(Nu,T,1),_(Eu,y,0),_(Iu,T,0),_(Nu,T,1),_(Nu,y,1),_(Iu,T,0),_(u,T,.5),_(u,T,.5),_(Iu,T,0),_(_u,y,1)))}function V(e,r,a,n,o,s){switch(t.strokeLineCap){case"round":o?I(e,a,r,s,.5):I(e,r,a,s,.5);break;case"square":if(o)Au.subVectors(r,e),wu.set(Au.y,-Au.x),Mu.addVectors(Au,wu).add(e),Su.subVectors(wu,Au).add(e),n?(Mu.toArray(i,3),Su.toArray(i,0),Su.toArray(i,9)):(Mu.toArray(i,3),Mu.toArray(i,9),Su.toArray(i,0));else{Au.subVectors(a,e),wu.set(Au.y,-Au.x),Mu.addVectors(Au,wu).add(e),Su.subVectors(wu,Au).add(e);var l=i.length;n?(Mu.toArray(i,l-3),Su.toArray(i,l-6),Su.toArray(i,l-12)):(Mu.toArray(i,l-6),Su.toArray(i,l-3),Su.toArray(i,l-12))}}}});var ku=function(t){e.Loader.call(this,t),this.libraryPath="",this.libraryPending=null,this.libraryBinary=null,this.libraryConfig={},this.url="",this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={},this.materials=[]};ku.taskCache=new WeakMap,ku.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:ku,setLibraryPath:function(e){return this.libraryPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),this.url=t,o.load(t,(function(e){if(ku.taskCache.has(e))return ku.taskCache.get(e).promise.then(r).catch(i);n.decodeObjects(e,t).then(r).catch(i)}),a,i)},debug:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))},decodeObjects:function(e,t){var r,a,i=this,n=e.byteLength,o=this._getWorker(n).then((function(t){return r=t,a=i.workerNextTaskID++,new Promise((function(t,i){r._callbacks[a]={resolve:t,reject:i},r.postMessage({type:"decode",id:a,buffer:e},[e])}))})).then((function(e){return i._createGeometry(e.data)}));return o.catch((function(){return!0})).then((function(){r&&a&&i._releaseTask(r,a)})),ku.taskCache.set(e,{url:t,promise:o}),o},parse:function(e,t,r){this.decodeObjects(e,"").then(t).catch(r)},_compareMaterials:function(e){var t={};t.name=e.name,t.color={},t.color.r=e.color.r,t.color.g=e.color.g,t.color.b=e.color.b,t.type=e.type;for(var r=0;r<this.materials.length;r++){var a=this.materials[r],i={};if(i.name=a.name,i.color={},i.color.r=a.color.r,i.color.g=a.color.g,i.color.b=a.color.b,i.type=a.type,JSON.stringify(t)===JSON.stringify(i))return a}return this.materials.push(e),e},_createMaterial:function(t){if(void 0===t)return new e.MeshStandardMaterial({color:new e.Color(1,1,1),metalness:.8,name:"default",side:2});var r=t.diffuseColor,a=new e.Color(r.r/255,r.g/255,r.b/255);0===r.r&&0===r.g&&0===r.b&&(a.r=1,a.g=1,a.b=1);for(var i=new e.MeshStandardMaterial({color:a,name:t.name,side:2,transparent:t.transparency>0,opacity:1-t.transparency}),n=new e.TextureLoader,o=0;o<t.textures.length;o++){var s=t.textures[o];if(null!==s.image){var l=n.load(s.image);switch(s.type){case"Diffuse":i.map=l;break;case"Bump":i.bumpMap=l;break;case"Transparency":i.alphaMap=l,i.transparent=!0;break;case"Emap":i.envMap=l}}}return i},_createGeometry:function(t){var r=new e.Object3D,a=[],i=[],n=[];r.userData.layers=t.layers,r.userData.groups=t.groups,r.userData.settings=t.settings,r.userData.objectType="File3dm",r.userData.materials=null,r.name=this.url;for(var o=t.objects,s=t.materials,l=0;l<o.length;l++){var u=o[l],c=u.attributes;switch(u.objectType){case"InstanceDefinition":i.push(u);break;case"InstanceReference":n.push(u);break;default:if(c.materialIndex>=0){var h=s[c.materialIndex],d=this._createMaterial(h);d=this._compareMaterials(d);var f=this._createObject(u,d)}else d=this._createMaterial(),f=this._createObject(u,d);if(void 0===f)continue;var p=t.layers[c.layerIndex];f.visible=!p||t.layers[c.layerIndex].visible,c.isInstanceDefinitionObject?a.push(f):r.add(f)}}for(var m=0;m<i.length;m++){for(var v=i[m],g=(o=[],0);g<v.attributes.objectIds.length;g++)for(var y=v.attributes.objectIds[g],x=0;x<a.length;x++){y===a[x].userData.attributes.id&&o.push(a[x])}for(var b=0;b<n.length;b++){var A=n[b];if(A.geometry.parentIdefId===v.attributes.id){var w=new e.Object3D,M=A.geometry.xform.array,S=new e.Matrix4;S.set(M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],M[8],M[9],M[10],M[11],M[12],M[13],M[14],M[15]),w.applyMatrix4(S);for(var T=0;T<o.length;T++)w.add(o[T].clone(!0));r.add(w)}}}return r.userData.materials=this.materials,r},_createObject:function(t,r){var a=new e.BufferGeometryLoader,i=t.attributes;switch(t.objectType){case"Point":case"PointSet":var n=null;if((u=a.parse(t.geometry)).attributes.hasOwnProperty("color"))n=new e.PointsMaterial({vertexColors:!0,sizeAttenuation:!1,size:2});else{var o=i.drawColor,s=new e.Color(o.r/255,o.g/255,o.b/255);n=new e.PointsMaterial({color:s,sizeAttenuation:!1,size:2})}n=this._compareMaterials(n);var l=new e.Points(u,n);return l.userData.attributes=i,l.userData.objectType=t.objectType,i.name&&(l.name=i.name),l;case"Mesh":case"Extrusion":case"SubD":case"Brep":if(null===t.geometry)return;var u;(u=a.parse(t.geometry)).attributes.hasOwnProperty("color")&&(r.vertexColors=!0),null===r&&(r=this._createMaterial(),r=this._compareMaterials(r));var c=new e.Mesh(u,r);return c.castShadow=i.castsShadows,c.receiveShadow=i.receivesShadows,c.userData.attributes=i,c.userData.objectType=t.objectType,i.name&&(c.name=i.name),c;case"Curve":u=a.parse(t.geometry);o=i.drawColor,s=new e.Color(o.r/255,o.g/255,o.b/255),n=new e.LineBasicMaterial({color:s});n=this._compareMaterials(n);var h=new e.Line(u,n);return h.userData.attributes=i,h.userData.objectType=t.objectType,i.name&&(h.name=i.name),h;case"TextDot":u=t.geometry;var d=document.createElement("canvas").getContext("2d"),f=u.fontHeight+"px "+u.fontFace;d.font=f;var p=d.measureText(u.text).width+10,m=u.fontHeight+10,v=window.devicePixelRatio;d.canvas.width=p*v,d.canvas.height=m*v,d.canvas.style.width=p+"px",d.canvas.style.height=m+"px",d.setTransform(v,0,0,v,0,0),d.font=f,d.textBaseline="middle",d.textAlign="center";s=i.drawColor;d.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",d.fillRect(0,0,p,m),d.fillStyle="white",d.fillText(u.text,p/2,m/2);var g=new e.CanvasTexture(d.canvas);g.minFilter=e.LinearFilter,g.wrapS=e.ClampToEdgeWrapping,g.wrapT=e.ClampToEdgeWrapping;n=new e.SpriteMaterial({map:g,depthTest:!1});var y=new e.Sprite(n);return y.position.set(u.point[0],u.point[1],u.point[2]),y.scale.set(p/10,m/10,1),y.userData.attributes=i,y.userData.objectType=t.objectType,i.name&&(y.name=i.name),y;case"Light":var x;if((u=t.geometry).isDirectionalLight)(x=new e.DirectionalLight).castShadow=i.castsShadows,x.position.set(u.location[0],u.location[1],u.location[2]),x.target.position.set(u.direction[0],u.direction[1],u.direction[2]),x.shadow.normalBias=.1;else if(u.isPointLight)(x=new e.PointLight).castShadow=i.castsShadows,x.position.set(u.location[0],u.location[1],u.location[2]),x.shadow.normalBias=.1;else if(u.isRectangularLight){x=new e.RectAreaLight;p=Math.abs(u.width[2]),m=Math.abs(u.length[0]);x.position.set(u.location[0]-m/2,u.location[1],u.location[2]-p/2),x.height=m,x.width=p,x.lookAt(new e.Vector3(u.direction[0],u.direction[1],u.direction[2]))}else if(u.isSpotLight)(x=new e.SpotLight).castShadow=i.castsShadows,x.position.set(u.location[0],u.location[1],u.location[2]),x.target.position.set(u.direction[0],u.direction[1],u.direction[2]),x.angle=u.spotAngleRadians,x.shadow.normalBias=.1;else if(u.isLinearLight)return void console.warn("THREE.3DMLoader:  No conversion exists for linear lights.");if(x){x.intensity=u.intensity;o=u.diffuse,s=new e.Color(o.r/255,o.g/255,o.b/255);x.color=s,x.userData.attributes=i,x.userData.objectType=t.objectType}return x}},_initLibrary:function(){var t=this;if(!this.libraryPending){var r=new e.FileLoader(this.manager);r.setPath(this.libraryPath);var a=new Promise((function(e,t){r.load("rhino3dm.js",e,void 0,t)})),i=new e.FileLoader(this.manager);i.setPath(this.libraryPath),i.setResponseType("arraybuffer");var n=new Promise((function(e,t){i.load("rhino3dm.wasm",e,void 0,t)}));this.libraryPending=Promise.all([a,n]).then((function(e){var r=e[0],a=e[1];t.libraryConfig.wasmBinary=a;var i=ku.Rhino3dmWorker.toString(),n=["/* rhino3dm.js */",r,"/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([n]))}))}return this.libraryPending},_getWorker:function(e){var t=this;return this._initLibrary().then((function(){var r;t.workerPool.length<t.workerLimit?((r=new Worker(t.workerSourceURL))._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",libraryConfig:t.libraryConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.Rhino3dmLoader: Unexpected message, "'+t.type+'"')}},t.workerPool.push(r)):t.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(r=t.workerPool[t.workerPool.length-1])._taskLoad+=e,r}))},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),ku.Rhino3dmWorker=function(){var e,t;function r(e,r){var n=e.geometry(),o=e.attributes(),s=n.objectType,l=null,u=null;switch(s){case t.ObjectType.Curve:var c=i(n,100),u={},h={};(f={}).itemSize=3,f.type="Float32Array",f.array=[];for(var d=0;d<c.length;d++)f.array.push(c[d][0]),f.array.push(c[d][1]),f.array.push(c[d][2]);u.position=f,h.attributes=u,l={data:h};break;case t.ObjectType.Point:var f,p=n.location,m={};u={},h={};(f={}).itemSize=3,f.type="Float32Array",f.array=[p[0],p[1],p[2]];var v=o.drawColor(r);m.itemSize=3,m.type="Float32Array",m.array=[v.r/255,v.g/255,v.b/255],u.position=f,u.color=m,h.attributes=u,l={data:h};break;case t.ObjectType.PointSet:case t.ObjectType.Mesh:l=n.toThreejsJSON();break;case t.ObjectType.Brep:for(var g=n.faces(),y=new t.Mesh,x=0;x<g.count;x++){var b=g.get(x),A=b.getMesh(t.MeshType.Any);A&&(y.append(A),A.delete()),b.delete()}y.faces().count>0&&(y.compact(),l=y.toThreejsJSON(),g.delete()),y.delete();break;case t.ObjectType.Extrusion:(y=n.getMesh(t.MeshType.Any))&&(l=y.toThreejsJSON(),y.delete());break;case t.ObjectType.TextDot:case t.ObjectType.Light:l=a(n);break;case t.ObjectType.InstanceReference:(l=a(n)).xform=a(n.xform),l.xform.array=n.xform.toFloatArray(!0);break;case t.ObjectType.SubD:n.subdivide(3),(y=t.Mesh.createFromSubDControlNet(n))&&(l=y.toThreejsJSON(),y.delete());break;default:console.warn("THREE.3DMLoader: TODO: Implement "+s.constructor.name)}if(l)return(u=a(o)).geometry=a(n),o.groupCount>0&&(u.groupIds=o.getGroupList()),o.userStringCount>0&&(u.userStrings=o.getUserStrings()),n.userStringCount>0&&(u.geometry.userStrings=n.getUserStrings()),u.drawColor=o.drawColor(r),{geometry:l,attributes:u,objectType:s=(s=s.constructor.name).substring(11,s.length)};console.warn("THREE.3DMLoader: "+s.constructor.name+" has no associated mesh geometry.")}function a(e){var t={};for(var r in e){var a=e[r];"function"!=typeof a&&("object"==typeof a&&null!==a&&a.hasOwnProperty("constructor")?t[r]={name:a.constructor.name,value:a.value}:t[r]=a)}return t}function i(e,r){var a=r,n=[],o=[];if(e instanceof t.LineCurve)return[e.pointAtStart,e.pointAtEnd];if(e instanceof t.PolylineCurve){a=e.pointCount;for(var s=0;s<a;s++)n.push(e.point(s));return n}if(e instanceof t.PolyCurve){for(var l=e.segmentCount,u=0;u<l;u++){var c=e.segmentCurve(u),h=i(c,a);n=n.concat(h),c.delete()}return n}if(e instanceof t.ArcCurve&&(a=(a=Math.floor(e.angleDegrees/5))<2?2:a),e instanceof t.NurbsCurve&&1===e.degree){for(var d=e.tryGetPolyline(),f=0;f<d.count;f++)n.push(d.get(f));return d.delete(),n}for(var p=e.domain,m=a-1,v=0;v<a;v++){var g=p[0]+v/m*(p[1]-p[0]);if(g!==p[0]&&g!==p[1]){var y,x=e.tangentAt(g),b=e.tangentAt(o.slice(-1)[0]),A=x[0]*x[0]+x[1]*x[1]+x[2]*x[2],w=b[0]*b[0]+b[1]*b[1]+b[2]*b[2],M=Math.sqrt(A*w);if(0===M)y=Math.PI/2;else{var S=(x.x*b.x+x.y*b.y+x.z*b.z)/M;y=Math.acos(Math.max(-1,Math.min(1,S)))}y<.1||o.push(g)}else o.push(g)}return n=o.map((function(t){return e.pointAt(t)}))}onmessage=function(i){var n=i.data;switch(n.type){case"init":var o,s=n.libraryConfig.wasmBinary;e=new Promise((function(e){o={wasmBinary:s,onRuntimeInitialized:e},rhino3dm(o)})).then((function(){t=o}));break;case"decode":var l=n.buffer;e.then((function(){var e=function(e,t){for(var i=new Uint8Array(t),n=e.File3dm.fromByteArray(i),o=[],s=[],l=[],u=[],c=[],h=[],d=n.objects(),f=d.count,p=0;p<f;p++){var m=d.get(p),v=r(m,n);m.delete(),v&&o.push(v)}for(var g=0;g<n.instanceDefinitions().count();g++){var y=n.instanceDefinitions().get(g),x=a(y);x.objectIds=y.getObjectIds(),o.push({geometry:null,attributes:x,objectType:"InstanceDefinition"})}for(var b=[e.TextureType.Diffuse,e.TextureType.Bump,e.TextureType.Transparency,e.TextureType.Opacity,e.TextureType.Emap],A=[e.TextureType.PBR_BaseColor,e.TextureType.PBR_Subsurface,e.TextureType.PBR_SubsurfaceScattering,e.TextureType.PBR_SubsurfaceScatteringRadius,e.TextureType.PBR_Metallic,e.TextureType.PBR_Specular,e.TextureType.PBR_SpecularTint,e.TextureType.PBR_Roughness,e.TextureType.PBR_Anisotropic,e.TextureType.PBR_Anisotropic_Rotation,e.TextureType.PBR_Sheen,e.TextureType.PBR_SheenTint,e.TextureType.PBR_Clearcoat,e.TextureType.PBR_ClearcoatBump,e.TextureType.PBR_ClearcoatRoughness,e.TextureType.PBR_OpacityIor,e.TextureType.PBR_OpacityRoughness,e.TextureType.PBR_Emission,e.TextureType.PBR_AmbientOcclusion,e.TextureType.PBR_Displacement],w=0;w<n.materials().count();w++){for(var M=n.materials().get(w),S=M.physicallyBased(),T=a(M),C=[],F=0;F<b.length;F++){if(L=M.getTexture(b[F])){var E={type:P=(P=b[F].constructor.name).substring(12,P.length)};(D=n.getEmbeddedFileAsBase64(L.fileName))?E.image="data:image/png;base64,"+D:(console.warn("THREE.3DMLoader: Image for "+P+" texture not embedded in file."),E.image=null),C.push(E),L.delete()}}if(T.textures=C,S.supported){console.log("pbr true");for(var B=0;B<A.length;B++){var L;if(L=M.getTexture(b[B])){var P,D=n.getEmbeddedFileAsBase64(L.fileName);E={type:P=(P=b[B].constructor.name).substring(12,P.length),image:"data:image/png;base64,"+D};C.push(E),L.delete()}}var N=a(M.physicallyBased());T=Object.assign(N,T)}s.push(T),M.delete(),S.delete()}for(var R=0;R<n.layers().count();R++){var _=n.layers().get(R),I=a(_);l.push(I),_.delete()}for(var O=0;O<n.views().count();O++){var U=n.views().get(O),k=a(U);u.push(k),U.delete()}for(var V=0;V<n.namedViews().count();V++){var G=n.namedViews().get(V),j=a(G);c.push(j),G.delete()}for(var z=0;z<n.groups().count();z++){var H=n.groups().get(z),W=a(H);h.push(W),H.delete()}var X=a(n.settings());return n.delete(),{objects:o,materials:s,layers:l,views:u,namedViews:c,groups:h,settings:X}}(t,l);self.postMessage({type:"decode",id:n.id,data:e})}))}}};var Vu=function(){var t=/^[og]\s*(.+)?/,r=/^mtllib /,a=/^usemtl /,i=/^usemap /,n=new e.Vector3,o=new e.Vector3,s=new e.Vector3,l=new e.Vector3,u=new e.Vector3;function c(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var a={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var a=r.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var a=this.vertices,i=this.object.geometry.vertices;i.push(a[e+0],a[e+1],a[e+2]),i.push(a[t+0],a[t+1],a[t+2]),i.push(a[r+0],a[r+1],a[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var a=this.normals,i=this.object.geometry.normals;i.push(a[e+0],a[e+1],a[e+2]),i.push(a[t+0],a[t+1],a[t+2]),i.push(a[r+0],a[r+1],a[r+2])},addFaceNormal:function(e,t,r){var a=this.vertices,i=this.object.geometry.normals;n.fromArray(a,e),o.fromArray(a,t),s.fromArray(a,r),u.subVectors(s,o),l.subVectors(n,o),u.cross(l),u.normalize(),i.push(u.x,u.y,u.z),i.push(u.x,u.y,u.z),i.push(u.x,u.y,u.z)},addColor:function(e,t,r){var a=this.colors,i=this.object.geometry.colors;void 0!==a[e]&&i.push(a[e+0],a[e+1],a[e+2]),void 0!==a[t]&&i.push(a[t+0],a[t+1],a[t+2]),void 0!==a[r]&&i.push(a[r+0],a[r+1],a[r+2])},addUV:function(e,t,r){var a=this.uvs,i=this.object.geometry.uvs;i.push(a[e+0],a[e+1]),i.push(a[t+0],a[t+1]),i.push(a[r+0],a[r+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,a,i,n,o,s,l){var u=this.vertices.length,c=this.parseVertexIndex(e,u),h=this.parseVertexIndex(t,u),d=this.parseVertexIndex(r,u);if(this.addVertex(c,h,d),this.addColor(c,h,d),void 0!==o&&""!==o){var f=this.normals.length;c=this.parseNormalIndex(o,f),h=this.parseNormalIndex(s,f),d=this.parseNormalIndex(l,f),this.addNormal(c,h,d)}else this.addFaceNormal(c,h,d);if(void 0!==a&&""!==a){var p=this.uvs.length;c=this.parseUVIndex(a,p),h=this.parseUVIndex(i,p),d=this.parseUVIndex(n,p),this.addUV(c,h,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,a=e.length;r<a;r++){var i=this.parseVertexIndex(e[r],t);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,a=this.uvs.length,i=0,n=e.length;i<n;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));for(var o=0,s=t.length;o<s;o++)this.addUVLine(this.parseUVIndex(t[o],a))}};return e.startObject("",!1),e}function h(t){e.Loader.call(this,t),this.materials=null}return h.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:h,load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},setMaterials:function(e){return this.materials=e,this},parse:function(n){var o=new c;-1!==n.indexOf("\r\n")&&(n=n.replace(/\r\n/g,"\n")),-1!==n.indexOf("\\\n")&&(n=n.replace(/\\\n/g,""));for(var s=n.split("\n"),l="",u="",h=[],d="function"==typeof"".trimLeft,f=0,p=s.length;f<p;f++)if(l=s[f],0!==(l=d?l.trimLeft():l.trim()).length&&"#"!==(u=l.charAt(0)))if("v"===u){var m=l.split(/\s+/);switch(m[0]){case"v":o.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7?o.colors.push(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])):o.colors.push(void 0,void 0,void 0);break;case"vn":o.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":o.uvs.push(parseFloat(m[1]),parseFloat(m[2]))}}else if("f"===u){for(var v=l.substr(1).trim().split(/\s+/),g=[],y=0,x=v.length;y<x;y++){var b=v[y];if(b.length>0){var A=b.split("/");g.push(A)}}for(var w=g[0],M=1,S=g.length-1;M<S;M++){var T=g[M],C=g[M+1];o.addFace(w[0],T[0],C[0],w[1],T[1],C[1],w[2],T[2],C[2])}}else if("l"===u){var F=l.substring(1).trim().split(" "),E=[],B=[];if(-1===l.indexOf("/"))E=F;else for(var L=0,P=F.length;L<P;L++){var D=F[L].split("/");""!==D[0]&&E.push(D[0]),""!==D[1]&&B.push(D[1])}o.addLineGeometry(E,B)}else if("p"===u){var N=l.substr(1).trim().split(" ");o.addPointGeometry(N)}else if(null!==(h=t.exec(l))){var R=(" "+h[0].substr(1).trim()).substr(1);o.startObject(R)}else if(a.test(l))o.object.startMaterial(l.substring(7).trim(),o.materialLibraries);else if(r.test(l))o.materialLibraries.push(l.substring(7).trim());else if(i.test(l))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===u){if((h=l.split(" ")).length>1){var _=h[1].trim().toLowerCase();o.object.smooth="0"!==_&&"off"!==_}else o.object.smooth=!0;(K=o.object.currentMaterial())&&(K.smooth=o.object.smooth)}else{if("\0"===l)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+l+'"')}o.finalize();var I=new e.Group;if(I.materialLibraries=[].concat(o.materialLibraries),!0===!(1===o.objects.length&&0===o.objects[0].geometry.vertices.length))for(var O=0,U=o.objects.length;O<U;O++){var k=o.objects[O],V=k.geometry,G=k.materials,j="Line"===V.type,z="Points"===V.type,H=!1;if(0!==V.vertices.length){(re=new e.BufferGeometry).setAttribute("position",new e.Float32BufferAttribute(V.vertices,3)),V.normals.length>0&&re.setAttribute("normal",new e.Float32BufferAttribute(V.normals,3)),V.colors.length>0&&(H=!0,re.setAttribute("color",new e.Float32BufferAttribute(V.colors,3))),!0===V.hasUVIndices&&re.setAttribute("uv",new e.Float32BufferAttribute(V.uvs,2));for(var W,X=[],Q=0,Y=G.length;Q<Y;Q++){var J=(te=G[Q]).name+"_"+te.smooth+"_"+H,K=o.materials[J];if(null!==this.materials)if(K=this.materials.create(te.name),!j||!K||K instanceof e.LineBasicMaterial){if(z&&K&&!(K instanceof e.PointsMaterial)){var q=new e.PointsMaterial({size:10,sizeAttenuation:!1});e.Material.prototype.copy.call(q,K),q.color.copy(K.color),q.map=K.map,K=q}}else{var Z=new e.LineBasicMaterial;e.Material.prototype.copy.call(Z,K),Z.color.copy(K.color),K=Z}void 0===K&&((K=j?new e.LineBasicMaterial:z?new e.PointsMaterial({size:1,sizeAttenuation:!1}):new e.MeshPhongMaterial).name=te.name,K.flatShading=!te.smooth,K.vertexColors=H,o.materials[J]=K),X.push(K)}if(X.length>1){for(var $=0,ee=G.length;$<ee;$++){var te=G[$];re.addGroup(te.groupStart,te.groupCount,$)}W=j?new e.LineSegments(re,X):z?new e.Points(re,X):new e.Mesh(re,X)}else W=j?new e.LineSegments(re,X[0]):z?new e.Points(re,X[0]):new e.Mesh(re,X[0]);W.name=k.name,I.add(W)}}else if(o.vertices.length>0){var re;K=new e.PointsMaterial({size:1,sizeAttenuation:!1});(re=new e.BufferGeometry).setAttribute("position",new e.Float32BufferAttribute(o.vertices,3)),o.colors.length>0&&void 0!==o.colors[0]&&(re.setAttribute("color",new e.Float32BufferAttribute(o.colors,3)),K.vertexColors=!0);var ae=new e.Points(re,K);I.add(ae)}return I}}),h}(),Gu=function(t){e.Loader.call(this,t)};Gu.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Gu,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){function r(t){for(var r="AMF Material",i=t.attributes.id.textContent,n={r:1,g:1,b:1,a:1},o=null,s=0;s<t.childNodes.length;s++){var l=t.childNodes[s];"metadata"===l.nodeName&&void 0!==l.attributes.type?"name"===l.attributes.type.value&&(r=l.textContent):"color"===l.nodeName&&(n=a(l))}return o=new e.MeshPhongMaterial({flatShading:!0,color:new e.Color(n.r,n.g,n.b),name:r}),1!==n.a&&(o.transparent=!0,o.opacity=n.a),{id:i,material:o}}function a(e){for(var t={r:1,g:1,b:1,a:1},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];"r"===a.nodeName?t.r=a.textContent:"g"===a.nodeName?t.g=a.textContent:"b"===a.nodeName?t.b=a.textContent:"a"===a.nodeName&&(t.a=a.textContent)}return t}function i(e){var t={name:"",triangles:[],materialid:null},r=e.firstElementChild;for(void 0!==e.attributes.materialid&&(t.materialId=e.attributes.materialid.nodeValue);r;){if("metadata"===r.nodeName)void 0!==r.attributes.type&&"name"===r.attributes.type.value&&(t.name=r.textContent);else if("triangle"===r.nodeName){var a=r.getElementsByTagName("v1")[0].textContent,i=r.getElementsByTagName("v2")[0].textContent,n=r.getElementsByTagName("v3")[0].textContent;t.triangles.push(a,i,n)}r=r.nextElementSibling}return t}function n(e){for(var t=[],r=[],a=e.firstElementChild;a;){if("vertex"===a.nodeName)for(var i=a.firstElementChild;i;){if("coordinates"===i.nodeName){var n=i.getElementsByTagName("x")[0].textContent,o=i.getElementsByTagName("y")[0].textContent,s=i.getElementsByTagName("z")[0].textContent;t.push(n,o,s)}else if("normal"===i.nodeName){var l=i.getElementsByTagName("nx")[0].textContent,u=i.getElementsByTagName("ny")[0].textContent,c=i.getElementsByTagName("nz")[0].textContent;r.push(l,u,c)}i=i.nextElementSibling}a=a.nextElementSibling}return{vertices:t,normals:r}}function o(e){for(var t=e.attributes.id.textContent,r={name:"amfobject",meshes:[]},o=null,s=e.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(r.name=s.textContent);else if("color"===s.nodeName)o=a(s);else if("mesh"===s.nodeName){for(var l=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:o};l;){if("vertices"===l.nodeName){var c=n(l);u.normals=u.normals.concat(c.normals),u.vertices=u.vertices.concat(c.vertices)}else"volume"===l.nodeName&&u.volumes.push(i(l));l=l.nextElementSibling}r.meshes.push(u)}s=s.nextElementSibling}return{id:t,obj:r}}var s,u,c=function(t){var r=new DataView(t);if("PK"===String.fromCharCode(r.getUint8(0),r.getUint8(1))){var a=null;console.log("THREE.AMFLoader: Loading Zip");try{a=l.unzipSync(new Uint8Array(t))}catch(e){if(e instanceof ReferenceError)return console.log("THREE.AMFLoader: fflate missing and file is compressed."),null}for(var i in a)if(".amf"===i.toLowerCase().substr(-4))break;console.log("THREE.AMFLoader: Trying to load file asset: null"),r=new DataView(a.null.buffer)}var n=e.LoaderUtils.decodeText(r),o=(new DOMParser).parseFromString(n,"application/xml");return"amf"!==o.documentElement.nodeName.toLowerCase()?(console.log("THREE.AMFLoader: Error loading AMF - no AMF document found."),null):o}(t),h="",d="",f=function(e){var t=1,r="millimeter";void 0!==e.documentElement.attributes.unit&&(r=e.documentElement.attributes.unit.value.toLowerCase());var a={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==a[r]&&(t=a[r]),console.log("THREE.AMFLoader: Unit scale: "+t),t}(c),p={},m={},v=c.documentElement.childNodes;for(s=0;s<v.length;s++){var g=v[s];if("metadata"===g.nodeName)void 0!==g.attributes.type&&("name"===g.attributes.type.value?h=g.textContent:"author"===g.attributes.type.value&&(d=g.textContent));else if("material"===g.nodeName){var y=r(g);p[y.id]=y.material}else if("object"===g.nodeName){var x=o(g);m[x.id]=x.obj}}var b=new e.Group,A=new e.MeshPhongMaterial({color:11184895,flatShading:!0});for(var w in b.name=h,b.userData.author=d,b.userData.loader="AMF",m){var M=m[w],S=M.meshes,T=new e.Group;for(T.name=M.name||"",s=0;s<S.length;s++){var C=A,F=S[s],E=new e.Float32BufferAttribute(F.vertices,3),B=null;if(F.normals.length&&(B=new e.Float32BufferAttribute(F.normals,3)),F.color){var L=F.color;(C=A.clone()).color=new e.Color(L.r,L.g,L.b),1!==L.a&&(C.transparent=!0,C.opacity=L.a)}var P=F.volumes;for(u=0;u<P.length;u++){var D=P[u],N=new e.BufferGeometry,R=C;N.setIndex(D.triangles),N.setAttribute("position",E.clone()),B&&N.setAttribute("normal",B.clone()),void 0!==p[D.materialId]&&(R=p[D.materialId]),N.scale(f,f,f),T.add(new e.Mesh(N,R.clone()))}}b.add(T)}return b}});var ju=function(){function t(t){e.Loader.call(this,t),this.loader=new e.FileLoader(this.manager),this.parser=null,this.meshBuilder=new a(this.manager),this.animationBuilder=new o}t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,setAnimationPath:function(e){return this.animationPath=e,this},load:function(t,r,a,i){var n,o=this.meshBuilder.setCrossOrigin(this.crossOrigin);n=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:e.LoaderUtils.extractUrlBase(t);var s=this._extractExtension(t).toLowerCase();"pmd"===s||"pmx"===s?this["pmd"===s?"loadPMD":"loadPMX"](t,(function(e){r(o.build(e,n,a,i))}),a,i):i&&i(new Error("THREE.MMDLoader: Unknown model file extension ."+s+"."))},loadAnimation:function(e,t,r,a,i){var n=this.animationBuilder;this.loadVMD(e,(function(e){r(t.isCamera?n.buildCameraAnimation(e):n.build(e,t))}),a,i)},loadWithAnimation:function(e,t,r,a,i){var n=this;this.load(e,(function(e){n.loadAnimation(t,e,(function(t){r({mesh:e,animation:t})}),a,i)}),a,i)},loadPMD:function(e,t,r,a){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(e,(function(e){t(i.parsePmd(e,!0))}),r,a)},loadPMX:function(e,t,r,a){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(e,(function(e){t(i.parsePmx(e,!0))}),r,a)},loadVMD:function(e,t,r,a){var i=Array.isArray(e)?e:[e],n=[],o=i.length,s=this._getParser();this.loader.setMimeType(void 0).setPath(this.animationPath).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials);for(var l=0,u=i.length;l<u;l++)this.loader.load(i[l],(function(e){n.push(s.parseVmd(e,!0)),n.length===o&&t(s.mergeVmds(n))}),r,a)},loadVPD:function(e,t,r,a,i){var n=this._getParser();this.loader.setMimeType(t?void 0:"text/plain; charset=shift_jis").setPath(this.animationPath).setResponseType("text").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(e,(function(e){r(n.parseVpd(e,!0))}),a,i)},_extractExtension:function(e){var t=e.lastIndexOf(".");return t<0?"":e.slice(t+1)},_getParser:function(){return null===this.parser&&(this.parser=new u.Parser),this.parser}});var r=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];function a(e){this.geometryBuilder=new i,this.materialBuilder=new n(e)}function i(){}function n(t){this.manager=t,this.textureLoader=new e.TextureLoader(this.manager),this.tgaLoader=null}function o(){}function s(t,r,a,i,n){e.Interpolant.call(this,t,r,a,i),this.interpolationParams=n}return a.prototype={constructor:a,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},build:function(t,r,a,i){var n=this.geometryBuilder.build(t),o=this.materialBuilder.setCrossOrigin(this.crossOrigin).setResourcePath(r).build(t,n,a,i),s=new e.SkinnedMesh(n,o),l=new e.Skeleton(function(t){var r,a,i,n,o=t.geometry,s=[];if(o&&void 0!==o.bones){for(i=0,n=o.bones.length;i<n;i++)a=o.bones[i],r=new e.Bone,s.push(r),r.name=a.name,r.position.fromArray(a.pos),r.quaternion.fromArray(a.rotq),void 0!==a.scl&&r.scale.fromArray(a.scl);for(i=0,n=o.bones.length;i<n;i++)-1!==(a=o.bones[i]).parent&&null!==a.parent&&void 0!==s[a.parent]?s[a.parent].add(s[i]):t.add(s[i])}return t.updateMatrixWorld(!0),s}(s));return s.bind(l),s}},i.prototype={constructor:i,build:function(t){for(var r=[],a=[],i=[],n=[],o=[],s=[],l=[],u=[],c=[],h=[],d=[],f=[],p=[],m=[],v=0,g={},y=0;y<t.metadata.vertexCount;y++){for(var x=t.vertices[y],b=0,A=x.position.length;b<A;b++)r.push(x.position[b]);for(var w=0,M=x.normal.length;w<M;w++)i.push(x.normal[w]);for(var S=0,T=x.uv.length;S<T;S++)a.push(x.uv[S]);for(var C=0;C<4;C++)l.push(x.skinIndices.length-1>=C?x.skinIndices[C]:0);for(var F=0;F<4;F++)u.push(x.skinWeights.length-1>=F?x.skinWeights[F]:0)}for(var E=0;E<t.metadata.faceCount;E++)for(var B=t.faces[E],L=0,P=B.indices.length;L<P;L++)n.push(B.indices[L]);for(var D=0;D<t.metadata.materialCount;D++){var N=t.materials[D];o.push({offset:3*v,count:3*N.faceCount}),v+=N.faceCount}for(var R=0;R<t.metadata.rigidBodyCount;R++){var _=t.rigidBodies[R],I=g[_.boneIndex];I=void 0===I?_.type:Math.max(_.type,I),g[_.boneIndex]=I}for(var O=0;O<t.metadata.boneCount;O++){-1!==(de={parent:(Z=t.bones[O]).parentIndex,name:Z.name,pos:Z.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:void 0!==g[O]?g[O]:-1}).parent&&(de.pos[0]-=t.bones[de.parent].position[0],de.pos[1]-=t.bones[de.parent].position[1],de.pos[2]-=t.bones[de.parent].position[2]),s.push(de)}if("pmd"===t.metadata.format)for(var U=0;U<t.metadata.ikCount;U++){for(var k={target:(z=t.iks[U]).target,effector:z.effector,iteration:z.iteration,maxAngle:4*z.maxAngle,links:[]},V=0,G=z.links.length;V<G;V++){(X={}).index=z.links[V].index,X.enabled=!0,t.bones[X.index].name.indexOf("")>=0&&(X.limitation=new e.Vector3(1,0,0)),k.links.push(X)}d.push(k)}else for(var j=0;j<t.metadata.boneCount;j++){var z;if(void 0!==(z=t.bones[j].ik)){k={target:j,effector:z.effector,iteration:z.iteration,maxAngle:z.maxAngle,links:[]};for(var H=0,W=z.links.length;H<W;H++){var X;if((X={}).index=z.links[H].index,X.enabled=!0,1===z.links[H].angleLimitation){var Q=z.links[H].lowerLimitationAngle,Y=z.links[H].upperLimitationAngle,J=-Y[0],K=-Y[1];Y[0]=-Q[0],Y[1]=-Q[1],Q[0]=J,Q[1]=K,X.rotationMin=(new e.Vector3).fromArray(Q),X.rotationMax=(new e.Vector3).fromArray(Y)}k.links.push(X)}d.push(k)}}if("pmx"===t.metadata.format){for(var q=0;q<t.metadata.boneCount;q++){var Z,$=(Z=t.bones[q]).grant;if(void 0!==$){k={index:q,parentIndex:$.parentIndex,ratio:$.ratio,isLocal:$.isLocal,affectRotation:$.affectRotation,affectPosition:$.affectPosition,transformationClass:Z.transformationClass};f.push(k)}}f.sort((function(e,t){return e.transformationClass-t.transformationClass}))}function ee(e,r,a){for(var i=0;i<r.elementCount;i++){var n,o=r.elements[i];n="pmd"===t.metadata.format?t.morphs[0].elements[o.index].index:o.index,e.array[3*n+0]+=o.position[0]*a,e.array[3*n+1]+=o.position[1]*a,e.array[3*n+2]+=o.position[2]*a}}for(var te=0;te<t.metadata.morphCount;te++){var re=t.morphs[te],ae={name:re.name},ie=new e.Float32BufferAttribute(3*t.metadata.vertexCount,3);ie.name=re.name;for(var ne=0;ne<3*t.metadata.vertexCount;ne++)ie.array[ne]=r[ne];if("pmd"===t.metadata.format)0!==te&&ee(ie,re,1);else if(0===re.type)for(var oe=0;oe<re.elementCount;oe++){var se=t.morphs[re.elements[oe].index],le=re.elements[oe].ratio;1===se.type&&ee(ie,se,le)}else 1===re.type?ee(ie,re,1):2===re.type||3===re.type||4===re.type||5===re.type||6===re.type||7===re.type||re.type;c.push(ae),h.push(ie)}for(var ue=0;ue<t.metadata.rigidBodyCount;ue++){var ce=t.rigidBodies[ue];ae={};for(var he in ce)ae[he]=ce[he];if("pmx"===t.metadata.format&&-1!==ae.boneIndex){var de=t.bones[ae.boneIndex];ae.position[0]-=de.position[0],ae.position[1]-=de.position[1],ae.position[2]-=de.position[2]}p.push(ae)}for(var fe=0;fe<t.metadata.constraintCount;fe++){var pe=t.constraints[fe];ae={};for(var me in pe)ae[me]=pe[me];var ve=p[ae.rigidBodyIndex1],ge=p[ae.rigidBodyIndex2];0!==ve.type&&2===ge.type&&-1!==ve.boneIndex&&-1!==ge.boneIndex&&t.bones[ge.boneIndex].parentIndex===ve.boneIndex&&(ge.type=1),m.push(ae)}var ye=new e.BufferGeometry;ye.setAttribute("position",new e.Float32BufferAttribute(r,3)),ye.setAttribute("normal",new e.Float32BufferAttribute(i,3)),ye.setAttribute("uv",new e.Float32BufferAttribute(a,2)),ye.setAttribute("skinIndex",new e.Uint16BufferAttribute(l,4)),ye.setAttribute("skinWeight",new e.Float32BufferAttribute(u,4)),ye.setIndex(n);for(var xe=0,be=o.length;xe<be;xe++)ye.addGroup(o[xe].offset,o[xe].count,xe);return ye.bones=s,ye.morphTargets=c,ye.morphAttributes.position=h,ye.morphTargetsRelative=!1,ye.userData.MMD={bones:s,iks:d,grants:f,rigidBodies:p,constraints:m,format:t.metadata.format},ye.computeBoundingSphere(),ye}},n.prototype={constructor:n,crossOrigin:"anonymous",resourcePath:void 0,setCrossOrigin:function(e){return this.crossOrigin=e,this},setResourcePath:function(e){return this.resourcePath=e,this},build:function(t,r){var a=[],i={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(var n=0;n<t.metadata.materialCount;n++){var o=t.materials[n],s={userData:{}};if(void 0!==o.name&&(s.name=o.name),s.color=(new e.Color).fromArray(o.diffuse),s.opacity=o.diffuse[3],s.emissive=(new e.Color).fromArray(o.ambient),s.transparent=1!==s.opacity,s.skinning=r.bones.length>0,s.morphTargets=r.morphTargets.length>0,s.fog=!0,s.blending=e.CustomBlending,s.blendSrc=e.SrcAlphaFactor,s.blendDst=e.OneMinusSrcAlphaFactor,s.blendSrcAlpha=e.SrcAlphaFactor,s.blendDstAlpha=e.DstAlphaFactor,"pmx"===t.metadata.format&&1==(1&o.flag)?s.side=e.DoubleSide:s.side=1===s.opacity?e.FrontSide:e.DoubleSide,"pmd"===t.metadata.format){if(o.fileName){var l=o.fileName.split("*");if(s.map=this._loadTexture(l[0],i),l.length>1){var u=l[1].slice(-4).toLowerCase();s.envMap=this._loadTexture(l[1],i),s.combine=".sph"===u?e.MultiplyOperation:e.AddOperation}}var c=-1===o.toonIndex?"toon00.bmp":t.toonTextures[o.toonIndex].fileName;s.gradientMap=this._loadTexture(c,i,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(c)}),s.userData.outlineParameters={thickness:1===o.edgeFlag?.003:0,color:[0,0,0],alpha:1,visible:1===o.edgeFlag}}else{var h;-1!==o.textureIndex&&(s.map=this._loadTexture(t.textures[o.textureIndex],i)),-1===o.envTextureIndex||1!==o.envFlag&&2!=o.envFlag||(s.envMap=this._loadTexture(t.textures[o.envTextureIndex],i),s.combine=1===o.envFlag?e.MultiplyOperation:e.AddOperation),-1===o.toonIndex||0!==o.toonFlag?(c="toon"+("0"+(o.toonIndex+1)).slice(-2)+".bmp",h=!0):(c=t.textures[o.toonIndex],h=!1),s.gradientMap=this._loadTexture(c,i,{isToonTexture:!0,isDefaultToonTexture:h}),s.userData.outlineParameters={thickness:o.edgeSize/300,color:o.edgeColor.slice(0,3),alpha:o.edgeColor[3],visible:0!=(16&o.flag)&&o.edgeSize>0}}void 0!==s.map&&(s.transparent||this._checkImageTransparency(s.map,r,n),s.emissive.multiplyScalar(.2)),a.push(new e.MeshToonMaterial(s))}if("pmx"===t.metadata.format)for(var d=function(e,t){for(var r=0,a=e.length;r<a;r++){var i=e[r];if(-1!==i.index){var n=t[i.index];n.opacity!==i.diffuse[3]&&(n.transparent=!0)}}},f=0,p=t.morphs.length;f<p;f++){var m=t.morphs[f],v=m.elements;if(0===m.type)for(var g=0,y=v.length;g<y;g++){var x=t.morphs[v[g].index];8===x.type&&d(x.elements,a)}else 8===m.type&&d(v,a)}return a},_getTGALoader:function(){if(null===this.tgaLoader){if(void 0===Os)throw new Error("THREE.MMDLoader: Import TGALoader");this.tgaLoader=new Os(this.manager)}return this.tgaLoader},_isDefaultToonTexture:function(e){return 10===e.length&&/toon(10|0[0-9])\.bmp/.test(e)},_loadTexture:function(t,a,i,n,o){var s,l=this;if(!0===(i=i||{}).isDefaultToonTexture){var u;try{u=parseInt(t.match(/toon([0-9]{2})\.bmp$/)[1])}catch(e){console.warn("THREE.MMDLoader: "+t+" seems like a not right default texture path. Using toon00.bmp instead."),u=0}s=r[u]}else s=this.resourcePath+t;if(void 0!==a[s])return a[s];var c=this.manager.getHandler(s);null===c&&(c=".tga"===t.slice(-4).toLowerCase()?this._getTGALoader():this.textureLoader);var h=c.load(s,(function(t){!0===i.isToonTexture&&(t.image=l._getRotatedImage(t.image),t.magFilter=e.NearestFilter,t.minFilter=e.NearestFilter),t.flipY=!1,t.wrapS=e.RepeatWrapping,t.wrapT=e.RepeatWrapping;for(var r=0;r<h.readyCallbacks.length;r++)h.readyCallbacks[r](h);delete h.readyCallbacks}),n,o);return h.readyCallbacks=[],a[s]=h,h},_getRotatedImage:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),a=e.width,i=e.height;return t.width=a,t.height=i,r.clearRect(0,0,a,i),r.translate(a/2,i/2),r.rotate(.5*Math.PI),r.translate(-a/2,-i/2),r.drawImage(e,0,0),r.getImageData(0,0,a,i)},_checkImageTransparency:function(e,t,r){e.readyCallbacks.push((function(a){function i(e,t){var r=e.width,a=e.height,i=Math.round(t.x*r)%r,n=Math.round(t.y*a)%a;i<0&&(i+=r),n<0&&(n+=a);var o=n*r+i;return e.data[4*o+3]}var n=void 0!==a.image.data?a.image:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}(a.image),o=t.groups[r];(function(e,t,r){var a=e.width,n=e.height;if(e.data.length/(a*n)!=4)return!1;for(var o=0;o<r.length;o+=3){for(var s={x:0,y:0},l=0;l<3;l++){var u=r[3*o+l],c={x:t[2*u+0],y:t[2*u+1]};if(i(e,c)<253)return!0;s.x+=c.x,s.y+=c.y}if(s.x/=3,s.y/=3,i(e,s)<253)return!0}return!1})(n,t.attributes.uv.array,t.index.array.slice(o.start,o.start+o.count))&&(e.transparent=!0)}))}},o.prototype={constructor:o,build:function(t,r){for(var a=this.buildSkeletalAnimation(t,r).tracks,i=this.buildMorphAnimation(t,r).tracks,n=0,o=i.length;n<o;n++)a.push(i[n]);return new e.AnimationClip("",-1,a)},buildSkeletalAnimation:function(t,r){function a(e,t,r){e.push(t[r+0]/127),e.push(t[r+8]/127),e.push(t[r+4]/127),e.push(t[r+12]/127)}for(var i=[],n={},o=r.skeleton.bones,s={},l=0,u=o.length;l<u;l++)s[o[l].name]=!0;for(var c=0;c<t.metadata.motionCount;c++){var h=t.motions[c],d=h.boneName;void 0!==s[d]&&(n[d]=n[d]||[],n[d].push(h))}for(var f in n){var p=n[f];p.sort((function(e,t){return e.frameNum-t.frameNum}));for(var m=[],v=[],g=[],y=[],x=[],b=r.skeleton.getBoneByName(f).position.toArray(),A=0,w=p.length;A<w;A++){var M=p[A].frameNum/30,S=p[A].position,T=p[A].rotation,C=p[A].interpolation;m.push(M);for(var F=0;F<3;F++)v.push(b[F]+S[F]);for(var E=0;E<4;E++)g.push(T[E]);for(var B=0;B<3;B++)a(y,C,B);a(x,C,3)}var L=".bones["+f+"]";i.push(this._createTrack(L+".position",e.VectorKeyframeTrack,m,v,y)),i.push(this._createTrack(L+".quaternion",e.QuaternionKeyframeTrack,m,g,x))}return new e.AnimationClip("",-1,i)},buildMorphAnimation:function(t,r){for(var a=[],i={},n=r.morphTargetDictionary,o=0;o<t.metadata.morphCount;o++){var s=t.morphs[o],l=s.morphName;void 0!==n[l]&&(i[l]=i[l]||[],i[l].push(s))}for(var u in i){var c=i[u];c.sort((function(e,t){return e.frameNum-t.frameNum}));for(var h=[],d=[],f=0,p=c.length;f<p;f++)h.push(c[f].frameNum/30),d.push(c[f].weight);a.push(new e.NumberKeyframeTrack(".morphTargetInfluences["+n[u]+"]",h,d))}return new e.AnimationClip("",-1,a)},buildCameraAnimation:function(t){function r(e,t){e.push(t.x),e.push(t.y),e.push(t.z)}function a(e,t,r){e.push(t[4*r+0]/127),e.push(t[4*r+1]/127),e.push(t[4*r+2]/127),e.push(t[4*r+3]/127)}var i=[],n=void 0===t.cameras?[]:t.cameras.slice();n.sort((function(e,t){return e.frameNum-t.frameNum}));for(var o,s,l=[],u=[],c=[],h=[],d=[],f=[],p=[],m=[],v=[],g=new e.Quaternion,y=new e.Euler,x=new e.Vector3,b=new e.Vector3,A=0,w=n.length;A<w;A++){var M=n[A],S=M.frameNum/30,T=M.position,C=M.rotation,F=M.distance,E=M.fov,B=M.interpolation;l.push(S),x.set(0,0,-F),b.set(T[0],T[1],T[2]),y.set(-C[0],-C[1],-C[2]),g.setFromEuler(y),x.add(b),x.applyQuaternion(g),r(u,b),(o=c).push((s=g).x),o.push(s.y),o.push(s.z),o.push(s.w),r(h,x),d.push(E);for(var L=0;L<3;L++)a(f,B,L);a(p,B,3);for(var P=0;P<3;P++)a(m,B,4);a(v,B,5)}return(i=[]).push(this._createTrack("target.position",e.VectorKeyframeTrack,l,u,f)),i.push(this._createTrack(".quaternion",e.QuaternionKeyframeTrack,l,c,p)),i.push(this._createTrack(".position",e.VectorKeyframeTrack,l,h,m)),i.push(this._createTrack(".fov",e.NumberKeyframeTrack,l,d,v)),new e.AnimationClip("",-1,i)},_createTrack:function(e,t,r,a,i){if(r.length>2){r=r.slice(),a=a.slice(),i=i.slice();for(var n=a.length/r.length,o=i.length/r.length,l=1,u=2,c=r.length;u<c;u++){for(var h=0;h<n;h++)if(a[l*n+h]!==a[(l-1)*n+h]||a[l*n+h]!==a[u*n+h]){l++;break}if(u>l){r[l]=r[u];for(var d=0;d<n;d++)a[l*n+d]=a[u*n+d];for(var f=0;f<o;f++)i[l*o+f]=i[u*o+f]}}r.length=l+1,a.length=(l+1)*n,i.length=(l+1)*o}var p=new t(e,r,a);return p.createInterpolant=function(e){return new s(this.times,this.values,this.getValueSize(),e,new Float32Array(i))},p}},s.prototype=Object.assign(Object.create(e.Interpolant.prototype),{constructor:s,interpolate_:function(t,r,a,i){var n=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=this.interpolationParams,u=t*s,c=u-s,h=i-r<.05?0:(a-r)/(i-r);if(4===s){var d=l[4*t+0],f=l[4*t+1],p=l[4*t+2],m=l[4*t+3],v=this._calculate(d,f,p,m,h);e.Quaternion.slerpFlat(n,0,o,c,o,u,v)}else if(3===s)for(var g=0;g!==s;++g){d=l[12*t+4*g+0],f=l[12*t+4*g+1],p=l[12*t+4*g+2],m=l[12*t+4*g+3],v=this._calculate(d,f,p,m,h);n[g]=o[c+g]*(1-v)+o[u+g]*v}else{d=l[4*t+0],f=l[4*t+1],p=l[4*t+2],m=l[4*t+3],v=this._calculate(d,f,p,m,h);n[0]=o[c]*(1-v)+o[u]*v}return n},_calculate:function(e,t,r,a,i){for(var n,o,s,l=.5,u=l,c=1-u,h=Math,d=0;d<15;d++){var f=(n=3*c*c*u)*e+(o=3*c*u*u)*t+(s=u*u*u)-i;if(h.abs(f)<1e-5)break;l/=2,c=1-(u+=f<0?l:-l)}return n*r+o*a+s}}),t}(),zu=function(t){e.CompressedTextureLoader.call(this,t)};zu.prototype=Object.assign(Object.create(e.CompressedTextureLoader.prototype),{constructor:zu,parse:function(e,t){var r=new Hu(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}}});var Hu=function(){function e(t,r){this.arrayBuffer=t;var a=new Uint8Array(this.arrayBuffer,0,12);if(171===a[0]&&75===a[1]&&84===a[2]&&88===a[3]&&32===a[4]&&49===a[5]&&49===a[6]&&187===a[7]&&13===a[8]&&10===a[9]&&26===a[10]&&10===a[11]){var i=Uint32Array.BYTES_PER_ELEMENT,n=new DataView(this.arrayBuffer,12,13*i),o=67305985===n.getUint32(0,!0);this.glType=n.getUint32(1*i,o),this.glTypeSize=n.getUint32(2*i,o),this.glFormat=n.getUint32(3*i,o),this.glInternalFormat=n.getUint32(4*i,o),this.glBaseInternalFormat=n.getUint32(5*i,o),this.pixelWidth=n.getUint32(6*i,o),this.pixelHeight=n.getUint32(7*i,o),this.pixelDepth=n.getUint32(8*i,o),this.numberOfArrayElements=n.getUint32(9*i,o),this.numberOfFaces=n.getUint32(10*i,o),this.numberOfMipmapLevels=n.getUint32(11*i,o),this.bytesOfKeyValueData=n.getUint32(12*i,o),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===r?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.mipmaps=function(t){for(var r=[],a=e.HEADER_LEN+this.bytesOfKeyValueData,i=this.pixelWidth,n=this.pixelHeight,o=t?this.numberOfMipmapLevels:1,s=0;s<o;s++){var l=new Int32Array(this.arrayBuffer,a,1)[0];a+=4;for(var u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,a,l);r.push({data:c,width:i,height:n}),a+=l,a+=3-(l+3)%4}i=Math.max(1,.5*i),n=Math.max(1,.5*n)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}(),Wu=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.load=function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},a.parse=function(t){for(var r=new e.Group,a=l.unzipSync(new Uint8Array(t.slice(16))),i=JSON.parse(l.strFromU8(a["metadata.json"])),n=new DataView(a["data.sketch"].buffer),o=n.getInt32(16,!0),s={},u=20,c=0;c<o;c++){for(var h=n.getInt32(u,!0),d=[n.getFloat32(u+4,!0),n.getFloat32(u+8,!0),n.getFloat32(u+12,!0),n.getFloat32(u+16,!0)],f=n.getFloat32(u+20,!0),p=n.getUint32(u+24,!0),m=n.getUint32(u+28,!0),v=0,g=0,y=0;y<4;y++){var x=1<<y;(p&x)>0&&(v+=4),(m&x)>0&&(g+=4)}u=u+28+v+4;var b=n.getInt32(u,!0),A=new Float32Array(3*b),w=new Float32Array(4*b);u+=4;for(var M=0,S=0;M<A.length;M+=3,S+=4)A[M+0]=n.getFloat32(u+0,!0),A[M+1]=n.getFloat32(u+4,!0),A[M+2]=n.getFloat32(u+8,!0),w[S+0]=n.getFloat32(u+12,!0),w[S+1]=n.getFloat32(u+16,!0),w[S+2]=n.getFloat32(u+20,!0),w[S+3]=n.getFloat32(u+24,!0),u=u+28+g;h in s==!1&&(s[h]=[]),s[h].push([A,w,f,d])}for(var T in s){var C=new Xu(s[T]),F=Ju(i.BrushIndex[T]);r.add(new e.Mesh(C,F))}return r},r}(e.Loader),Xu=function(t){function r(r){var a;a=t.call(this)||this;var i=[],n=[],o=[],s=new e.Vector3,l=new e.Vector3,u=new e.Quaternion,c=new e.Quaternion,h=new e.Vector3,d=new e.Vector3,f=new e.Vector3,p=new e.Vector3;for(var m in r){var v=r[m],g=v[0],y=v[1],x=v[2],b=v[3];l.fromArray(g,0),c.fromArray(y,0);for(var A=3,w=4,M=g.length;A<M;A+=3,w+=4){s.fromArray(g,A),u.fromArray(y,w),h.set(-x,0,0),h.applyQuaternion(u),h.add(s),d.set(x,0,0),d.applyQuaternion(u),d.add(s),f.set(x,0,0),f.applyQuaternion(c),f.add(l),p.set(-x,0,0),p.applyQuaternion(c),p.add(l),i.push(h.x,h.y,-h.z),i.push(d.x,d.y,-d.z),i.push(p.x,p.y,-p.z),i.push(d.x,d.y,-d.z),i.push(f.x,f.y,-f.z),i.push(p.x,p.y,-p.z),l.copy(s),c.copy(u),n.push.apply(n,b),n.push.apply(n,b),n.push.apply(n,b),n.push.apply(n,b),n.push.apply(n,b),n.push.apply(n,b);var S=A/M,T=(A-3)/M;o.push(S,0),o.push(S,1),o.push(T,0),o.push(S,1),o.push(T,1),o.push(T,0)}}return a.setAttribute("position",new e.BufferAttribute(new Float32Array(i),3)),a.setAttribute("color",new e.BufferAttribute(new Float32Array(n),4)),a.setAttribute("uv",new e.BufferAttribute(new Float32Array(o),2)),a}return g.default(r,t),r}(e.BufferGeometry),Qu={"89d104cd-d012-426b-b5b3-bbaee63ac43c":"Bubbles","700f3aa8-9a7c-2384-8b8a-ea028905dd8c":"CelVinyl","0f0ff7b2-a677-45eb-a7d6-0cd7206f4816":"ChromaticWave","1161af82-50cf-47db-9706-0c3576d43c43":"CoarseBristles","79168f10-6961-464a-8be1-57ed364c5600":"CoarseBristlesSingleSided","1caa6d7d-f015-3f54-3a4b-8b5354d39f81":"Comet","c8313697-2563-47fc-832e-290f4c04b901":"DiamondHull","4391aaaa-df73-4396-9e33-31e4e4930b27":"Disco","d1d991f2-e7a0-4cf1-b328-f57e915e6260":"DotMarker","6a1cf9f9-032c-45ec-9b1d-a6680bee30f7":"Dots","0d3889f3-3ede-470c-8af4-f44813306126":"DoubleTaperedFlat","0d3889f3-3ede-470c-8af4-de4813306126":"DoubleTaperedMarker","d0262945-853c-4481-9cbd-88586bed93cb":"DuctTape","3ca16e2f-bdcd-4da2-8631-dcef342f40f1":"DuctTapeSingleSided","f6e85de3-6dcc-4e7f-87fd-cee8c3d25d51":"Electricity","02ffb866-7fb2-4d15-b761-1012cefb1360":"Embers","cb92b597-94ca-4255-b017-0e3f42f12f9e":"Fire","2d35bcf0-e4d8-452c-97b1-3311be063130":"Flat","55303bc4-c749-4a72-98d9-d23e68e76e18":"FlatDeprecated","280c0a7a-aad8-416c-a7d2-df63d129ca70":"FlatSingleSided","cf019139-d41c-4eb0-a1d0-5cf54b0a42f3":"Highlighter","6a1cf9f9-032c-45ec-9b6e-a6680bee32e9":"HyperGrid","dce872c2-7b49-4684-b59b-c45387949c5c":"Hypercolor","e8ef32b1-baa8-460a-9c2c-9cf8506794f5":"HypercolorSingleSided","2f212815-f4d3-c1a4-681a-feeaf9c6dc37":"Icing","f5c336cf-5108-4b40-ade9-c687504385ab":"Ink","c0012095-3ffd-4040-8ee1-fc180d346eaa":"InkSingleSided","4a76a27a-44d8-4bfe-9a8c-713749a499b0":"Leaves","ea19de07-d0c0-4484-9198-18489a3c1487":"LeavesSingleSided","2241cd32-8ba2-48a5-9ee7-2caef7e9ed62":"Light","4391aaaa-df81-4396-9e33-31e4e4930b27":"LightWire","d381e0f5-3def-4a0d-8853-31e9200bcbda":"Lofted","429ed64a-4e97-4466-84d3-145a861ef684":"Marker","79348357-432d-4746-8e29-0e25c112e3aa":"MatteHull","b2ffef01-eaaa-4ab5-aa64-95a2c4f5dbc6":"NeonPulse","f72ec0e7-a844-4e38-82e3-140c44772699":"OilPaint","c515dad7-4393-4681-81ad-162ef052241b":"OilPaintSingleSided","f1114e2e-eb8d-4fde-915a-6e653b54e9f5":"Paper","759f1ebd-20cd-4720-8d41-234e0da63716":"PaperSingleSided","e0abbc80-0f80-e854-4970-8924a0863dcc":"Petal","c33714d1-b2f9-412e-bd50-1884c9d46336":"Plasma","ad1ad437-76e2-450d-a23a-e17f8310b960":"Rainbow","faaa4d44-fcfb-4177-96be-753ac0421ba3":"ShinyHull","70d79cca-b159-4f35-990c-f02193947fe8":"Smoke","d902ed8b-d0d1-476c-a8de-878a79e3a34c":"Snow","accb32f5-4509-454f-93f8-1df3fd31df1b":"SoftHighlighter","cf7f0059-7aeb-53a4-2b67-c83d863a9ffa":"Spikes","8dc4a70c-d558-4efd-a5ed-d4e860f40dc3":"Splatter","7a1c8107-50c5-4b70-9a39-421576d6617e":"SplatterSingleSided","0eb4db27-3f82-408d-b5a1-19ebd7d5b711":"Stars","44bb800a-fbc3-4592-8426-94ecb05ddec3":"Streamers","0077f88c-d93a-42f3-b59b-b31c50cdb414":"Taffy","b468c1fb-f254-41ed-8ec9-57030bc5660c":"TaperedFlat","c8ccb53d-ae13-45ef-8afb-b730d81394eb":"TaperedFlatSingleSided","d90c6ad8-af0f-4b54-b422-e0f92abe1b3c":"TaperedMarker","1a26b8c0-8a07-4f8a-9fac-d2ef36e0cad0":"TaperedMarker_Flat","75b32cf0-fdd6-4d89-a64b-e2a00b247b0f":"ThickPaint","fdf0326a-c0d1-4fed-b101-9db0ff6d071f":"ThickPaintSingleSided","4391385a-df73-4396-9e33-31e4e4930b27":"Toon","a8fea537-da7c-4d4b-817f-24f074725d6d":"UnlitHull","d229d335-c334-495a-a801-660ac8a87360":"VelvetInk","10201aa3-ebc2-42d8-84b7-2e63f6eeb8ab":"Waveform","b67c0e81-ce6d-40a8-aeb0-ef036b081aa3":"WetPaint","dea67637-cd1a-27e4-c9b1-52f4bbcb84e5":"WetPaintSingleSided","5347acf0-a8e2-47b6-8346-30c70719d763":"WigglyGraphite","e814fef1-97fd-7194-4a2f-50c2bb918be2":"WigglyGraphiteSingleSided","4391385a-cf83-4396-9e33-31e4e4930b27":"Wire"},Yu={BloomColor:"\n\t\t\tvec3 BloomColor(vec3 color, float gain) {\n\t\t\t\t// Guarantee that there's at least a little bit of all 3 channels.\n\t\t\t\t// This makes fully-saturated strokes (which only have 2 non-zero\n\t\t\t\t// color channels) eventually clip to white rather than to a secondary.\n\t\t\t\tfloat cmin = length(color.rgb) * .05;\n\t\t\t\tcolor.rgb = max(color.rgb, vec3(cmin, cmin, cmin));\n\t\t\t\t// If we try to remove this pow() from .a, it brightens up\n\t\t\t\t// pressure-sensitive strokes; looks better as-is.\n\t\t\t\tcolor = pow(color, vec3(2.2));\n\t\t\t\tcolor.rgb *= 2. * exp(gain * 10.);\n\t\t\t\treturn color;\n\t\t\t}\n\t\t",LinearToSrgb:"\n\t\t\tvec3 LinearToSrgb(vec3 color) {\n\t\t\t\t// Approximation http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\n\t\t\t\tvec3 linearColor = color.rgb;\n\t\t\t\tvec3 S1 = sqrt(linearColor);\n\t\t\t\tvec3 S2 = sqrt(S1);\n\t\t\t\tvec3 S3 = sqrt(S2);\n\t\t\t\tcolor.rgb = 0.662002687 * S1 + 0.684122060 * S2 - 0.323583601 * S3 - 0.0225411470 * linearColor;\n\t\t\t\treturn color;\n\t\t\t}\n\t\t",hsv:"\n\t\t\t// uniform sampler2D lookupTex;\n\t\t\tvec4 lookup(vec4 textureColor) {\n\t\t\t\treturn textureColor;\n\t\t\t}\n\n\t\t\tvec3 lookup(vec3 textureColor) {\n\t\t\t\treturn textureColor;\n\t\t\t}\n\n\t\t\tvec3 hsv2rgb( vec3 hsv ) {\n\t\t\t\tvec3 rgb = clamp( abs(mod(hsv.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0 );\n\t\t\t\treturn hsv.z * mix( vec3(1.0), rgb, hsv.y);\n\t\t\t}\n\n\t\t\tvec3 rgb2hsv( vec3 rgb ) {\n\t\t\t\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\t\t\t\tvec4 p = mix(vec4(rgb.bg, K.wz), vec4(rgb.gb, K.xy), step(rgb.b, rgb.g));\n\t\t\t\tvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\n\n\t\t\t\tfloat d = q.x - min(q.w, q.y);\n\t\t\t\tfloat e = 1.0e-10;\n\n\t\t\t\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n\t\t\t}\n\t\t",SrgbToLinear:"\n\t\t\tvec3 SrgbToLinear(vec3 color) {\n\t\t\t\t// Approximation http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\n\t\t\t\tvec3 sRGB = color.rgb;\n\t\t\t\tcolor.rgb = sRGB * (sRGB * (sRGB * 0.305306011 + 0.682171111) + 0.012522878);\n\t\t\t\treturn color;\n\t\t\t}\n\t\t"};function Ju(t){switch(Qu[t]){case"Light":return new e.RawShaderMaterial({uniforms:{mainTex:{value:(new e.TextureLoader).setPath("./textures/tiltbrush/").load("Light.webp")},alphaTest:{value:.067},emission_gain:{value:.45},alpha:{value:1}},vertexShader:"\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tattribute vec2 uv;\n\t\t\tattribute vec4 color;\n\t\t\tattribute vec3 position;\n\n\t\t\tuniform mat4 modelMatrix;\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\t\t\tuniform mat4 viewMatrix;\n\t\t\tuniform mat3 normalMatrix;\n\t\t\tuniform vec3 cameraPosition;\n\n\t\t\tvarying vec2 vUv;\n\t\t\tvarying vec3 vColor;\n\n\t\t\t"+Yu.LinearToSrgb+"\n\t\t\t"+Yu.hsv+"\n\n\t\t\tvoid main() {\n\n\t\t\t\tvUv = uv;\n\n\t\t\t\tvColor = lookup(color.rgb);\n\n\t\t\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t\t}\n\t\t",fragmentShader:"\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tuniform float emission_gain;\n\n\t\t\tuniform sampler2D mainTex;\n\t\t\tuniform float alphaTest;\n\n\t\t\tvarying vec2 vUv;\n\t\t\tvarying vec3 vColor;\n\n\t\t\t"+Yu.BloomColor+"\n\t\t\t"+Yu.SrgbToLinear+"\n\n\t\t\tvoid main(){\n\t\t\t\tvec4 col = texture2D(mainTex, vUv);\n\t\t\t\tvec3 color = vColor;\n\t\t\t\tcolor = BloomColor(color, emission_gain);\n\t\t\t\tcolor = color * col.rgb;\n\t\t\t\tcolor = color * col.a;\n\t\t\t\tcolor = SrgbToLinear(color);\n\t\t\t\tgl_FragColor = vec4(color, 1.0);\n\t\t\t}\n\t\t",side:2,transparent:!0,depthFunc:2,depthWrite:!0,depthTest:!1,blending:5,blendDst:201,blendDstAlpha:201,blendEquation:100,blendEquationAlpha:100,blendSrc:201,blendSrcAlpha:201});default:return new e.MeshBasicMaterial({vertexColors:!0,side:e.DoubleSide})}}var Ku=function(t){e.Loader.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};Ku.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Ku,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){var t={attributeIDs:n.defaultAttributeIDs,attributeTypes:n.defaultAttributeTypes,useUniqueIDs:!1};n.decodeGeometry(e,t).then(r).catch(i)}),a,i)},decodeDracoFile:function(e,t,r,a){var i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:a||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)},decodeGeometry:function(e,t){var r=this;for(var a in t.attributeTypes){var i=t.attributeTypes[a];void 0!==i.BYTES_PER_ELEMENT&&(t.attributeTypes[a]=i.name)}var n,o=JSON.stringify(t);if(Ku.taskCache.has(e)){var s=Ku.taskCache.get(e);if(s.key===o)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var l=this.workerNextTaskID++,u=e.byteLength,c=this._getWorker(l,u).then((function(r){return n=r,new Promise((function(r,a){n._callbacks[l]={resolve:r,reject:a},n.postMessage({type:"decode",id:l,taskConfig:t,buffer:e},[e])}))})).then((function(e){return r._createGeometry(e.geometry)}));return c.catch((function(){return!0})).then((function(){n&&l&&r._releaseTask(n,l)})),Ku.taskCache.set(e,{key:o,promise:c}),c},_createGeometry:function(t){var r=new e.BufferGeometry;t.index&&r.setIndex(new e.BufferAttribute(t.index.array,1));for(var a=0;a<t.attributes.length;a++){var i=t.attributes[a],n=i.name,o=i.array,s=i.itemSize;r.setAttribute(n,new e.BufferAttribute(o,s))}return r},_loadLibrary:function(t,r){var a=new e.FileLoader(this.manager);return a.setPath(this.decoderPath),a.setResponseType(r),a.setWithCredentials(this.withCredentials),new Promise((function(e,r){a.load(t,e,void 0,r)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var a=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var i=Ku.DRACOWorker.toString(),n=["/* draco decoder */",a,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([n]))})),this.decoderPending},_getWorker:function(e,t){var r=this;return this._initDecoder().then((function(){var a;r.workerPool.length<r.workerLimit?((a=new Worker(r.workerSourceURL))._callbacks={},a._taskCosts={},a._taskLoad=0,a.postMessage({type:"init",decoderConfig:r.decoderConfig}),a.onmessage=function(e){var t=e.data;switch(t.type){case"decode":a._callbacks[t.id].resolve(t);break;case"error":a._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(a)):r.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(a=r.workerPool[r.workerPool.length-1])._taskCosts[e]=t,a._taskLoad+=t,a}))},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),Ku.DRACOWorker=function(){var e,t;function r(e,t,r,a,i,n){var o=n.num_components(),s=r.num_points()*o,l=s*i.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,n,u,l,c);var h=new i(e.HEAPF32.buffer,c,s).slice();return e._free(c),{name:a,array:h,itemSize:o}}onmessage=function(a){var i=a.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var n=i.buffer,o=i.taskConfig;t.then((function(e){var t=e.draco,a=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(n),n.byteLength);try{var l=function(e,t,a,i){var n,o,s=i.attributeIDs,l=i.attributeTypes,u=t.GetEncodedGeometryType(a);if(u===e.TRIANGULAR_MESH)n=new e.Mesh,o=t.DecodeBufferToMesh(a,n);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");n=new e.PointCloud,o=t.DecodeBufferToPointCloud(a,n)}if(!o.ok()||0===n.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var c={index:null,attributes:[]};for(var h in s){var d,f,p=self[l[h]];if(i.useUniqueIDs)f=s[h],d=t.GetAttributeByUniqueId(n,f);else{if(-1===(f=t.GetAttributeId(n,e[s[h]])))continue;d=t.GetAttribute(n,f)}c.attributes.push(r(e,t,n,h,p,d))}u===e.TRIANGULAR_MESH&&(c.index=function(e,t,r){var a=3*r.num_faces(),i=4*a,n=e._malloc(i);t.GetTrianglesUInt32Array(r,i,n);var o=new Uint32Array(e.HEAPF32.buffer,n,a).slice();return e._free(n),{array:o,itemSize:1}}(e,t,n));return e.destroy(n),c}(t,a,s,o),u=l.attributes.map((function(e){return e.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}finally{t.destroy(s),t.destroy(a)}}))}}},Ku.taskCache=new WeakMap,Ku.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},Ku.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},Ku.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},Ku.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};var qu=function(t){e.Loader.call(this,t),this.hdrLoader=new dl,this.type=e.UnsignedByteType};qu.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:qu,load:function(t,r,a,i){Array.isArray(t)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(t),t=r,r=a,a=i,i=arguments[4]);var n=new e.CubeTexture;switch(n.type=this.type,n.type){case e.UnsignedByteType:n.encoding=e.RGBEEncoding,n.format=e.RGBAFormat,n.minFilter=e.NearestFilter,n.magFilter=e.NearestFilter,n.generateMipmaps=!1;break;case e.FloatType:case e.HalfFloatType:n.encoding=e.LinearEncoding,n.format=e.RGBFormat,n.minFilter=e.LinearFilter,n.magFilter=e.LinearFilter,n.generateMipmaps=!1}var o=this,s=0;function l(r,a,i,l){new e.FileLoader(o.manager).setPath(o.path).setResponseType("arraybuffer").setWithCredentials(o.withCredentials).load(t[r],(function(t){s++;var i=o.hdrLoader.parse(t);if(i){if(void 0!==i.data){var l=new e.DataTexture(i.data,i.width,i.height);l.type=n.type,l.encoding=n.encoding,l.format=n.format,l.minFilter=n.minFilter,l.magFilter=n.magFilter,l.generateMipmaps=n.generateMipmaps,n.images[r]=l}6===s&&(n.needsUpdate=!0,a&&a(n))}}),i,l)}for(var u=0;u<t.length;u++)l(u,r,a,i);return n},setDataType:function(e){return this.type=e,this.hdrLoader.setDataType(e),this}});var Zu=function(t){e.Loader.call(this,t)};Zu.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Zu,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t){function r(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function a(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var r=parseInt(v[i].substr(e,t));if(r){var a=function(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}(b,r);void 0===p[a]&&(f.push([b-1,r-1,1]),p[a]=f.length-1)}}for(var o,s,l,u,c,h={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},d=[],f=[],p={},m={},v=t.split("\n"),g=0,y=v.length;g<y;g++)if("ATOM"===v[g].substr(0,4)||"HETATM"===v[g].substr(0,6)){o=parseFloat(v[g].substr(30,7)),s=parseFloat(v[g].substr(38,7)),l=parseFloat(v[g].substr(46,7)),u=parseInt(v[g].substr(6,5))-1,""===(c=r(v[g].substr(76,2)).toLowerCase())&&(c=r(v[g].substr(12,2)).toLowerCase());var x=[o,s,l,h[c],a(c)];d.push(x),m[u]=x}else if("CONECT"===v[g].substr(0,6)){var b=parseInt(v[g].substr(6,5));n(11,5),n(16,5),n(21,5),n(26,5)}return function(){var t,r,a,i,n,o={geometryAtoms:new e.BufferGeometry,geometryBonds:new e.BufferGeometry,json:{atoms:d}},s=o.geometryAtoms,l=o.geometryBonds,u=[],c=[],h=[];for(t=0,r=d.length;t<r;t++){var p=d[t];a=p[0],i=p[1],n=p[2],u.push(a,i,n);var v=p[3][0]/255,g=p[3][1]/255,y=p[3][2]/255;c.push(v,g,y)}for(t=0,r=f.length;t<r;t++){var x=f[t],b=x[0],A=x[1],w=m[b],M=m[A];a=w[0],i=w[1],n=w[2],h.push(a,i,n),a=M[0],i=M[1],n=M[2],h.push(a,i,n)}return s.setAttribute("position",new e.Float32BufferAttribute(u,3)),s.setAttribute("color",new e.Float32BufferAttribute(c,3)),l.setAttribute("position",new e.Float32BufferAttribute(h,3)),o}()}});var $u,ec,tc,rc=function(){var t=null;function r(){if(null===t){var e=new ArrayBuffer(2),r=new Uint8Array(e),a=new Uint16Array(e);r[0]=170,r[1]=187,t=43707===a[0]}return t}var a=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],i={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function n(e,t,a,n,o){var s,l=t.BYTES_PER_ELEMENT;if(o===r()||1===l)s=new t(e,a,n);else{var u=new DataView(e,a,n*l),c=i[t.name],h=!o,d=0;for(s=new t(n);d<n;d++)s[d]=u[c](d*l,h)}return s}function o(t){e.Loader.call(this,t)}return o.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:o,load:function(t,a,i,n){var o=this,s=new e.FileLoader(o.manager);s.setPath(o.path),s.setResponseType("arraybuffer"),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),t=t.replace(/\*/g,r()?"be":"le"),s.load(t,(function(e){try{a(o.parse(e))}catch(e){n?n(e):console.error(e),o.manager.itemError(t)}}),i,n)},parse:function(t){var r,i,o=function(e){var t=new Uint8Array(e),r=t[0],i=t[1],o=!!(i>>7&1),s=i>>6&1,l=1==(i>>5&1),u=31&i,c=0,h=0;if(l?(c=(t[2]<<16)+(t[3]<<8)+t[4],h=(t[5]<<16)+(t[6]<<8)+t[7]):(c=t[2]+(t[3]<<8)+(t[4]<<16),h=t[5]+(t[6]<<8)+(t[7]<<16)),0===r)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==r)throw new Error("PRWM decoder: Unsupported format version: "+r);if(!o){if(0!==s)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==h)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var d,f,p,m,v,g,y,x,b=8,A={};for(x=0;x<u;x++){for(d="";b<t.length&&(f=t[b],b++,0!==f);)d+=String.fromCharCode(f);p=(i=t[b])>>7&1,m=1+(i>>4&3),b++,g=n(e,v=a[15&i],b=4*Math.ceil(b/4),m*c,l),b+=v.BYTES_PER_ELEMENT*m*c,A[d]={type:p,cardinality:m,values:g}}return b=4*Math.ceil(b/4),y=null,o&&(y=n(e,1===s?Uint32Array:Uint16Array,b,h,l)),{version:r,attributes:A,indices:y}}(t),s=Object.keys(o.attributes),l=new e.BufferGeometry;for(i=0;i<s.length;i++)r=o.attributes[s[i]],l.setAttribute(s[i],new e.BufferAttribute(r.values,r.cardinality,r.normalized));return null!==o.indices&&l.setIndex(new e.BufferAttribute(o.indices,1)),l}}),o.isBigEndianPlatform=function(){return r()},o}(),ac=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.loadCubemap=function(t,r,a,i){var n=new e.CubeTexture,o=0,s=this;function l(e){s.load(t[e],(function(t){n.images[e]=t,6===++o&&(n.needsUpdate=!0,r&&r(n))}),void 0,i)}for(var u=0;u<t.length;++u)l(u);return n.encoding=e.RGBM7Encoding,n.format=e.RGBAFormat,n.minFilter=e.LinearFilter,n.generateMipmaps=!1,n},a.parse=function(t){var r=ic.decode(t),a=ic.toRGBA8(r)[0];return{width:r.width,height:r.height,data:new Uint8Array(a),format:e.RGBAFormat,type:e.UnsignedByteType,flipY:!0,encoding:e.RGBM7Encoding}},r}(e.DataTextureLoader),ic={};ic.toRGBA8=function(e){var t=e.width,r=e.height;if(null==e.tabs.acTL)return[ic.toRGBA8.decodeImage(e.data,t,r,e).buffer];var a=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var i=t*r*4,n=new Uint8Array(i),o=new Uint8Array(i),s=new Uint8Array(i),l=0;l<e.frames.length;l++){var u=e.frames[l],c=u.rect.x,h=u.rect.y,d=u.rect.width,f=u.rect.height,p=ic.toRGBA8.decodeImage(u.data,d,f,e);if(0!=l)for(var m=0;m<i;m++)s[m]=n[m];if(0==u.blend?ic._copyTile(p,d,f,n,t,r,c,h,0):1==u.blend&&ic._copyTile(p,d,f,n,t,r,c,h,1),a.push(n.buffer.slice(0)),0==u.dispose);else if(1==u.dispose)ic._copyTile(o,d,f,n,t,r,c,h,0);else if(2==u.dispose)for(var v=0;v<i;v++)n[v]=s[v]}return a},ic.toRGBA8.decodeImage=function(e,t,r,a){var n=t*r,o=ic.decode._getBPP(a),s=Math.ceil(t*o/8),l=new Uint8Array(4*n),u=new Uint32Array(l.buffer),c=a.ctype,h=a.depth,d=ic._bin.readUshort;if(6==c){var f=n<<2;if(8==h)for(var p=0;p<f;p+=4)l[p]=e[p],l[p+1]=e[p+1],l[p+2]=e[p+2],l[p+3]=e[p+3];if(16==h)for(var m=0;m<f;m++)l[m]=e[m<<1]}else if(2==c){var v=a.tabs.tRNS;if(null==v){if(8==h)for(var g=0;g<n;g++){var y=3*g;u[g]=255<<24|e[y+2]<<16|e[y+1]<<8|e[y]}if(16==h)for(var x=0;x<n;x++){y=6*x;u[x]=255<<24|e[y+4]<<16|e[y+2]<<8|e[y]}}else{var b=v[0],A=v[1],w=v[2];if(8==h)for(var M=0;M<n;M++){var S=M<<2;y=3*M;u[M]=255<<24|e[y+2]<<16|e[y+1]<<8|e[y],e[y]==b&&e[y+1]==A&&e[y+2]==w&&(l[S+3]=0)}if(16==h)for(var T=0;T<n;T++){S=T<<2,y=6*T;u[T]=255<<24|e[y+4]<<16|e[y+2]<<8|e[y],d(e,y)==b&&d(e,y+2)==A&&d(e,y+4)==w&&(l[S+3]=0)}}}else if(3==c){var C=a.tabs.PLTE,F=a.tabs.tRNS,E=F?F.length:0;if(1==h)for(var B=0;B<r;B++)for(var L=B*s,P=B*t,D=0;D<t;D++){S=P+D<<2;var N=3*(k=e[L+(D>>3)]>>7-((7&D)<<0)&1);l[S]=C[N],l[S+1]=C[N+1],l[S+2]=C[N+2],l[S+3]=k<E?F[k]:255}if(2==h)for(var R=0;R<r;R++){L=R*s,P=R*t;for(var _=0;_<t;_++){S=P+_<<2,N=3*(k=e[L+(_>>2)]>>6-((3&_)<<1)&3);l[S]=C[N],l[S+1]=C[N+1],l[S+2]=C[N+2],l[S+3]=k<E?F[k]:255}}if(4==h)for(var I=0;I<r;I++){L=I*s,P=I*t;for(var O=0;O<t;O++){S=P+O<<2,N=3*(k=e[L+(O>>1)]>>4-((1&O)<<2)&15);l[S]=C[N],l[S+1]=C[N+1],l[S+2]=C[N+2],l[S+3]=k<E?F[k]:255}}if(8==h)for(var U=0;U<n;U++){var k;S=U<<2,N=3*(k=e[U]);l[S]=C[N],l[S+1]=C[N+1],l[S+2]=C[N+2],l[S+3]=k<E?F[k]:255}}else if(4==c){if(8==h)for(var V=0;V<n;V++){S=V<<2;var G=e[z=V<<1];l[S]=G,l[S+1]=G,l[S+2]=G,l[S+3]=e[z+1]}if(16==h)for(var j=0;j<n;j++){var z;S=j<<2,G=e[z=j<<2];l[S]=G,l[S+1]=G,l[S+2]=G,l[S+3]=e[z+2]}}else if(0==c){b=a.tabs.tRNS?a.tabs.tRNS:-1;for(var H=0;H<r;H++){var W=H*s,X=H*t;if(1==h)for(var Q=0;Q<t;Q++){var Y=(G=255*(e[W+(Q>>>3)]>>>7-(7&Q)&1))==255*b?0:255;u[X+Q]=Y<<24|G<<16|G<<8|G}else if(2==h)for(var J=0;J<t;J++){Y=(G=85*(e[W+(J>>>2)]>>>6-((3&J)<<1)&3))==85*b?0:255;u[X+J]=Y<<24|G<<16|G<<8|G}else if(4==h)for(var K=0;K<t;K++){Y=(G=17*(e[W+(K>>>1)]>>>4-((1&K)<<2)&15))==17*b?0:255;u[X+K]=Y<<24|G<<16|G<<8|G}else if(8==h)for(var q=0;q<t;q++){Y=(G=e[W+q])==b?0:255;u[X+q]=Y<<24|G<<16|G<<8|G}else if(16==h)for(var Z=0;Z<t;Z++){G=e[W+(Z<<1)],Y=d(e,W+(Z<<i))==b?0:255;u[X+Z]=Y<<24|G<<16|G<<8|G}}}return l},ic.decode=function(e){for(var t,r=new Uint8Array(e),a=8,i=ic._bin,n=i.readUshort,o=i.readUint,s={tabs:{},frames:[]},l=new Uint8Array(r.length),u=0,c=0,h=[137,80,78,71,13,10,26,10],d=0;d<8;d++)if(r[d]!=h[d])throw"The input is not a PNG file!";for(;a<r.length;){var f=i.readUint(r,a);a+=4;var p=i.readASCII(r,a,4);if(a+=4,"IHDR"==p)ic.decode._IHDR(r,a,s);else if("CgBI"==p)s.tabs[p]=r.slice(a,a+4);else if("IDAT"==p){for(var m=0;m<f;m++)l[u+m]=r[a+m];u+=f}else if("acTL"==p)s.tabs[p]={num_frames:o(r,a),num_plays:o(r,a+4)},t=new Uint8Array(r.length);else if("fcTL"==p){var v;if(0!=c)(v=s.frames[s.frames.length-1]).data=ic.decode._decompress(s,t.slice(0,c),v.rect.width,v.rect.height),c=0;var g={x:o(r,a+12),y:o(r,a+16),width:o(r,a+4),height:o(r,a+8)},y=n(r,a+22);y=n(r,a+20)/(0==y?100:y);var x={rect:g,delay:Math.round(1e3*y),dispose:r[a+24],blend:r[a+25]};s.frames.push(x)}else if("fdAT"==p){for(var b=0;b<f-4;b++)t[c+b]=r[a+b+4];c+=f-4}else if("pHYs"==p)s.tabs[p]=[i.readUint(r,a),i.readUint(r,a+4),r[a+8]];else if("cHRM"==p){s.tabs[p]=[];for(var A=0;A<8;A++)s.tabs[p].push(i.readUint(r,a+4*A))}else if("tEXt"==p||"zTXt"==p){null==s.tabs[p]&&(s.tabs[p]={});var w=i.nextZero(r,a),M=i.readASCII(r,a,w-a),S=a+f-w-1;if("tEXt"==p)E=i.readASCII(r,w+1,S);else{var T=ic.decode._inflate(r.slice(w+2,w+2+S));E=i.readUTF8(T,0,T.length)}s.tabs[p][M]=E}else if("iTXt"==p){null==s.tabs[p]&&(s.tabs[p]={});w=0;var C=a;w=i.nextZero(r,C);M=i.readASCII(r,C,w-C);var F=r[C=w+1];C+=2,w=i.nextZero(r,C),i.readASCII(r,C,w-C),C=w+1,w=i.nextZero(r,C),i.readUTF8(r,C,w-C);var E;S=f-((C=w+1)-a);if(0==F)E=i.readUTF8(r,C,S);else{T=ic.decode._inflate(r.slice(C,C+S));E=i.readUTF8(T,0,T.length)}s.tabs[p][M]=E}else if("PLTE"==p)s.tabs[p]=i.readBytes(r,a,f);else if("hIST"==p){var B=s.tabs.PLTE.length/3;s.tabs[p]=[];for(var L=0;L<B;L++)s.tabs[p].push(n(r,a+2*L))}else if("tRNS"==p)3==s.ctype?s.tabs[p]=i.readBytes(r,a,f):0==s.ctype?s.tabs[p]=n(r,a):2==s.ctype&&(s.tabs[p]=[n(r,a),n(r,a+2),n(r,a+4)]);else if("gAMA"==p)s.tabs[p]=i.readUint(r,a)/1e5;else if("sRGB"==p)s.tabs[p]=r[a];else if("bKGD"==p)0==s.ctype||4==s.ctype?s.tabs[p]=[n(r,a)]:2==s.ctype||6==s.ctype?s.tabs[p]=[n(r,a),n(r,a+2),n(r,a+4)]:3==s.ctype&&(s.tabs[p]=r[a]);else if("IEND"==p)break;a+=f,i.readUint(r,a),a+=4}0!=c&&((v=s.frames[s.frames.length-1]).data=ic.decode._decompress(s,t.slice(0,c),v.rect.width,v.rect.height),c=0);return s.data=ic.decode._decompress(s,l,s.width,s.height),delete s.compress,delete s.interlace,delete s.filter,s},ic.decode._decompress=function(e,t,r,a){var i=ic.decode._getBPP(e),n=Math.ceil(r*i/8),o=new Uint8Array((n+1+e.interlace)*a);return t=e.tabs.CgBI?ic.inflateRaw(t,o):ic.decode._inflate(t,o),0==e.interlace?t=ic.decode._filterZero(t,e,0,r,a):1==e.interlace&&(t=ic.decode._readInterlace(t,e)),t},ic.decode._inflate=function(e,t){return ic.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),t)},ic.inflateRaw=((tc={}).H={},tc.H.N=function(e,t){var r,a,i=Uint8Array,n=0,o=0,s=0,l=0,u=0,c=0,h=0,d=0,f=0;if(3==e[0]&&0==e[1])return t||new i(0);var p=tc.H,m=p.b,v=p.e,g=p.R,y=p.n,x=p.A,b=p.Z,A=p.m,w=null==t;for(w&&(t=new i(e.length>>>2<<5));0==n;)if(n=m(e,f,1),o=m(e,f+1,2),f+=3,0!=o){if(w&&(t=tc.H.W(t,d+(1<<17))),1==o&&(r=A.J,a=A.h,c=511,h=31),2==o){s=v(e,f,5)+257,l=v(e,f+5,5)+1,u=v(e,f+10,4)+4,f+=14;for(var M=1,S=0;S<38;S+=2)A.Q[S]=0,A.Q[S+1]=0;for(var T=0;T<u;T++){var C=v(e,f+3*T,3);A.Q[1+(A.X[T]<<1)]=C,C>M&&(M=C)}f+=3*u,y(A.Q,M),x(A.Q,M,A.u),r=A.w,a=A.d,f=g(A.u,(1<<M)-1,s+l,e,f,A.v);var F=p.V(A.v,0,s,A.C);c=(1<<F)-1;var E=p.V(A.v,s,l,A.D);h=(1<<E)-1,y(A.C,F),x(A.C,F,r),y(A.D,E),x(A.D,E,a)}for(;;){var B=r[b(e,f)&c];f+=15&B;var L=B>>>4;if(L>>>8==0)t[d++]=L;else{if(256==L)break;var P=d+L-254;if(L>264){var D=A.q[L-257];P=d+(D>>>3)+v(e,f,7&D),f+=7&D}var N=a[b(e,f)&h];f+=15&N;var R=N>>>4,_=A.c[R],I=(_>>>4)+m(e,f,15&_);for(f+=15&_;d<P;)t[d]=t[d++-I],t[d]=t[d++-I],t[d]=t[d++-I],t[d]=t[d++-I];d=P}}}else{0!=(7&f)&&(f+=8-(7&f));var O=4+(f>>>3),U=e[O-4]|e[O-3]<<8;w&&(t=tc.H.W(t,d+U)),t.set(new i(e.buffer,e.byteOffset+O,U),d),f=O+U<<3,d+=U}return t.length==d?t:t.slice(0,d)},tc.H.W=function(e,t){var r=e.length;if(t<=r)return e;var a=new Uint8Array(r<<1);return a.set(e,0),a},tc.H.R=function(e,t,r,a,i,n){for(var o=tc.H.e,s=tc.H.Z,l=0;l<r;){var u=e[s(a,i)&t];i+=15&u;var c=u>>>4;if(c<=15)n[l]=c,l++;else{var h=0,d=0;16==c?(d=3+o(a,i,2),i+=2,h=n[l-1]):17==c?(d=3+o(a,i,3),i+=3):18==c&&(d=11+o(a,i,7),i+=7);for(var f=l+d;l<f;)n[l]=h,l++}}return i},tc.H.V=function(e,t,r,a){for(var i=0,n=0,o=a.length>>>1;n<r;){var s=e[n+t];a[n<<1]=0,a[1+(n<<1)]=s,s>i&&(i=s),n++}for(;n<o;)a[n<<1]=0,a[1+(n<<1)]=0,n++;return i},tc.H.n=function(e,t){for(var r,a,i,n,o,s=tc.H.m,l=e.length,u=s.j,c=0;c<=t;c++)u[c]=0;for(n=1;n<l;n+=2)u[e[n]]++;var h=s.K;for(r=0,u[0]=0,a=1;a<=t;a++)r=r+u[a-1]<<1,h[a]=r;for(i=0;i<l;i+=2)0!=(o=e[i+1])&&(e[i]=h[o],h[o]++)},tc.H.A=function(e,t,r){for(var a=e.length,i=tc.H.m.r,n=0;n<a;n+=2)if(0!=e[n+1])for(var o=n>>1,s=e[n+1],l=o<<4|s,u=t-s,c=e[n]<<u,h=c+(1<<u);c!=h;)r[i[c]>>>15-t]=l,c++},tc.H.l=function(e,t){for(var r=tc.H.m.r,a=15-t,i=0;i<e.length;i+=2){var n=e[i]<<t-e[i+1];e[i]=r[n]>>>a}},tc.H.M=function(e,t,r){r<<=7&t;var a=t>>>3;e[a]|=r,e[a+1]|=r>>>8},tc.H.I=function(e,t,r){r<<=7&t;var a=t>>>3;e[a]|=r,e[a+1]|=r>>>8,e[a+2]|=r>>>16},tc.H.e=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<r)-1},tc.H.b=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<r)-1},tc.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},tc.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},tc.H.m=($u=Uint16Array,ec=Uint32Array,{K:new $u(16),j:new $u(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new $u(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new ec(32),J:new $u(512),_:[],h:new $u(32),$:[],w:new $u(32768),C:[],v:[],d:new $u(32768),D:[],u:new $u(512),Q:[],r:new $u(32768),s:new ec(286),Y:new ec(30),a:new ec(19),t:new ec(15e3),k:new $u(65536),g:new $u(32768)}),function(){for(var e=tc.H.m,t=0;t<32768;t++){var r=t;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,e.r[t]=(r>>>16|r<<16)>>>17}function a(e,t,r){for(;0!=t--;)e.push(0,r)}for(var i=0;i<32;i++)e.q[i]=e.S[i]<<3|e.T[i],e.c[i]=e.p[i]<<4|e.z[i];a(e._,144,8),a(e._,112,9),a(e._,24,7),a(e._,8,8),tc.H.n(e._,9),tc.H.A(e._,9,e.J),tc.H.l(e._,9),a(e.$,32,5),tc.H.n(e.$,5),tc.H.A(e.$,5,e.h),tc.H.l(e.$,5),a(e.Q,19,0),a(e.C,286,0),a(e.D,30,0),a(e.v,320,0)}(),tc.H.N),ic.decode._readInterlace=function(e,t){for(var r=t.width,a=t.height,i=ic.decode._getBPP(t),n=i>>3,o=Math.ceil(r*i/8),s=new Uint8Array(a*o),l=0,u=[0,0,4,0,2,0,1],c=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],d=[8,8,4,4,2,2,1],f=0;f<7;){for(var p=h[f],m=d[f],v=0,g=0,y=u[f];y<a;)y+=p,g++;for(var x=c[f];x<r;)x+=m,v++;var b=Math.ceil(v*i/8);ic.decode._filterZero(e,t,l,v,g);for(var A=0,w=u[f];w<a;){for(var M=c[f],S=l+A*b<<3;M<r;){var T;if(1==i)T=(T=e[S>>3])>>7-(7&S)&1,s[w*o+(M>>3)]|=T<<7-((7&M)<<0);if(2==i)T=(T=e[S>>3])>>6-(7&S)&3,s[w*o+(M>>2)]|=T<<6-((3&M)<<1);if(4==i)T=(T=e[S>>3])>>4-(7&S)&15,s[w*o+(M>>1)]|=T<<4-((1&M)<<2);if(i>=8)for(var C=w*o+M*n,F=0;F<n;F++)s[C+F]=e[(S>>3)+F];S+=i,M+=m}A++,w+=p}v*g!=0&&(l+=g*(1+b)),f+=1}return s},ic.decode._getBPP=function(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth},ic.decode._filterZero=function(e,t,r,a,i){var n=ic.decode._getBPP(t),o=Math.ceil(a*n/8),s=ic.decode._paeth;n=Math.ceil(n/8);var l=0,u=1,c=e[r],h=0;if(c>1&&(e[r]=[0,0,1][c-2]),3==c)for(h=n;h<o;h++)e[h+1]=e[h+1]+(e[h+1-n]>>>1)&255;for(var d=0;d<i;d++)if(h=0,0==(c=e[(u=(l=r+d*o)+d+1)-1]))for(;h<o;h++)e[l+h]=e[u+h];else if(1==c){for(;h<n;h++)e[l+h]=e[u+h];for(;h<o;h++)e[l+h]=e[u+h]+e[l+h-n]}else if(2==c)for(;h<o;h++)e[l+h]=e[u+h]+e[l+h-o];else if(3==c){for(;h<n;h++)e[l+h]=e[u+h]+(e[l+h-o]>>>1);for(;h<o;h++)e[l+h]=e[u+h]+(e[l+h-o]+e[l+h-n]>>>1)}else{for(;h<n;h++)e[l+h]=e[u+h]+s(0,e[l+h-o],0);for(;h<o;h++)e[l+h]=e[u+h]+s(e[l+h-n],e[l+h-o],e[l+h-n-o])}return e},ic.decode._paeth=function(e,t,r){var a=e+t-r,i=a-e,n=a-t,o=a-r;return i*i<=n*n&&i*i<=o*o?e:n*n<=o*o?t:r},ic.decode._IHDR=function(e,t,r){var a=ic._bin;r.width=a.readUint(e,t),t+=4,r.height=a.readUint(e,t),t+=4,r.depth=e[t],t++,r.ctype=e[t],t++,r.compress=e[t],t++,r.filter=e[t],t++,r.interlace=e[t],t++},ic._bin={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},readUint:function(e,t){return 16777216*e[t]+(e[t+1]<<16|e[t+2]<<8|e[t+3])},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},readASCII:function(e,t,r){for(var a="",i=0;i<r;i++)a+=String.fromCharCode(e[t+i]);return a},writeASCII:function(e,t,r){for(var a=0;a<r.length;a++)e[t+a]=r.charCodeAt(a)},readBytes:function(e,t,r){for(var a=[],i=0;i<r;i++)a.push(e[t+i]);return a},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,r){for(var a,i="",n=0;n<r;n++)i+="%"+ic._bin.pad(e[t+n].toString(16));try{a=decodeURIComponent(i)}catch(a){return ic._bin.readASCII(e,t,r)}return a}},ic._copyTile=function(e,t,r,a,i,n,o,s,l){for(var u=Math.min(t,i),c=Math.min(r,n),h=0,d=0,f=0;f<c;f++)for(var p=0;p<u;p++)if(o>=0&&s>=0?(h=f*t+p<<2,d=(s+f)*i+o+p<<2):(h=(-s+f)*t-o+p<<2,d=f*i+p<<2),0==l)a[d]=e[h],a[d+1]=e[h+1],a[d+2]=e[h+2],a[d+3]=e[h+3];else if(1==l){var m=e[h+3]*(1/255),v=e[h]*m,g=e[h+1]*m,y=e[h+2]*m,x=a[d+3]*(1/255),b=a[d]*x,A=a[d+1]*x,w=a[d+2]*x,M=1-m,S=m+x*M,T=0==S?0:1/S;a[d+3]=255*S,a[d+0]=(v+b*M)*T,a[d+1]=(g+A*M)*T,a[d+2]=(y+w*M)*T}else if(2==l){m=e[h+3],v=e[h],g=e[h+1],y=e[h+2],x=a[d+3],b=a[d],A=a[d+1],w=a[d+2];m==x&&v==b&&g==A&&y==w?(a[d]=0,a[d+1]=0,a[d+2]=0,a[d+3]=0):(a[d]=v,a[d+1]=g,a[d+2]=y,a[d+3]=m)}else if(3==l){m=e[h+3],v=e[h],g=e[h+1],y=e[h+2],x=a[d+3],b=a[d],A=a[d+1],w=a[d+2];if(m==x&&v==b&&g==A&&y==w)continue;if(m<220&&x>20)return!1}return!0};var nc=function(t){function r(){return t.apply(this,arguments)||this}g.default(r,t);var a=r.prototype;return a.load=function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},a.parse=function(e){var t=new DataView(e),r=t.getUint32(0,!0),a=t.getUint32(4,!0);if(542658390===r&&150===a){for(var i,n=[0,4294967295,4291624959,4288282623,4284940287,4281597951,4278255615,4294954239,4291611903,4288269567,4284927231,4281584895,4278242559,4294941183,4291598847,4288256511,4284914175,4281571839,4278229503,4294928127,4291585791,4288243455,4284901119,4281558783,4278216447,4294915071,4291572735,4288230399,4284888063,4281545727,4278203391,4294902015,4291559679,4288217343,4284875007,4281532671,4278190335,4294967244,4291624908,4288282572,4284940236,4281597900,4278255564,4294954188,4291611852,4288269516,4284927180,4281584844,4278242508,4294941132,4291598796,4288256460,4284914124,4281571788,4278229452,4294928076,4291585740,4288243404,4284901068,4281558732,4278216396,4294915020,4291572684,4288230348,4284888012,4281545676,4278203340,4294901964,4291559628,4288217292,4284874956,4281532620,4278190284,4294967193,4291624857,4288282521,4284940185,4281597849,4278255513,4294954137,4291611801,4288269465,4284927129,4281584793,4278242457,4294941081,4291598745,4288256409,4284914073,4281571737,4278229401,4294928025,4291585689,4288243353,4284901017,4281558681,4278216345,4294914969,4291572633,4288230297,4284887961,4281545625,4278203289,4294901913,4291559577,4288217241,4284874905,4281532569,4278190233,4294967142,4291624806,4288282470,4284940134,4281597798,4278255462,4294954086,4291611750,4288269414,4284927078,4281584742,4278242406,4294941030,4291598694,4288256358,4284914022,4281571686,4278229350,4294927974,4291585638,4288243302,4284900966,4281558630,4278216294,4294914918,4291572582,4288230246,4284887910,4281545574,4278203238,4294901862,4291559526,4288217190,4284874854,4281532518,4278190182,4294967091,4291624755,4288282419,4284940083,4281597747,4278255411,4294954035,4291611699,4288269363,4284927027,4281584691,4278242355,4294940979,4291598643,4288256307,4284913971,4281571635,4278229299,4294927923,4291585587,4288243251,4284900915,4281558579,4278216243,4294914867,4291572531,4288230195,4284887859,4281545523,4278203187,4294901811,4291559475,4288217139,4284874803,4281532467,4278190131,4294967040,4291624704,4288282368,4284940032,4281597696,4278255360,4294953984,4291611648,4288269312,4284926976,4281584640,4278242304,4294940928,4291598592,4288256256,4284913920,4281571584,4278229248,4294927872,4291585536,4288243200,4284900864,4281558528,4278216192,4294914816,4291572480,4288230144,4284887808,4281545472,4278203136,4294901760,4291559424,4288217088,4284874752,4281532416,4278190318,4278190301,4278190267,4278190250,4278190216,4278190199,4278190165,4278190148,4278190114,4278190097,4278251008,4278246656,4278237952,4278233600,4278224896,4278220544,4278211840,4278207488,4278198784,4278194432,4293787648,4292673536,4290445312,4289331200,4287102976,4285988864,4283760640,4282646528,4280418304,4279304192,4293848814,4292730333,4290493371,4289374890,4287137928,4286019447,4283782485,4282664004,4280427042,4279308561],o=8,s=[];o<t.byteLength;){for(var l="",u=0;u<4;u++)l+=String.fromCharCode(t.getUint8(o++,!0));var c=t.getUint32(o,!0);if(o+=4,t.getUint32(o,!0),o+=4,"SIZE"===l){var h=t.getUint32(o,!0);o+=4;var d=t.getUint32(o,!0);o+=4;var f=t.getUint32(o,!0);o+=4,i={palette:n,size:{x:h,y:d,z:f}},s.push(i),o+=c-12}else if("XYZI"===l){var p=t.getUint32(o,!0);o+=4,i.data=new Uint8Array(e,o,4*p),o+=4*p}else if("RGBA"===l){for(var m=[0],v=0;v<256;v++)m[v+1]=t.getUint32(o,!0),o+=4;i.palette=m}else o+=c}return s}console.error("Not a valid VOX file")},r}(e.Loader),oc=function(t){function r(r){var a=r.data,i=r.size,n=r.palette,o=[],s=[],l=[0,0,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1],u=[1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0],c=[0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1],h=[0,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0],d=[0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0],f=[0,1,1,1,1,1,0,1,0,1,1,0,0,1,0,1,1,1];function p(e,t,r,a,n,l,u){t-=i.x/2,r-=i.z/2,a+=i.y/2;for(var c=0;c<18;c+=3)o.push(e[c+0]+t,e[c+1]+r,e[c+2]+a),s.push(n,l,u)}for(var m=i.x,v=i.x*i.y,g=new Uint8Array(i.x*i.y*i.z),y=0;y<a.length;y+=4){g[a[y+0]+a[y+1]*m+a[y+2]*v]=255}for(var x=!1,b=0;b<a.length;b+=4){var A=a[b+0],w=a[b+1],M=a[b+2],S=n[a[b+3]],T=(S>>0&255)/255,C=(S>>8&255)/255,F=(S>>16&255)/255;(T>0||C>0||F>0)&&(x=!0);var E=A+w*m+M*v;0!==g[E+1]&&A!==i.x-1||p(u,A,M,-w,T,C,F),0!==g[E-1]&&0!==A||p(l,A,M,-w,T,C,F),0!==g[E+m]&&w!==i.y-1||p(h,A,M,-w,T,C,F),0!==g[E-m]&&0!==w||p(c,A,M,-w,T,C,F),0!==g[E+v]&&M!==i.z-1||p(f,A,M,-w,T,C,F),0!==g[E-v]&&0!==M||p(d,A,M,-w,T,C,F)}var B=new e.BufferGeometry;B.setAttribute("position",new e.Float32BufferAttribute(o,3)),B.computeVertexNormals();var L=new e.MeshStandardMaterial;return x&&(B.setAttribute("color",new e.Float32BufferAttribute(s,3)),L.vertexColors=!0),t.call(this,B,L)||this}return g.default(r,t),r}(e.Mesh),sc=function(t){function r(r){for(var a,i=r.data,n=r.size,o=n.x,s=n.x*n.y,l=new Uint8Array(n.x*n.y*n.z),u=0;u<i.length;u+=4){l[i[u+0]+i[u+1]*o+i[u+2]*s]=255}return(a=t.call(this,l,n.x,n.y,n.z)||this).format=e.RedFormat,a.minFilter=e.NearestFilter,a.magFilter=e.LinearFilter,a.unpackAlignment=1,a}return g.default(r,t),r}(e.DataTexture3D),lc=function(t,r){this.manager=void 0!==t?t:e.DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=r||{}},uc={replaceUUIDObject:function(e,t,r,a){if(a=void 0===a||a,"object"==typeof t&&(t=t.uuid),"object"==typeof e)for(var i=Object.keys(e),n=0;n<i.length;n++){var o=i[n];a&&(e[o]=this.replaceUUIDObject(e[o],t,r)),o===t&&(e[t]=e[o],delete e[o])}return e===t?r:e},replaceUUID:function(e,t,r){return this.replaceUUIDObject(e,t,r,!1),this.replaceUUIDObject(e.nodes,t,r),this.replaceUUIDObject(e.materials,t,r),this.replaceUUIDObject(e.passes,t,r),this.replaceUUIDObject(e.library,t,r,!1),e}};Object.assign(lc.prototype,{load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);return o.setPath(n.path),o.load(t,(function(e){r(n.parse(JSON.parse(e)))}),a,i),this},setPath:function(e){return this.path=e,this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=this.resolve(e[t]);else for(var r in e)"uuid"!==r&&(e[r]=this.resolve(e[r]))}return e},declare:function(e){var t,r,a;for(t in e.nodes)r=e.nodes[t],a=new Hr[r.nodeType+"Node"],r.name&&(a.name=r.name,this.names[a.name]=a),this.nodes[t]=a;for(t in e.materials)r=e.materials[t],a=new Hr[r.type],r.name&&(a.name=r.name,this.names[a.name]=a),this.materials[t]=a;for(t in e.passes)r=e.passes[t],a=new Hr[r.type],r.name&&(a.name=r.name,this.names[a.name]=a),this.passes[t]=a;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){var t;for(t in(e=this.resolve(this.declare(e))).nodes)this.nodes[t].copy(e.nodes[t]);for(t in e.materials)this.materials[t].copy(e.materials[t]);for(t in e.passes)this.passes[t].copy(e.passes[t]);return this.material||this.pass||this}});var cc,hc=function(t){e.Loader.call(this,t),this.littleEndian=!0};hc.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:hc,load:function(t,r,a,i){var n=this,o=new e.FileLoader(n.manager);o.setPath(n.path),o.setResponseType("arraybuffer"),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials),o.load(t,(function(e){try{r(n.parse(e,t))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t,r){var a=e.LoaderUtils.decodeText(new Uint8Array(t)),i=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),a=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=a[1],t.headerLen=a[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map((function(e){return parseInt(e,10)}))),null!==t.count)t.count=t.count[1].split(" ").map((function(e){return parseInt(e,10)}));else{t.count=[];for(var i=0,n=t.fields.length;i<n;i++)t.count.push(1)}t.offset={};for(var o=0,s=0,l=t.fields.length;s<l;s++)"ascii"===t.data?t.offset[t.fields[s]]=s:(t.offset[t.fields[s]]=o,o+=t.size[s]*t.count[s]);return t.rowSize=o,t}(a),n=[],o=[],s=[];if("ascii"===i.data)for(var l=i.offset,u=a.substr(i.headerLen).split("\n"),c=0,h=u.length;c<h;c++)if(""!==u[c]){var d=u[c].split(" ");if(void 0!==l.x&&(n.push(parseFloat(d[l.x])),n.push(parseFloat(d[l.y])),n.push(parseFloat(d[l.z]))),void 0!==l.rgb){var f=parseFloat(d[l.rgb]),p=f>>16&255,m=f>>8&255,v=f>>0&255;s.push(p/255,m/255,v/255)}void 0!==l.normal_x&&(o.push(parseFloat(d[l.normal_x])),o.push(parseFloat(d[l.normal_y])),o.push(parseFloat(d[l.normal_z])))}if("binary_compressed"===i.data)for(var g=new Uint32Array(t.slice(i.headerLen,i.headerLen+8)),y=g[0],x=g[1],b=function(e,t){var r,a,i,n=e.length,o=new Uint8Array(t),s=0,l=0;do{if((r=e[s++])<32){if(l+ ++r>t)throw new Error("Output buffer is not large enough");if(s+r>n)throw new Error("Invalid compressed data");do{o[l++]=e[s++]}while(--r)}else{if(a=r>>5,i=l-((31&r)<<8)-1,s>=n)throw new Error("Invalid compressed data");if(7===a&&(a+=e[s++],s>=n))throw new Error("Invalid compressed data");if(i-=e[s++],l+a+2>t)throw new Error("Output buffer is not large enough");if(i<0)throw new Error("Invalid compressed data");if(i>=l)throw new Error("Invalid compressed data");do{o[l++]=o[i++]}while(2+--a)}}while(s<n);return o}(new Uint8Array(t,i.headerLen+8,y),x),A=new DataView(b.buffer),w=(l=i.offset,0);w<i.points;w++)void 0!==l.x&&(n.push(A.getFloat32(i.points*l.x+i.size[0]*w,this.littleEndian)),n.push(A.getFloat32(i.points*l.y+i.size[1]*w,this.littleEndian)),n.push(A.getFloat32(i.points*l.z+i.size[2]*w,this.littleEndian))),void 0!==l.rgb&&(s.push(A.getUint8(i.points*l.rgb+i.size[3]*w+0)/255),s.push(A.getUint8(i.points*l.rgb+i.size[3]*w+1)/255),s.push(A.getUint8(i.points*l.rgb+i.size[3]*w+2)/255)),void 0!==l.normal_x&&(o.push(A.getFloat32(i.points*l.normal_x+i.size[4]*w,this.littleEndian)),o.push(A.getFloat32(i.points*l.normal_y+i.size[5]*w,this.littleEndian)),o.push(A.getFloat32(i.points*l.normal_z+i.size[6]*w,this.littleEndian)));if("binary"===i.data){A=new DataView(t,i.headerLen),l=i.offset;for(var M=0,S=0;M<i.points;M++,S+=i.rowSize)void 0!==l.x&&(n.push(A.getFloat32(S+l.x,this.littleEndian)),n.push(A.getFloat32(S+l.y,this.littleEndian)),n.push(A.getFloat32(S+l.z,this.littleEndian))),void 0!==l.rgb&&(s.push(A.getUint8(S+l.rgb+2)/255),s.push(A.getUint8(S+l.rgb+1)/255),s.push(A.getUint8(S+l.rgb+0)/255)),void 0!==l.normal_x&&(o.push(A.getFloat32(S+l.normal_x,this.littleEndian)),o.push(A.getFloat32(S+l.normal_y,this.littleEndian)),o.push(A.getFloat32(S+l.normal_z,this.littleEndian)))}var T=new e.BufferGeometry;n.length>0&&T.setAttribute("position",new e.Float32BufferAttribute(n,3)),o.length>0&&T.setAttribute("normal",new e.Float32BufferAttribute(o,3)),s.length>0&&T.setAttribute("color",new e.Float32BufferAttribute(s,3)),T.computeBoundingSphere();var C=new e.PointsMaterial({size:.005});s.length>0?C.vertexColors=!0:C.color.setHex(16777215*Math.random());var F=new e.Points(T,C),E=r.split("").reverse().join("");return E=(E=/([^\/]*)/.exec(E))[1].split("").reverse().join(""),F.name=E,F}});var dc=function(t,r){e.Loader.call(this,t),r=r||{},this.resourcePath=void 0!==r.resourcePath?r.resourcePath:""};function fc(e){this.textureLoader=e}function pc(e){this.textureLoader=e}function mc(){}dc.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:dc,load:function(t,r,a,i){var n=this,o=""===n.path?function(e,t){var r=e.indexOf(t);return-1===r?"./":e.substr(0,r)}(t,"Objects"):n.path,s=t.split(o).pop().split(".")[0],l=new e.FileLoader(this.manager);l.setPath(n.path),l.setResponseType("arraybuffer"),l.load(t,(function(e){try{r(n.parse(e,o,s))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},parse:function(t,r,a){return cc=(new vu).parse(t),new fc(new e.TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin)).parse(a)}}),fc.prototype={constructor:fc,parse:function(e){return this.materials=new pc(this.textureLoader).parse(),this.defaultLayerName=e,this.meshes=this.parseLayers(),{materials:this.materials,meshes:this.meshes}},parseLayers:function(){var e=[],t=[],r=new mc,a=this;return cc.layers.forEach((function(i){var n=r.parse(i.geometry,i),o=a.parseMesh(n,i);e[i.number]=o,-1===i.parent?t.push(o):e[i.parent].add(o)})),this.applyPivots(t),t},parseMesh:function(t,r){var a,i=this.getMaterials(t.userData.matNames,r.geometry.type);return this.duplicateUVs(t,i),a="points"===r.geometry.type?new e.Points(t,i):"lines"===r.geometry.type?new e.LineSegments(t,i):new e.Mesh(t,i),r.name?a.name=r.name:a.name=this.defaultLayerName+"_layer_"+r.number,a.userData.pivot=r.pivot,a},applyPivots:function(e){e.forEach((function(e){e.traverse((function(e){var t=e.userData.pivot;if(e.position.x+=t[0],e.position.y+=t[1],e.position.z+=t[2],e.parent){var r=e.parent.userData.pivot;e.position.x-=r[0],e.position.y-=r[1],e.position.z-=r[2]}}))}))},getMaterials:function(t,r){var a=[],i=this;t.forEach((function(e,t){a[t]=i.getMaterialByName(e)})),"points"!==r&&"lines"!==r||a.forEach((function(t,i){var n={color:t.color};"points"===r?(n.size=.1,n.map=t.map,n.morphTargets=t.morphTargets,a[i]=new e.PointsMaterial(n)):"lines"===r&&(a[i]=new e.LineBasicMaterial(n))}));var n=a.filter(Boolean);return 1===n.length?n[0]:a},getMaterialByName:function(e){return this.materials.filter((function(t){return t.name===e}))[0]},duplicateUVs:function(t,r){var a=!1;Array.isArray(r)?r.forEach((function(e){e.aoMap&&(a=!0)})):r.aoMap&&(a=!0),a&&t.setAttribute("uv2",new e.BufferAttribute(t.attributes.uv.array,2))}},pc.prototype={constructor:pc,parse:function(){var e=[];for(var t in this.textures={},cc.materials)"LWO3"===cc.format?e.push(this.parseMaterial(cc.materials[t],t,cc.textures)):"LWO2"===cc.format&&e.push(this.parseMaterialLwo2(cc.materials[t],t,cc.textures));return e},parseMaterial:function(e,t,r){var a={name:t,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},i=this.parseConnections(e.connections,e.nodes),n=this.parseTextureNodes(i.maps);this.parseAttributeImageMaps(i.attributes,r,n,e.maps);var o=this.parseAttributes(i.attributes,n);return this.parseEnvMap(i,n,o),a=Object.assign(n,a),a=Object.assign(a,o),new(this.getMaterialType(i.attributes))(a)},parseMaterialLwo2:function(t,r){var a={name:r,side:this.getSide(t.attributes),flatShading:this.getSmooth(t.attributes)},i=this.parseAttributes(t.attributes,{});return a=Object.assign(a,i),new e.MeshPhongMaterial(a)},getSide:function(t){if(!t.side)return e.BackSide;switch(t.side){case 0:case 1:return e.BackSide;case 2:return e.FrontSide;case 3:return e.DoubleSide}},getSmooth:function(e){return!e.smooth||!e.smooth},parseConnections:function(e,t){var r={maps:{}},a=e.inputName,i=e.inputNodeName,n=e.nodeName,o=this;return a.forEach((function(e,a){if("Material"===e){var n=o.getNodeByRefName(i[a],t);r.attributes=n.attributes,r.envMap=n.fileName,r.name=i[a]}})),n.forEach((function(e,n){e===r.name&&(r.maps[a[n]]=o.getNodeByRefName(i[n],t))})),r},getNodeByRefName:function(e,t){for(var r in t)if(t[r].refName===e)return t[r]},parseTextureNodes:function(t){var r={};for(var a in t){var i=t[a],n=i.fileName;if(!n)return;var o=this.loadTexture(n);switch(void 0!==i.widthWrappingMode&&(o.wrapS=this.getWrappingType(i.widthWrappingMode)),void 0!==i.heightWrappingMode&&(o.wrapT=this.getWrappingType(i.heightWrappingMode)),a){case"Color":r.map=o;break;case"Roughness":r.roughnessMap=o,r.roughness=.5;break;case"Specular":r.specularMap=o,r.specular=16777215;break;case"Luminous":r.emissiveMap=o,r.emissive=8421504;break;case"Luminous Color":r.emissive=8421504;break;case"Metallic":r.metalnessMap=o,r.metalness=.5;break;case"Transparency":case"Alpha":r.alphaMap=o,r.transparent=!0;break;case"Normal":r.normalMap=o,void 0!==i.amplitude&&(r.normalScale=new e.Vector2(i.amplitude,i.amplitude));break;case"Bump":r.bumpMap=o}}return r.roughnessMap&&r.specularMap&&delete r.specularMap,r},parseAttributeImageMaps:function(e,t,r){for(var a in e){var i=e[a];if(i.maps){var n=i.maps[0],o=this.getTexturePathByIndex(n.imageIndex,t);if(!o)return;var s=this.loadTexture(o);switch(void 0!==n.wrap&&(s.wrapS=this.getWrappingType(n.wrap.w)),void 0!==n.wrap&&(s.wrapT=this.getWrappingType(n.wrap.h)),a){case"Color":r.map=s;break;case"Diffuse":r.aoMap=s;break;case"Roughness":r.roughnessMap=s,r.roughness=1;break;case"Specular":r.specularMap=s,r.specular=16777215;break;case"Luminosity":r.emissiveMap=s,r.emissive=8421504;break;case"Metallic":r.metalnessMap=s,r.metalness=1;break;case"Transparency":case"Alpha":r.alphaMap=s,r.transparent=!0;break;case"Normal":r.normalMap=s;break;case"Bump":r.bumpMap=s}}}},parseAttributes:function(t,r){var a={};return t.Color&&!r.map?a.color=(new e.Color).fromArray(t.Color.value):a.color=new e.Color,t.Transparency&&0!==t.Transparency.value&&(a.opacity=1-t.Transparency.value,a.transparent=!0),t["Bump Height"]&&(a.bumpScale=.1*t["Bump Height"].value),t["Refraction Index"]&&(a.refractionRatio=1/t["Refraction Index"].value),this.parsePhysicalAttributes(a,t,r),this.parseStandardAttributes(a,t,r),this.parsePhongAttributes(a,t,r),a},parsePhysicalAttributes:function(e,t){t.Clearcoat&&t.Clearcoat.value>0&&(e.clearcoat=t.Clearcoat.value,t["Clearcoat Gloss"]&&(e.clearcoatRoughness=.5*(1-t["Clearcoat Gloss"].value)))},parseStandardAttributes:function(t,r,a){r.Luminous&&(t.emissiveIntensity=r.Luminous.value,r["Luminous Color"]&&!a.emissive?t.emissive=(new e.Color).fromArray(r["Luminous Color"].value):t.emissive=new e.Color(8421504)),r.Roughness&&!a.roughnessMap&&(t.roughness=r.Roughness.value),r.Metallic&&!a.metalnessMap&&(t.metalness=r.Metallic.value)},parsePhongAttributes:function(t,r,a){r.Diffuse&&t.color.multiplyScalar(r.Diffuse.value),r.Reflection&&(t.reflectivity=r.Reflection.value,t.combine=e.AddOperation),r.Luminosity&&(t.emissiveIntensity=r.Luminosity.value,a.emissiveMap||a.map?t.emissive=new e.Color(8421504):t.emissive=t.color),r.Roughness||!r.Specular||a.specularMap||(r["Color Highlight"]?t.specular=(new e.Color).setScalar(r.Specular.value).lerp(t.color.clone().multiplyScalar(r.Specular.value),r["Color Highlight"].value):t.specular=(new e.Color).setScalar(r.Specular.value)),t.specular&&r.Glossiness&&(t.shininess=7+Math.pow(2,12*r.Glossiness.value+2))},parseEnvMap:function(t,r,a){if(t.envMap){var i=this.loadTexture(t.envMap);a.transparent&&a.opacity<.999?(i.mapping=e.EquirectangularRefractionMapping,void 0!==a.reflectivity&&(delete a.reflectivity,delete a.combine),void 0!==a.metalness&&delete a.metalness):i.mapping=e.EquirectangularReflectionMapping,r.envMap=i}},getTexturePathByIndex:function(e){var t="";return cc.textures?(cc.textures.forEach((function(r){r.index===e&&(t=r.fileName)})),t):t},loadTexture:function(e){return e?this.textureLoader.load(e,void 0,void 0,(function(){console.warn("LWOLoader: non-standard resource hierarchy. Use `resourcePath` parameter to specify root content directory.")})):null},getWrappingType:function(t){switch(t){case 0:return console.warn('LWOLoader: "Reset" texture wrapping type is not supported in three'),e.ClampToEdgeWrapping;case 1:return e.RepeatWrapping;case 2:return e.MirroredRepeatWrapping;case 3:return e.ClampToEdgeWrapping}},getMaterialType:function(t){return t.Clearcoat&&t.Clearcoat.value>0?e.MeshPhysicalMaterial:t.Roughness?e.MeshStandardMaterial:e.MeshPhongMaterial}},mc.prototype={constructor:mc,parse:function(t,r){var a=new e.BufferGeometry;a.setAttribute("position",new e.Float32BufferAttribute(t.points,3));var i=this.splitIndices(t.vertexIndices,t.polygonDimensions);return a.setIndex(i),this.parseGroups(a,t),a.computeVertexNormals(),this.parseUVs(a,r,i),this.parseMorphTargets(a,r,i),a.translate(-r.pivot[0],-r.pivot[1],-r.pivot[2]),a},splitIndices:function(e,t){var r=[],a=0;return t.forEach((function(t){if(t<4)for(var i=0;i<t;i++)r.push(e[a+i]);else if(4===t)r.push(e[a],e[a+1],e[a+2],e[a],e[a+2],e[a+3]);else if(t>4){for(var n=1;n<t-1;n++)r.push(e[a],e[a+n],e[a+n+1]);console.warn("LWOLoader: polygons with greater than 4 sides are not supported")}a+=t})),r},parseGroups:function(e,t){var r=cc.tags,a=[],i=3;"lines"===t.type&&(i=2),"points"===t.type&&(i=1);for(var n,o=this.splitMaterialIndices(t.polygonDimensions,t.materialIndices),s=0,l={},u=0,c=0,h=0;h<o.length;h+=2){var d,f=o[h+1];if(0===h&&(a[s]=r[f]),void 0===n&&(n=f),f!==n)l[r[n]]?d=l[r[n]]:(d=s,l[r[n]]=s,a[s]=r[n],s++),e.addGroup(u,c,d),u+=c,n=f,c=0;c+=i}e.groups.length>0&&(l[r[f]]?d=l[r[f]]:(d=s,l[r[f]]=s,a[s]=r[f]),e.addGroup(u,c,d));e.userData.matNames=a},splitMaterialIndices:function(e,t){var r=[];return e.forEach((function(e,a){if(e<=3)r.push(t[2*a],t[2*a+1]);else if(4===e)r.push(t[2*a],t[2*a+1],t[2*a],t[2*a+1]);else for(var i=0;i<e-2;i++)r.push(t[2*a],t[2*a+1])})),r},parseUVs:function(t,r){var a=Array.from(Array(2*t.attributes.position.count),(function(){return 0}));for(var i in r.uvs){var n=r.uvs[i].uvs;r.uvs[i].uvIndices.forEach((function(e,t){a[2*e]=n[2*t],a[2*e+1]=n[2*t+1]}))}t.setAttribute("uv",new e.Float32BufferAttribute(a,2))},parseMorphTargets:function(t,r){var a=0;for(var i in r.morphTargets){var n=t.attributes.position.array.slice();t.morphAttributes.position||(t.morphAttributes.position=[]);var o=r.morphTargets[i].points,s=r.morphTargets[i].indices,l=r.morphTargets[i].type;s.forEach((function(e,t){"relative"===l?(n[3*e]+=o[3*t],n[3*e+1]+=o[3*t+1],n[3*e+2]+=o[3*t+2]):(n[3*e]=o[3*t],n[3*e+1]=o[3*t+1],n[3*e+2]=o[3*t+2])})),t.morphAttributes.position[a]=new e.Float32BufferAttribute(n,3),t.morphAttributes.position[a].name=i,a++}t.morphTargetsRelative=!1}};var vc=function(t){e.Loader.call(this,t),this.propertyNameMapping={}};vc.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:vc,load:function(t,r,a,i){var n=this,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(n.parse(e))}catch(e){i?i(e):console.error(e),n.manager.itemError(t)}}),a,i)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(t){function r(e){var t="",r=0,a=/ply([\s\S]*)end_header\r?\n/.exec(e);null!==a&&(t=a[1],r=new Blob([a[0]]).size);var i,n,o,s,l,u,c={comments:[],elements:[],headerLength:r,objInfo:""},d=t.split("\n");for(var f=0;f<d.length;f++){var p=d[f];if(""!==(p=p.trim()))switch(n=(o=p.split(/\s+/)).shift(),p=o.join(" "),n){case"format":c.format=o[0],c.version=o[1];break;case"comment":c.comments.push(p);break;case"element":void 0!==i&&c.elements.push(i),(i={}).name=o[0],i.count=parseInt(o[1]),i.properties=[];break;case"property":i.properties.push((s=o,l=h.propertyNameMapping,u=void 0,"list"===(u={type:s[0]}).type?(u.name=s[3],u.countType=s[1],u.itemType=s[2]):u.name=s[1],u.name in l&&(u.name=l[u.name]),u));break;case"obj_info":c.objInfo=p;break;default:console.log("unhandled",n,o)}}return void 0!==i&&c.elements.push(i),c}function a(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function i(e,t){for(var r=t.split(/\s+/),i={},n=0;n<e.length;n++)if("list"===e[n].type){for(var o=[],s=a(r.shift(),e[n].countType),l=0;l<s;l++)o.push(a(r.shift(),e[n].itemType));i[e[n].name]=o}else i[e[n].name]=a(r.shift(),e[n].type);return i}function n(e,t){var r,a={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},n="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(n=r[1]);for(var l=n.split("\n"),u=0,c=0,h=0;h<l.length;h++){var d=l[h];if(""!==(d=d.trim())){c>=t.elements[u].count&&(u++,c=0);var f=i(t.elements[u].properties,d);s(a,t.elements[u].name,f),c++}}return o(a)}function o(t){var r=new e.BufferGeometry;return t.indices.length>0&&r.setIndex(t.indices),r.setAttribute("position",new e.Float32BufferAttribute(t.vertices,3)),t.normals.length>0&&r.setAttribute("normal",new e.Float32BufferAttribute(t.normals,3)),t.uvs.length>0&&r.setAttribute("uv",new e.Float32BufferAttribute(t.uvs,2)),t.colors.length>0&&r.setAttribute("color",new e.Float32BufferAttribute(t.colors,3)),t.faceVertexUvs.length>0&&(r=r.toNonIndexed()).setAttribute("uv",new e.Float32BufferAttribute(t.faceVertexUvs,2)),r.computeBoundingSphere(),r}function s(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var a=r.vertex_indices||r.vertex_index,i=r.texcoord;3===a.length?(e.indices.push(a[0],a[1],a[2]),i&&6===i.length&&(e.faceVertexUvs.push(i[0],i[1]),e.faceVertexUvs.push(i[2],i[3]),e.faceVertexUvs.push(i[4],i[5]))):4===a.length&&(e.indices.push(a[0],a[1],a[3]),e.indices.push(a[1],a[2],a[3]))}}function l(e,t,r,a){switch(r){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,a),2];case"uint16":case"ushort":return[e.getUint16(t,a),2];case"int32":case"int":return[e.getInt32(t,a),4];case"uint32":case"uint":return[e.getUint32(t,a),4];case"float32":case"float":return[e.getFloat32(t,a),4];case"float64":case"double":return[e.getFloat64(t,a),8]}}function u(e,t,r,a){for(var i,n={},o=0,s=0;s<r.length;s++)if("list"===r[s].type){var u=[],c=(i=l(e,t+o,r[s].countType,a))[0];o+=i[1];for(var h=0;h<c;h++)i=l(e,t+o,r[s].itemType,a),u.push(i[0]),o+=i[1];n[r[s].name]=u}else i=l(e,t+o,r[s].type,a),n[r[s].name]=i[0],o+=i[1];return[n,o]}var c,h=this;if(t instanceof ArrayBuffer){var d=e.LoaderUtils.decodeText(new Uint8Array(t)),f=r(d);c="ascii"===f.format?n(d,f):function(e,t){for(var r,a={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i="binary_little_endian"===t.format,n=new DataView(e,t.headerLength),l=0,c=0;c<t.elements.length;c++)for(var h=0;h<t.elements[c].count;h++){l+=(r=u(n,l,t.elements[c].properties,i))[1];var d=r[0];s(a,t.elements[c].name,d)}return o(a)}(t,f)}else c=n(t,r(t));return c}});var gc=function(t){function r(){var r;r=t.call(this)||this,b.default(x.default(r),"isLineSegmentsGeometry",!0),b.default(x.default(r),"type","LineSegmentsGeometry"),b.default(x.default(r),"boundingBox",null),b.default(x.default(r),"boundingSphere",null),b.default(x.default(r),"box",new e.Box3),b.default(x.default(r),"vector",new e.Vector3);return r.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),r.setAttribute("position",new e.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),r.setAttribute("uv",new e.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2)),r}g.default(r,t);var a=r.prototype;return a.applyMatrix4=function(e){var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),r.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},a.setPositions=function(t){var r;if(t instanceof Float32Array)r=t;else{if(!Array.isArray(t))return console.error("LineSegmentsGeometry.setPosition requires either a Float32Array or regular array of numbers"),this;r=new Float32Array(t)}var a=new e.InstancedInterleavedBuffer(r,6,1);return this.setAttribute("instanceStart",new e.InterleavedBufferAttribute(a,3,0)),this.setAttribute("instanceEnd",new e.InterleavedBufferAttribute(a,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},a.setColors=function(t){var r;if(t instanceof Float32Array)r=t;else{if(!Array.isArray(t))return console.error("LineSegmentsGeometry.setColors requires either a Float32Array or regular array of numbers"),this;r=new Float32Array(t)}var a=new e.InstancedInterleavedBuffer(r,6,1);return this.setAttribute("instanceColorStart",new e.InterleavedBufferAttribute(a,3,0)),this.setAttribute("instanceColorEnd",new e.InterleavedBufferAttribute(a,3,3)),this},a.fromWireframeGeometry=function(e){return this.setPositions(Array.from(e.attributes.position.array)),this},a.fromEdgesGeometry=function(e){return this.setPositions(Array.from(e.attributes.position.array)),this},a.fromMesh=function(t){return this.fromWireframeGeometry(new e.WireframeGeometry(t.geometry)),this},a.fromLineSegments=function(e){var t=e.geometry;return t.isBufferGeometry&&this.setPositions(Array.from(t.attributes.position.array)),this},a.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new e.Box3);var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;void 0!==t&&void 0!==r&&(this.boundingBox.setFromBufferAttribute(t),this.box.setFromBufferAttribute(r),this.boundingBox.union(this.box))},a.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new e.Sphere),null===this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;if(void 0!==t&&void 0!==r){var a=this.boundingSphere.center;this.boundingBox&&this.boundingBox.getCenter(a);for(var i=0,n=0,o=t.count;n<o;n++)this.vector.fromBufferAttribute(t,n),i=Math.max(i,a.distanceToSquared(this.vector)),this.vector.fromBufferAttribute(r,n),i=Math.max(i,a.distanceToSquared(this.vector));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}},a.toJSON=function(){},r}(e.InstancedBufferGeometry),yc=function(e){function t(){var t;return t=e.call(this)||this,b.default(x.default(t),"type","LineGeometry"),b.default(x.default(t),"isLineGeometry",!0),b.default(x.default(t),"setColors",(function(r){for(var a=r.length-3,i=new Float32Array(2*a),n=0;n<a;n+=3)i[2*n]=r[n],i[2*n+1]=r[n+1],i[2*n+2]=r[n+2],i[2*n+3]=r[n+3],i[2*n+4]=r[n+4],i[2*n+5]=r[n+5];return e.prototype.setColors.call(x.default(t),i),x.default(t)})),b.default(x.default(t),"fromLine",(function(e){var r=e.geometry;return r.isBufferGeometry&&t.setPositions(Array.from(r.attributes.position.array)),x.default(t)})),b.default(x.default(t),"copy",(function(){return x.default(t)})),t}return g.default(t,e),t.prototype.setPositions=function(t){for(var r=t.length-3,a=new Float32Array(2*r),i=0;i<r;i+=3)a[2*i]=t[i],a[2*i+1]=t[i+1],a[2*i+2]=t[i+2],a[2*i+3]=t[i+3],a[2*i+4]=t[i+4],a[2*i+5]=t[i+5];return e.prototype.setPositions.call(this,a),this},t}(gc),xc={linewidth:{value:1},resolution:{value:new e.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1},opacity:{value:1}};e.ShaderLib.line={uniforms:e.UniformsUtils.merge([e.UniformsLib.common,e.UniformsLib.fog,xc]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef ALPHA_TO_COVERAGE\n\n\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\tfloat a = vUv.x;\n\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\tfloat len2 = a * a + b * b;\n\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t}\n\n\t\t\t#else\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var bc,Ac,wc=function(t){function r(r){var a;return void 0===r&&(r={}),a=t.call(this,{uniforms:e.UniformsUtils.clone(e.ShaderLib.line.uniforms),vertexShader:e.ShaderLib.line.vertexShader,fragmentShader:e.ShaderLib.line.fragmentShader,clipping:!0})||this,b.default(x.default(a),"isLineMaterial",!0),b.default(x.default(a),"dashed",!1),b.default(x.default(a),"color",0),b.default(x.default(a),"lineWidth",0),b.default(x.default(a),"dashScale",0),b.default(x.default(a),"dashOffset",0),b.default(x.default(a),"dashSize",0),b.default(x.default(a),"opacity",0),b.default(x.default(a),"resolution",new e.Vector2),b.default(x.default(a),"alphaToCoverage",!1),Object.defineProperties(x.default(a),{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("ALPHA_TO_COVERAGE"in this.defines)},set:function(e){Boolean(e)!==Boolean("ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),e?(this.defines.ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),a.setValues(r),a}return g.default(r,t),r}(e.ShaderMaterial),Mc=function(t,r){e.Mesh.call(this),this.type="Wireframe",this.geometry=void 0!==t?t:new gc,this.material=void 0!==r?r:new wc({color:16777215*Math.random()})};Mc.prototype=Object.assign(Object.create(e.Mesh.prototype),{constructor:Mc,isWireframe:!0,computeLineDistances:(bc=new e.Vector3,Ac=new e.Vector3,function(){for(var t=this.geometry,r=t.attributes.instanceStart,a=t.attributes.instanceEnd,i=new Float32Array(2*r.data.count),n=0,o=0,s=r.data.count;n<s;n++,o+=2)bc.fromBufferAttribute(r,n),Ac.fromBufferAttribute(a,n),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+bc.distanceTo(Ac);var l=new e.InstancedInterleavedBuffer(i,2,1);return t.setAttribute("instanceDistanceStart",new e.InterleavedBufferAttribute(l,1,0)),t.setAttribute("instanceDistanceEnd",new e.InterleavedBufferAttribute(l,1,1)),this})});var Sc=function(t){gc.call(this),this.type="WireframeGeometry2",this.fromWireframeGeometry(new e.WireframeGeometry(t))};Sc.prototype=Object.assign(Object.create(gc.prototype),{constructor:Sc,isWireframeGeometry2:!0});var Tc=function(t){function r(r,a){var i;return void 0===r&&(r=new gc),void 0===a&&(a=new wc({color:16777215*Math.random()})),i=t.call(this,r,a)||this,b.default(x.default(i),"type","LineSegments2"),b.default(x.default(i),"isLineSegments2",!0),b.default(x.default(i),"distStart",new e.Vector3),b.default(x.default(i),"distEnd",new e.Vector3),b.default(x.default(i),"computeLineDistances",(function(){for(var t=i.geometry,r=t.attributes.instanceStart,a=t.attributes.instanceEnd,n=new Float32Array(2*r.data.count),o=0,s=0,l=r.data.count;o<l;o++,s+=2)i.distStart.fromBufferAttribute(r,o),i.distEnd.fromBufferAttribute(a,o),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+i.distStart.distanceTo(i.distEnd);var u=new e.InstancedInterleavedBuffer(n,2,1);return t.setAttribute("instanceDistanceStart",new e.InterleavedBufferAttribute(u,1,0)),t.setAttribute("instanceDistanceEnd",new e.InterleavedBufferAttribute(u,1,1)),x.default(i)})),b.default(x.default(i),"rayStart",new e.Vector4),b.default(x.default(i),"rayEnd",new e.Vector4),b.default(x.default(i),"ssOrigin",new e.Vector4),b.default(x.default(i),"ssOrigin3",new e.Vector3),b.default(x.default(i),"mvMatrix",new e.Matrix4),b.default(x.default(i),"line",new e.Line3),b.default(x.default(i),"closestPoint",new e.Vector3),b.default(x.default(i),"raycast",(function(t,r){null===t.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var a=t.ray,n=t.camera,o=n.projectionMatrix,s=i.geometry,l=i.material,u=l.resolution,c=l.linewidth+0,h=s.attributes.instanceStart,d=s.attributes.instanceEnd,f=-n.near;a.at(1,new e.Vector3(i.ssOrigin.x,i.ssOrigin.y,i.ssOrigin.z)),i.ssOrigin.w=1,i.ssOrigin.applyMatrix4(n.matrixWorldInverse),i.ssOrigin.applyMatrix4(o),i.ssOrigin.multiplyScalar(1/i.ssOrigin.w),i.ssOrigin.x*=u.x/2,i.ssOrigin.y*=u.y/2,i.ssOrigin.z=0,i.ssOrigin3.set(i.ssOrigin.x,i.ssOrigin.y,i.ssOrigin.z);var p=i.matrixWorld;i.mvMatrix.multiplyMatrices(n.matrixWorldInverse,p);for(var m=0,v=h.count;m<v;m++){if(i.rayStart.fromBufferAttribute(h,m),i.rayEnd.fromBufferAttribute(d,m),i.rayStart.w=1,i.rayEnd.w=1,i.rayStart.applyMatrix4(i.mvMatrix),i.rayEnd.applyMatrix4(i.mvMatrix),!(i.rayStart.z>f&&i.rayEnd.z>f)){if(i.rayStart.z>f){var g=i.rayStart.z-i.rayEnd.z,y=(i.rayStart.z-f)/g;i.rayStart.lerp(i.rayEnd,y)}else if(i.rayEnd.z>f){var b=i.rayEnd.z-i.rayStart.z,A=(i.rayEnd.z-f)/b;i.rayEnd.lerp(i.rayStart,A)}i.rayStart.applyMatrix4(o),i.rayEnd.applyMatrix4(o),i.rayStart.multiplyScalar(1/i.rayStart.w),i.rayEnd.multiplyScalar(1/i.rayEnd.w),i.rayStart.x*=u.x/2,i.rayStart.y*=u.y/2,i.rayEnd.x*=u.x/2,i.rayEnd.y*=u.y/2,i.line.start.set(i.rayStart.x,i.rayStart.y,i.rayStart.z),i.line.start.z=0,i.line.end.set(i.rayEnd.x,i.rayEnd.y,i.rayEnd.z),i.line.end.z=0;var w=i.line.closestPointToPointParameter(i.ssOrigin3,!0);i.line.at(w,i.closestPoint);var M=e.MathUtils.lerp(i.rayStart.z,i.rayEnd.z,w),S=M>=-1&&M<=1,T=i.ssOrigin3.distanceTo(i.closestPoint)<.5*c;if(S&&T){i.line.start.fromBufferAttribute(h,m),i.line.end.fromBufferAttribute(d,m),i.line.start.applyMatrix4(p),i.line.end.applyMatrix4(p);var C=new e.Vector3,F=new e.Vector3;a.distanceSqToSegment(i.line.start,i.line.end,F,C),r.push({distance:a.origin.distanceTo(F),point:F,face:null,faceIndex:m,object:x.default(i),uv:void 0,pointOnLine:C})}}}})),i}return g.default(r,t),r}(e.Mesh),Cc=function(e){function t(t,r){var a;return void 0===t&&(t=new yc),void 0===r&&(r=new wc({color:16777215*Math.random()})),a=e.call(this,t,r)||this,b.default(x.default(a),"type","Line2"),b.default(x.default(a),"isLine2",!0),a}return g.default(t,e),t}(Tc),Fc=function(t){function r(r,a){var i;i.lightProbe=r,i.size=a;var n=new e.ShaderMaterial({type:"LightProbeHelperMaterial",uniforms:{sh:{value:i.lightProbe.sh.coefficients},intensity:{value:i.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\tgl_FragColor = linearToOutputTexel( vec4( outgoingLight, 1.0 ) );","}"].join("\n")}),o=new e.SphereGeometry(1,32,16);return(i=t.call(this,o,n)||this).type="LightProbeHelper",i.onBeforeRender(),i}g.default(r,t);var a=r.prototype;return a.dispose=function(){this.geometry.dispose(),this.material.dispose()},a.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},r}(e.Mesh),Ec=new e.Vector3,Bc=new e.Vector3,Lc=function(e){function t(e,t,r){var a;a.object=e,a.size=void 0!==t?t:1;var i=a.object.geometry;return console.error("THREE.VertexTangentsHelper: geometry not an instance of THREE.BufferGeometry.",i),x.default(a)}return g.default(t,e),t.prototype.update=function(){this.object.updateMatrixWorld(!0);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,r=this.object.geometry,a=r.attributes.position,i=r.attributes.tangent,n=0,o=0,s=a.count;o<s;o++)Ec.set(a.getX(o),a.getY(o),a.getZ(o)).applyMatrix4(e),Bc.set(i.getX(o),i.getY(o),i.getZ(o)),Bc.transformDirection(e).multiplyScalar(this.size).add(Ec),t.setXYZ(n,Ec.x,Ec.y,Ec.z),n+=1,t.setXYZ(n,Bc.x,Bc.y,Bc.z),n+=1;t.needsUpdate=!0},t}(e.LineSegments),Pc=function(t){function r(r,a,i,n){var o;o.audio=r,o.range=a||1,o.divisionsInnerAngle=i||16,o.divisionsOuterAngle=n||2;var s=new e.BufferGeometry,l=o.divisionsInnerAngle+2*o.divisionsOuterAngle,u=new Float32Array(3*(3*l+3));s.setAttribute("position",new e.BufferAttribute(u,3));var c=new e.LineBasicMaterial({color:65280}),h=new e.LineBasicMaterial({color:16776960});return(o=t.call(this,s,[h,c])||this).type="PositionalAudioHelper",o.update(),o}g.default(r,t);var a=r.prototype;return a.update=function(){var t,r,a=this.audio,i=this.range,n=this.divisionsInnerAngle,o=this.divisionsOuterAngle,s=e.MathUtils.degToRad(a.panner.coneInnerAngle),l=e.MathUtils.degToRad(a.panner.coneOuterAngle),u=s/2,c=l/2,h=0,d=0,f=this.geometry,p=f.attributes.position;function m(e,a,n,o){var s=(a-e)/n;for(p.setXYZ(h,0,0,0),d++,t=e;t<a;t+=s)r=h+d,p.setXYZ(r,Math.sin(t)*i,0,Math.cos(t)*i),p.setXYZ(r+1,Math.sin(Math.min(t+s,a))*i,0,Math.cos(Math.min(t+s,a))*i),p.setXYZ(r+2,0,0,0),d+=3;f.addGroup(h,d,o),h+=d,d=0}f.clearGroups(),m(-c,-u,o,0),m(-u,u,n,1),m(u,c,o,0),p.needsUpdate=!0,s===l&&(this.material[0].visible=!1)},a.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},r}(e.Line),Dc=new e.Vector3,Nc=new e.Vector3,Rc=new e.Matrix3,_c=function(t){function r(r,a,i){var n,o=new e.BufferGeometry,s=void 0!==i?i:16711680;(n=t.call(this,o,new e.LineBasicMaterial({color:s,toneMapped:!1}))||this).object=r,n.size=void 0!==a?a:.1;var l=0,u=n.object.geometry;if(u&&u.isGeometry)return console.error("THREE.VertexNormalsHelper no longer supports Geometry. Use BufferGeometry instead."),x.default(n);u&&u.isBufferGeometry&&(l=u.attributes.normal.count);var c=new e.Float32BufferAttribute(2*l*3,3);return o.setAttribute("position",c),n.type="VertexNormalsHelper",n.matrixAutoUpdate=!1,n.update(),n}return g.default(r,t),r.prototype.update=function(){this.object.updateMatrixWorld(!0),Rc.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,t=this.geometry.attributes.position,r=this.object.geometry;if(r&&r.isGeometry)console.error("THREE.VertexNormalsHelper no longer supports Geometry. Use BufferGeometry instead.");else{if(r&&r.isBufferGeometry)for(var a=r.attributes.position,i=r.attributes.normal,n=0,o=0,s=a.count;o<s;o++)Dc.set(a.getX(o),a.getY(o),a.getZ(o)).applyMatrix4(e),Nc.set(i.getX(o),i.getY(o),i.getZ(o)),Nc.applyMatrix3(Rc).normalize().multiplyScalar(this.size).add(Dc),t.setXYZ(n,Dc.x,Dc.y,Dc.z),n+=1,t.setXYZ(n,Nc.x,Nc.y,Nc.z),n+=1;t.needsUpdate=!0}},r}(e.LineSegments),Ic=function(t){function r(r,a){var i;i.light=r,i.color=a;var n=new e.BufferGeometry;n.setAttribute("position",new e.Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var o=new e.LineBasicMaterial({fog:!1});(i=t.call(this,n,o)||this).type="RectAreaLightHelper";var s=new e.BufferGeometry;return s.setAttribute("position",new e.Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),s.computeBoundingSphere(),i.add(new e.Mesh(s,new e.MeshBasicMaterial({side:e.BackSide,fog:!1}))),i}g.default(r,t);var a=r.prototype;return a.updateMatrixWorld=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.copy(this.light.matrixWorld).scale(this.scale),this.children[0].matrixWorld.copy(this.matrixWorld)},a.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},r}(e.Line),Oc={init:function(){var t=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-4.48815e-7,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,9.07581e-7,1.12813,.997866,-8.96716e-7,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,8.79224e-7,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,6.55682e-7,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,4.62391e-7,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,3.04092e-7,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,1.73682e-7,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,7.78271e-8,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-6.27338e-7,.0306409,1.97672e-8,99168e-8,-158573e-10,.0314638,4.99803e-7,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,2.37499e-8,-9.99999e-8,282592e-10,1.14596e-10,100292e-11,-166369e-11,250354e-9,6.77492e-9,350752e-11,-637769e-11,357289e-9,6.31655e-8,826445e-11,-174689e-10,516179e-9,3.1851e-7,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],r=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,5.45037e-10,0,0,.999994,2.85095e-9,0,0,.999989,1.26931e-8,0,0,.999973,4.89938e-8,0,0,.999947,1.66347e-7,0,0,.999894,5.02694e-7,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,1.15855e-10,0,0,.999996,6.6947e-10,0,0,.999991,3.30863e-9,0,0,.999983,1.41737e-8,0,0,.999968,5.32626e-8,0,0,.99994,1.77431e-7,0,0,.999891,5.28835e-7,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,2.22338e-10,0,0,.999995,1.0967e-9,0,0,.999991,4.82132e-9,0,0,.999981,1.89434e-8,0,0,.999967,6.67716e-8,0,0,.999938,2.12066e-7,0,0,.999886,6.0977e-7,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,1.01739e-10,0,0,.999997,4.70132e-10,0,0,.999993,2.00436e-9,0,0,.999988,7.83682e-9,0,0,.999979,2.80338e-8,0,0,.999962,9.17033e-8,0,0,.999933,2.74514e-7,0,0,.999881,7.53201e-7,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,2.51859e-10,0,0,.999996,9.96192e-10,0,0,.999992,3.74531e-9,0,0,.999986,1.32022e-8,0,0,.999975,4.33315e-8,0,0,.999959,1.31956e-7,0,0,.999927,3.72249e-7,0,0,.999871,9.72461e-7,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,1.79597e-10,0,0,.999997,6.02367e-10,0,0,.999994,2.06835e-9,0,0,.99999,6.94952e-9,0,0,.999984,2.23363e-8,0,0,.999972,6.78578e-8,0,0,.999952,1.93571e-7,0,0,.999919,5.16594e-7,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,1.14608e-10,0,0,.999998,2.10507e-10,0,0,.999997,4.99595e-10,0,0,.999995,1.39897e-9,0,0,.999994,4.19818e-9,0,0,.999988,1.27042e-8,0,0,.999979,3.75153e-8,0,0,.999965,1.06206e-7,0,0,.999945,2.85381e-7,0,0,.999908,7.23611e-7,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,2.86798e-10,0,0,1,2.86877e-10,0,0,1,2.88094e-10,0,0,1,2.93506e-10,0,0,1,3.09262e-10,0,0,.999999,3.48593e-10,0,0,.999999,4.44582e-10,0,0,.999998,6.88591e-10,0,0,.999996,1.34391e-9,0,0,.999993,3.17438e-9,0,0,.999989,8.35609e-9,0,0,.999983,2.28677e-8,0,0,.999974,6.23361e-8,0,0,.999959,1.65225e-7,0,0,.999936,4.19983e-7,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,1.68222e-7,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,1.09018e-9,0,0,1,1.0904e-9,0,0,1,1.09393e-9,0,0,1,1.1095e-9,0,0,1,1.154e-9,0,0,1,1.26089e-9,0,0,.999999,1.5059e-9,0,0,.999997,2.07899e-9,0,0,.999994,3.48164e-9,0,0,.999993,7.05728e-9,0,0,.999987,1.63692e-8,0,0,.999981,4.06033e-8,0,0,.999969,1.0245e-7,0,0,.999953,2.55023e-7,0,0,.999925,6.1511e-7,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,3.54014e-9,0,0,1,3.54073e-9,0,0,1,3.54972e-9,0,0,1,3.58929e-9,0,0,1,3.70093e-9,0,0,.999999,3.96194e-9,0,0,.999998,4.53352e-9,0,0,.999997,5.78828e-9,0,0,.999994,8.63812e-9,0,0,.999991,1.53622e-8,0,0,.999985,3.16356e-8,0,0,.999977,7.12781e-8,0,0,.999964,1.66725e-7,0,0,.999945,3.90501e-7,0,0,.999912,8.95622e-7,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,1.0153e-8,0,0,1,1.01544e-8,0,0,1,1.01751e-8,0,0,1,1.02662e-8,0,0,1,1.0521e-8,0,0,.999999,1.11049e-8,0,0,.999999,1.23408e-8,0,0,.999996,1.4924e-8,0,0,.999992,2.04471e-8,0,0,.999989,3.26539e-8,0,0,.99998,6.03559e-8,0,0,.999971,1.23936e-7,0,0,.999955,2.69058e-7,0,0,.999933,5.93604e-7,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,2.2038e-7,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,2.63344e-8,0,0,1,2.63373e-8,0,0,1,2.63815e-8,0,0,1,2.65753e-8,0,0,1,2.71132e-8,0,0,.999999,2.83279e-8,0,0,.999997,3.0833e-8,0,0,.999995,3.58711e-8,0,0,.999992,4.61266e-8,0,0,.999985,6.7574e-8,0,0,.999977,1.1358e-7,0,0,.999966,2.13657e-7,0,0,.999948,4.31151e-7,0,0,.999923,8.96656e-7,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,6.28647e-8,0,0,1,6.28705e-8,0,0,1,6.29587e-8,0,0,1,6.33441e-8,0,0,.999999,6.44087e-8,0,0,.999998,6.67856e-8,0,0,.999997,7.15889e-8,0,0,.999995,8.09577e-8,0,0,.999989,9.92764e-8,0,0,.999983,1.35834e-7,0,0,.999974,2.10482e-7,0,0,.999959,3.65215e-7,0,0,.999939,6.86693e-7,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,1.39968e-7,0,0,1,1.39979e-7,0,0,1,1.40145e-7,0,0,1,1.4087e-7,0,0,.999999,1.42865e-7,0,0,.999998,1.47279e-7,0,0,.999997,1.56057e-7,0,0,.999992,1.7276e-7,0,0,.999989,2.04352e-7,0,0,.99998,2.6494e-7,0,0,.999969,3.83435e-7,0,0,.999953,6.18641e-7,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,2.9368e-7,0,0,1,2.937e-7,0,0,1,2.93998e-7,0,0,1,2.95298e-7,0,0,.999999,2.98865e-7,0,0,.999998,3.067e-7,0,0,.999995,3.22082e-7,0,0,.999992,3.50767e-7,0,0,.999986,4.03538e-7,0,0,.999976,5.01372e-7,0,0,.999964,6.8562e-7,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,5.85473e-7,0,0,1,5.85507e-7,0,0,1,5.8602e-7,0,0,.999999,5.88259e-7,0,0,.999999,5.94381e-7,0,0,.999998,6.07754e-7,0,0,.999995,6.33729e-7,0,0,.99999,6.8137e-7,0,0,.999984,7.67003e-7,0,0,.999973,9.21212e-7,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,8.8288e-7,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],a=new Float32Array(t),i=new Float32Array(r);e.UniformsLib.LTC_FLOAT_1=new e.DataTexture(a,64,64,e.RGBAFormat,e.FloatType,e.UVMapping,e.ClampToEdgeWrapping,e.ClampToEdgeWrapping,e.LinearFilter,e.NearestFilter,1),e.UniformsLib.LTC_FLOAT_2=new e.DataTexture(i,64,64,e.RGBAFormat,e.FloatType,e.UVMapping,e.ClampToEdgeWrapping,e.ClampToEdgeWrapping,e.LinearFilter,e.NearestFilter,1);var n=new Uint16Array(t.length);t.forEach((function(t,r){n[r]=e.DataUtils.toHalfFloat(t)}));var o=new Uint16Array(r.length);r.forEach((function(t,r){o[r]=e.DataUtils.toHalfFloat(t)})),e.UniformsLib.LTC_HALF_1=new e.DataTexture(n,64,64,e.RGBAFormat,e.HalfFloatType,e.UVMapping,e.ClampToEdgeWrapping,e.ClampToEdgeWrapping,e.LinearFilter,e.NearestFilter,1),e.UniformsLib.LTC_HALF_2=new e.DataTexture(o,64,64,e.RGBAFormat,e.HalfFloatType,e.UVMapping,e.ClampToEdgeWrapping,e.ClampToEdgeWrapping,e.LinearFilter,e.NearestFilter,1)}},Uc={fromCubeTexture:function(t){for(var r,a,i,n=0,o=new e.Vector3,s=new e.Vector3,l=new e.Color,u=[0,0,0,0,0,0,0,0,0],c=new e.SphericalHarmonics3,h=c.coefficients,d=0;d<6;d++){var f=t.image[d],p=f.width,m=f.height,v=document.createElement("canvas");v.width=p,v.height=m;var g=v.getContext("2d");g.drawImage(f,0,0,p,m);for(var y=g.getImageData(0,0,p,m),x=y.data,b=y.width,A=2/b,w=0,M=x.length;w<M;w+=4){l.setRGB(x[w]/255,x[w+1]/255,x[w+2]/255),kc(l,t.encoding);var S=w/4,T=(S%b+.5)*A-1,C=1-(Math.floor(S/b)+.5)*A;switch(d){case 0:o.set(-1,C,-T);break;case 1:o.set(1,C,T);break;case 2:o.set(-T,1,-C);break;case 3:o.set(-T,-1,C);break;case 4:o.set(-T,C,1);break;case 5:o.set(T,C,-1)}a=o.lengthSq(),n+=i=4/(Math.sqrt(a)*a),s.copy(o).normalize(),e.SphericalHarmonics3.getBasisAt(s,u);for(var F=0;F<9;F++)h[F].x+=u[F]*l.r*i,h[F].y+=u[F]*l.g*i,h[F].z+=u[F]*l.b*i}}r=4*Math.PI/n;for(var E=0;E<9;E++)h[E].x*=r,h[E].y*=r,h[E].z*=r;return new e.LightProbe(c)},fromCubeRenderTarget:function(t,r){for(var a,i,n,o=0,s=new e.Vector3,l=new e.Vector3,u=new e.Color,c=[0,0,0,0,0,0,0,0,0],h=new e.SphericalHarmonics3,d=h.coefficients,f=0;f<6;f++){var p=r.width,m=new Uint8Array(p*p*4);t.readRenderTargetPixels(r,0,0,p,p,m,f);for(var v=2/p,g=0,y=m.length;g<y;g+=4){u.setRGB(m[g]/255,m[g+1]/255,m[g+2]/255),kc(u,r.texture.encoding);var x=g/4,b=(x%p+.5)*v-1,A=1-(Math.floor(x/p)+.5)*v;switch(f){case 0:s.set(1,A,-b);break;case 1:s.set(-1,A,b);break;case 2:s.set(b,1,-A);break;case 3:s.set(b,-1,A);break;case 4:s.set(b,A,1);break;case 5:s.set(-b,A,-1)}i=s.lengthSq(),o+=n=4/(Math.sqrt(i)*i),l.copy(s).normalize(),e.SphericalHarmonics3.getBasisAt(l,c);for(var w=0;w<9;w++)d[w].x+=c[w]*u.r*n,d[w].y+=c[w]*u.g*n,d[w].z+=c[w]*u.b*n}}a=4*Math.PI/o;for(var M=0;M<9;M++)d[M].x*=a,d[M].y*=a,d[M].z*=a;return new e.LightProbe(h)}},kc=function(t,r){switch(r){case e.sRGBEncoding:t.convertSRGBToLinear();break;case e.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return t},Vc=function(){function t(t,r,a,i,n){this.degree1=t,this.degree2=r,this.knots1=a,this.knots2=i,this.controlPoints=[];for(var o=a.length-t-1,s=i.length-r-1,l=0;l<o;++l){this.controlPoints[l]=[];for(var u=0;u<s;++u){var c=n[l][u];this.controlPoints[l][u]=new e.Vector4(c.x,c.y,c.z,c.w)}}}return t.prototype.getPoint=function(e,t,r){var a=this.knots1[0]+e*(this.knots1[this.knots1.length-1]-this.knots1[0]),i=this.knots2[0]+t*(this.knots2[this.knots2.length-1]-this.knots2[0]);$n(this.degree1,this.degree2,this.knots1,this.knots2,this.controlPoints,a,i,r)},t}(),Gc=function(t){function r(){return t.call(this)||this}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t=2*Math.PI*t;var i=-.22*Math.cos(t)-1.28*Math.sin(t)-.44*Math.cos(3*t)-.78*Math.sin(3*t),n=-.1*Math.cos(2*t)-.27*Math.sin(2*t)+.38*Math.cos(4*t)+.46*Math.sin(4*t),o=.7*Math.cos(3*t)-.4*Math.sin(3*t);return a.set(i,n,o).multiplyScalar(20)},r}(e.Curve),jc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?5:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=16*Math.pow(Math.sin(t),3),n=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);return a.set(i,n,0).multiplyScalar(this.scale)},r}(e.Curve),zc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?70:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t=4*t*Math.PI;var i=this.scale/2,n=i*(1+Math.cos(t)),o=i*Math.sin(t),s=2*i*Math.sin(t/2);return a.set(n,o,s)},r}(e.Curve),Hc=function(t){function r(){return t.call(this)||this}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=50*Math.sin(t),n=Math.cos(t)*(10+50*Math.cos(t)),o=Math.sin(t)*(10+50*Math.cos(t));return a.set(i,n,o)},r}(e.Curve),Wc=function(t){function r(){return t.call(this)||this}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3,i=2*Math.PI*t*150/30,n=30*Math.cos(i),o=30*Math.sin(i),s=150*t;return a.set(n,o,s)},r}(e.Curve),Xc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?10:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=(2+Math.cos(3*t))*Math.cos(2*t),n=(2+Math.cos(3*t))*Math.sin(2*t),o=Math.sin(3*t);return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),Qc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?10:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=(2+Math.cos(4*t))*Math.cos(3*t),n=(2+Math.cos(4*t))*Math.sin(3*t),o=Math.sin(4*t);return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),Yc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?10:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=(2+Math.cos(5*t))*Math.cos(2*t),n=(2+Math.cos(5*t))*Math.sin(2*t),o=Math.sin(5*t);return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),Jc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?10:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t=4*t-2;var i=Math.pow(t,3)-3*t,n=Math.pow(t,4)-4*t*t,o=.2*Math.pow(t,5)-2*t;return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),Kc=function(e,t,r){return r*(t-e)+e},qc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?1:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3,i=.4*(t=Kc(-4,4,t))*(t*t-7)*(t*t-10),n=Math.pow(t,4)-13*t*t,o=.1*t*(t*t-4)*(t*t-9)*(t*t-12);return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),Zc=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?40:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3;t*=2*Math.PI;var i=Math.cos(2*t)*(1+.6*(Math.cos(5*t)+.75*Math.cos(10*t))),n=Math.sin(2*t)*(1+.6*(Math.cos(5*t)+.75*Math.cos(10*t))),o=.35*Math.sin(5*t);return a.set(i,n,o).multiplyScalar(this.scale)},r}(e.Curve),$c=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?40:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3,i=t*Math.PI*2,n=Math.cos(2*i)*(1+.45*Math.cos(3*i)+.4*Math.cos(9*i)),o=Math.sin(2*i)*(1+.45*Math.cos(3*i)+.4*Math.cos(9*i)),s=.2*Math.sin(9*i);return a.set(n,o,s).multiplyScalar(this.scale)},r}(e.Curve),eh=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?40:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3,i=t*Math.PI*2,n=Math.cos(3*i)*(1+.3*Math.cos(5*i)+.5*Math.cos(10*i)),o=Math.sin(3*i)*(1+.3*Math.cos(5*i)+.5*Math.cos(10*i)),s=.2*Math.sin(20*i);return a.set(n,o,s).multiplyScalar(this.scale)},r}(e.Curve),th=function(t){function r(e){var r;return(r=t.call(this)||this).scale=void 0===e?40:e,r}return g.default(r,t),r.prototype.getPoint=function(t,r){var a=r||new e.Vector3,i=t*Math.PI*2,n=Math.cos(4*i)*(1+.5*(Math.cos(5*i)+.4*Math.cos(20*i))),o=Math.sin(4*i)*(1+.5*(Math.cos(5*i)+.4*Math.cos(20*i))),s=.35*Math.sin(15*i);return a.set(n,o,s).multiplyScalar(this.scale)},r}(e.Curve),rh=new e.Matrix4,ah=new e.Object3D,ih=new e.Vector3,nh=function(t){function r(){var r;return(r=t.call(this)||this).isGeometry=!0,r.uuid=e.MathUtils.generateUUID(),r.name="",r.type="Geometry",r.vertices=[],r.colors=[],r.faces=[],r.faceVertexUvs=[[]],r.morphTargets=[],r.morphNormals=[],r.skinWeights=[],r.skinIndices=[],r.lineDistances=[],r.boundingBox=null,r.boundingSphere=null,r.elementsNeedUpdate=!1,r.verticesNeedUpdate=!1,r.uvsNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.lineDistancesNeedUpdate=!1,r.groupsNeedUpdate=!1,r}g.default(r,t);var a=r.prototype;return a.applyMatrix4=function(t){for(var r=(new e.Matrix3).getNormalMatrix(t),a=0,i=this.vertices.length;a<i;a++){this.vertices[a].applyMatrix4(t)}for(var n=0,o=this.faces.length;n<o;n++){var s=this.faces[n];s.normal.applyMatrix3(r).normalize();for(var l=0,u=s.vertexNormals.length;l<u;l++)s.vertexNormals[l].applyMatrix3(r).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},a.rotateX=function(e){return rh.makeRotationX(e),this.applyMatrix4(rh),this},a.rotateY=function(e){return rh.makeRotationY(e),this.applyMatrix4(rh),this},a.rotateZ=function(e){return rh.makeRotationZ(e),this.applyMatrix4(rh),this},a.translate=function(e,t,r){return rh.makeTranslation(e,t,r),this.applyMatrix4(rh),this},a.scale=function(e,t,r){return rh.makeScale(e,t,r),this.applyMatrix4(rh),this},a.lookAt=function(e){return ah.lookAt(e),ah.updateMatrix(),this.applyMatrix4(ah.matrix),this},a.fromBufferGeometry=function(t){var r=this,a=null!==t.index?t.index:void 0,i=t.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var n=i.position,o=i.normal,s=i.color,l=i.uv,u=i.uv2;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=0;c<n.count;c++)r.vertices.push((new e.Vector3).fromBufferAttribute(n,c)),void 0!==s&&r.colors.push((new e.Color).fromBufferAttribute(s,c));function h(t,a,i,n){var c=void 0===s?[]:[r.colors[t].clone(),r.colors[a].clone(),r.colors[i].clone()],h=void 0===o?[]:[(new e.Vector3).fromBufferAttribute(o,t),(new e.Vector3).fromBufferAttribute(o,a),(new e.Vector3).fromBufferAttribute(o,i)],d=new sh(t,a,i,h,c,n);r.faces.push(d),void 0!==l&&r.faceVertexUvs[0].push([(new e.Vector2).fromBufferAttribute(l,t),(new e.Vector2).fromBufferAttribute(l,a),(new e.Vector2).fromBufferAttribute(l,i)]),void 0!==u&&r.faceVertexUvs[1].push([(new e.Vector2).fromBufferAttribute(u,t),(new e.Vector2).fromBufferAttribute(u,a),(new e.Vector2).fromBufferAttribute(u,i)])}var d=t.groups;if(d.length>0)for(var f=0;f<d.length;f++)for(var p=d[f],m=p.start,v=m,g=m+p.count;v<g;v+=3)void 0!==a?h(a.getX(v),a.getX(v+1),a.getX(v+2),p.materialIndex):h(v,v+1,v+2,p.materialIndex);else if(void 0!==a)for(var y=0;y<a.count;y+=3)h(a.getX(y),a.getX(y+1),a.getX(y+2));else for(var x=0;x<n.count;x+=3)h(x,x+1,x+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},a.center=function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ih).negate(),this.translate(ih.x,ih.y,ih.z),this},a.normalize=function(){this.computeBoundingSphere();var t=this.boundingSphere.center,r=this.boundingSphere.radius,a=0===r?1:1/r,i=new e.Matrix4;return i.set(a,0,0,-a*t.x,0,a,0,-a*t.y,0,0,a,-a*t.z,0,0,0,1),this.applyMatrix4(i),this},a.computeFaceNormals=function(){for(var t=new e.Vector3,r=new e.Vector3,a=0,i=this.faces.length;a<i;a++){var n=this.faces[a],o=this.vertices[n.a],s=this.vertices[n.b],l=this.vertices[n.c];t.subVectors(l,s),r.subVectors(o,s),t.cross(r),t.normalize(),n.normal.copy(t)}},a.computeVertexNormals=function(t){void 0===t&&(t=!0);for(var r=new Array(this.vertices.length),a=0,i=this.vertices.length;a<i;a++)r[a]=new e.Vector3;if(t)for(var n=new e.Vector3,o=new e.Vector3,s=0,l=this.faces.length;s<l;s++){var u=this.faces[s],c=this.vertices[u.a],h=this.vertices[u.b],d=this.vertices[u.c];n.subVectors(d,h),o.subVectors(c,h),n.cross(o),r[u.a].add(n),r[u.b].add(n),r[u.c].add(n)}else{this.computeFaceNormals();for(var f=0,p=this.faces.length;f<p;f++){var m=this.faces[f];r[m.a].add(m.normal),r[m.b].add(m.normal),r[m.c].add(m.normal)}}for(var v=0,g=this.vertices.length;v<g;v++)r[v].normalize();for(var y=0,x=this.faces.length;y<x;y++){var b=this.faces[y],A=b.vertexNormals;3===A.length?(A[0].copy(r[b.a]),A[1].copy(r[b.b]),A[2].copy(r[b.c])):(A[0]=r[b.a].clone(),A[1]=r[b.b].clone(),A[2]=r[b.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},a.computeFlatVertexNormals=function(){this.computeFaceNormals();for(var e=0,t=this.faces.length;e<t;e++){var r=this.faces[e],a=r.vertexNormals;3===a.length?(a[0].copy(r.normal),a[1].copy(r.normal),a[2].copy(r.normal)):(a[0]=r.normal.clone(),a[1]=r.normal.clone(),a[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},a.computeMorphNormals=function(){for(var t=0,a=this.faces.length;t<a;t++){var i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(var n=0,o=i.vertexNormals.length;n<o;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}var s=new r;s.faces=this.faces;for(var l=0,u=this.morphTargets.length;l<u;l++){if(!this.morphNormals[l]){this.morphNormals[l]={},this.morphNormals[l].faceNormals=[],this.morphNormals[l].vertexNormals=[];for(var c=this.morphNormals[l].faceNormals,h=this.morphNormals[l].vertexNormals,d=0,f=this.faces.length;d<f;d++){var p=new e.Vector3,m={a:new e.Vector3,b:new e.Vector3,c:new e.Vector3};c.push(p),h.push(m)}}var v=this.morphNormals[l];s.vertices=this.morphTargets[l].vertices,s.computeFaceNormals(),s.computeVertexNormals();for(var g=0,y=this.faces.length;g<y;g++){var x=this.faces[g],b=v.faceNormals[g],A=v.vertexNormals[g];b.copy(x.normal),A.a.copy(x.vertexNormals[0]),A.b.copy(x.vertexNormals[1]),A.c.copy(x.vertexNormals[2])}}for(var w=0,M=this.faces.length;w<M;w++){var S=this.faces[w];S.normal=S.__originalFaceNormal,S.vertexNormals=S.__originalVertexNormals}},a.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new e.Box3),this.boundingBox.setFromPoints(this.vertices)},a.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new e.Sphere),this.boundingSphere.setFromPoints(this.vertices)},a.merge=function(t,r,a){if(void 0===a&&(a=0),t&&t.isGeometry){var i,n=this.vertices.length,o=this.vertices,s=t.vertices,l=this.faces,u=t.faces,c=this.colors,h=t.colors;void 0!==r&&(i=(new e.Matrix3).getNormalMatrix(r));for(var d=0,f=s.length;d<f;d++){var p=s[d].clone();void 0!==r&&p.applyMatrix4(r),o.push(p)}for(var m=0,v=h.length;m<v;m++)c.push(h[m].clone());for(var g=0,y=u.length;g<y;g++){var x=u[g],b=void 0,A=void 0,w=x.vertexNormals,M=x.vertexColors,S=new sh(x.a+n,x.b+n,x.c+n);S.normal.copy(x.normal),void 0!==i&&S.normal.applyMatrix3(i).normalize();for(var T=0,C=w.length;T<C;T++)b=w[T].clone(),void 0!==i&&b.applyMatrix3(i).normalize(),S.vertexNormals.push(b);S.color.copy(x.color);for(var F=0,E=M.length;F<E;F++)A=M[F],S.vertexColors.push(A.clone());S.materialIndex=x.materialIndex+a,l.push(S)}for(var B=0,L=t.faceVertexUvs.length;B<L;B++){var P=t.faceVertexUvs[B];void 0===this.faceVertexUvs[B]&&(this.faceVertexUvs[B]=[]);for(var D=0,N=P.length;D<N;D++){for(var R=P[D],_=[],I=0,O=R.length;I<O;I++)_.push(R[I].clone());this.faceVertexUvs[B].push(_)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},a.mergeMesh=function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},a.mergeVertices=function(e){void 0===e&&(e=4);for(var t={},r=[],a=[],i=Math.pow(10,e),n=0,o=this.vertices.length;n<o;n++){var s=this.vertices[n],l=Math.round(s.x*i)+"_"+Math.round(s.y*i)+"_"+Math.round(s.z*i);void 0===t[l]?(t[l]=n,r.push(this.vertices[n]),a[n]=r.length-1):a[n]=a[t[l]]}for(var u=[],c=0,h=this.faces.length;c<h;c++){var d=this.faces[c];d.a=a[d.a],d.b=a[d.b],d.c=a[d.c];for(var f=[d.a,d.b,d.c],p=0;p<3;p++)if(f[p]===f[(p+1)%3]){u.push(c);break}}for(var m=u.length-1;m>=0;m--){var v=u[m];this.faces.splice(v,1);for(var g=0,y=this.faceVertexUvs.length;g<y;g++)this.faceVertexUvs[g].splice(v,1)}var x=this.vertices.length-r.length;return this.vertices=r,x},a.setFromPoints=function(t){this.vertices=[];for(var r=0,a=t.length;r<a;r++){var i=t[r];this.vertices.push(new e.Vector3(i.x,i.y,i.z||0))}return this},a.sortFacesByMaterialIndex=function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var a,i,n=this.faceVertexUvs[0],o=this.faceVertexUvs[1];n&&n.length===t&&(a=[]),o&&o.length===t&&(i=[]);for(var s=0;s<t;s++){var l=e[s]._id;a&&a.push(n[l]),i&&i.push(o[l])}a&&(this.faceVertexUvs[0]=a),i&&(this.faceVertexUvs[1]=i)},a.toJSON=function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var a=[],i=0;i<this.vertices.length;i++){var n=this.vertices[i];a.push(n.x,n.y,n.z)}for(var o=[],s=[],l={},u=[],c={},h=[],d={},f=0;f<this.faces.length;f++){var p=this.faces[f],m=void 0!==this.faceVertexUvs[0][f],v=p.normal.length()>0,g=p.vertexNormals.length>0,y=1!==p.color.r||1!==p.color.g||1!==p.color.b,x=p.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,m),b=S(b,4,v),b=S(b,5,g),b=S(b,6,y),b=S(b,7,x),o.push(b),o.push(p.a,p.b,p.c),o.push(p.materialIndex),m){var A=this.faceVertexUvs[0][f];o.push(F(A[0]),F(A[1]),F(A[2]))}if(v&&o.push(T(p.normal)),g){var w=p.vertexNormals;o.push(T(w[0]),T(w[1]),T(w[2]))}if(y&&o.push(C(p.color)),x){var M=p.vertexColors;o.push(C(M[0]),C(M[1]),C(M[2]))}}function S(e,t,r){return r?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function C(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function F(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=a,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},a.clone=function(){return(new r).copy(this)},a.copy=function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var t=e.vertices,r=0,a=t.length;r<a;r++)this.vertices.push(t[r].clone());for(var i=e.colors,n=0,o=i.length;n<o;n++)this.colors.push(i[n].clone());for(var s=e.faces,l=0,u=s.length;l<u;l++)this.faces.push(s[l].clone());for(var c=0,h=e.faceVertexUvs.length;c<h;c++){var d=e.faceVertexUvs[c];void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var f=0,p=d.length;f<p;f++){for(var m=d[f],v=[],g=0,y=m.length;g<y;g++){var x=m[g];v.push(x.clone())}this.faceVertexUvs[c].push(v)}}for(var b=e.morphTargets,A=0,w=b.length;A<w;A++){var M={};if(M.name=b[A].name,void 0!==b[A].vertices){M.vertices=[];for(var S=0,T=b[A].vertices.length;S<T;S++)M.vertices.push(b[A].vertices[S].clone())}if(void 0!==b[A].normals){M.normals=[];for(var C=0,F=b[A].normals.length;C<F;C++)M.normals.push(b[A].normals[C].clone())}this.morphTargets.push(M)}for(var E=e.morphNormals,B=0,L=E.length;B<L;B++){var P={};if(void 0!==E[B].vertexNormals){P.vertexNormals=[];for(var D=0,N=E[B].vertexNormals.length;D<N;D++){var R=E[B].vertexNormals[D],_={};_.a=R.a.clone(),_.b=R.b.clone(),_.c=R.c.clone(),P.vertexNormals.push(_)}}if(void 0!==E[B].faceNormals){P.faceNormals=[];for(var I=0,O=E[B].faceNormals.length;I<O;I++)P.faceNormals.push(E[B].faceNormals[I].clone())}this.morphNormals.push(P)}for(var U=e.skinWeights,k=0,V=U.length;k<V;k++)this.skinWeights.push(U[k].clone());for(var G=e.skinIndices,j=0,z=G.length;j<z;j++)this.skinIndices.push(G[j].clone());for(var H=e.lineDistances,W=0,X=H.length;W<X;W++)this.lineDistances.push(H[W]);var Q=e.boundingBox;null!==Q&&(this.boundingBox=Q.clone());var Y=e.boundingSphere;return null!==Y&&(this.boundingSphere=Y.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},a.toBufferGeometry=function(){var t=(new oh).fromGeometry(this),r=new e.BufferGeometry,a=new Float32Array(3*t.vertices.length);if(r.setAttribute("position",new e.BufferAttribute(a,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);r.setAttribute("normal",new e.BufferAttribute(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);r.setAttribute("color",new e.BufferAttribute(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var o=new Float32Array(2*t.uvs.length);r.setAttribute("uv",new e.BufferAttribute(o,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var s=new Float32Array(2*t.uvs2.length);r.setAttribute("uv2",new e.BufferAttribute(s,2).copyVector2sArray(t.uvs2))}for(var l in r.groups=t.groups,t.morphTargets){for(var u=[],c=t.morphTargets[l],h=0,d=c.length;h<d;h++){var f=c[h],p=new e.Float32BufferAttribute(3*f.data.length,3);p.name=f.name,u.push(p.copyVector3sArray(f.data))}r.morphAttributes[l]=u}if(t.skinIndices.length>0){var m=new e.Float32BufferAttribute(4*t.skinIndices.length,4);r.setAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var v=new e.Float32BufferAttribute(4*t.skinWeights.length,4);r.setAttribute("skinWeight",v.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(r.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(r.boundingBox=t.boundingBox.clone()),r},a.computeTangents=function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},a.computeLineDistances=function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},a.applyMatrix=function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},a.dispose=function(){this.dispatchEvent({type:"dispose"})},r}(e.EventDispatcher);nh.createBufferGeometryFromObject=function(t){var r=new e.BufferGeometry,a=t.geometry;if(t.isPoints||t.isLine){var i=new e.Float32BufferAttribute(3*a.vertices.length,3),n=new e.Float32BufferAttribute(3*a.colors.length,3);if(r.setAttribute("position",i.copyVector3sArray(a.vertices)),r.setAttribute("color",n.copyColorsArray(a.colors)),a.lineDistances&&a.lineDistances.length===a.vertices.length){var o=new e.Float32BufferAttribute(a.lineDistances.length,1);r.setAttribute("lineDistance",o.copyArray(a.lineDistances))}null!==a.boundingSphere&&(r.boundingSphere=a.boundingSphere.clone()),null!==a.boundingBox&&(r.boundingBox=a.boundingBox.clone())}else t.isMesh&&(r=a.toBufferGeometry());return r};var oh=function(){function t(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var r=t.prototype;return r.computeGroups=function(e){var t,r,a=[],i=void 0,n=e.faces;for(r=0;r<n.length;r++){var o=n[r];o.materialIndex!==i&&(i=o.materialIndex,void 0!==t&&(t.count=3*r-t.start,a.push(t)),t={start:3*r,materialIndex:i})}void 0!==t&&(t.count=3*r-t.start,a.push(t)),this.groups=a},r.fromGeometry=function(t){var r,a=t.faces,i=t.vertices,n=t.faceVertexUvs,o=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,l=t.morphTargets,u=l.length;if(u>0){r=[];for(var c=0;c<u;c++)r[c]={name:l[c].name,data:[]};this.morphTargets.position=r}var h,d=t.morphNormals,f=d.length;if(f>0){h=[];for(var p=0;p<f;p++)h[p]={name:d[p].name,data:[]};this.morphTargets.normal=h}var m=t.skinIndices,v=t.skinWeights,g=m.length===i.length,y=v.length===i.length;i.length>0&&0===a.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var x=0;x<a.length;x++){var b=a[x];this.vertices.push(i[b.a],i[b.b],i[b.c]);var A=b.vertexNormals;if(3===A.length)this.normals.push(A[0],A[1],A[2]);else{var w=b.normal;this.normals.push(w,w,w)}var M=b.vertexColors;if(3===M.length)this.colors.push(M[0],M[1],M[2]);else{var S=b.color;this.colors.push(S,S,S)}if(!0===o){var T=n[0][x];void 0!==T?this.uvs.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",x),this.uvs.push(new e.Vector2,new e.Vector2,new e.Vector2))}if(!0===s){var C=n[1][x];void 0!==C?this.uvs2.push(C[0],C[1],C[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",x),this.uvs2.push(new e.Vector2,new e.Vector2,new e.Vector2))}for(var F=0;F<u;F++){var E=l[F].vertices;r[F].data.push(E[b.a],E[b.b],E[b.c])}for(var B=0;B<f;B++){var L=d[B].vertexNormals[x];h[B].data.push(L.a,L.b,L.c)}g&&this.skinIndices.push(m[b.a],m[b.b],m[b.c]),y&&this.skinWeights.push(v[b.a],v[b.b],v[b.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},t}(),sh=function(){function t(t,r,a,i,n,o){void 0===o&&(o=0),this.a=t,this.b=r,this.c=a,this.normal=i&&i.isVector3?i:new e.Vector3,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new e.Color,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=o}var r=t.prototype;return r.clone=function(){return(new this.constructor).copy(this)},r.copy=function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var a=0,i=e.vertexColors.length;a<i;a++)this.vertexColors[a]=e.vertexColors[a].clone();return this},t}(),lh=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};var r,a="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(a="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",console.log("Warning: meshopt_decoder is using experimental SIMD support"));var i=WebAssembly.instantiate(function(e){for(var r=new Uint8Array(e.length),a=0;a<e.length;++a){var i=e.charCodeAt(a);r[a]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}var n=0;for(a=0;a<e.length;++a)r[n++]=r[a]<60?t[r[a]]:64*(r[a]-60)+r[++a];return r.buffer.slice(0,n)}(a),{}).then((function(e){(r=e.instance).exports.__wasm_call_ctors()}));function n(e,t,a,i,n,o){var s=r.exports.sbrk,l=a+3&-4,u=s(l*i),c=s(n.length),h=new Uint8Array(r.exports.memory.buffer);h.set(n,c);var d=e(u,a,i,c,n.length);if(0==d&&o&&o(u,l,i),t.set(h.subarray(u,u+a*i)),s(u-s(0)),0!=d)throw new Error("Malformed buffer data: "+d)}var o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:i,supported:!0,decodeVertexBuffer:function(e,t,a,i,s){n(r.exports.meshopt_decodeVertexBuffer,e,t,a,i,r.exports[o[s]])},decodeIndexBuffer:function(e,t,a,i){n(r.exports.meshopt_decodeIndexBuffer,e,t,a,i)},decodeIndexSequence:function(e,t,a,i){n(r.exports.meshopt_decodeIndexSequence,e,t,a,i)},decodeGltfBuffer:function(e,t,a,i,l,u){n(r.exports[s[l]],e,t,a,i,r.exports[o[u]])}}}();exports.ACESFilmicToneMappingShader=Oo,exports.AMFLoader=Gu,exports.ARButton=lo,exports.AdaptiveToneMappingPass=Cn,exports.AfterimagePass=_n,exports.AfterimageShader=Rn,exports.AmmoPhysics=function(){return _s.apply(this,arguments)},exports.AnaglyphEffect=function(t,r,a){this.colorMatrixLeft=(new e.Matrix3).fromArray([.4561,-.0400822,-.0152161,.500484,-.0378246,-.0205971,.176381,-.0157589,-.00546856]),this.colorMatrixRight=(new e.Matrix3).fromArray([-.0434706,.378476,-.0721527,-.0879388,.73364,-.112961,-.00155529,-.0184503,1.2264]);var i=new e.OrthographicCamera(-1,1,1,-1,0,1),n=new e.Scene,o=new e.StereoCamera,s={minFilter:e.LinearFilter,magFilter:e.NearestFilter,format:e.RGBAFormat};void 0===r&&(r=512),void 0===a&&(a=512);var l=new e.WebGLRenderTarget(r,a,s),u=new e.WebGLRenderTarget(r,a,s),c=new e.ShaderMaterial({uniforms:{mapLeft:{value:l.texture},mapRight:{value:u.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),h=new e.Mesh(new e.PlaneGeometry(2,2),c);n.add(h),this.setSize=function(e,r){t.setSize(e,r);var a=t.getPixelRatio();l.setSize(e*a,r*a),u.setSize(e*a,r*a)},this.render=function(e,r){var a=t.getRenderTarget();e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),o.update(r),t.setRenderTarget(l),t.clear(),t.render(e,o.cameraL),t.setRenderTarget(u),t.clear(),t.render(e,o.cameraR),t.setRenderTarget(null),t.render(n,i),t.setRenderTarget(a)},this.dispose=function(){l&&l.dispose(),u&&u.dispose(),h&&h.geometry.dispose(),c&&c.dispose()}},exports.AnimationClipCreator=fa,exports.AsciiEffect=function(e,t,r){t=void 0===t?" .:-=+*#%@":t,r||(r={});var a,i,n=r.resolution?r.resolution:.15,o=r.scale?r.scale:1,s=!!r.color&&r.color,l=!!r.alpha&&r.alpha,u=!!r.block&&r.block,c=!!r.invert&&r.invert,h=document.createElement("div");h.style.cursor="default";var d,f,p,m=document.createElement("table");h.appendChild(m),this.setSize=function(t,r){a=t,i=r,e.setSize(t,r),function(){d=Math.round(a*M),f=Math.round(i*M),b.width=d,b.height=f,(p=e.domElement).style.backgroundColor&&(m.rows[0].cells[0].style.backgroundColor=p.style.backgroundColor,m.rows[0].cells[0].style.color=p.style.color);m.cellSpacing=0,m.cellPadding=0;var t=m.style;t.display="inline",t.width=Math.round(d/M*o)+"px",t.height=Math.round(f/M*o)+"px",t.whiteSpace="pre",t.margin="0px",t.padding="0px",t.letterSpacing=C+"px",t.fontFamily=y,t.fontSize=S+"px",t.lineHeight=T+"px",t.textAlign="left",t.textDecoration="none"}()},this.render=function(t,r){e.render(t,r),function(e,t){A.clearRect(0,0,d,f),A.drawImage(x,0,0,d,f);for(var r=A.getImageData(0,0,d,f).data,a="",i=0;i<f;i+=2){for(var n=0;n<d;n++){var o=4*(i*d+n),h=r[o],p=r[o+1],m=r[o+2],v=r[o+3],g=void 0,y=void 0;y=(.3*h+.59*p+.11*m)/255,0==v&&(y=1),g=Math.floor((1-y)*(w.length-1)),c&&(g=w.length-g-1);var b=w[g];void 0!==b&&" "!=b||(b="&nbsp;"),a+=s?"<span style='color:rgb("+h+","+p+","+m+");"+(u?"background-color:rgb("+h+","+p+","+m+");":"")+(l?"opacity:"+v/255+";":"")+"'>"+b+"</span>":b}a+="<br/>"}t.innerHTML="<tr><td>"+a+"</td></tr>"}(0,m)},this.domElement=h;var v=" .,:;i1tfLCG08@".split(""),g=" CGO08@".split(""),y="courier new, monospace",x=e.domElement,b=document.createElement("canvas");if(b.getContext){var A=b.getContext("2d");if(A.getImageData){var w=s?g:v;t&&(w=t);var M=.5;M=.25,n&&(M=n);var S=2/M*o,T=2/M*o,C=0;switch(o){case 1:C=-1;break;case 2:case 3:C=-2.1;break;case 4:C=-3.1;break;case 5:C=-4.15}}}},exports.AssimpLoader=fl,exports.AttributeNode=pr,exports.BVHLoader=Js,exports.BasicNode=rr,exports.BasicNodeMaterial=cr,exports.BasicShader=Bs,exports.BasisTextureLoader=tl,exports.BleachBypassShader=Ro,exports.BlendColorFactor=211,exports.BlendShader=_o,exports.BloomPass=Jn,exports.BlurNode=Vr,exports.BlurShaderUtils=Dn,exports.BokehDepthShader=ci,exports.BokehPass=wn,exports.BokehShader=An,exports.BokehShader2=ui,exports.BoolNode=Dr,exports.BoxLineGeometry=po,exports.BrightnessContrastShader=Ms,exports.BumpMapNode=Ut,exports.BypassNode=wr,exports.CCDIKSolver=pa,exports.CSM=Fo,exports.CSMHelper=Eo,exports.CSS2DObject=Q,exports.CSS2DRenderer=function(){var t,r,a,i,n=this,o=new e.Vector3,s=new e.Matrix4,l=new e.Matrix4,u={objects:new WeakMap},c=document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.getSize=function(){return{width:t,height:r}},this.setSize=function(e,n){a=(t=e)/2,i=(r=n)/2,c.style.width=e+"px",c.style.height=n+"px"};var h=function e(t,r,s){if(t instanceof Q){t.onBeforeRender(n,r,s),o.setFromMatrixPosition(t.matrixWorld),o.applyMatrix4(l);var h=t.element;h.style.transform="translate(-50%,-50%) translate("+(o.x*a+a)+"px,"+(-o.y*i+i)+"px)",h.style.display=t.visible&&o.z>=-1&&o.z<=1?"":"none";var f={distanceToCameraSquared:d(s,t)};u.objects.set(t,f),h.parentNode!==c&&c.appendChild(h),t.onAfterRender(n,r,s)}for(var p=0,m=t.children.length;p<m;p++)e(t.children[p],r,s)},d=function(){var t=new e.Vector3,r=new e.Vector3;return function(e,a){return t.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(a.matrixWorld),t.distanceToSquared(r)}}(),f=function(e){for(var t=function(e){var t=[];return e.traverse((function(e){e instanceof Q&&t.push(e)})),t}(e).sort((function(e,t){return u.objects.get(e).distanceToCameraSquared-u.objects.get(t).distanceToCameraSquared})),r=t.length,a=0,i=t.length;a<i;a++)t[a].element.style.zIndex=r-a};this.render=function(e,t){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),s.copy(t.matrixWorldInverse),l.multiplyMatrices(t.projectionMatrix,s),h(e,e,t),f(e)}},exports.CSS3DObject=ve,exports.CSS3DRenderer=function(){var t,r,a,i,n=this,o=new e.Matrix4,s={camera:{fov:0,style:""},objects:new WeakMap},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l;var u=document.createElement("div");function c(e){return Math.abs(e)<1e-10?0:e}function h(e){var t=e.elements;return"matrix3d("+c(t[0])+","+c(-t[1])+","+c(t[2])+","+c(t[3])+","+c(t[4])+","+c(-t[5])+","+c(t[6])+","+c(t[7])+","+c(t[8])+","+c(-t[9])+","+c(t[10])+","+c(t[11])+","+c(t[12])+","+c(-t[13])+","+c(t[14])+","+c(t[15])+")"}function d(e){var t=e.elements;return"translate(-50%,-50%)"+("matrix3d("+c(t[0])+","+c(t[1])+","+c(t[2])+","+c(t[3])+","+c(-t[4])+","+c(-t[5])+","+c(-t[6])+","+c(-t[7])+","+c(t[8])+","+c(t[9])+","+c(t[10])+","+c(t[11])+","+c(t[12])+","+c(t[13])+","+c(t[14])+","+c(t[15])+")")}function f(e,t,r,a){if(e instanceof ve){var i;e.onBeforeRender(n,t,r),e instanceof ge?(o.copy(r.matrixWorldInverse),o.transpose(),o.copyPosition(e.matrixWorld),o.scale(e.scale),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,i=d(o)):i=d(e.matrixWorld);var l=e.element,c=s.objects.get(e);if(void 0===c||c.style!==i){l.style.transform=i;var h={style:i};s.objects.set(e,h)}l.style.display=e.visible?"":"none",l.parentNode!==u&&u.appendChild(l),e.onAfterRender(n,t,r)}for(var p=0,m=e.children.length;p<m;p++)f(e.children[p],t,r)}u.style.transformStyle="preserve-3d",u.style.pointerEvents="none",l.appendChild(u),this.getSize=function(){return{width:t,height:r}},this.setSize=function(e,n){a=(t=e)/2,i=(r=n)/2,l.style.width=e+"px",l.style.height=n+"px",u.style.width=e+"px",u.style.height=n+"px"},this.render=function(e,t){var r=t.projectionMatrix.elements[5]*i;if(s.camera.fov!==r&&(l.style.perspective=t.isPerspectiveCamera?r+"px":"",s.camera.fov=r),!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera)var n=-(t.right+t.left)/2,o=(t.top+t.bottom)/2;var d=(t.isOrthographicCamera?"scale("+r+")translate("+c(n)+"px,"+c(o)+"px)"+h(t.matrixWorldInverse):"translateZ("+r+"px)"+h(t.matrixWorldInverse))+"translate("+a+"px,"+i+"px)";s.camera.style!==d&&(u.style.transform=d,s.camera.style=d),f(e,e,t)}},exports.CSS3DSprite=ge,exports.CameraControls=Ui,exports.CameraNode=mr,exports.Capsule=Di,exports.CheckerNode=kr,exports.CinematicCamera=hi,exports.CinquefoilKnot=Yc,exports.ClearMaskPass=On,exports.ClearPass=rn,exports.ColladaExporter=ca,exports.ColladaLoader=Ks,exports.ColorAdjustmentNode=jr,exports.ColorConverter=Ni,exports.ColorCorrectionShader=ko,exports.ColorMapKeywords=Oi,exports.ColorNode=kt,exports.ColorNodeUniform=ue,exports.ColorSpaceNode=Ft,exports.ColorUniform=re,exports.ColorifyShader=Ds,exports.ColorsNode=Ar,exports.CondNode=Pr,exports.ConstNode=tt,exports.ConvexGeometry=F,exports.ConvexHull=C,exports.ConvexObjectBreaker=E,exports.ConvolutionShader=Yn,exports.CopyShader=pn,exports.CubeTextureNode=Qt,exports.CubeTexturePass=Bn,exports.DDSLoader=wl,exports.DOFMipMapShader=Ls,exports.DRACOExporter=ua,exports.DRACOLoader=Ku,exports.DecalGeometry=mo,exports.DecalVertex=vo,exports.DecoratedTorusKnot4a=Zc,exports.DecoratedTorusKnot4b=$c,exports.DecoratedTorusKnot5a=eh,exports.DecoratedTorusKnot5c=th,exports.DepthLimitedBlurShader=Pn,exports.DeviceOrientationControls=Yi,exports.DigitalGlitch=an,exports.DotScreenPass=Vn,exports.DotScreenShader=kn,exports.DragControls=Xi,exports.EXRLoader=ml,exports.EdgeSplitModifier=function(){var t=this;b.default(this,"A",new e.Vector3),b.default(this,"B",new e.Vector3),b.default(this,"C",new e.Vector3),b.default(this,"positions",[]),b.default(this,"normals",new Float32Array),b.default(this,"indexes",[]),b.default(this,"pointToIndexMap",[]),b.default(this,"splitIndexes",[]),b.default(this,"oldNormals",[]),b.default(this,"computeNormals",(function(){t.normals=new Float32Array(3*t.indexes.length);for(var e=0;e<t.indexes.length;e+=3){var r=t.indexes[e];t.A.set(t.positions[3*r],t.positions[3*r+1],t.positions[3*r+2]),r=t.indexes[e+1],t.B.set(t.positions[3*r],t.positions[3*r+1],t.positions[3*r+2]),r=t.indexes[e+2],t.C.set(t.positions[3*r],t.positions[3*r+1],t.positions[3*r+2]),t.C.sub(t.B),t.A.sub(t.B);for(var a=t.C.cross(t.A).normalize(),i=0;i<3;i++)t.normals[3*(e+i)]=a.x,t.normals[3*(e+i)+1]=a.y,t.normals[3*(e+i)+2]=a.z}})),b.default(this,"mapPositionsToIndexes",(function(){t.pointToIndexMap=Array(t.positions.length/3);for(var e=0;e<t.indexes.length;e++){var r=t.indexes[e];null==t.pointToIndexMap[r]&&(t.pointToIndexMap[r]=[]),t.pointToIndexMap[r].push(e)}})),b.default(this,"edgeSplitToGroups",(function(e,r,a){t.A.set(t.normals[3*a],t.normals[3*a+1],t.normals[3*a+2]).normalize();for(var i,n={splitGroup:[],currentGroup:[a]},o=Ye(e);!(i=o()).done;){var s=i.value;s!==a&&(t.B.set(t.normals[3*s],t.normals[3*s+1],t.normals[3*s+2]).normalize(),t.B.dot(t.A)<r?n.splitGroup.push(s):n.currentGroup.push(s))}return n})),b.default(this,"edgeSplit",(function(e,r,a){if(void 0===a&&(a=null),0!==e.length){for(var i,n=[],o=Ye(e);!(i=o()).done;){var s=i.value;n.push(t.edgeSplitToGroups(e,r,s))}for(var l=n[0],u=0,c=n;u<c.length;u++){var h=c[u];h.currentGroup.length>l.currentGroup.length&&(l=h)}null!=a&&t.splitIndexes.push({original:a,indexes:l.currentGroup}),l.splitGroup.length&&t.edgeSplit(l.splitGroup,r,a||l.currentGroup[0])}})),b.default(this,"modify",(function(r,a,i){void 0===i&&(i=!0);var n=!1;if(r.attributes.normal&&(n=!0,r=r.clone(),!0===i&&null!==r.index&&(t.oldNormals=r.attributes.normal.array),r.deleteAttribute("normal")),null==r.index){if(void 0===Ge)throw"THREE.EdgeSplitModifier relies on BufferGeometryUtils";r=Ue(r)}t.indexes=r.index.array,t.positions=r.getAttribute("position").array,t.computeNormals(),t.mapPositionsToIndexes(),t.splitIndexes=[];for(var o,s=Ye(t.pointToIndexMap);!(o=s()).done;){var l=o.value;t.edgeSplit(l,Math.cos(a)-.001)}for(var u={},c=0,h=Object.keys(r.attributes);c<h.length;c++){var d=h[c],f=r.attributes[d],p=new f.array.constructor((t.indexes.length+t.splitIndexes.length)*f.itemSize);p.set(f.array),u[d]=new e.BufferAttribute(p,f.itemSize,f.normalized)}var m=new Uint32Array(t.indexes.length);m.set(t.indexes);for(var v=0;v<t.splitIndexes.length;v++){for(var g=t.splitIndexes[v],y=t.indexes[g.original],x=0,b=Object.values(u);x<b.length;x++)for(var A=b[x],w=0;w<A.itemSize;w++)A.array[(t.indexes.length+v)*A.itemSize+w]=A.array[y*A.itemSize+w];for(var M,S=Ye(g.indexes);!(M=S()).done;){m[M.value]=t.indexes.length+v}}(r=new e.BufferGeometry).setIndex(new e.BufferAttribute(m,1));for(var T=0,C=Object.keys(u);T<C.length;T++){var F=C[T];r.setAttribute(F,u[F])}if(n&&(r.computeVertexNormals(),null!==t.oldNormals)){for(var E,B=new Array(t.oldNormals.length/3).fill(!1),L=Ye(t.splitIndexes);!(E=L()).done;){B[E.value.original]=!0}for(var P=0;P<B.length;P++)if(!1===B[P])for(var D=0;D<3;D++)r.attributes.normal.array[3*P+D]=t.oldNormals[3*P+D]}return r}))},exports.EffectComposer=Un,exports.ExpressionNode=St,exports.FBXLoader=to,exports.FXAAShader=Xo,exports.Face3=sh,exports.FigureEightPolynomialKnot=qc,exports.FilmPass=fn,exports.FilmShader=dn,exports.FirstPersonControls=ji,exports.FlakesTexture=function(e,t){void 0===e&&(e=512),void 0===t&&(t=512);var r=document.createElement("canvas");r.width=e,r.height=t;var a=r.getContext("2d");a.fillStyle="rgb(127,127,255)",a.fillRect(0,0,e,t);for(var i=0;i<4e3;i++){var n=Math.random()*e,o=Math.random()*t,s=3*Math.random()+3,l=2*Math.random()-1,u=2*Math.random()-1,c=1.5,h=Math.sqrt(l*l+u*u+c*c);l/=h,u/=h,c/=h,a.fillStyle="rgb("+(127*l+127)+","+(127*u+127)+","+255*c+")",a.beginPath(),a.arc(n,o,s,0,2*Math.PI),a.fill()}return r},exports.FloatNode=$e,exports.FloatNodeUniform=ne,exports.FloatUniform=Z,exports.Flow=Le,exports.FlyControls=$i,exports.FocusShader=Go,exports.FreiChenShader=xs,exports.FresnelShader=Fs,exports.FullScreenQuad=Xr,exports.FunctionCallNode=Mt,exports.FunctionNode=wt,exports.GCodeLoader=Sl,exports.GLTFExporter=Jr,exports.GLTFLoader=Zs,exports.GPUAddressMode={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},exports.GPUBindingType=Y,exports.GPUBlendFactor={Zero:"zero",One:"one",SrcColor:"src-color",OneMinusSrcColor:"one-minus-src-color",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",DstColor:"dst-color",OneMinusDstColor:"one-minus-dst-color",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",BlendColor:"blend-color",OneMinusBlendColor:"one-minus-blend-color"},exports.GPUBlendOperation={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},exports.GPUColorWriteFlags={None:0,Red:1,Green:2,Blue:4,Alpha:8,All:15},exports.GPUCompareFunction={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},exports.GPUComputationRenderer=function(t,r,a){this.variables=[],this.currentTextureIndex=0;var i=e.FloatType,n=new e.Scene,o=new e.Camera;o.position.z=1;var s={passThruTexture:{value:null}},l=h("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",s),u=new e.Mesh(new e.PlaneGeometry(2,2),l);function c(e){e.defines.resolution="vec2( "+t.toFixed(1)+", "+r.toFixed(1)+" )"}function h(t,r){r=r||{};var a=new e.ShaderMaterial({uniforms:r,vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:t});return c(a),a}n.add(u),this.setDataType=function(e){return i=e,this},this.addVariable=function(t,r,a){var i={name:t,initialValueTexture:a,material:this.createShaderMaterial(r),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:e.NearestFilter,magFilter:e.NearestFilter};return this.variables.push(i),i},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===a.capabilities.isWebGL2&&!1===a.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===a.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var e=0;e<this.variables.length;e++){var i=this.variables[e];i.renderTargets[0]=this.createRenderTarget(t,r,i.wrapS,i.wrapT,i.minFilter,i.magFilter),i.renderTargets[1]=this.createRenderTarget(t,r,i.wrapS,i.wrapT,i.minFilter,i.magFilter),this.renderTexture(i.initialValueTexture,i.renderTargets[0]),this.renderTexture(i.initialValueTexture,i.renderTargets[1]);var n=i.material,o=n.uniforms;if(null!==i.dependencies)for(var s=0;s<i.dependencies.length;s++){var l=i.dependencies[s];if(l.name!==i.name){for(var u=!1,c=0;c<this.variables.length;c++)if(l.name===this.variables[c].name){u=!0;break}if(!u)return"Variable dependency not found. Variable="+i.name+", dependency="+l.name}o[l.name]={value:null},n.fragmentShader="\nuniform sampler2D "+l.name+";\n"+n.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0,r=0,a=this.variables.length;r<a;r++){var i=this.variables[r];if(null!==i.dependencies)for(var n=i.material.uniforms,o=0,s=i.dependencies.length;o<s;o++){var l=i.dependencies[o];n[l.name].value=l.renderTargets[e].texture}this.doRenderTarget(i.material,i.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=c,this.createShaderMaterial=h,this.createRenderTarget=function(a,n,o,s,l,u){return a=a||t,n=n||r,o=o||e.ClampToEdgeWrapping,s=s||e.ClampToEdgeWrapping,l=l||e.NearestFilter,u=u||e.NearestFilter,new e.WebGLRenderTarget(a,n,{wrapS:o,wrapT:s,minFilter:l,magFilter:u,format:e.RGBAFormat,type:i,depthBuffer:!1})},this.createTexture=function(){var a=new Float32Array(t*r*4);return new e.DataTexture(a,t,r,e.RGBAFormat,e.FloatType)},this.renderTexture=function(e,t){s.passThruTexture.value=e,this.doRenderTarget(l,t),s.passThruTexture.value=null},this.doRenderTarget=function(e,t){var r=a.getRenderTarget();u.material=e,a.setRenderTarget(t),a.render(n,o),u.material=l,a.setRenderTarget(r)}},exports.GPUCullMode={None:"none",Front:"front",Back:"back"},exports.GPUFilterMode={Linear:"linear",Nearest:"nearest"},exports.GPUFrontFace={CCW:"ccw",CW:"cw"},exports.GPUIndexFormat={Uint16:"uint16",Uint32:"uint32"},exports.GPUInputStepMode={Vertex:"vertex",Instance:"instance"},exports.GPULoadOp={Load:"load"},exports.GPUPrimitiveTopology={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},exports.GPUStencilOperation={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},exports.GPUStoreOp={Store:"store",Clear:"clear"},exports.GPUTextureDimension={OneD:"1d",TwoD:"2d",ThreeD:"3d"},exports.GPUTextureFormat={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BRGA8Unorm:"bgra8unorm",BRGA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10uFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Stencil8:"stencil8",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSNorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",Depth24UnormStencil8:"depth24unorm-stencil8",Depth32FloatStencil8:"depth32float-stencil8"},exports.GPUTextureViewDimension=J,exports.GPUVertexFormat={Uchar2:"uchar2",Uchar4:"uchar4",Char2:"char2",Char4:"char4",Uchar2Norm:"uchar2norm",Uchar4Norm:"uchar4norm",Char2Norm:"char2norm",Char4Norm:"char4norm",Ushort2:"ushort2",Ushort4:"ushort4",Short2:"short2",Short4:"short4",Ushort2Norm:"ushort2norm",Ushort4Norm:"ushort4norm",Short2Norm:"short2norm",Short4Norm:"short4norm",Half2:"half2",Half4:"half4",Float:"float",Float2:"float2",Float3:"float3",Float4:"float4",Uint:"uint",Uint2:"uint2",Uint3:"uint3",Uint4:"uint4",Int:"int",Int2:"int2",Int3:"int3",Int4:"int4"},exports.GammaCorrectionShader=Ts,exports.Geometry=nh,exports.GeometryCompressionUtils=si,exports.GlitchPass=nn,exports.GodRaysCombineShader=Po,exports.GodRaysDepthMaskShader=Bo,exports.GodRaysFakeSunShader=Do,exports.GodRaysGenerateShader=Lo,exports.GrannyKnot=Gc,exports.Gyroscope=_,exports.HDRCubeTextureLoader=qu,exports.HalftonePass=sn,exports.HalftoneShader=on,exports.HeartCurve=jc,exports.HelixCurve=Wc,exports.HorizontalBlurShader={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},exports.HorizontalTiltShiftShader=As,exports.HueSaturationShader=Es,exports.IFFParser=vu,exports.ImprovedNoise=function(){for(var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=0;t<256;t++)e[256+t]=e[t];function r(e){return e*e*e*(e*(6*e-15)+10)}function a(e,t,r){return t+e*(r-t)}function i(e,t,r,a){var i=15&e,n=i<8?t:r,o=i<4?r:12==i||14==i?t:a;return(0==(1&i)?n:-n)+(0==(2&i)?o:-o)}return{noise:function(t,n,o){var s=Math.floor(t),l=Math.floor(n),u=Math.floor(o),c=255&s,h=255&l,d=255&u,f=(t-=s)-1,p=(n-=l)-1,m=(o-=u)-1,v=r(t),g=r(n),y=r(o),x=e[c]+h,b=e[x]+d,A=e[x+1]+d,w=e[c+1]+h,M=e[w]+d,S=e[w+1]+d;return a(y,a(g,a(v,i(e[b],t,n,o),i(e[M],f,n,o)),a(v,i(e[A],t,p,o),i(e[S],f,p,o))),a(g,a(v,i(e[b+1],t,n,m),i(e[M+1],f,n,m)),a(v,i(e[A+1],t,p,m),i(e[S+1],f,p,m))))}}},exports.InputNode=Ze,exports.InstancedFlow=De,exports.IntNode=Nr,exports.JoinNode=Br,exports.KMZLoader=qs,exports.KTX2Loader=ll,exports.KTXLoader=zu,exports.KaleidoShader=Io,exports.KnotCurve=Hc,exports.LDrawLoader=fu,exports.LUT3dlLoader=Al,exports.LUTCubeLoader=Us,exports.LUTPass=tn,exports.LWO2Parser=mu,exports.LWO3Parser=pu,exports.LWOLoader=dc,exports.Lensflare=Aa,exports.LensflareElement=Ta,exports.LightNode=vr,exports.LightProbeGenerator=Uc,exports.LightProbeHelper=Fc,exports.LightningStorm=Da,exports.LightningStrike=Pa,exports.Line2=Cc,exports.LineGeometry=yc,exports.LineMaterial=wc,exports.LineSegments2=Tc,exports.LineSegmentsGeometry=gc,exports.LottieLoader=cl,exports.LuminanceNode=Gr,exports.LuminosityHighPassShader=Fn,exports.LuminosityShader=Sn,exports.Lut=_i,exports.MD2Character=function(){var t=this;function r(t,r){for(var a=new e.TextureLoader,n=[],o=0;o<r.length;o++)n[o]=a.load(t+r[o],i),n[o].mapping=e.UVMapping,n[o].name=r[o],n[o].encoding=e.sRGBEncoding;return n}function a(t,r){var a=new e.MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),i=new e.MeshLambertMaterial({color:16777215,wireframe:!1,map:r,morphTargets:!0,morphNormals:!0}),n=new e.Mesh(t,i);return n.rotation.y=-Math.PI/2,n.castShadow=!0,n.receiveShadow=!0,n.materialTexture=i,n.materialWireframe=a,n}function i(){t.loadCounter-=1,0===t.loadCounter&&t.onLoadComplete()}this.scale=1,this.animationFPS=6,this.root=new e.Object3D,this.meshBody=null,this.meshWeapon=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.activeAnimation=null,this.mixer=null,this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(n){this.loadCounter=2*n.weapons.length+n.skins.length+1;for(var o=[],s=0;s<n.weapons.length;s++)o[s]=n.weapons[s][1];this.skinsBody=r(n.baseUrl+"skins/",n.skins),this.skinsWeapon=r(n.baseUrl+"skins/",o);var l=new S;l.load(n.baseUrl+n.body,(function(r){var n=new e.Box3;n.setFromBufferAttribute(r.attributes.position),t.root.position.y=-t.scale*n.min.y;var o=a(r,t.skinsBody[0]);o.scale.set(t.scale,t.scale,t.scale),t.root.add(o),t.meshBody=o,t.meshBody.clipOffset=0,t.activeAnimationClipName=o.geometry.animations[0].name,t.mixer=new e.AnimationMixer(o),i()}));for(var u=function(e,r){return function(n){var o=a(n,t.skinsWeapon[e]);o.scale.set(t.scale,t.scale,t.scale),o.visible=!1,o.name=r,t.root.add(o),t.weapons[e]=o,t.meshWeapon=o,i()}},c=0;c<n.weapons.length;c++)l.load(n.baseUrl+n.weapons[c][0],u(c,n.weapons[c][0]))},this.setPlaybackRate=function(e){this.mixer.timeScale=0!==e?1/e:0},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e])},this.setWeapon=function(e){for(var r=0;r<this.weapons.length;r++)this.weapons[r].visible=!1;var a=this.weapons[e];a&&(a.visible=!0,this.meshWeapon=a,t.syncWeaponAnimation())},this.setAnimation=function(e){if(this.meshBody){this.meshBody.activeAction&&(this.meshBody.activeAction.stop(),this.meshBody.activeAction=null);var r=this.mixer.clipAction(e,this.meshBody);r&&(this.meshBody.activeAction=r.play())}t.activeClipName=e,t.syncWeaponAnimation()},this.syncWeaponAnimation=function(){var e=t.activeClipName;if(t.meshWeapon){this.meshWeapon.activeAction&&(this.meshWeapon.activeAction.stop(),this.meshWeapon.activeAction=null);var r=this.mixer.clipAction(e,this.meshWeapon);r&&(this.meshWeapon.activeAction=r.syncWith(this.meshBody.activeAction).play())}},this.update=function(e){this.mixer&&this.mixer.update(e)}},exports.MD2CharacterComplex=function(){var t=this;function r(t,r){for(var a=new e.TextureLoader,n=[],o=0;o<r.length;o++)n[o]=a.load(t+r[o],i),n[o].mapping=e.UVMapping,n[o].name=r[o],n[o].encoding=e.sRGBEncoding;return n}function a(r,a){var i=new e.MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),n=new e.MeshLambertMaterial({color:16777215,wireframe:!1,map:a,morphTargets:!0,morphNormals:!0}),o=new T(r,n);return o.rotation.y=-Math.PI/2,o.materialTexture=n,o.materialWireframe=i,o.autoCreateAnimations(t.animationFPS),o}function i(){t.loadCounter-=1,0===t.loadCounter&&t.onLoadComplete()}function n(e){return 1===e?1:1-Math.pow(2,-10*e)}this.scale=1,this.animationFPS=6,this.transitionFrames=15,this.maxSpeed=275,this.maxReverseSpeed=-275,this.frontAcceleration=600,this.backAcceleration=600,this.frontDecceleration=600,this.angularSpeed=2.5,this.root=new e.Object3D,this.meshBody=null,this.meshWeapon=null,this.controls=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.currentSkin=void 0,this.onLoadComplete=function(){},this.meshes=[],this.animations={},this.loadCounter=0,this.speed=0,this.bodyOrientation=0,this.walkSpeed=this.maxSpeed,this.crouchSpeed=.5*this.maxSpeed,this.activeAnimation=null,this.oldAnimation=null,this.enableShadows=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].castShadow=e,this.meshes[t].receiveShadow=e},this.setVisible=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].visible=e,this.meshes[t].visible=e},this.shareParts=function(e){this.animations=e.animations,this.walkSpeed=e.walkSpeed,this.crouchSpeed=e.crouchSpeed,this.skinsBody=e.skinsBody,this.skinsWeapon=e.skinsWeapon;var t=a(e.meshBody.geometry,this.skinsBody[0]);t.scale.set(this.scale,this.scale,this.scale),this.root.position.y=e.root.position.y,this.root.add(t),this.meshBody=t,this.meshes.push(t);for(var r=0;r<e.weapons.length;r++){var i=a(e.weapons[r].geometry,this.skinsWeapon[r]);i.scale.set(this.scale,this.scale,this.scale),i.visible=!1,i.name=e.weapons[r].name,this.root.add(i),this.weapons[r]=i,this.meshWeapon=i,this.meshes.push(i)}},this.loadParts=function(n){this.animations=n.animations,this.walkSpeed=n.walkSpeed,this.crouchSpeed=n.crouchSpeed,this.loadCounter=2*n.weapons.length+n.skins.length+1;for(var o=[],s=0;s<n.weapons.length;s++)o[s]=n.weapons[s][1];this.skinsBody=r(n.baseUrl+"skins/",n.skins),this.skinsWeapon=r(n.baseUrl+"skins/",o);var l=new S;l.load(n.baseUrl+n.body,(function(r){var n=new e.Box3;n.setFromBufferAttribute(r.attributes.position),t.root.position.y=-t.scale*n.min.y;var o=a(r,t.skinsBody[0]);o.scale.set(t.scale,t.scale,t.scale),t.root.add(o),t.meshBody=o,t.meshes.push(o),i()}));for(var u=function(e,r){return function(n){var o=a(n,t.skinsWeapon[e]);o.scale.set(t.scale,t.scale,t.scale),o.visible=!1,o.name=r,t.root.add(o),t.weapons[e]=o,t.meshWeapon=o,t.meshes.push(o),i()}},c=0;c<n.weapons.length;c++)l.load(n.baseUrl+n.weapons[c][0],u(c,n.weapons[c][0]))},this.setPlaybackRate=function(e){this.meshBody&&(this.meshBody.duration=this.meshBody.baseDuration/e),this.meshWeapon&&(this.meshWeapon.duration=this.meshWeapon.baseDuration/e)},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e],this.currentSkin=e)},this.setWeapon=function(e){for(var t=0;t<this.weapons.length;t++)this.weapons[t].visible=!1;var r=this.weapons[e];r&&(r.visible=!0,this.meshWeapon=r,this.activeAnimation&&(r.playAnimation(this.activeAnimation),this.meshWeapon.setAnimationTime(this.activeAnimation,this.meshBody.getAnimationTime(this.activeAnimation))))},this.setAnimation=function(e){e!==this.activeAnimation&&e&&(this.meshBody&&(this.meshBody.setAnimationWeight(e,0),this.meshBody.playAnimation(e),this.oldAnimation=this.activeAnimation,this.activeAnimation=e,this.blendCounter=this.transitionFrames),this.meshWeapon&&(this.meshWeapon.setAnimationWeight(e,0),this.meshWeapon.playAnimation(e)))},this.update=function(e){this.controls&&this.updateMovementModel(e),this.animations&&(this.updateBehaviors(),this.updateAnimations(e))},this.updateAnimations=function(e){var t=1;this.blendCounter>0&&(t=(this.transitionFrames-this.blendCounter)/this.transitionFrames,this.blendCounter-=1),this.meshBody&&(this.meshBody.update(e),this.meshBody.setAnimationWeight(this.activeAnimation,t),this.meshBody.setAnimationWeight(this.oldAnimation,1-t)),this.meshWeapon&&(this.meshWeapon.update(e),this.meshWeapon.setAnimationWeight(this.activeAnimation,t),this.meshWeapon.setAnimationWeight(this.oldAnimation,1-t))},this.updateBehaviors=function(){var e,t,r=this.controls,a=this.animations;r.crouch?(e=a.crouchMove,t=a.crouchIdle):(e=a.move,t=a.idle),r.jump&&(e=a.jump,t=a.jump),r.attack&&(r.crouch?(e=a.crouchAttack,t=a.crouchAttack):(e=a.attack,t=a.attack)),(r.moveForward||r.moveBackward||r.moveLeft||r.moveRight)&&this.activeAnimation!==e&&this.setAnimation(e),Math.abs(this.speed)<.2*this.maxSpeed&&!(r.moveLeft||r.moveRight||r.moveForward||r.moveBackward)&&this.activeAnimation!==t&&this.setAnimation(t),r.moveForward&&(this.meshBody&&(this.meshBody.setAnimationDirectionForward(this.activeAnimation),this.meshBody.setAnimationDirectionForward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionForward(this.activeAnimation),this.meshWeapon.setAnimationDirectionForward(this.oldAnimation))),r.moveBackward&&(this.meshBody&&(this.meshBody.setAnimationDirectionBackward(this.activeAnimation),this.meshBody.setAnimationDirectionBackward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionBackward(this.activeAnimation),this.meshWeapon.setAnimationDirectionBackward(this.oldAnimation)))},this.updateMovementModel=function(t){var r=this.controls;r.crouch?this.maxSpeed=this.crouchSpeed:this.maxSpeed=this.walkSpeed,this.maxReverseSpeed=-this.maxSpeed,r.moveForward&&(this.speed=e.MathUtils.clamp(this.speed+t*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),r.moveBackward&&(this.speed=e.MathUtils.clamp(this.speed-t*this.backAcceleration,this.maxReverseSpeed,this.maxSpeed));if(r.moveLeft&&(this.bodyOrientation+=t*this.angularSpeed,this.speed=e.MathUtils.clamp(this.speed+1*t*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),r.moveRight&&(this.bodyOrientation-=t*this.angularSpeed,this.speed=e.MathUtils.clamp(this.speed+1*t*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),!r.moveForward&&!r.moveBackward)if(this.speed>0){var a=n(this.speed/this.maxSpeed);this.speed=e.MathUtils.clamp(this.speed-a*t*this.frontDecceleration,0,this.maxSpeed)}else{a=n(this.speed/this.maxReverseSpeed);this.speed=e.MathUtils.clamp(this.speed+a*t*this.backAcceleration,this.maxReverseSpeed,0)}var i=this.speed*t;this.root.position.x+=Math.sin(this.bodyOrientation)*i,this.root.position.z+=Math.cos(this.bodyOrientation)*i,this.root.rotation.y=this.bodyOrientation}},exports.MD2Loader=S,exports.MDDLoader=pl,exports.MMDAnimationHelper=va,exports.MMDExporter=function(){var t;this.parseVpd=function(r,a,i){if(!0!==r.isSkinnedMesh)return console.warn("THREE.MMDExporter: parseVpd() requires SkinnedMesh instance."),null;function n(e){Math.abs(e)<1e-6&&(e=0);var t=e.toString();-1===t.indexOf(".")&&(t+=".");var r=(t+="000000").indexOf(".");return t.slice(0,r)+"."+t.slice(r+1,r+7)}function o(e){for(var t=[],r=0,a=e.length;r<a;r++)t.push(n(e[r]));return t.join(",")}r.updateMatrixWorld(!0);var s=r.skeleton.bones,l=function(e){var t=e.clone();return t.pose(),t.skeleton.bones}(r),c=new e.Vector3,h=new e.Quaternion,d=new e.Quaternion,f=new e.Matrix4,p=[];p.push("Vocaloid Pose Data file"),p.push(""),p.push((""!==r.name?r.name.replace(/\s/g,"_"):"skin")+".osm;"),p.push(s.length+";"),p.push("");for(var m=0,v=s.length;m<v;m++){var g=s[m],y=l[m];!0===i&&void 0!==g.userData.ik&&void 0!==g.userData.ik.originalMatrix?f.fromArray(g.userData.ik.originalMatrix):f.copy(g.matrix),c.setFromMatrixPosition(f),h.setFromRotationMatrix(f);var x=c.sub(y.position).toArray(),b=d.copy(y.quaternion).conjugate().multiply(h).toArray();x[2]=-x[2],b[0]=-b[0],b[1]=-b[1],p.push("Bone"+m+"{"+g.name),p.push("  "+o(x)+";"),p.push("  "+o(b)+";"),p.push("}"),p.push("")}p.push("");var A=p.join("\n");return!0===a?function(e){if(void 0===t){var r=(new u.CharsetEncoder).s2uTable;t={};for(var a=Object.keys(r),i=0,n=a.length;i<n;i++){var o=a[i],s=r[o];o=parseInt(o),t[s]=o}}for(var l=[],c=0,h=e.length;c<h;c++){var d=e.charCodeAt(c);if(void 0===(s=t[d]))throw"cannot convert charcode 0x"+d.toString(16);s>255?(l.push(s>>8&255),l.push(255&s)):l.push(255&s)}return new Uint8Array(l)}(A):A}},exports.MMDLoader=ju,exports.MMDPhysics=ma,exports.MTLLoader=Gs,exports.MapControls=qi,exports.MapControlsExp=Vi,exports.MarchingCubes=Fa,exports.MaskPass=In,exports.MathNode=Ct,exports.Matrix3Node=Tr,exports.Matrix3NodeUniform=ce,exports.Matrix3Uniform=ae,exports.Matrix4Node=Rr,exports.Matrix4NodeUniform=he,exports.Matrix4Uniform=ie,exports.MaxMIPLevelNode=Vt,exports.MeshStandardNode=nr,exports.MeshStandardNodeMaterial=ur,exports.MeshSurfaceSampler=di,exports.MeshoptDecoder=lh,exports.MirrorShader=No,exports.MorphAnimMesh=I,exports.MorphBlendMesh=T,exports.NRRDLoader=ks,exports.NURBSCurve=eo,exports.NURBSSurface=Vc,exports.Node=Ke,exports.NodeBuilder=Zt,exports.NodeFrame=fr,exports.NodeLib=xt,exports.NodeMaterial=er,exports.NodeMaterialLoader=lc,exports.NodeMaterialLoaderUtils=uc,exports.NodePass=Yr,exports.NodePostProcessing=zr,exports.NodeShaderStage={Vertex:"vertex",Fragment:"fragment"},exports.NodeType={Float:"float",Vector2:"vec2",Vector3:"vec3",Vector4:"vec4",Matrix3:"mat3",Matrix4:"mat4"},exports.NodeUniform=zt,exports.NodeUpdateType={None:"none",Frame:"frame",Object:"object"},exports.NodeUtils=Rt,exports.NoiseNode=Ur,exports.NormalMapNode=Ot,exports.NormalMapShader=ys,exports.NormalNode=Lt,exports.OBB=Bi,exports.OBJExporter=da,exports.OBJLoader=Vu,exports.Octree=Ri,exports.OneMinusBlendColorFactor=212,exports.OperatorNode=Tt,exports.OrbitControls=Ki,exports.OrbitControlsExp=ki,exports.OutlineEffect=function(t,r){r=r||{},this.enabled=!0;var a=void 0!==r.defaultThickness?r.defaultThickness:.003,i=(new e.Color).fromArray(void 0!==r.defaultColor?r.defaultColor:[0,0,0]),n=void 0!==r.defaultAlpha?r.defaultAlpha:1,o=void 0!==r.defaultKeepAlive&&r.defaultKeepAlive,s={},l={},u={},c={outlineThickness:{value:a},outlineColor:{value:i},outlineAlpha:{value:n}},h=["#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 normal, vec4 skinned ) {","\tfloat thickness = outlineThickness;","\tconst float ratio = 1.0;","\tvec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + normal, 1.0 );","\tvec4 norm = normalize( pos - pos2 );","\treturn pos + norm * thickness * pos.w * ratio;","}","void main() {","\t#include <uv_vertex>","\t#include <beginnormal_vertex>","\t#include <morphnormal_vertex>","\t#include <skinbase_vertex>","\t#include <skinnormal_vertex>","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <displacementmap_vertex>","\t#include <project_vertex>","\tvec3 outlineNormal = - objectNormal;","\tgl_Position = calculateOutline( gl_Position, outlineNormal, vec4( transformed, 1.0 ) );","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\t#include <fog_vertex>","}"].join("\n"),d=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","\t#include <clipping_planes_fragment>","\t#include <logdepthbuf_fragment>","\tgl_FragColor = vec4( outlineColor, outlineAlpha );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","\t#include <premultiplied_alpha_fragment>","}"].join("\n");function f(t){var r=function(t){var r=s[t.uuid];return void 0===r&&(r={material:new e.ShaderMaterial({type:"OutlineEffect",uniforms:e.UniformsUtils.merge([e.UniformsLib.fog,e.UniformsLib.displacementmap,c]),vertexShader:h,fragmentShader:d,side:e.BackSide}),used:!0,keepAlive:o,count:0},s[t.uuid]=r),r.used=!0,r.material}(t);return l[r.uuid]=t,function(e,t){if("invisible"===e.name)return;var r=t.userData.outlineParameters;e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.fog=t.fog,e.toneMapped=t.toneMapped,e.premultipliedAlpha=t.premultipliedAlpha,e.displacementMap=t.displacementMap,void 0!==r?(!1===t.visible?e.visible=!1:e.visible=void 0===r.visible||r.visible,e.transparent=void 0!==r.alpha&&r.alpha<1||t.transparent,void 0!==r.keepAlive&&(s[t.uuid].keepAlive=r.keepAlive)):(e.transparent=t.transparent,e.visible=t.visible);!0!==t.wireframe&&!1!==t.depthTest||(e.visible=!1);t.clippingPlanes&&(e.clipping=!0,e.clippingPlanes=t.clippingPlanes,e.clipIntersection=t.clipIntersection,e.clipShadows=t.clipShadows);e.version=t.version}(r,t),r}function p(e){var t=e.geometry,r=!1;return void 0!==e.geometry&&(r=!t.isBufferGeometry||void 0!==t.attributes.normal),!0===e.isMesh&&void 0!==e.material&&!0===r}function m(e){if(!1!==p(e)){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=f(e.material[t]);else e.material=f(e.material);u[e.uuid]=e.onBeforeRender,e.onBeforeRender=g}}function v(e){if(!1!==p(e)){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=l[e.material[t].uuid];else e.material=l[e.material.uuid];e.onBeforeRender=u[e.uuid]}}function g(e,t,r,a,i){var n=l[i.uuid];void 0!==n&&function(e,t){var r=t.userData.outlineParameters;e.uniforms.outlineAlpha.value=t.opacity,void 0!==r&&(void 0!==r.thickness&&(e.uniforms.outlineThickness.value=r.thickness),void 0!==r.color&&e.uniforms.outlineColor.value.fromArray(r.color),void 0!==r.alpha&&(e.uniforms.outlineAlpha.value=r.alpha));t.displacementMap&&(e.uniforms.displacementMap.value=t.displacementMap,e.uniforms.displacementScale.value=t.displacementScale,e.uniforms.displacementBias.value=t.displacementBias)}(i,n)}this.render=function(e,r){var a,i=!1;if(void 0!==arguments[2]&&(console.warn("THREE.OutlineEffect.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),a=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.OutlineEffect.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),void 0!==a&&t.setRenderTarget(a),i&&t.clear(),!1!==this.enabled){var n=t.autoClear;t.autoClear=this.autoClear,t.render(e,r),t.autoClear=n,this.renderOutline(e,r)}else t.render(e,r)},this.renderOutline=function(e,r){var a=t.autoClear,i=e.autoUpdate,n=e.background,o=t.shadowMap.enabled;e.autoUpdate=!1,e.background=null,t.autoClear=!1,t.shadowMap.enabled=!1,e.traverse(m),t.render(e,r),e.traverse(v),function(){for(var e,t=0,r=(e=Object.keys(l)).length;t<r;t++)l[e[t]]=void 0;for(var a=0,i=(e=Object.keys(u)).length;a<i;a++)u[e[a]]=void 0;for(var n=0,o=(e=Object.keys(s)).length;n<o;n++){var c=e[n];!1===s[c].used?(s[c].count++,!1===s[c].keepAlive&&s[c].count>60&&delete s[c]):(s[c].used=!1,s[c].count=0)}}(),e.autoUpdate=i,e.background=n,t.autoClear=a,t.shadowMap.enabled=o},this.autoClear=t.autoClear,this.domElement=t.domElement,this.shadowMap=t.shadowMap,this.clear=function(e,r,a){t.clear(e,r,a)},this.getPixelRatio=function(){return t.getPixelRatio()},this.setPixelRatio=function(e){t.setPixelRatio(e)},this.getSize=function(e){return t.getSize(e)},this.setSize=function(e,r,a){t.setSize(e,r,a)},this.setViewport=function(e,r,a,i){t.setViewport(e,r,a,i)},this.setScissor=function(e,r,a,i){t.setScissor(e,r,a,i)},this.setScissorTest=function(e){t.setScissorTest(e)},this.setRenderTarget=function(e){t.setRenderTarget(e)}},exports.OutlinePass=mn,exports.PCDLoader=hc,exports.PDBLoader=Zu,exports.PLYExporter=la,exports.PLYLoader=vc,exports.PRWMLoader=rc,exports.PVRLoader=Ml,exports.PackedPhongMaterial=li,exports.ParallaxBarrierEffect=function(t){var r=new e.OrthographicCamera(-1,1,1,-1,0,1),a=new e.Scene,i=new e.StereoCamera,n={minFilter:e.LinearFilter,magFilter:e.NearestFilter,format:e.RGBAFormat},o=new e.WebGLRenderTarget(512,512,n),s=new e.WebGLRenderTarget(512,512,n),l=new e.ShaderMaterial({uniforms:{mapLeft:{value:o.texture},mapRight:{value:s.texture}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","\tvec2 uv = vUv;","\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {","\t\tgl_FragColor = texture2D( mapLeft, uv );","\t} else {","\t\tgl_FragColor = texture2D( mapRight, uv );","\t}","}"].join("\n")}),u=new e.Mesh(new e.PlaneGeometry(2,2),l);a.add(u),this.setSize=function(e,r){t.setSize(e,r);var a=t.getPixelRatio();o.setSize(e*a,r*a),s.setSize(e*a,r*a)},this.render=function(e,n){e.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),i.update(n),t.setRenderTarget(o),t.clear(),t.render(e,i.cameraL),t.setRenderTarget(s),t.clear(),t.render(e,i.cameraR),t.setRenderTarget(null),t.render(a,r)}},exports.ParallaxShader=Uo,exports.ParametricGeometries=uo,exports.Pass=Wr,exports.PeppersGhostEffect=function(t){var r,a,i,n=this;n.cameraDistance=15,n.reflectFromAbove=!1;var o=new e.PerspectiveCamera,s=new e.PerspectiveCamera,l=new e.PerspectiveCamera,u=new e.PerspectiveCamera,c=new e.Vector3,h=new e.Quaternion,d=new e.Vector3;t.autoClear=!1,this.setSize=function(e,n){r=e/2,e<n?(a=e/3,i=e/3):(a=n/3,i=n/3),t.setSize(e,n)},this.render=function(e,f){e.updateMatrixWorld(),null===f.parent&&f.updateMatrixWorld(),f.matrixWorld.decompose(c,h,d),o.position.copy(c),o.quaternion.copy(h),o.translateZ(n.cameraDistance),o.lookAt(e.position),s.position.copy(c),s.quaternion.copy(h),s.translateZ(-n.cameraDistance),s.lookAt(e.position),s.rotation.z+=Math.PI/180*180,l.position.copy(c),l.quaternion.copy(h),l.translateX(-n.cameraDistance),l.lookAt(e.position),l.rotation.x+=Math.PI/180*90,u.position.copy(c),u.quaternion.copy(h),u.translateX(n.cameraDistance),u.lookAt(e.position),u.rotation.x+=Math.PI/180*90,t.clear(),t.setScissorTest(!0),t.setScissor(r-a/2,2*i,a,i),t.setViewport(r-a/2,2*i,a,i),n.reflectFromAbove?t.render(e,s):t.render(e,o),t.setScissor(r-a/2,0,a,i),t.setViewport(r-a/2,0,a,i),n.reflectFromAbove?t.render(e,o):t.render(e,s),t.setScissor(r-a/2-a,i,a,i),t.setViewport(r-a/2-a,i,a,i),n.reflectFromAbove?t.render(e,u):t.render(e,l),t.setScissor(r+a/2,i,a,i),t.setViewport(r+a/2,i,a,i),n.reflectFromAbove?t.render(e,l):t.render(e,u),t.setScissorTest(!1)}},exports.PhongNode=or,exports.PhongNodeMaterial=lr,exports.PixelShader=Vo,exports.PointerLockControls=Qi,exports.PositionNode=Bt,exports.PositionalAudioHelper=Pc,exports.ProgressiveLightMap=X,exports.Projector=Me,exports.PropertyNode=ar,exports.RGBELoader=dl,exports.RGBMLoader=ac,exports.RGBShiftShader=zo,exports.RTTNode=Or,exports.RawNode=$t,exports.RectAreaLightHelper=Ic,exports.RectAreaLightUniformsLib=Oc,exports.ReflectNode=Pt,exports.Reflector=ga,exports.ReflectorForSSRPass=Ra,exports.ReflectorNode=Ir,exports.ReflectorRTT=Na,exports.Refractor=ya,exports.RenderPass=Qn,exports.RenderableFace=xe,exports.RenderableLine=Ae,exports.RenderableObject=ye,exports.RenderableSprite=we,exports.RenderableVertex=be,exports.ResolutionNode=gr,exports.Rhino3dmLoader=ku,exports.RollerCoasterGeometry=O,exports.RollerCoasterLiftersGeometry=U,exports.RollerCoasterShadowGeometry=k,exports.RoomEnvironment=function(){var t=new e.Scene,r=new e.BoxGeometry;r.deleteAttribute("uv");var a=new e.MeshStandardMaterial({side:e.BackSide}),i=new e.MeshStandardMaterial,n=new e.PointLight(16777215,5,28,2);n.position.set(.418,16.199,.3),t.add(n);var o=new e.Mesh(r,a);o.position.set(-.757,13.219,.717),o.scale.set(31.713,28.305,28.591),t.add(o);var s=new e.Mesh(r,i);s.position.set(-10.906,2.009,1.846),s.rotation.set(0,-.195,0),s.scale.set(2.328,7.905,4.651),t.add(s);var l=new e.Mesh(r,i);l.position.set(-5.607,-.754,-.758),l.rotation.set(0,.994,0),l.scale.set(1.97,1.534,3.955),t.add(l);var u=new e.Mesh(r,i);u.position.set(6.167,.857,7.803),u.rotation.set(0,.561,0),u.scale.set(3.927,6.285,3.687),t.add(u);var c=new e.Mesh(r,i);c.position.set(-2.017,.018,6.124),c.rotation.set(0,.333,0),c.scale.set(2.002,4.566,2.064),t.add(c);var h=new e.Mesh(r,i);h.position.set(2.291,-.756,-2.621),h.rotation.set(0,-.286,0),h.scale.set(1.546,1.552,1.496),t.add(h);var d=new e.Mesh(r,i);d.position.set(-2.193,-.369,-5.547),d.rotation.set(0,.516,0),d.scale.set(3.875,3.487,2.986),t.add(d);var f=new e.Mesh(r,x(50));f.position.set(-16.116,14.37,8.208),f.scale.set(.1,2.428,2.739),t.add(f);var p=new e.Mesh(r,x(50));p.position.set(-16.109,18.021,-8.207),p.scale.set(.1,2.425,2.751),t.add(p);var m=new e.Mesh(r,x(17));m.position.set(14.904,12.198,-1.832),m.scale.set(.15,4.265,6.331),t.add(m);var v=new e.Mesh(r,x(43));v.position.set(-.462,8.89,14.52),v.scale.set(4.38,5.441,.088),t.add(v);var g=new e.Mesh(r,x(20));g.position.set(3.235,11.486,-12.541),g.scale.set(2.5,2,.1),t.add(g);var y=new e.Mesh(r,x(100));function x(t){var r=new e.MeshBasicMaterial;return r.color.setScalar(t),r}return y.position.set(0,20,0),y.scale.set(1,.1,1),t.add(y),t},exports.RoughnessMipmapper=Ha,exports.RoundedBoxGeometry=fo,exports.SAOPass=Nn,exports.SAOShader=Ln,exports.SMAABlendShader=cn,exports.SMAAEdgesShader=ln,exports.SMAAPass=hn,exports.SMAAWeightsShader=un,exports.SSAARenderPass=Wn,exports.SSAOBlurShader=yn,exports.SSAODepthShader=gn,exports.SSAOPass=xn,exports.SSAOShader=vn,exports.SSRBlurShader=zn,exports.SSRDepthShader=jn,exports.SSRPass=Hn,exports.SSRShader=Gn,exports.STLExporter=ha,exports.STLLoader=Vs,exports.SVGLoader=Uu,exports.SVGObject=Se,exports.SVGRenderer=function(){var t,r,a,i,n,o,s,l,u,c,h,d,f,p=this,m=new Me,v=document.createElementNS("http://www.w3.org/2000/svg","svg"),g=new e.Box2,y=new e.Box2,x=new e.Color,b=new e.Color,A=new e.Color,w=new e.Color,M=new e.Color,S=new e.Color,T=new e.Vector3,C=new e.Vector3,F=new e.Vector3,E=new e.Matrix3,B=new e.Matrix4,L=new e.Matrix4,P=[],D=0,N=1,R=null;function _(){for(D=0;v.childNodes.length>0;)v.removeChild(v.childNodes[0])}function I(e){return null!==R?e.toFixed(R):e}function O(e,t,r){var a=t.scale.x*o,i=t.scale.y*s;r.isPointsMaterial&&(a*=r.size,i*=r.size);var n="M"+I(e.x-.5*a)+","+I(e.y-.5*i)+"h"+I(a)+"v"+I(i)+"h"+I(-a)+"z",l="";(r.isSpriteMaterial||r.isPointsMaterial)&&(l="fill:"+r.color.getStyle()+";fill-opacity:"+r.opacity),G(l,n)}function U(e,t,r,a){var i="M"+I(e.positionScreen.x)+","+I(e.positionScreen.y)+"L"+I(t.positionScreen.x)+","+I(t.positionScreen.y);if(a.isLineBasicMaterial){var n="fill:none;stroke:"+a.color.getStyle()+";stroke-opacity:"+a.opacity+";stroke-width:"+a.linewidth+";stroke-linecap:"+a.linecap;a.isLineDashedMaterial&&(n=n+";stroke-dasharray:"+a.dashSize+","+a.gapSize),G(n,i)}}function k(e,t,r,i,n){p.info.render.vertices+=3,p.info.render.faces++;var o="M"+I(e.positionScreen.x)+","+I(e.positionScreen.y)+"L"+I(t.positionScreen.x)+","+I(t.positionScreen.y)+"L"+I(r.positionScreen.x)+","+I(r.positionScreen.y)+"z";n.isMeshBasicMaterial?(x.copy(n.color),n.vertexColors&&x.multiply(i.color)):n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial?(b.copy(n.color),n.vertexColors&&b.multiply(i.color),x.copy(A),C.copy(e.positionWorld).add(t.positionWorld).add(r.positionWorld).divideScalar(3),function(e,t,r,a){for(var i=0,n=e.length;i<n;i++){var o=e[i],s=o.color;if(o.isDirectionalLight){var l=T.setFromMatrixPosition(o.matrixWorld).normalize();if((u=r.dot(l))<=0)continue;u*=o.intensity,a.r+=s.r*u,a.g+=s.g*u,a.b+=s.b*u}else if(o.isPointLight){var u;if(l=T.setFromMatrixPosition(o.matrixWorld),(u=r.dot(T.subVectors(l,t).normalize()))<=0)continue;if(0==(u*=0==o.distance?1:1-Math.min(t.distanceTo(l)/o.distance,1)))continue;u*=o.intensity,a.r+=s.r*u,a.g+=s.g*u,a.b+=s.b*u}}}(a,C,i.normalModel,x),x.multiply(b).add(n.emissive)):n.isMeshNormalMaterial&&(F.copy(i.normalModel).applyMatrix3(E).normalize(),x.setRGB(F.x,F.y,F.z).multiplyScalar(.5).addScalar(.5)),G(n.wireframe?"fill:none;stroke:"+x.getStyle()+";stroke-opacity:"+n.opacity+";stroke-width:"+n.wireframeLinewidth+";stroke-linecap:"+n.wireframeLinecap+";stroke-linejoin:"+n.wireframeLinejoin:"fill:"+x.getStyle()+";fill-opacity:"+n.opacity,o)}function V(e,t,r){var a,i=t.x-e.x,n=t.y-e.y,o=i*i+n*n;0!==o&&(i*=a=r/Math.sqrt(o),n*=a,t.x+=i,t.y+=n,e.x-=i,e.y-=n)}function G(e,t){f===e?d+=t:(j(),f=e,d=t)}function j(){d&&((h=function(e){if(null==P[e])return P[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==N&&P[e].setAttribute("shape-rendering","crispEdges"),P[e];return P[e]}(D++)).setAttribute("d",d),h.setAttribute("style",f),v.appendChild(h)),d="",f=""}this.domElement=v,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":N=1;break;case"low":N=0}},this.setClearColor=function(e){S.set(e)},this.setPixelRatio=function(){},this.setSize=function(e,t){o=(i=e)/2,s=(n=t)/2,v.setAttribute("viewBox",-o+" "+-s+" "+i+" "+n),v.setAttribute("width",i),v.setAttribute("height",n),g.min.set(-o,-s),g.max.set(o,s)},this.getSize=function(){return{width:i,height:n}},this.setPrecision=function(e){R=e},this.clear=function(){_(),v.style.backgroundColor=S.getStyle()},this.render=function(i,n){if(n instanceof e.Camera!=!1){var h=i.background;h&&h.isColor?(_(),v.style.backgroundColor=h.getStyle()):!0===this.autoClear&&this.clear(),p.info.render.vertices=0,p.info.render.faces=0,B.copy(n.matrixWorldInverse),L.multiplyMatrices(n.projectionMatrix,B),t=m.projectScene(i,n,this.sortObjects,this.sortElements),r=t.elements,a=t.lights,E.getNormalMatrix(n.matrixWorldInverse),function(e){A.setRGB(0,0,0),w.setRGB(0,0,0),M.setRGB(0,0,0);for(var t=0,r=e.length;t<r;t++){var a=e[t],i=a.color;a.isAmbientLight?(A.r+=i.r,A.g+=i.g,A.b+=i.b):a.isDirectionalLight?(w.r+=i.r,w.g+=i.g,w.b+=i.b):a.isPointLight&&(M.r+=i.r,M.g+=i.g,M.b+=i.b)}}(a),d="",f="";for(var x=0,b=r.length;x<b;x++){var S=r[x],C=S.material;if(void 0!==C&&0!==C.opacity)if(y.makeEmpty(),S instanceof we)(l=S).x*=o,l.y*=-s,O(l,S,C);else if(S instanceof Ae)l=S.v1,u=S.v2,l.positionScreen.x*=o,l.positionScreen.y*=-s,u.positionScreen.x*=o,u.positionScreen.y*=-s,y.setFromPoints([l.positionScreen,u.positionScreen]),!0===g.intersectsBox(y)&&U(l,u,S,C);else if(S instanceof xe){if(l=S.v1,u=S.v2,c=S.v3,l.positionScreen.z<-1||l.positionScreen.z>1)continue;if(u.positionScreen.z<-1||u.positionScreen.z>1)continue;if(c.positionScreen.z<-1||c.positionScreen.z>1)continue;l.positionScreen.x*=o,l.positionScreen.y*=-s,u.positionScreen.x*=o,u.positionScreen.y*=-s,c.positionScreen.x*=o,c.positionScreen.y*=-s,this.overdraw>0&&(V(l.positionScreen,u.positionScreen,this.overdraw),V(u.positionScreen,c.positionScreen,this.overdraw),V(c.positionScreen,l.positionScreen,this.overdraw)),y.setFromPoints([l.positionScreen,u.positionScreen,c.positionScreen]),!0===g.intersectsBox(y)&&k(l,u,c,S,C)}}j(),i.traverseVisible((function(e){if(e instanceof Se){if(T.setFromMatrixPosition(e.matrixWorld),T.applyMatrix4(L),T.z<-1||T.z>1)return;var t=T.x*o,r=-T.y*s,a=e.node;a.setAttribute("transform","translate("+t+","+r+")"),v.appendChild(a)}}))}else console.error("THREE.SVGRenderer.render: camera is not an instance of Camera.")}},exports.SavePass=bn,exports.SceneUtils=Ua,exports.ScreenNode=_r,exports.ScreenUVNode=yr,exports.SelectionBox=Rs,exports.SelectionHelper=Ns,exports.SepiaShader=Wo,exports.ShaderPass=Qr,exports.ShadowMapViewer=oi,exports.ShadowMesh=ba,exports.SimplexNoise=La,exports.SimplifyModifier=Qe,exports.SkeletonUtils=ai,exports.Sky=_a,exports.SkyGeometry=V,exports.SobelOperatorShader=Ss,exports.SpecularMIPLevelNode=Gt,exports.SpriteNode=sr,exports.SpriteNodeMaterial=hr,exports.StandardNode=jt,exports.StandardNodeMaterial=tr,exports.StereoEffect=function(t){var r=new e.StereoCamera;r.aspect=.5;var a=new e.Vector2;this.setEyeSeparation=function(e){r.eyeSep=e},this.setSize=function(e,r){t.setSize(e,r)},this.render=function(e,i){e.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld(),r.update(i),t.getSize(a),t.autoClear&&t.clear(),t.setScissorTest(!0),t.setScissor(0,0,a.width/2,a.height),t.setViewport(0,0,a.width/2,a.height),t.render(e,r.cameraL),t.setScissor(a.width/2,0,a.width/2,a.height),t.setViewport(a.width/2,0,a.width/2,a.height),t.render(e,r.cameraR),t.setScissorTest(!1)}},exports.StructNode=it,exports.SubSlotNode=Sr,exports.SubsurfaceScatteringShader=fs,exports.SwitchNode=ir,exports.TAARenderPass=Xn,exports.TDSLoader=Tl,exports.TGALoader=Os,exports.TTFLoader=hl,exports.TeapotGeometry=go,exports.TechnicolorShader=Ps,exports.TempNode=qe,exports.TessellateModifier=function(t,r){var a=this;void 0===t&&(t=.1),void 0===r&&(r=6),b.default(this,"maxEdgeLength",void 0),b.default(this,"maxIterations",void 0),b.default(this,"modify",(function(t){null!==t.index&&(t=t.toNonIndexed());var r=a.maxIterations,i=a.maxEdgeLength*a.maxEdgeLength,n=new e.Vector3,o=new e.Vector3,s=new e.Vector3,l=new e.Vector3,u=[n,o,s,l],c=new e.Vector3,h=new e.Vector3,d=new e.Vector3,f=new e.Vector3,p=[c,h,d,f],m=new e.Color,v=new e.Color,g=new e.Color,y=new e.Color,x=[m,v,g,y],b=new e.Vector2,A=new e.Vector2,w=new e.Vector2,M=new e.Vector2,S=[b,A,w,M],T=new e.Vector2,C=new e.Vector2,F=new e.Vector2,E=new e.Vector2,B=[T,C,F,E],L=t.attributes,P=void 0!==L.normal,D=void 0!==L.color,N=void 0!==L.uv,R=void 0!==L.uv2,_=L.position.array,I=P?L.normal.array:null,O=D?L.color.array:null,U=N?L.uv.array:null,k=R?L.uv2.array:null,V=_,G=I,j=O,z=U,H=k,W=0,X=!0;function Q(e,t,r){var a=u[e],i=u[t],n=u[r];if(V.push(a.x,a.y,a.z),V.push(i.x,i.y,i.z),V.push(n.x,n.y,n.z),P){var o=p[e],s=p[t],l=p[r];G.push(o.x,o.y,o.z),G.push(s.x,s.y,s.z),G.push(l.x,l.y,l.z)}if(D){var c=x[e],h=x[t],d=x[r];j.push(c.r,c.g,c.b),j.push(h.r,h.g,h.b),j.push(d.r,d.g,d.b)}if(N){var f=S[e],m=S[t],v=S[r];z.push(f.x,f.y),z.push(m.x,m.y),z.push(v.x,v.y)}if(R){var g=B[e],y=B[t],b=B[r];H.push(g.x,g.y),H.push(y.x,y.y),H.push(b.x,b.y)}}for(;X&&W<r;){W++,X=!1,_=V,V=[],P&&(I=G,G=[]),D&&(O=j,j=[]),N&&(U=z,z=[]),R&&(k=H,H=[]);for(var Y=0,J=0,K=_.length;Y<K;Y+=9,J+=6){n.fromArray(_,Y+0),o.fromArray(_,Y+3),s.fromArray(_,Y+6),P&&I&&(c.fromArray(I,Y+0),h.fromArray(I,Y+3),d.fromArray(I,Y+6)),D&&O&&(m.fromArray(O,Y+0),v.fromArray(O,Y+3),g.fromArray(O,Y+6)),N&&U&&(b.fromArray(U,J+0),A.fromArray(U,J+2),w.fromArray(U,J+4)),R&&k&&(T.fromArray(k,J+0),C.fromArray(k,J+2),F.fromArray(k,J+4));var q=n.distanceToSquared(o),Z=o.distanceToSquared(s),$=n.distanceToSquared(s);q>i||Z>i||$>i?(X=!0,q>=Z&&q>=$?(l.lerpVectors(n,o,.5),P&&f.lerpVectors(c,h,.5),D&&y.lerpColors(m,v,.5),N&&M.lerpVectors(b,A,.5),R&&E.lerpVectors(T,C,.5),Q(0,3,2),Q(3,1,2)):Z>=q&&Z>=$?(l.lerpVectors(o,s,.5),P&&f.lerpVectors(h,d,.5),D&&y.lerpColors(v,g,.5),N&&M.lerpVectors(A,w,.5),R&&E.lerpVectors(C,F,.5),Q(0,1,3),Q(3,2,0)):(l.lerpVectors(n,s,.5),P&&f.lerpVectors(c,d,.5),D&&y.lerpColors(m,g,.5),N&&M.lerpVectors(b,w,.5),R&&E.lerpVectors(T,F,.5),Q(0,1,3),Q(3,1,2))):Q(0,1,2)}}var ee=new e.BufferGeometry;return ee.setAttribute("position",new e.Float32BufferAttribute(V,3)),P&&ee.setAttribute("normal",new e.Float32BufferAttribute(G,3)),D&&ee.setAttribute("color",new e.Float32BufferAttribute(j,3)),N&&ee.setAttribute("uv",new e.Float32BufferAttribute(z,2)),R&&ee.setAttribute("uv2",new e.Float32BufferAttribute(H,2)),ee})),this.maxEdgeLength=t,this.maxIterations=r},exports.TextureCubeNode=Dt,exports.TextureCubeUVNode=Et,exports.TextureNode=Xt,exports.TexturePass=Mn,exports.ThreeMFLoader=vl,exports.TiltLoader=Wu,exports.TimerNode=Lr,exports.ToneMapShader=Tn,exports.ToonShader1=ps,exports.ToonShader2=ms,exports.ToonShaderDotted=gs,exports.ToonShaderHatching=vs,exports.TorusKnot=Qc,exports.TrackballControls=Ji,exports.TrackballControlsExp=Gi,exports.TransformControls=zi,exports.TransformControlsGizmo=Hi,exports.TransformControlsPlane=Wi,exports.TreesGeometry=G,exports.TrefoilKnot=Xc,exports.TrefoilPolynomialKnot=Jc,exports.TriangleBlurShader=Ho,exports.TubePainter=function(){var t=3e6,r=new e.BufferAttribute(new Float32Array(t),3);r.usage=e.DynamicDrawUsage;var a=new e.BufferAttribute(new Float32Array(t),3);a.usage=e.DynamicDrawUsage;var i=new e.BufferAttribute(new Float32Array(t),3);i.usage=e.DynamicDrawUsage;var n=new e.BufferGeometry;n.setAttribute("position",r),n.setAttribute("normal",a),n.setAttribute("color",i),n.drawRange.count=0;var o=new e.MeshStandardMaterial({vertexColors:!0}),s=new e.Mesh(n,o);s.frustumCulled=!1;var l=new e.Vector3,u=new e.Vector3,c=new e.Vector3,h=new e.Vector3,d=new e.Color(16777215),f=1;function p(t,o,s,p){if(0!==t.distanceToSquared(o)){for(var m=n.drawRange.count,v=function(t){for(var r=2*Math.PI,a=[],i=.01*t,n=0;n<10;n++){var o=n/10*r;a.push(new e.Vector3(Math.sin(o)*i,Math.cos(o)*i,0))}return a}(f),g=0,y=v.length;g<y;g++){var x=v[g],b=v[(g+1)%y];l.copy(x).applyMatrix4(p).add(o),u.copy(b).applyMatrix4(p).add(o),c.copy(b).applyMatrix4(s).add(t),h.copy(x).applyMatrix4(s).add(t),l.toArray(r.array,3*(m+0)),u.toArray(r.array,3*(m+1)),h.toArray(r.array,3*(m+2)),u.toArray(r.array,3*(m+3)),c.toArray(r.array,3*(m+4)),h.toArray(r.array,3*(m+5)),l.copy(x).applyMatrix4(p).normalize(),u.copy(b).applyMatrix4(p).normalize(),c.copy(b).applyMatrix4(s).normalize(),h.copy(x).applyMatrix4(s).normalize(),l.toArray(a.array,3*(m+0)),u.toArray(a.array,3*(m+1)),h.toArray(a.array,3*(m+2)),u.toArray(a.array,3*(m+3)),c.toArray(a.array,3*(m+4)),h.toArray(a.array,3*(m+5)),d.toArray(i.array,3*(m+0)),d.toArray(i.array,3*(m+1)),d.toArray(i.array,3*(m+2)),d.toArray(i.array,3*(m+3)),d.toArray(i.array,3*(m+4)),d.toArray(i.array,3*(m+5)),m+=6}n.drawRange.count=m}}var m=new e.Vector3(0,1,0),v=new e.Vector3,g=new e.Vector3,y=new e.Matrix4,x=new e.Matrix4,b=0;return{mesh:s,moveTo:function(e){v.copy(e),y.lookAt(g,v,m),g.copy(e),x.copy(y)},lineTo:function(e){v.copy(e),y.lookAt(g,v,m),p(v,g,y,x),g.copy(v),x.copy(y)},setSize:function(e){f=e},update:function(){var e=b,t=n.drawRange.count;e!==t&&(r.updateRange.offset=3*e,r.updateRange.count=3*(t-e),r.needsUpdate=!0,a.updateRange.offset=3*e,a.updateRange.count=3*(t-e),a.needsUpdate=!0,i.updateRange.offset=3*e,i.updateRange.count=3*(t-e),i.needsUpdate=!0,b=n.drawRange.count)}}},exports.USDZExporter=Kr,exports.UVNode=It,exports.UVTransformNode=Cr,exports.UVsDebug=function(t,r){var a=new e.Vector2,i=new e.Vector2,n=[new e.Vector2,new e.Vector2,new e.Vector2],o=[],s=document.createElement("canvas"),l=r||1024,u=r||1024;s.width=l,s.height=u;var c=s.getContext("2d");if(c.lineWidth=1,c.strokeStyle="rgb( 63, 63, 63 )",c.textAlign="center",c.fillStyle="rgb( 255, 255, 255 )",c.fillRect(0,0,l,u),!t.isGeometry){var h=t.index,d=t.attributes.uv;if(h)for(var f=0,p=h.count;f<p;f+=3)o[0]=h.getX(f),o[1]=h.getX(f+1),o[2]=h.getX(f+2),n[0].fromBufferAttribute(d,o[0]),n[1].fromBufferAttribute(d,o[1]),n[2].fromBufferAttribute(d,o[2]),g(o,n,f/3);else for(var m=0,v=d.count;m<v;m+=3)o[0]=m,o[1]=m+1,o[2]=m+2,n[0].fromBufferAttribute(d,o[0]),n[1].fromBufferAttribute(d,o[1]),n[2].fromBufferAttribute(d,o[2]),g(o,n,m/3);return s}function g(e,t,r){c.beginPath(),a.set(0,0);for(var n=0,o=t.length;n<o;n++){var s=t[n];a.x+=s.x,a.y+=s.y,0===n?c.moveTo(s.x*(l-2)+.5,(1-s.y)*(u-2)+.5):c.lineTo(s.x*(l-2)+.5,(1-s.y)*(u-2)+.5)}for(c.closePath(),c.stroke(),a.divideScalar(t.length),c.font="18px Arial",c.fillStyle="rgb( 63, 63, 63 )",c.fillText(r,a.x*l,(1-a.y)*u),a.x>.95&&c.fillText(r,a.x%1*l,(1-a.y)*u),c.font="12px Arial",c.fillStyle="rgb( 191, 191, 191 )",j=0,jl=t.length;j<jl;j++){s=t[j];i.addVectors(a,s).divideScalar(2);var h=e[j];c.fillText("abc"[j]+h,i.x*l,(1-i.y)*u),i.x>.95&&c.fillText("abc"[j]+h,i.x%1*l,(1-i.y)*u)}}console.error("THREE.UVsDebug no longer supports Geometry. Use THREE.BufferGeometry instead.")},exports.UnpackDepthRGBAShader=ni,exports.UnrealBloomPass=En,exports.VOXDataTexture3D=sc,exports.VOXLoader=nc,exports.VOXMesh=oc,exports.VRButton=so,exports.VRMLLoader=el,exports.VRMLoader=$s,exports.VTKLoader=bl,exports.VarNode=dr,exports.Vector2Node=_t,exports.Vector2NodeUniform=oe,exports.Vector2Uniform=$,exports.Vector3Node=Ht,exports.Vector3NodeUniform=se,exports.Vector3Uniform=ee,exports.Vector4Node=Wt,exports.Vector4NodeUniform=le,exports.Vector4Uniform=te,exports.VelocityNode=Mr,exports.VertexNormalsHelper=_c,exports.VertexTangentsHelper=Lc,exports.VerticalBlurShader={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n  \n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "},exports.VerticalTiltShiftShader=ws,exports.VignetteShader=Cs,exports.VivianiCurve=zc,exports.Volume=W,exports.VolumeRenderShader1=bs,exports.VolumeSlice=H,exports.WEBGL=z,exports.Water=Ca,exports.Water2=Ia,exports.WaterRefractionShader=jo,exports.WebGPUSampled3DTexture=pe,exports.WebGPUSampledArrayTexture=fe,exports.WebGPUSampledCubeTexture=me,exports.WebGPUSampledTexture=de,exports.Wireframe=Mc,exports.WireframeGeometry2=Sc,exports.XLoader=Ys,exports.XREstimatedLight=oo,exports.XRHandModelFactory=io,exports.XRHandOculusMeshModel=ro,exports.XRHandPrimitiveModel=Kn,exports.XYZLoader=xl,exports.calcBSplineDerivatives=function(t,r,a,i,n){for(var o=n<t?n:t,s=[],l=this.findSpan(t,i,r),u=this.calcBasisFunctionDerivatives(l,i,t,o,r),c=[],h=0;h<a.length;++h){var d=(p=a[h].clone()).w;p.x*=d,p.y*=d,p.z*=d,c[h]=p}for(var f=0;f<=o;++f){for(var p=c[l-t].clone().multiplyScalar(u[f][0]),m=1;m<=t;++m)p.add(c[l-t+m].clone().multiplyScalar(u[f][m]));s[f]=p}for(var v=o+1;v<=n+1;++v)s[v]=new e.Vector4(0,0,0);return s},exports.calcBSplinePoint=qn,exports.calcBasisFunctionDerivatives=function(e,t,r,a,i){for(var n=[],o=0;o<=r;++o)n[o]=0;for(var s=[],l=0;l<=a;++l)s[l]=n.slice(0);for(var u=[],c=0;c<=r;++c)u[c]=n.slice(0);u[0][0]=1;for(var h=n.slice(0),d=n.slice(0),f=1;f<=r;++f){h[f]=t-i[e+1-f],d[f]=i[e+f]-t;for(var p=0,m=0;m<f;++m){var v=d[m+1],g=h[f-m];u[f][m]=v+g;var y=u[m][f-1]/u[f][m];u[m][f]=p+v*y,p=g*y}u[f][f]=p}for(var x=0;x<=r;++x)s[0][x]=u[x][r];for(var b=0;b<=r;++b){for(var A=0,w=1,M=[],S=0;S<=r;++S)M[S]=n.slice(0);M[0][0]=1;for(var T=1;T<=a;++T){var C=0,F=b-T,E=r-T;b>=T&&(M[w][0]=M[A][0]/u[E+1][F],C=M[w][0]*u[F][E]);for(var B=b-1<=E?T-1:r-b,L=F>=-1?1:-F;L<=B;++L)M[w][L]=(M[A][L]-M[A][L-1])/u[E+1][F+L],C+=M[w][L]*u[F+L][E];b<=E&&(M[w][T]=-M[A][T-1]/u[E+1][b],C+=M[w][T]*u[b][E]),s[T][b]=C;var P=A;A=w,w=P}}for(var D=r,N=1;N<=a;++N){for(var R=0;R<=r;++R)s[N][R]*=D;D*=r-N}return s},exports.calcBasisFunctions=function(e,t,r,a){var i=[],n=[],o=[];i[0]=1;for(var s=1;s<=r;++s){n[s]=t-a[e+1-s],o[s]=a[e+s]-t;for(var l=0,u=0;u<s;++u){var c=o[u+1],h=n[s-u],d=i[u]/(c+h);i[u]=l+c*d,l=h*d}i[s]=l}return i},exports.calcKoverI=function(e,t){for(var r=1,a=2;a<=e;++a)r*=a;for(var i=1,n=2;n<=t;++n)i*=n;for(var o=2;o<=e-t;++o)i*=o;return r/i},exports.calcNURBSDerivatives=Zn,exports.calcRationalCurveDerivatives=function(t){for(var r=t.length,a=[],i=[],n=0;n<r;++n){var o=t[n];a[n]=new e.Vector3(o.x,o.y,o.z),i[n]=o.w}for(var s=[],l=0;l<r;++l){for(var u=a[l].clone(),c=1;c<=l;++c)u.sub(s[l-c].clone().multiplyScalar(this.calcKoverI(l,c)*i[c]));s[l]=u.divideScalar(i[0])}return s},exports.calcSurfacePoint=$n,exports.computeMorphedAttributes=Ve,exports.edgeTable=Ea,exports.estimateBytesUsed=Oe,exports.findSpan=function(e,t,r){var a=r.length-e-1;if(t>=r[a])return a-1;if(t<=r[e])return e;for(var i=e,n=a,o=Math.floor((i+n)/2);t<r[o]||t>=r[o+1];)t<r[o]?n=o:i=o,o=Math.floor((i+n)/2);return o},exports.getUniforms=Ee,exports.gosper=function(e){e=void 0!==e?e:1;var t=function(e){for(var t,r=e.axiom,a=0,i=e.steps;0<=i?a<i:a>i;0<=i?a++:a--){t="";for(var n=0,o=r.length;n<o;n++){var s=r[n];s in e.rules?t+=e.rules[s]:t+=s}r=t}return t}({axiom:"A",steps:4,rules:{A:"A+BF++BF-FA--FAFA-BF+",B:"-FA+BFBF++BF+FA--FA-B"}});return function(e){for(var t=0,r=0,a=0,i=[0,0,0],n=e.fractal,o=0,s=n.length;o<s;o++){var l=n[o];"+"===l?a+=e.angle:"-"===l?a-=e.angle:"F"===l&&(t+=e.size*Math.cos(a),r+=-e.size*Math.sin(a),i.push(t,r,0))}return i}({fractal:t,size:e,angle:Math.PI/3})},exports.hilbert2D=function t(r,a,i,n,o,s,l){r=void 0!==r?r:new e.Vector3(0,0,0);var u=(a=void 0!==a?a:10)/2,c=(i=void 0!==i?i:1,n=void 0!==n?n:0,o=void 0!==o?o:1,s=void 0!==s?s:2,l=void 0!==l?l:3,[new e.Vector3(r.x-u,r.y,r.z-u),new e.Vector3(r.x-u,r.y,r.z+u),new e.Vector3(r.x+u,r.y,r.z+u),new e.Vector3(r.x+u,r.y,r.z-u)]),h=[c[n],c[o],c[s],c[l]];if(0<=--i){var d=[];return Array.prototype.push.apply(d,t(h[0],u,i,n,l,s,o)),Array.prototype.push.apply(d,t(h[1],u,i,n,o,s,l)),Array.prototype.push.apply(d,t(h[2],u,i,n,o,s,l)),Array.prototype.push.apply(d,t(h[3],u,i,s,o,n,l)),d}return h},exports.hilbert3D=function t(r,a,i,n,o,s,l,u,c,h,d){r=void 0!==r?r:new e.Vector3(0,0,0);var f=(a=void 0!==a?a:10)/2,p=(i=void 0!==i?i:1,n=void 0!==n?n:0,o=void 0!==o?o:1,s=void 0!==s?s:2,l=void 0!==l?l:3,u=void 0!==u?u:4,c=void 0!==c?c:5,h=void 0!==h?h:6,d=void 0!==d?d:7,[new e.Vector3(r.x-f,r.y+f,r.z-f),new e.Vector3(r.x-f,r.y+f,r.z+f),new e.Vector3(r.x-f,r.y-f,r.z+f),new e.Vector3(r.x-f,r.y-f,r.z-f),new e.Vector3(r.x+f,r.y-f,r.z-f),new e.Vector3(r.x+f,r.y-f,r.z+f),new e.Vector3(r.x+f,r.y+f,r.z+f),new e.Vector3(r.x+f,r.y+f,r.z-f)]),m=[p[n],p[o],p[s],p[l],p[u],p[c],p[h],p[d]];if(--i>=0){var v=[];return Array.prototype.push.apply(v,t(m[0],f,i,n,l,u,d,h,c,s,o)),Array.prototype.push.apply(v,t(m[1],f,i,n,d,h,o,s,c,u,l)),Array.prototype.push.apply(v,t(m[2],f,i,n,d,h,o,s,c,u,l)),Array.prototype.push.apply(v,t(m[3],f,i,s,l,n,o,h,d,u,c)),Array.prototype.push.apply(v,t(m[4],f,i,s,l,n,o,h,d,u,c)),Array.prototype.push.apply(v,t(m[5],f,i,u,l,s,c,h,o,n,d)),Array.prototype.push.apply(v,t(m[6],f,i,u,l,s,c,h,o,n,d)),Array.prototype.push.apply(v,t(m[7],f,i,h,c,s,o,n,l,u,d)),v}return m},exports.initSplineTexture=Te,exports.interleaveAttributes=Ie,exports.mergeBufferAttributes=_e,exports.mergeBufferGeometries=Re,exports.mergeVertices=Ue,exports.modifyShader=Be,exports.scaleTo=Kc,exports.toTrianglesDrawMode=ke,exports.triTable=Ba,exports.updateSplineTexture=Ce;
