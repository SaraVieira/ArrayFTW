"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e,r,o,a,n,i,s,c,h,m,l,p,u,d,y=require("three"),P=(t=new y.Frustum,e=new y.Vector3,r=new y.Vector3,o=new y.Vector3,a=new y.Vector3,n=new y.Vector3,i=new y.Vector3,s=new y.Vector3,c=new y.Vector3,h=new y.Vector3,m=new y.Vector3,l=new y.Vector3,p=new y.Vector3,u=new y.Vector3,d=new y.Vector3,function(){function P(t,e,r){this.camera=t,this.scene=e,this.startPoint=new y.Vector3,this.endPoint=new y.Vector3,this.collection=[],this.deep=r||Number.MAX_VALUE}var x=P.prototype;return x.select=function(e,r){return this.startPoint=e||this.startPoint,this.endPoint=r||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(t,this.scene),this.collection},x.updateFrustum=function(e,y){if(e=e||this.startPoint,y=y||this.endPoint,e.x===y.x&&(y.x+=Number.EPSILON),e.y===y.y&&(y.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera)r.copy(e),r.x=Math.min(e.x,y.x),r.y=Math.max(e.y,y.y),y.x=Math.max(e.x,y.x),y.y=Math.min(e.y,y.y),o.setFromMatrixPosition(this.camera.matrixWorld),a.copy(r),n.set(y.x,r.y,0),i.copy(y),s.set(r.x,y.y,0),a.unproject(this.camera),n.unproject(this.camera),i.unproject(this.camera),s.unproject(this.camera),p.copy(a).sub(o),u.copy(n).sub(o),d.copy(i).sub(o),p.normalize(),u.normalize(),d.normalize(),p.multiplyScalar(this.deep),u.multiplyScalar(this.deep),d.multiplyScalar(this.deep),p.add(o),u.add(o),d.add(o),(P=t.planes)[0].setFromCoplanarPoints(o,a,n),P[1].setFromCoplanarPoints(o,n,i),P[2].setFromCoplanarPoints(i,s,o),P[3].setFromCoplanarPoints(s,a,o),P[4].setFromCoplanarPoints(n,i,s),P[5].setFromCoplanarPoints(d,u,p),P[5].normal.multiplyScalar(-1);else if(this.camera.isOrthographicCamera){var P,x=Math.min(e.x,y.x),F=Math.max(e.y,y.y),w=Math.max(e.x,y.x),C=Math.min(e.y,y.y);a.set(x,F,-1),n.set(w,F,-1),i.set(w,C,-1),s.set(x,C,-1),c.set(x,F,1),h.set(w,F,1),m.set(w,C,1),l.set(x,C,1),a.unproject(this.camera),n.unproject(this.camera),i.unproject(this.camera),s.unproject(this.camera),c.unproject(this.camera),h.unproject(this.camera),m.unproject(this.camera),l.unproject(this.camera),(P=t.planes)[0].setFromCoplanarPoints(a,c,h),P[1].setFromCoplanarPoints(n,h,m),P[2].setFromCoplanarPoints(m,l,s),P[3].setFromCoplanarPoints(l,c,a),P[4].setFromCoplanarPoints(n,i,s),P[5].setFromCoplanarPoints(m,h,c),P[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")},x.searchChildInFrustum=function(t,r){if((r.isMesh||r.isLine||r.isPoints)&&void 0!==r.material&&(null===r.geometry.boundingSphere&&r.geometry.computeBoundingSphere(),e.copy(r.geometry.boundingSphere.center),e.applyMatrix4(r.matrixWorld),t.containsPoint(e)&&this.collection.push(r)),r.children.length>0)for(var o=0;o<r.children.length;o++)this.searchChildInFrustum(t,r.children[o])},P}());exports.SelectionBox=P;
