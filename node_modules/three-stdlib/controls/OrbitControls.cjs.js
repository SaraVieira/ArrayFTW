"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/assertThisInitialized"),t=require("@babel/runtime/helpers/inheritsLoose"),a=require("@babel/runtime/helpers/defineProperty"),n=require("three");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(e),r=o(t),c=o(a),u=function(e){function t(t,a){var o,r,u,l,s,d,m;o=e.call(this)||this,c.default(i.default(o),"object",void 0),c.default(i.default(o),"domElement",void 0),c.default(i.default(o),"enabled",!0),c.default(i.default(o),"target",new n.Vector3),c.default(i.default(o),"minDistance",0),c.default(i.default(o),"maxDistance",1/0),c.default(i.default(o),"minZoom",0),c.default(i.default(o),"maxZoom",1/0),c.default(i.default(o),"minPolarAngle",0),c.default(i.default(o),"maxPolarAngle",Math.PI),c.default(i.default(o),"minAzimuthAngle",-1/0),c.default(i.default(o),"maxAzimuthAngle",1/0),c.default(i.default(o),"enableDamping",!1),c.default(i.default(o),"dampingFactor",.05),c.default(i.default(o),"enableZoom",!0),c.default(i.default(o),"zoomSpeed",1),c.default(i.default(o),"enableRotate",!0),c.default(i.default(o),"rotateSpeed",1),c.default(i.default(o),"enablePan",!0),c.default(i.default(o),"panSpeed",1),c.default(i.default(o),"screenSpacePanning",!0),c.default(i.default(o),"keyPanSpeed",7),c.default(i.default(o),"autoRotate",!1),c.default(i.default(o),"autoRotateSpeed",2),c.default(i.default(o),"keys",{LEFT:37,UP:38,RIGHT:39,BOTTOM:40}),c.default(i.default(o),"mouseButtons",{LEFT:n.MOUSE.ROTATE,MIDDLE:n.MOUSE.DOLLY,RIGHT:n.MOUSE.PAN}),c.default(i.default(o),"touches",{ONE:n.TOUCH.ROTATE,TWO:n.TOUCH.DOLLY_PAN}),c.default(i.default(o),"target0",void 0),c.default(i.default(o),"position0",void 0),c.default(i.default(o),"zoom0",void 0),c.default(i.default(o),"_domElementKeyEvents",null),c.default(i.default(o),"getPolarAngle",void 0),c.default(i.default(o),"getAzimuthalAngle",void 0),c.default(i.default(o),"listenToKeyEvents",void 0),c.default(i.default(o),"saveState",void 0),c.default(i.default(o),"reset",void 0),c.default(i.default(o),"update",void 0),c.default(i.default(o),"connect",void 0),c.default(i.default(o),"dispose",void 0),o.object=t,o.domElement=a,o.target0=o.target.clone(),o.position0=o.object.position.clone(),o.zoom0=o.object instanceof n.PerspectiveCamera?o.object.zoom:1,o.getPolarAngle=function(){return O.phi},o.getAzimuthalAngle=function(){return O.theta},o.listenToKeyEvents=function(e){e.addEventListener("keydown",te),o._domElementKeyEvents=e},o.saveState=function(){p.target0.copy(p.target),p.position0.copy(p.object.position),p.zoom0=p.object instanceof n.PerspectiveCamera?p.object.zoom:1},o.reset=function(){p.target.copy(p.target0),p.object.position.copy(p.position0),p.object instanceof n.PerspectiveCamera&&(p.object.zoom=p.zoom0,p.object.updateProjectionMatrix()),p.dispatchEvent(f),p.update(),E=v.NONE},o.update=(r=new n.Vector3,u=(new n.Quaternion).setFromUnitVectors(t.up,new n.Vector3(0,1,0)),l=u.clone().invert(),s=new n.Vector3,d=new n.Quaternion,m=2*Math.PI,function(){var e=p.object.position;r.copy(e).sub(p.target),r.applyQuaternion(u),O.setFromVector3(r),p.autoRotate&&E===v.NONE&&Y(2*Math.PI/60/60*p.autoRotateSpeed),p.enableDamping?(O.theta+=T.theta*p.dampingFactor,O.phi+=T.phi*p.dampingFactor):(O.theta+=T.theta,O.phi+=T.phi);var t=p.minAzimuthAngle,a=p.maxAzimuthAngle;return isFinite(t)&&isFinite(a)&&(t<-Math.PI?t+=m:t>Math.PI&&(t-=m),a<-Math.PI?a+=m:a>Math.PI&&(a-=m),O.theta=t<=a?Math.max(t,Math.min(a,O.theta)):O.theta>(t+a)/2?Math.max(t,O.theta):Math.min(a,O.theta)),O.phi=Math.max(p.minPolarAngle,Math.min(p.maxPolarAngle,O.phi)),O.makeSafe(),O.radius*=y,O.radius=Math.max(p.minDistance,Math.min(p.maxDistance,O.radius)),!0===p.enableDamping?p.target.addScaledVector(P,p.dampingFactor):p.target.add(P),r.setFromSpherical(O),r.applyQuaternion(l),e.copy(p.target).add(r),p.object.lookAt(p.target),!0===p.enableDamping?(T.theta*=1-p.dampingFactor,T.phi*=1-p.dampingFactor,P.multiplyScalar(1-p.dampingFactor)):(T.set(0,0,0),P.set(0,0,0)),y=1,!!(L||s.distanceToSquared(p.object.position)>g||8*(1-d.dot(p.object.quaternion))>g)&&(p.dispatchEvent(f),s.copy(p.object.position),d.copy(p.object.quaternion),L=!1,!0)}),o.connect=function(e){e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),p.domElement=e,p.domElement.addEventListener("contextmenu",ie),p.domElement.addEventListener("pointerdown",Q),p.domElement.addEventListener("wheel",ee),p.domElement.addEventListener("touchstart",ae),p.domElement.addEventListener("touchend",oe),p.domElement.addEventListener("touchmove",ne)},o.dispose=function(){var e,t,a,n,o,i,r,c;null===(e=p.domElement)||void 0===e||e.removeEventListener("contextmenu",ie),null===(t=p.domElement)||void 0===t||t.removeEventListener("pointerdown",Q),null===(a=p.domElement)||void 0===a||a.removeEventListener("wheel",ee),null===(n=p.domElement)||void 0===n||n.removeEventListener("touchstart",ae),null===(o=p.domElement)||void 0===o||o.removeEventListener("touchend",oe),null===(i=p.domElement)||void 0===i||i.removeEventListener("touchmove",ne),null===(r=p.domElement)||void 0===r||r.ownerDocument.removeEventListener("pointermove",J),null===(c=p.domElement)||void 0===c||c.ownerDocument.removeEventListener("pointerup",$),null!==p._domElementKeyEvents&&p._domElementKeyEvents.removeEventListener("keydown",te)};var p=i.default(o),f={type:"change"},h={type:"start"},b={type:"end"},v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},E=v.NONE,g=1e-6,O=new n.Spherical,T=new n.Spherical,y=1,P=new n.Vector3,L=!1,j=new n.Vector2,A=new n.Vector2,w=new n.Vector2,N=new n.Vector2,M=new n.Vector2,C=new n.Vector2,S=new n.Vector2,D=new n.Vector2,R=new n.Vector2;function k(){return Math.pow(.95,p.zoomSpeed)}function Y(e){T.theta-=e}function x(e){T.phi-=e}var H,U=(H=new n.Vector3,function(e,t){H.setFromMatrixColumn(t,0),H.multiplyScalar(-e),P.add(H)}),_=function(){var e=new n.Vector3;return function(t,a){!0===p.screenSpacePanning?e.setFromMatrixColumn(a,1):(e.setFromMatrixColumn(a,0),e.crossVectors(p.object.up,e)),e.multiplyScalar(t),P.add(e)}}(),V=function(){var e=new n.Vector3;return function(t,a){var o=p.domElement;if(o&&p.object instanceof n.PerspectiveCamera&&p.object.isPerspectiveCamera){var i=p.object.position;e.copy(i).sub(p.target);var r=e.length();r*=Math.tan(p.object.fov/2*Math.PI/180),U(2*t*r/o.clientHeight,p.object.matrix),_(2*a*r/o.clientHeight,p.object.matrix)}else o&&p.object instanceof n.OrthographicCamera&&p.object.isOrthographicCamera?(U(t*(p.object.right-p.object.left)/p.object.zoom/o.clientWidth,p.object.matrix),_(a*(p.object.top-p.object.bottom)/p.object.zoom/o.clientHeight,p.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),p.enablePan=!1)}}();function z(e){p.object instanceof n.PerspectiveCamera&&p.object.isPerspectiveCamera?y/=e:p.object instanceof n.OrthographicCamera&&p.object.isOrthographicCamera?(p.object.zoom=Math.max(p.minZoom,Math.min(p.maxZoom,p.object.zoom*e)),p.object.updateProjectionMatrix(),L=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),p.enableZoom=!1)}function I(e){p.object instanceof n.PerspectiveCamera&&p.object.isPerspectiveCamera?y*=e:p.object instanceof n.OrthographicCamera&&p.object.isOrthographicCamera?(p.object.zoom=Math.max(p.minZoom,Math.min(p.maxZoom,p.object.zoom/e)),p.object.updateProjectionMatrix(),L=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),p.enableZoom=!1)}function X(e){j.set(e.clientX,e.clientY)}function F(e){N.set(e.clientX,e.clientY)}function Z(e){if(1==e.touches.length)j.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);j.set(t,a)}}function K(e){if(1==e.touches.length)N.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);N.set(t,a)}}function q(e){var t=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+a*a);S.set(0,n)}function B(e){if(1==e.touches.length)A.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);A.set(t,a)}w.subVectors(A,j).multiplyScalar(p.rotateSpeed);var n=p.domElement;n&&(Y(2*Math.PI*w.x/n.clientHeight),x(2*Math.PI*w.y/n.clientHeight)),j.copy(A)}function G(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,a)}C.subVectors(M,N).multiplyScalar(p.panSpeed),V(C.x,C.y),N.copy(M)}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+a*a);D.set(0,n),R.set(0,Math.pow(D.y/S.y,p.zoomSpeed)),z(R.y),S.copy(D)}function Q(e){if(!1!==p.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t,a;switch(e.preventDefault(),null!==(t=p.domElement)&&void 0!==t&&t.focus?p.domElement.focus():window.focus(),e.button){case 0:a=p.mouseButtons.LEFT;break;case 1:a=p.mouseButtons.MIDDLE;break;case 2:a=p.mouseButtons.RIGHT;break;default:a=-1}switch(a){case n.MOUSE.DOLLY:if(!1===p.enableZoom)return;!function(e){S.set(e.clientX,e.clientY)}(e),E=v.DOLLY;break;case n.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===p.enablePan)return;F(e),E=v.PAN}else{if(!1===p.enableRotate)return;X(e),E=v.ROTATE}break;case n.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===p.enableRotate)return;X(e),E=v.ROTATE}else{if(!1===p.enablePan)return;F(e),E=v.PAN}break;default:E=v.NONE}if(E!==v.NONE){var o,i;null===(o=p.domElement)||void 0===o||o.ownerDocument.addEventListener("pointermove",J),null===(i=p.domElement)||void 0===i||i.ownerDocument.addEventListener("pointerup",$),p.dispatchEvent(h)}}(e)}}function J(e){if(!1!==p.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===p.enabled)return;switch(e.preventDefault(),E){case v.ROTATE:if(!1===p.enableRotate)return;!function(e){A.set(e.clientX,e.clientY),w.subVectors(A,j).multiplyScalar(p.rotateSpeed);var t=p.domElement;t&&(Y(2*Math.PI*w.x/t.clientHeight),x(2*Math.PI*w.y/t.clientHeight)),j.copy(A),p.update()}(e);break;case v.DOLLY:if(!1===p.enableZoom)return;!function(e){D.set(e.clientX,e.clientY),R.subVectors(D,S),R.y>0?z(k()):R.y<0&&I(k()),S.copy(D),p.update()}(e);break;case v.PAN:if(!1===p.enablePan)return;!function(e){M.set(e.clientX,e.clientY),C.subVectors(M,N).multiplyScalar(p.panSpeed),V(C.x,C.y),N.copy(M),p.update()}(e)}}(e)}}function $(e){switch(e.pointerType){case"mouse":case"pen":!function(){var e,t;if(null===(e=p.domElement)||void 0===e||e.ownerDocument.removeEventListener("pointermove",J),null===(t=p.domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerup",$),!1===p.enabled)return;p.dispatchEvent(b),E=v.NONE}()}}function ee(e){!1===p.enabled||!1===p.enableZoom||E!==v.NONE&&E!==v.ROTATE||(e.preventDefault(),p.dispatchEvent(h),function(e){e.deltaY<0?I(k()):e.deltaY>0&&z(k()),p.update()}(e),p.dispatchEvent(b))}function te(e){!1!==p.enabled&&!1!==p.enablePan&&function(e){var t=!1;switch(e.keyCode){case p.keys.UP:V(0,p.keyPanSpeed),t=!0;break;case p.keys.BOTTOM:V(0,-p.keyPanSpeed),t=!0;break;case p.keys.LEFT:V(p.keyPanSpeed,0),t=!0;break;case p.keys.RIGHT:V(-p.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),p.update())}(e)}function ae(e){if(!1!==p.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(p.touches.ONE){case n.TOUCH.ROTATE:if(!1===p.enableRotate)return;Z(e),E=v.TOUCH_ROTATE;break;case n.TOUCH.PAN:if(!1===p.enablePan)return;K(e),E=v.TOUCH_PAN;break;default:E=v.NONE}break;case 2:switch(p.touches.TWO){case n.TOUCH.DOLLY_PAN:if(!1===p.enableZoom&&!1===p.enablePan)return;!function(e){p.enableZoom&&q(e),p.enablePan&&K(e)}(e),E=v.TOUCH_DOLLY_PAN;break;case n.TOUCH.DOLLY_ROTATE:if(!1===p.enableZoom&&!1===p.enableRotate)return;!function(e){p.enableZoom&&q(e),p.enableRotate&&Z(e)}(e),E=v.TOUCH_DOLLY_ROTATE;break;default:E=v.NONE}break;default:E=v.NONE}E!==v.NONE&&p.dispatchEvent(h)}}function ne(e){if(!1!==p.enabled)switch(e.preventDefault(),E){case v.TOUCH_ROTATE:if(!1===p.enableRotate)return;B(e),p.update();break;case v.TOUCH_PAN:if(!1===p.enablePan)return;G(e),p.update();break;case v.TOUCH_DOLLY_PAN:if(!1===p.enableZoom&&!1===p.enablePan)return;!function(e){p.enableZoom&&W(e),p.enablePan&&G(e)}(e),p.update();break;case v.TOUCH_DOLLY_ROTATE:if(!1===p.enableZoom&&!1===p.enableRotate)return;!function(e){p.enableZoom&&W(e),p.enableRotate&&B(e)}(e),p.update();break;default:E=v.NONE}}function oe(){!1!==p.enabled&&(p.dispatchEvent(b),E=v.NONE)}function ie(e){!1!==p.enabled&&e.preventDefault()}return void 0!==a&&o.connect(a),o.update(),o}return r.default(t,e),t}(n.EventDispatcher),l=function(e){function t(t,a){var o;return(o=e.call(this,t,a)||this).screenSpacePanning=!1,o.mouseButtons.LEFT=n.MOUSE.PAN,o.mouseButtons.RIGHT=n.MOUSE.ROTATE,o.touches.ONE=n.TOUCH.PAN,o.touches.TWO=n.TOUCH.DOLLY_ROTATE,o}return r.default(t,e),t}(u);exports.MapControls=l,exports.OrbitControls=u;
