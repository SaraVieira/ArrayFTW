"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/assertThisInitialized"),t=require("@babel/runtime/helpers/inheritsLoose"),a=require("@babel/runtime/helpers/defineProperty"),o=require("three");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=n(e),d=n(t),r=n(a),u=function(e){function t(t,a){var n;return n=e.call(this)||this,r.default(l.default(n),"object",void 0),r.default(l.default(n),"domElement",void 0),r.default(l.default(n),"enabled",!0),r.default(l.default(n),"movementSpeed",1),r.default(l.default(n),"lookSpeed",.005),r.default(l.default(n),"lookVertical",!0),r.default(l.default(n),"autoForward",!1),r.default(l.default(n),"activeLook",!0),r.default(l.default(n),"heightSpeed",!1),r.default(l.default(n),"heightCoef",1),r.default(l.default(n),"heightMin",0),r.default(l.default(n),"heightMax",1),r.default(l.default(n),"constrainVertical",!1),r.default(l.default(n),"verticalMin",0),r.default(l.default(n),"verticalMax",Math.PI),r.default(l.default(n),"mouseDragOn",!1),r.default(l.default(n),"autoSpeedFactor",0),r.default(l.default(n),"mouseX",0),r.default(l.default(n),"mouseY",0),r.default(l.default(n),"moveForward",!1),r.default(l.default(n),"moveBackward",!1),r.default(l.default(n),"moveLeft",!1),r.default(l.default(n),"moveRight",!1),r.default(l.default(n),"moveUp",!1),r.default(l.default(n),"moveDown",!1),r.default(l.default(n),"viewHalfX",0),r.default(l.default(n),"viewHalfY",0),r.default(l.default(n),"lat",0),r.default(l.default(n),"lon",0),r.default(l.default(n),"lookDirection",new o.Vector3),r.default(l.default(n),"spherical",new o.Spherical),r.default(l.default(n),"target",new o.Vector3),r.default(l.default(n),"dispose",(function(){n.domElement.removeEventListener("contextmenu",n.contextmenu),n.domElement.removeEventListener("mousedown",n.onMouseDown),n.domElement.removeEventListener("mousemove",n.onMouseMove),n.domElement.removeEventListener("mouseup",n.onMouseUp),window.removeEventListener("keydown",n.onKeyDown),window.removeEventListener("keyup",n.onKeyUp)})),r.default(l.default(n),"handleResize",(function(){n.domElement instanceof Document?(n.viewHalfX=window.innerWidth/2,n.viewHalfY=window.innerHeight/2):(n.viewHalfX=n.domElement.offsetWidth/2,n.viewHalfY=n.domElement.offsetHeight/2)})),r.default(l.default(n),"onMouseDown",(function(e){if(n.domElement instanceof HTMLElement&&n.domElement.focus(),e.preventDefault(),n.activeLook)switch(e.button){case 0:n.moveForward=!0;break;case 2:n.moveBackward=!0}n.mouseDragOn=!0})),r.default(l.default(n),"onMouseUp",(function(e){if(e.preventDefault(),n.activeLook)switch(e.button){case 0:n.moveForward=!1;break;case 2:n.moveBackward=!1}n.mouseDragOn=!1})),r.default(l.default(n),"onMouseMove",(function(e){n.domElement instanceof Document?(n.mouseX=e.pageX-n.viewHalfX,n.mouseY=e.pageY-n.viewHalfY):(n.mouseX=e.pageX-n.domElement.offsetLeft-n.viewHalfX,n.mouseY=e.pageY-n.domElement.offsetTop-n.viewHalfY)})),r.default(l.default(n),"onKeyDown",(function(e){switch(e.code){case"ArrowUp":case"KeyW":n.moveForward=!0;break;case"ArrowLeft":case"KeyA":n.moveLeft=!0;break;case"ArrowDown":case"KeyS":n.moveBackward=!0;break;case"ArrowRight":case"KeyD":n.moveRight=!0;break;case"KeyR":n.moveUp=!0;break;case"KeyF":n.moveDown=!0}})),r.default(l.default(n),"onKeyUp",(function(e){switch(e.code){case"ArrowUp":case"KeyW":n.moveForward=!1;break;case"ArrowLeft":case"KeyA":n.moveLeft=!1;break;case"ArrowDown":case"KeyS":n.moveBackward=!1;break;case"ArrowRight":case"KeyD":n.moveRight=!1;break;case"KeyR":n.moveUp=!1;break;case"KeyF":n.moveDown=!1}})),r.default(l.default(n),"lookAt",(function(e,t,a){return e instanceof o.Vector3?n.target.copy(e):t&&a&&n.target.set(e,t,a),n.object.lookAt(n.target),n.setOrientation(l.default(n)),l.default(n)})),r.default(l.default(n),"targetPosition",new o.Vector3),r.default(l.default(n),"update",(function(e){if(!1!==n.enabled){if(n.heightSpeed){var t=o.MathUtils.clamp(n.object.position.y,n.heightMin,n.heightMax)-n.heightMin;n.autoSpeedFactor=e*(t*n.heightCoef)}else n.autoSpeedFactor=0;var a=e*n.movementSpeed;(n.moveForward||n.autoForward&&!n.moveBackward)&&n.object.translateZ(-(a+n.autoSpeedFactor)),n.moveBackward&&n.object.translateZ(a),n.moveLeft&&n.object.translateX(-a),n.moveRight&&n.object.translateX(a),n.moveUp&&n.object.translateY(a),n.moveDown&&n.object.translateY(-a);var l=e*n.lookSpeed;n.activeLook||(l=0);var d=1;n.constrainVertical&&(d=Math.PI/(n.verticalMax-n.verticalMin)),n.lon-=n.mouseX*l,n.lookVertical&&(n.lat-=n.mouseY*l*d),n.lat=Math.max(-85,Math.min(85,n.lat));var r=o.MathUtils.degToRad(90-n.lat),u=o.MathUtils.degToRad(n.lon);n.constrainVertical&&(r=o.MathUtils.mapLinear(r,0,Math.PI,n.verticalMin,n.verticalMax));var i=n.object.position;n.targetPosition.setFromSphericalCoords(1,r,u).add(i),n.object.lookAt(n.targetPosition)}})),r.default(l.default(n),"contextmenu",(function(e){return e.preventDefault()})),r.default(l.default(n),"setOrientation",(function(e){var t=e.object.quaternion;n.lookDirection.set(0,0,-1).applyQuaternion(t),n.spherical.setFromVector3(n.lookDirection),n.lat=90-o.MathUtils.radToDeg(n.spherical.phi),n.lon=o.MathUtils.radToDeg(n.spherical.theta)})),void 0===a&&(console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.'),a=document),n.object=t,n.domElement=a,n.domElement instanceof HTMLElement&&n.domElement.setAttribute("tabindex","-1"),n.handleResize(),n.setOrientation(l.default(n)),n.domElement.addEventListener("contextmenu",n.contextmenu),n.domElement.addEventListener("mousemove",n.onMouseMove),n.domElement.addEventListener("mousedown",n.onMouseDown),n.domElement.addEventListener("mouseup",n.onMouseUp),window.addEventListener("keydown",n.onKeyDown),window.addEventListener("keyup",n.onKeyUp),n}return d.default(t,e),t}(o.EventDispatcher);exports.FirstPersonControls=u;
