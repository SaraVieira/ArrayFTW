"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/assertThisInitialized"),t=require("@babel/runtime/helpers/inheritsLoose"),n=require("@babel/runtime/helpers/defineProperty"),a=require("three");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=i(e),r=i(t),d=i(n),u=function(e){function t(t){var n;return n=e.call(this)||this,d.default(o.default(n),"object",void 0),d.default(o.default(n),"changeEvent",{type:"change"}),d.default(o.default(n),"EPS",1e-6),d.default(o.default(n),"enabled",!0),d.default(o.default(n),"deviceOrientation",{alpha:0,beta:0,gamma:0}),d.default(o.default(n),"screenOrientation",0),d.default(o.default(n),"alphaOffset",0),d.default(o.default(n),"onDeviceOrientationChangeEvent",(function(e){n.deviceOrientation=e})),d.default(o.default(n),"onScreenOrientationChangeEvent",(function(){n.screenOrientation=window.orientation||0})),d.default(o.default(n),"zee",new a.Vector3(0,0,1)),d.default(o.default(n),"euler",new a.Euler),d.default(o.default(n),"q0",new a.Quaternion),d.default(o.default(n),"q1",new a.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),d.default(o.default(n),"setObjectQuaternion",(function(e,t,a,i,o){n.euler.set(a,t,-i,"YXZ"),e.setFromEuler(n.euler),e.multiply(n.q1),e.multiply(n.q0.setFromAxisAngle(n.zee,-o))})),d.default(o.default(n),"connect",(function(){n.onScreenOrientationChangeEvent(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",n.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",n.onDeviceOrientationChangeEvent))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",n.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",n.onDeviceOrientationChangeEvent)),n.enabled=!0})),d.default(o.default(n),"disconnect",(function(){window.removeEventListener("orientationchange",n.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",n.onDeviceOrientationChangeEvent),n.enabled=!1})),d.default(o.default(n),"lastQuaternion",new a.Quaternion),d.default(o.default(n),"update",(function(){if(!1!==n.enabled){var e=n.deviceOrientation;if(e){var t=e.alpha?a.MathUtils.degToRad(e.alpha)+n.alphaOffset:0,i=e.beta?a.MathUtils.degToRad(e.beta):0,o=e.gamma?a.MathUtils.degToRad(e.gamma):0,r=n.screenOrientation?a.MathUtils.degToRad(n.screenOrientation):0;n.setObjectQuaternion(n.object.quaternion,t,i,o,r),8*(1-n.lastQuaternion.dot(n.object.quaternion))>n.EPS&&(n.lastQuaternion.copy(n.object.quaternion),n.dispatchEvent(n.changeEvent))}}})),d.default(o.default(n),"dispose",(function(){return n.disconnect()})),n.object=t,n.object.rotation.reorder("YXZ"),n.connect(),n}return r.default(t,e),t}(a.EventDispatcher);exports.DeviceOrientationControls=u;
